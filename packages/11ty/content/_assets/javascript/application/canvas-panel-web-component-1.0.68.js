/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@digirati/canvas-panel-web-components@1.0.68/dist/bundle.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
(()=>{var e,t=Object.create,i=Object.defineProperty,r=Object.defineProperties,n=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertyNames,s=Object.getOwnPropertySymbols,l=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,h=(e,t,r)=>t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,d=(e,t)=>{for(var i in t||(t={}))u.call(t,i)&&h(e,i,t[i]);if(s)for(var i of s(t))c.call(t,i)&&h(e,i,t[i]);return e},p=(e,t)=>r(e,a(t)),f=e=>i(e,"__esModule",{value:!0}),g=(e,t)=>{var i={};for(var r in e)u.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&s)for(var r of s(e))t.indexOf(r)<0&&c.call(e,r)&&(i[r]=e[r]);return i},m=(e,t)=>()=>(e&&(t=e(e=0)),t),v=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),y=(e,t,r,a)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let s of o(t))!u.call(e,s)&&(r||"default"!==s)&&i(e,s,{get:()=>t[s],enumerable:!(a=n(t,s))||a.enumerable});return e},b=(e,r)=>y(f(i(null!=e?t(l(e)):{},"default",!r&&e&&e.__esModule?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e),w=(e="undefined"!=typeof WeakMap?new WeakMap:0,(t,i)=>e&&e.get(t)||(i=y(f({}),t,1),e&&e.set(t,i),i)),x=(e,t,i)=>(h(e,"symbol"!=typeof t?t+"":t,i),i);function _(e,t){for(var i in t)e[i]=t[i];return e}function S(e){var t=e.parentNode;t&&t.removeChild(e)}function E(e,t,i){var r,n,a,o={};for(a in t)"key"==a?r=t[a]:"ref"==a?n=t[a]:o[a]=t[a];if(arguments.length>2&&(o.children=arguments.length>3?K.call(arguments,2):i),"function"==typeof e&&null!=e.defaultProps)for(a in e.defaultProps)void 0===o[a]&&(o[a]=e.defaultProps[a]);return k(e,o,r,n,null)}function k(e,t,i,r,n){var a={type:e,props:t,key:i,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==n?++Z:n};return null==n&&null!=X.vnode&&X.vnode(a),a}function C(){return{current:null}}function A(e){return e.children}function P(e,t){this.props=e,this.context=t}function O(e,t){if(null==t)return e.__?O(e.__,e.__.__k.indexOf(e)+1):null;for(var i;t<e.__k.length;t++)if(null!=(i=e.__k[t])&&null!=i.__e)return i.__e;return"function"==typeof e.type?O(e):null}function T(e){var t,i;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(i=e.__k[t])&&null!=i.__e){e.__e=e.__c.base=i.__e;break}return T(e)}}function R(e){(!e.__d&&(e.__d=!0)&&J.push(e)&&!I.__r++||te!==X.debounceRendering)&&((te=X.debounceRendering)||ee)(I)}function I(){for(var e;I.__r=J.length;)e=J.sort((function(e,t){return e.__v.__b-t.__v.__b})),J=[],e.some((function(e){var t,i,r,n,a,o;e.__d&&(a=(n=(t=e).__v).__e,(o=t.__P)&&(i=[],(r=_({},n)).__v=n.__v+1,D(o,n,r,t.__n,void 0!==o.ownerSVGElement,null!=n.__h?[a]:null,i,null==a?O(n):a,n.__h),U(i,n),n.__e!=a&&T(n)))}))}function M(e,t,i,r,n,a,o,s,l,u){var c,h,d,p,f,g,m,v=r&&r.__k||ne,y=v.length;for(i.__k=[],c=0;c<t.length;c++)if(null!=(p=i.__k[c]=null==(p=t[c])||"boolean"==typeof p?null:"string"==typeof p||"number"==typeof p||"bigint"==typeof p?k(null,p,null,null,p):Array.isArray(p)?k(A,{children:p},null,null,null):p.__b>0?k(p.type,p.props,p.key,null,p.__v):p)){if(p.__=i,p.__b=i.__b+1,null===(d=v[c])||d&&p.key==d.key&&p.type===d.type)v[c]=void 0;else for(h=0;h<y;h++){if((d=v[h])&&p.key==d.key&&p.type===d.type){v[h]=void 0;break}d=null}D(e,p,d=d||re,n,a,o,s,l,u),f=p.__e,(h=p.ref)&&d.ref!=h&&(m||(m=[]),d.ref&&m.push(d.ref,null,p),m.push(h,p.__c||f,p)),null!=f?(null==g&&(g=f),"function"==typeof p.type&&p.__k===d.__k?p.__d=l=z(p,l,e):l=F(e,p,d,v,f,l),"function"==typeof i.type&&(i.__d=l)):l&&d.__e==l&&l.parentNode!=e&&(l=O(d))}for(i.__e=g,c=y;c--;)null!=v[c]&&("function"==typeof i.type&&null!=v[c].__e&&v[c].__e==i.__d&&(i.__d=O(r,c+1)),H(v[c],v[c]));if(m)for(c=0;c<m.length;c++)W(m[c],m[++c],m[++c])}function z(e,t,i){for(var r,n=e.__k,a=0;n&&a<n.length;a++)(r=n[a])&&(r.__=e,t="function"==typeof r.type?z(r,t,i):F(i,r,r,n,r.__e,t));return t}function L(e,t){return t=t||[],null==e||"boolean"==typeof e||(Array.isArray(e)?e.some((function(e){L(e,t)})):t.push(e)),t}function F(e,t,i,r,n,a){var o,s,l;if(void 0!==t.__d)o=t.__d,t.__d=void 0;else if(null==i||n!=a||null==n.parentNode)e:if(null==a||a.parentNode!==e)e.appendChild(n),o=null;else{for(s=a,l=0;(s=s.nextSibling)&&l<r.length;l+=2)if(s==n)break e;e.insertBefore(n,a),o=a}return void 0!==o?o:n.nextSibling}function N(e,t,i){"-"===t[0]?e.setProperty(t,i):e[t]=null==i?"":"number"!=typeof i||ae.test(t)?i:i+"px"}function j(e,t,i,r,n){var a;e:if("style"===t)if("string"==typeof i)e.style.cssText=i;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)i&&t in i||N(e.style,t,"");if(i)for(t in i)r&&i[t]===r[t]||N(e.style,t,i[t])}else if("o"===t[0]&&"n"===t[1])a=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=i,i?r||e.addEventListener(t,a?B:$,a):e.removeEventListener(t,a?B:$,a);else if("dangerouslySetInnerHTML"!==t){if(n)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==i?"":i;break e}catch(e){}"function"==typeof i||(null!=i&&(!1!==i||"a"===t[0]&&"r"===t[1])?e.setAttribute(t,i):e.removeAttribute(t))}}function $(e){this.l[e.type+!1](X.event?X.event(e):e)}function B(e){this.l[e.type+!0](X.event?X.event(e):e)}function D(e,t,i,r,n,a,o,s,l){var u,c,h,d,p,f,g,m,v,y,b,w=t.type;if(void 0!==t.constructor)return null;null!=i.__h&&(l=i.__h,s=t.__e=i.__e,t.__h=null,a=[s]),(u=X.__b)&&u(t);try{e:if("function"==typeof w){if(m=t.props,v=(u=w.contextType)&&r[u.__c],y=u?v?v.props.value:u.__:r,i.__c?g=(c=t.__c=i.__c).__=c.__E:("prototype"in w&&w.prototype.render?t.__c=c=new w(m,y):(t.__c=c=new P(m,y),c.constructor=w,c.render=q),v&&v.sub(c),c.props=m,c.state||(c.state={}),c.context=y,c.__n=r,h=c.__d=!0,c.__h=[]),null==c.__s&&(c.__s=c.state),null!=w.getDerivedStateFromProps&&(c.__s==c.state&&(c.__s=_({},c.__s)),_(c.__s,w.getDerivedStateFromProps(m,c.__s))),d=c.props,p=c.state,h)null==w.getDerivedStateFromProps&&null!=c.componentWillMount&&c.componentWillMount(),null!=c.componentDidMount&&c.__h.push(c.componentDidMount);else{if(null==w.getDerivedStateFromProps&&m!==d&&null!=c.componentWillReceiveProps&&c.componentWillReceiveProps(m,y),!c.__e&&null!=c.shouldComponentUpdate&&!1===c.shouldComponentUpdate(m,c.__s,y)||t.__v===i.__v){c.props=m,c.state=c.__s,t.__v!==i.__v&&(c.__d=!1),c.__v=t,t.__e=i.__e,t.__k=i.__k,t.__k.forEach((function(e){e&&(e.__=t)})),c.__h.length&&o.push(c);break e}null!=c.componentWillUpdate&&c.componentWillUpdate(m,c.__s,y),null!=c.componentDidUpdate&&c.__h.push((function(){c.componentDidUpdate(d,p,f)}))}c.context=y,c.props=m,c.state=c.__s,(u=X.__r)&&u(t),c.__d=!1,c.__v=t,c.__P=e,u=c.render(c.props,c.state,c.context),c.state=c.__s,null!=c.getChildContext&&(r=_(_({},r),c.getChildContext())),h||null==c.getSnapshotBeforeUpdate||(f=c.getSnapshotBeforeUpdate(d,p)),b=null!=u&&u.type===A&&null==u.key?u.props.children:u,M(e,Array.isArray(b)?b:[b],t,i,r,n,a,o,s,l),c.base=t.__e,t.__h=null,c.__h.length&&o.push(c),g&&(c.__E=c.__=null),c.__e=!1}else null==a&&t.__v===i.__v?(t.__k=i.__k,t.__e=i.__e):t.__e=function(e,t,i,r,n,a,o,s){var l,u,c,h=i.props,d=t.props,p=t.type,f=0;if("svg"===p&&(n=!0),null!=a)for(;f<a.length;f++)if((l=a[f])&&"setAttribute"in l==!!p&&(p?l.localName===p:3===l.nodeType)){e=l,a[f]=null;break}if(null==e){if(null===p)return document.createTextNode(d);e=n?document.createElementNS("http://www.w3.org/2000/svg",p):document.createElement(p,d.is&&d),a=null,s=!1}if(null===p)h===d||s&&e.data===d||(e.data=d);else{if(a=a&&K.call(e.childNodes),u=(h=i.props||re).dangerouslySetInnerHTML,c=d.dangerouslySetInnerHTML,!s){if(null!=a)for(h={},f=0;f<e.attributes.length;f++)h[e.attributes[f].name]=e.attributes[f].value;(c||u)&&(c&&(u&&c.__html==u.__html||c.__html===e.innerHTML)||(e.innerHTML=c&&c.__html||""))}if(function(e,t,i,r,n){var a;for(a in i)"children"===a||"key"===a||a in t||j(e,a,null,i[a],r);for(a in t)n&&"function"!=typeof t[a]||"children"===a||"key"===a||"value"===a||"checked"===a||i[a]===t[a]||j(e,a,t[a],i[a],r)}(e,d,h,n,s),c)t.__k=[];else if(f=t.props.children,M(e,Array.isArray(f)?f:[f],t,i,r,n&&"foreignObject"!==p,a,o,a?a[0]:i.__k&&O(i,0),s),null!=a)for(f=a.length;f--;)null!=a[f]&&S(a[f]);s||("value"in d&&void 0!==(f=d.value)&&(f!==e.value||"progress"===p&&!f||"option"===p&&f!==h.value)&&j(e,"value",f,h.value,!1),"checked"in d&&void 0!==(f=d.checked)&&f!==e.checked&&j(e,"checked",f,h.checked,!1))}return e}(i.__e,t,i,r,n,a,o,l);(u=X.diffed)&&u(t)}catch(e){t.__v=null,(l||null!=a)&&(t.__e=s,t.__h=!!l,a[a.indexOf(s)]=null),X.__e(e,t,i)}}function U(e,t){X.__c&&X.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){X.__e(e,t.__v)}}))}function W(e,t,i){try{"function"==typeof e?e(t):e.current=t}catch(e){X.__e(e,i)}}function H(e,t,i){var r,n;if(X.unmount&&X.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||W(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){X.__e(e,t)}r.base=r.__P=null}if(r=e.__k)for(n=0;n<r.length;n++)r[n]&&H(r[n],t,"function"!=typeof e.type);i||null==e.__e||S(e.__e),e.__e=e.__d=void 0}function q(e,t,i){return this.constructor(e,i)}function V(e,t,i){var r,n,a;X.__&&X.__(e,t),n=(r="function"==typeof i)?null:i&&i.__k||t.__k,a=[],D(t,e=(!r&&i||t).__k=E(A,null,[e]),n||re,re,void 0!==t.ownerSVGElement,!r&&i?[i]:n?null:t.firstChild?K.call(t.childNodes):null,a,!r&&i?i:n?n.__e:t.firstChild,r),U(a,e)}function Q(e,t){V(e,t,Q)}function Y(e,t,i){var r,n,a,o=_({},e.props);for(a in t)"key"==a?r=t[a]:"ref"==a?n=t[a]:o[a]=t[a];return arguments.length>2&&(o.children=arguments.length>3?K.call(arguments,2):i),k(e.type,o,r||e.key,n||e.ref,null)}function G(e,t){var i={__c:t="__cC"+ie++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var i,r;return this.getChildContext||(i=[],(r={})[t]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&i.some(R)},this.sub=function(e){i.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){i.splice(i.indexOf(e),1),t&&t.call(e)}}),e.children}};return i.Provider.__=i.Consumer.contextType=i}var K,X,Z,J,ee,te,ie,re,ne,ae,oe=m((()=>{re={},ae=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,K=(ne=[]).slice,X={__e:function(e,t,i,r){for(var n,a,o;t=t.__;)if((n=t.__c)&&!n.__)try{if((a=n.constructor)&&null!=a.getDerivedStateFromError&&(n.setState(a.getDerivedStateFromError(e)),o=n.__d),null!=n.componentDidCatch&&(n.componentDidCatch(e,r||{}),o=n.__d),o)return n.__E=n}catch(t){e=t}throw e}},Z=0,function(e){return null!=e&&void 0===e.constructor},P.prototype.setState=function(e,t){var i;i=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=_({},this.state),"function"==typeof e&&(e=e(_({},i),this.props)),e&&_(i,e),null!=e&&this.__v&&(t&&this.__h.push(t),R(this))},P.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),R(this))},P.prototype.render=A,J=[],ee="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,I.__r=0,ie=0}));function se(e,t){X.__h&&X.__h(ke,e,Ae||t),Ae=0;var i=ke.__H||(ke.__H={__:[],__h:[]});return e>=i.__.length&&i.__.push({}),i.__[e]}function le(e){return Ae=1,ue(Se,e)}function ue(e,t,i){var r=se(Ee++,2);return r.t=e,r.__c||(r.__=[i?i(t):Se(void 0,t),function(e){var t=r.t(r.__[0],e);r.__[0]!==t&&(r.__=[t,r.__[1]],r.__c.setState({}))}],r.__c=ke),r.__}function ce(e,t){var i=se(Ee++,3);!X.__s&&_e(i.__H,t)&&(i.__=e,i.__H=t,ke.__H.__h.push(i))}function he(e,t){var i=se(Ee++,4);!X.__s&&_e(i.__H,t)&&(i.__=e,i.__H=t,ke.__h.push(i))}function de(e){return Ae=5,fe((function(){return{current:e}}),[])}function pe(e,t,i){Ae=6,he((function(){return"function"==typeof e?(e(t()),function(){return e(null)}):e?(e.current=t(),function(){return e.current=null}):void 0}),null==i?i:i.concat(e))}function fe(e,t){var i=se(Ee++,7);return _e(i.__H,t)&&(i.__=e(),i.__H=t,i.__h=e),i.__}function ge(e,t){return Ae=8,fe((function(){return e}),t)}function me(e){var t=ke.context[e.__c],i=se(Ee++,9);return i.c=e,t?(null==i.__&&(i.__=!0,t.sub(ke)),t.props.value):e.__}function ve(e,t){X.useDebugValue&&X.useDebugValue(t?t(e):e)}function ye(e){var t=se(Ee++,10),i=le();return t.__=e,ke.componentDidCatch||(ke.componentDidCatch=function(e){t.__&&t.__(e),i[1](e)}),[i[0],function(){i[1](void 0)}]}function be(){for(var e;e=Pe.shift();)if(e.__P)try{e.__H.__h.forEach(we),e.__H.__h.forEach(xe),e.__H.__h=[]}catch(t){e.__H.__h=[],X.__e(t,e.__v)}}function we(e){var t=ke,i=e.__c;"function"==typeof i&&(e.__c=void 0,i()),ke=t}function xe(e){var t=ke;e.__c=e.__(),ke=t}function _e(e,t){return!e||e.length!==t.length||t.some((function(t,i){return t!==e[i]}))}function Se(e,t){return"function"==typeof t?t(e):t}var Ee,ke,Ce,Ae,Pe,Oe,Te,Re,Ie,Me,ze,Le=m((()=>{oe(),Ae=0,Pe=[],Oe=X.__b,Te=X.__r,Re=X.diffed,Ie=X.__c,Me=X.unmount,X.__b=function(e){ke=null,Oe&&Oe(e)},X.__r=function(e){Te&&Te(e),Ee=0;var t=(ke=e.__c).__H;t&&(t.__h.forEach(we),t.__h.forEach(xe),t.__h=[])},X.diffed=function(e){Re&&Re(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==Pe.push(t)&&Ce===X.requestAnimationFrame||((Ce=X.requestAnimationFrame)||function(e){var t,i=function(){clearTimeout(r),ze&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(i,100);ze&&(t=requestAnimationFrame(i))})(be)),ke=null},X.__c=function(e,t){t.some((function(e){try{e.__h.forEach(we),e.__h=e.__h.filter((function(e){return!e.__||xe(e)}))}catch(i){t.some((function(e){e.__h&&(e.__h=[])})),t=[],X.__e(i,e.__v)}})),Ie&&Ie(e,t)},X.unmount=function(e){Me&&Me(e);var t,i=e.__c;i&&i.__H&&(i.__H.__.forEach((function(e){try{we(e)}catch(e){t=e}})),t&&X.__e(t,i.__v))},ze="function"==typeof requestAnimationFrame})),Fe={};function Ne(e,t){for(var i in t)e[i]=t[i];return e}function je(e,t){for(var i in e)if("__source"!==i&&!(i in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function $e(e){this.props=e}function Be(e,t){function i(e){var i=this.props.ref,r=i==e.ref;return!r&&i&&(i.call?i(null):i.current=null),t?!t(this.props,e)||!r:je(this.props,e)}function r(t){return this.shouldComponentUpdate=i,E(e,t)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r}function De(e){function t(t){var i=Ne({},t);return delete i.ref,e(i,t.ref||null)}return t.$$typeof=ot,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}function Ue(){this.__u=0,this.t=null,this.__b=null}function We(e){var t=e.__.__c;return t&&t.__e&&t.__e(e)}function He(e){var t,i,r;function n(n){if(t||(t=e()).then((function(e){i=e.default||e}),(function(e){r=e})),r)throw r;if(!i)throw t;return E(i,n)}return n.displayName="Lazy",n.__f=!0,n}function qe(){this.u=null,this.o=null}function Ve(e){return this.getChildContext=function(){return e.context},e.children}function Qe(e){var t=this,i=e.i;t.componentWillUnmount=function(){V(null,t.l),t.l=null,t.i=null},t.i&&t.i!==i&&t.componentWillUnmount(),e.__v?(t.l||(t.i=i,t.l={nodeType:1,parentNode:i,childNodes:[],appendChild:function(e){this.childNodes.push(e),t.i.appendChild(e)},insertBefore:function(e,i){this.childNodes.push(e),t.i.appendChild(e)},removeChild:function(e){this.childNodes.splice(this.childNodes.indexOf(e)>>>1,1),t.i.removeChild(e)}}),V(E(Ve,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}function Ye(e,t){return E(Qe,{__v:e,i:t})}function Ge(e,t,i){return null==t.__k&&(t.textContent=""),V(e,t),"function"==typeof i&&i(),e?e.__c:null}function Ke(e,t,i){return Q(e,t),"function"==typeof i&&i(),e?e.__c:null}function Xe(){}function Ze(){return this.cancelBubble}function Je(){return this.defaultPrevented}function et(e){return E.bind(null,e)}function tt(e){return!!e&&e.$$typeof===dt}function it(e){return tt(e)?Y.apply(null,arguments):e}function rt(e){return!!e.__k&&(V(null,e),!0)}function nt(e){return e&&(e.base||1===e.nodeType&&e)||null}((e,t)=>{for(var r in t)i(e,r,{get:t[r],enumerable:!0})})(Fe,{Children:()=>lt,Component:()=>P,Fragment:()=>A,PureComponent:()=>$e,StrictMode:()=>kt,Suspense:()=>Ue,SuspenseList:()=>qe,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:()=>xt,cloneElement:()=>it,createContext:()=>G,createElement:()=>E,createFactory:()=>et,createPortal:()=>Ye,createRef:()=>C,default:()=>Ct,findDOMNode:()=>nt,flushSync:()=>Et,forwardRef:()=>De,hydrate:()=>Ke,isValidElement:()=>tt,lazy:()=>He,memo:()=>Be,render:()=>Ge,unmountComponentAtNode:()=>rt,unstable_batchedUpdates:()=>St,useCallback:()=>ge,useContext:()=>me,useDebugValue:()=>ve,useEffect:()=>ce,useErrorBoundary:()=>ye,useImperativeHandle:()=>pe,useLayoutEffect:()=>he,useMemo:()=>fe,useReducer:()=>ue,useRef:()=>de,useState:()=>le,version:()=>_t});var at,ot,st,lt,ut,ct,ht,dt,pt,ft,gt,mt,vt,yt,bt,wt,xt,_t,St,Et,kt,Ct,At=m((()=>{Le(),Le(),oe(),oe(),($e.prototype=new P).isPureReactComponent=!0,$e.prototype.shouldComponentUpdate=function(e,t){return je(this.props,e)||je(this.state,t)},at=X.__b,X.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),at&&at(e)},ot=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911,st=function(e,t){return null==e?null:L(L(e).map(t))},lt={map:st,forEach:st,count:function(e){return e?L(e).length:0},only:function(e){var t=L(e);if(1!==t.length)throw"Children.only";return t[0]},toArray:L},ut=X.__e,X.__e=function(e,t,i,r){if(e.then)for(var n,a=t;a=a.__;)if((n=a.__c)&&n.__c)return null==t.__e&&(t.__e=i.__e,t.__k=i.__k),n.__c(e,t);ut(e,t,i,r)},ct=X.unmount,X.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),ct&&ct(e)},(Ue.prototype=new P).__c=function(e,t){var i=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(i);var n=We(r.__v),a=!1,o=function(){a||(a=!0,i.__R=null,n?n(s):s())};i.__R=o;var s=function(){if(! --r.__u){if(r.state.__e){var e=r.state.__e;r.__v.__k[0]=function e(t,i,r){return t&&(t.__v=null,t.__k=t.__k&&t.__k.map((function(t){return e(t,i,r)})),t.__c&&t.__c.__P===i&&(t.__e&&r.insertBefore(t.__e,t.__d),t.__c.__e=!0,t.__c.__P=r)),t}(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__e:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__e:r.__b=r.__v.__k[0]}),e.then(o,o)},Ue.prototype.componentWillUnmount=function(){this.t=[]},Ue.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var i=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=function e(t,i,r){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),t.__c.__H=null),null!=(t=Ne({},t)).__c&&(t.__c.__P===r&&(t.__c.__P=i),t.__c=null),t.__k=t.__k&&t.__k.map((function(t){return e(t,i,r)}))),t}(this.__b,i,r.__O=r.__P)}this.__b=null}var n=t.__e&&E(A,null,e.fallback);return n&&(n.__h=null),[E(A,null,t.__e?null:e.children),n]},ht=function(e,t,i){if(++i[1]===i[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(i=e.u;i;){for(;i.length>3;)i.pop()();if(i[1]<i[0])break;e.u=i=i[2]}},(qe.prototype=new P).__e=function(e){var t=this,i=We(t.__v),r=t.o.get(e);return r[0]++,function(n){var a=function(){t.props.revealOrder?(r.push(n),ht(t,e,r)):n()};i?i(a):a()}},qe.prototype.render=function(e){this.u=null,this.o=new Map;var t=L(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var i=t.length;i--;)this.o.set(t[i],this.u=[1,0,this.u]);return e.children},qe.prototype.componentDidUpdate=qe.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,i){ht(e,i,t)}))},dt=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,pt=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,ft=typeof document<"u",gt=function(e){return(typeof Symbol<"u"&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)},P.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(P.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})})),mt=X.event,X.event=function(e){return mt&&(e=mt(e)),e.persist=Xe,e.isPropagationStopped=Ze,e.isDefaultPrevented=Je,e.nativeEvent=e},yt={configurable:!0,get:function(){return this.class}},bt=X.vnode,X.vnode=function(e){var t=e.type,i=e.props,r=i;if("string"==typeof t){var n=-1===t.indexOf("-");for(var a in r={},i){var o=i[a];ft&&"children"===a&&"noscript"===t||"value"===a&&"defaultValue"in i&&null==o||("defaultValue"===a&&"value"in i&&null==i.value?a="value":"download"===a&&!0===o?o="":/ondoubleclick/i.test(a)?a="ondblclick":/^onchange(textarea|input)/i.test(a+t)&&!gt(i.type)?a="oninput":/^onfocus$/i.test(a)?a="onfocusin":/^onblur$/i.test(a)?a="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(a)?a=a.toLowerCase():n&&pt.test(a)?a=a.replace(/[A-Z0-9]/,"-$&").toLowerCase():null===o&&(o=void 0),r[a]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=L(i.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=L(i.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,i.class!=i.className&&(yt.enumerable="className"in i,null!=i.className&&(r.class=i.className),Object.defineProperty(r,"className",yt))}e.$$typeof=dt,bt&&bt(e)},wt=X.__r,X.__r=function(e){wt&&wt(e),vt=e.__c},xt={ReactCurrentDispatcher:{current:{readContext:function(e){return vt.__n[e.__c].props.value}}}},_t="17.0.2",St=function(e,t){return e(t)},Et=function(e,t){return e(t)},kt=A,Ct={useState:le,useReducer:ue,useEffect:ce,useLayoutEffect:he,useRef:de,useImperativeHandle:pe,useMemo:fe,useCallback:ge,useContext:me,useDebugValue:ve,version:"17.0.2",Children:lt,render:Ge,hydrate:Ke,unmountComponentAtNode:rt,createPortal:Ye,createElement:E,createContext:G,createFactory:et,cloneElement:it,createRef:C,Fragment:A,isValidElement:tt,findDOMNode:nt,Component:P,PureComponent:$e,memo:Be,forwardRef:De,flushSync:Et,unstable_batchedUpdates:St,StrictMode:A,Suspense:Ue,SuspenseList:qe,lazy:He,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:xt}})),Pt=v((e=>{"use strict";function t(e,t){var i=e.length;e.push(t);e:for(;0<i;){var r=i-1>>>1,a=e[r];if(!(0<n(a,t)))break e;e[r]=t,e[i]=a,i=r}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],i=e.pop();if(i!==t){e[0]=i;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var s=2*(r+1)-1,l=e[s],u=s+1,c=e[u];if(0>n(l,i))u<a&&0>n(c,l)?(e[r]=c,e[u]=i,r=u):(e[r]=l,e[s]=i,r=s);else{if(!(u<a&&0>n(c,i)))break e;e[r]=c,e[u]=i,r=u}}}return t}function n(e,t){var i=e.sortIndex-t.sortIndex;return 0!==i?i:e.id-t.id}"object"==typeof performance&&"function"==typeof performance.now?(a=performance,e.unstable_now=function(){return a.now()}):(o=Date,s=o.now(),e.unstable_now=function(){return o.now()-s});var a,o,s,l=[],u=[],c=1,h=null,d=3,p=!1,f=!1,g=!1,m="function"==typeof setTimeout?setTimeout:null,v="function"==typeof clearTimeout?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;function b(e){for(var n=i(u);null!==n;){if(null===n.callback)r(u);else{if(!(n.startTime<=e))break;r(u),n.sortIndex=n.expirationTime,t(l,n)}n=i(u)}}function w(e){if(g=!1,b(e),!f)if(null!==i(l))f=!0,I(x);else{var t=i(u);null!==t&&M(w,t.startTime-e)}}function x(t,n){f=!1,g&&(g=!1,v(A),A=-1),p=!0;var a=d;try{for(b(n),h=i(l);null!==h&&(!(h.expirationTime>n)||t&&!T());){var o=h.callback;if("function"==typeof o){h.callback=null,d=h.priorityLevel;var s=o(h.expirationTime<=n);n=e.unstable_now(),"function"==typeof s?h.callback=s:h===i(l)&&r(l),b(n)}else r(l);h=i(l)}if(null!==h)var c=!0;else{var m=i(u);null!==m&&M(w,m.startTime-n),c=!1}return c}finally{h=null,d=a,p=!1}}typeof navigator<"u"&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,S,E,k=!1,C=null,A=-1,P=5,O=-1;function T(){return!(e.unstable_now()-O<P)}function R(){if(null!==C){var t=e.unstable_now();O=t;var i=!0;try{i=C(!0,t)}finally{i?_():(k=!1,C=null)}}else k=!1}function I(e){C=e,k||(k=!0,_())}function M(t,i){A=m((function(){t(e.unstable_now())}),i)}"function"==typeof y?_=function(){y(R)}:typeof MessageChannel<"u"?(S=new MessageChannel,E=S.port2,S.port1.onmessage=R,_=function(){E.postMessage(null)}):_=function(){m(R,0)},e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){f||p||(f=!0,I(x))},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return i(l)},e.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var i=d;d=t;try{return e()}finally{d=i}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var i=d;d=e;try{return t()}finally{d=i}},e.unstable_scheduleCallback=function(r,n,a){var o=e.unstable_now();switch("object"==typeof a&&null!==a?a="number"==typeof(a=a.delay)&&0<a?o+a:o:a=o,r){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return r={id:c++,callback:n,priorityLevel:r,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>o?(r.sortIndex=a,t(u,r),null===i(l)&&r===i(u)&&(g?(v(A),A=-1):g=!0,M(w,a-o))):(r.sortIndex=s,t(l,r),f||p||(f=!0,I(x))),r},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(e){var t=d;return function(){var i=d;d=t;try{return e.apply(this,arguments)}finally{d=i}}}})),Ot=v(((e,t)=>{"use strict";t.exports=Pt()})),Tt=v(((e,t)=>{t.exports=function(e){var t={},i=(At(),w(Fe)),r=Ot(),n=Object.assign;function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,s=Symbol.for("react.element"),l=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),d=Symbol.for("react.provider"),p=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.suspense_list"),v=Symbol.for("react.memo"),y=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var b=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var x=Symbol.iterator;function _(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=x&&e[x]||e["@@iterator"])?e:null}function S(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case u:return"Fragment";case l:return"Portal";case h:return"Profiler";case c:return"StrictMode";case g:return"Suspense";case m:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case p:return(e.displayName||"Context")+".Consumer";case d:return(e._context.displayName||"Context")+".Provider";case f:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case v:return null!==(t=e.displayName||null)?t:S(e.type)||"Memo";case y:t=e._payload,e=e._init;try{return S(e(t))}catch(e){}}return null}function E(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return S(t);case 8:return t===c?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function k(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(4098&(t=e).flags)&&(i=t.return),e=t.return}while(e)}return 3===t.tag?i:null}function C(e){if(k(e)!==e)throw Error(a(188))}function A(e){var t=e.alternate;if(!t){if(null===(t=k(e)))throw Error(a(188));return t!==e?null:e}for(var i=e,r=t;;){var n=i.return;if(null===n)break;var o=n.alternate;if(null===o){if(null!==(r=n.return)){i=r;continue}break}if(n.child===o.child){for(o=n.child;o;){if(o===i)return C(n),e;if(o===r)return C(n),t;o=o.sibling}throw Error(a(188))}if(i.return!==r.return)i=n,r=o;else{for(var s=!1,l=n.child;l;){if(l===i){s=!0,i=n,r=o;break}if(l===r){s=!0,r=n,i=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===i){s=!0,i=o,r=n;break}if(l===r){s=!0,r=o,i=n;break}l=l.sibling}if(!s)throw Error(a(189))}}if(i.alternate!==r)throw Error(a(190))}if(3!==i.tag)throw Error(a(188));return i.stateNode.current===i?e:t}function P(e){return null!==(e=A(e))?O(e):null}function O(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=O(e);if(null!==t)return t;e=e.sibling}return null}function T(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){if(4!==e.tag){var t=T(e);if(null!==t)return t}e=e.sibling}return null}var R,I=Array.isArray,M=e.getPublicInstance,z=e.getRootHostContext,L=e.getChildHostContext,F=e.prepareForCommit,N=e.resetAfterCommit,j=e.createInstance,$=e.appendInitialChild,B=e.finalizeInitialChildren,D=e.prepareUpdate,U=e.shouldSetTextContent,W=e.createTextInstance,H=e.scheduleTimeout,q=e.cancelTimeout,V=e.noTimeout,Q=e.isPrimaryRenderer,Y=e.supportsMutation,G=e.supportsPersistence,K=e.supportsHydration,X=e.getInstanceFromNode,Z=e.preparePortalMount,J=e.getCurrentEventPriority,ee=e.detachDeletedInstance,te=e.supportsMicrotasks,ie=e.scheduleMicrotask,re=e.supportsTestSelectors,ne=e.findFiberRoot,ae=e.getBoundingRect,oe=e.getTextContent,se=e.isHiddenSubtree,le=e.matchAccessibilityRole,ue=e.setFocusIfFocusable,ce=e.setupIntersectionObserver,he=e.appendChild,de=e.appendChildToContainer,pe=e.commitTextUpdate,fe=e.commitMount,ge=e.commitUpdate,me=e.insertBefore,ve=e.insertInContainerBefore,ye=e.removeChild,be=e.removeChildFromContainer,we=e.resetTextContent,xe=e.hideInstance,_e=e.hideTextInstance,Se=e.unhideInstance,Ee=e.unhideTextInstance,ke=e.clearContainer,Ce=e.cloneInstance,Ae=e.createContainerChildSet,Pe=e.appendChildToContainerChildSet,Oe=e.finalizeContainerChildren,Te=e.replaceContainerChildren,Re=e.cloneHiddenInstance,Ie=e.cloneHiddenTextInstance,Me=e.canHydrateInstance,ze=e.canHydrateTextInstance,Le=e.canHydrateSuspenseInstance,Ne=e.isSuspenseInstancePending,je=e.isSuspenseInstanceFallback,$e=e.getSuspenseInstanceFallbackErrorDetails,Be=e.registerSuspenseInstanceRetry,De=e.getNextHydratableSibling,Ue=e.getFirstHydratableChild,We=e.getFirstHydratableChildWithinContainer,He=e.getFirstHydratableChildWithinSuspenseInstance,qe=e.hydrateInstance,Ve=e.hydrateTextInstance,Qe=e.hydrateSuspenseInstance,Ye=e.getNextHydratableInstanceAfterSuspenseInstance,Ge=e.commitHydratedContainer,Ke=e.commitHydratedSuspenseInstance,Xe=e.clearSuspenseBoundary,Ze=e.clearSuspenseBoundaryFromContainer,Je=e.shouldDeleteUnhydratedTailInstances,et=e.didNotMatchHydratedContainerTextInstance,tt=e.didNotMatchHydratedTextInstance;function it(e){if(void 0===R)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);R=t&&t[1]||""}return"\n"+R+e}var rt=!1;function nt(e,t){if(!e||rt)return"";rt=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var r=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){r=e}e.call(t.prototype)}else{try{throw Error()}catch(e){r=e}e()}}catch(t){if(t&&r&&"string"==typeof t.stack){for(var n=t.stack.split("\n"),a=r.stack.split("\n"),o=n.length-1,s=a.length-1;1<=o&&0<=s&&n[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(n[o]!==a[s]){if(1!==o||1!==s)do{if(o--,0>--s||n[o]!==a[s]){var l="\n"+n[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=s);break}}}finally{rt=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?it(e):""}var at=Object.prototype.hasOwnProperty,ot=[],st=-1;function lt(e){return{current:e}}function ut(e){0>st||(e.current=ot[st],ot[st]=null,st--)}function ct(e,t){st++,ot[st]=e.current,e.current=t}var ht={},dt=lt(ht),pt=lt(!1),ft=ht;function gt(e,t){var i=e.type.contextTypes;if(!i)return ht;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var n,a={};for(n in i)a[n]=t[n];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function mt(e){return null!=(e=e.childContextTypes)}function vt(){ut(pt),ut(dt)}function yt(e,t,i){if(dt.current!==ht)throw Error(a(168));ct(dt,t),ct(pt,i)}function bt(e,t,i){var r=e.stateNode;if(t=t.childContextTypes,"function"!=typeof r.getChildContext)return i;for(var o in r=r.getChildContext())if(!(o in t))throw Error(a(108,E(e)||"Unknown",o));return n({},i,r)}function wt(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ht,ft=dt.current,ct(dt,e),ct(pt,pt.current),!0}function xt(e,t,i){var r=e.stateNode;if(!r)throw Error(a(169));i?(e=bt(e,t,ft),r.__reactInternalMemoizedMergedChildContext=e,ut(pt),ut(dt),ct(dt,e)):ut(pt),ct(pt,i)}var _t=Math.clz32?Math.clz32:function(e){return 0==(e>>>=0)?32:31-(St(e)/Et|0)|0},St=Math.log,Et=Math.LN2;var kt=64,Ct=4194304;function Pt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Tt(e,t){var i=e.pendingLanes;if(0===i)return 0;var r=0,n=e.suspendedLanes,a=e.pingedLanes,o=268435455&i;if(0!==o){var s=o&~n;0!==s?r=Pt(s):0!==(a&=o)&&(r=Pt(a))}else 0!==(o=i&~n)?r=Pt(o):0!==a&&(r=Pt(a));if(0===r)return 0;if(0!==t&&t!==r&&0==(t&n)&&((n=r&-r)>=(a=t&-t)||16===n&&0!=(4194240&a)))return t;if(0!=(4&r)&&(r|=16&i),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)n=1<<(i=31-_t(t)),r|=e[i],t&=~n;return r}function Rt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function It(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Mt(){var e=kt;return 0==(4194240&(kt<<=1))&&(kt=64),e}function zt(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function Lt(e,t,i){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-_t(t)]=i}function Ft(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var r=31-_t(i),n=1<<r;n&t|e[r]&t&&(e[r]|=t),i&=~n}}var Nt=0;function jt(e){return 1<(e&=-e)?4<e?0!=(268435455&e)?16:536870912:4:1}var $t=r.unstable_scheduleCallback,Bt=r.unstable_cancelCallback,Dt=r.unstable_shouldYield,Ut=r.unstable_requestPaint,Wt=r.unstable_now,Ht=r.unstable_ImmediatePriority,qt=r.unstable_UserBlockingPriority,Vt=r.unstable_NormalPriority,Qt=r.unstable_IdlePriority,Yt=null,Gt=null;var Kt="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Xt=null,Zt=!1,Jt=!1;function ei(e){null===Xt?Xt=[e]:Xt.push(e)}function ti(){if(!Jt&&null!==Xt){Jt=!0;var e=0,t=Nt;try{var i=Xt;for(Nt=1;e<i.length;e++){var r=i[e];do{r=r(!0)}while(null!==r)}Xt=null,Zt=!1}catch(t){throw null!==Xt&&(Xt=Xt.slice(e+1)),$t(Ht,ti),t}finally{Nt=t,Jt=!1}}return null}var ii=[],ri=0,ni=null,ai=0,oi=[],si=0,li=null,ui=1,ci="";function hi(e,t){ii[ri++]=ai,ii[ri++]=ni,ni=e,ai=t}function di(e,t,i){oi[si++]=ui,oi[si++]=ci,oi[si++]=li,li=e;var r=ui;e=ci;var n=32-_t(r)-1;r&=~(1<<n),i+=1;var a=32-_t(t)+n;if(30<a){var o=n-n%5;a=(r&(1<<o)-1).toString(32),r>>=o,n-=o,ui=1<<32-_t(t)+n|i<<n|r,ci=a+e}else ui=1<<a|i<<n|r,ci=e}function pi(e){null!==e.return&&(hi(e,1),di(e,1,0))}function fi(e){for(;e===ni;)ni=ii[--ri],ii[ri]=null,ai=ii[--ri],ii[ri]=null;for(;e===li;)li=oi[--si],oi[si]=null,ci=oi[--si],oi[si]=null,ui=oi[--si],oi[si]=null}var gi=null,mi=null,vi=!1,yi=!1,bi=null;function wi(e,t){var i=cs(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,null===(t=e.deletions)?(e.deletions=[i],e.flags|=16):t.push(i)}function xi(e,t){switch(e.tag){case 5:return null!==(t=Me(t,e.type,e.pendingProps))&&(e.stateNode=t,gi=e,mi=Ue(t),!0);case 6:return null!==(t=ze(t,e.pendingProps))&&(e.stateNode=t,gi=e,mi=null,!0);case 13:if(null!==(t=Le(t))){var i=null!==li?{id:ui,overflow:ci}:null;return e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},(i=cs(18,null,null,0)).stateNode=t,i.return=e,e.child=i,gi=e,mi=null,!0}return!1;default:return!1}}function _i(e){return 0!=(1&e.mode)&&0==(128&e.flags)}function Si(e){if(vi){var t=mi;if(t){var i=t;if(!xi(e,t)){if(_i(e))throw Error(a(418));t=De(i);var r=gi;t&&xi(e,t)?wi(r,i):(e.flags=-4097&e.flags|2,vi=!1,gi=e)}}else{if(_i(e))throw Error(a(418));e.flags=-4097&e.flags|2,vi=!1,gi=e}}}function Ei(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;gi=e}function ki(e){if(!K||e!==gi)return!1;if(!vi)return Ei(e),vi=!0,!1;if(3!==e.tag&&(5!==e.tag||Je(e.type)&&!U(e.type,e.memoizedProps))){var t=mi;if(t){if(_i(e))throw Ci(),Error(a(418));for(;t;)wi(e,t),t=De(t)}}if(Ei(e),13===e.tag){if(!K)throw Error(a(316));if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));mi=Ye(e)}else mi=gi?De(e.stateNode):null;return!0}function Ci(){for(var e=mi;e;)e=De(e)}function Ai(){K&&(mi=gi=null,yi=vi=!1)}function Pi(e){null===bi?bi=[e]:bi.push(e)}var Oi=o.ReactCurrentBatchConfig;function Ti(e,t){if(Kt(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(r=0;r<i.length;r++){var n=i[r];if(!at.call(t,n)||!Kt(e[n],t[n]))return!1}return!0}function Ri(e){switch(e.tag){case 5:return it(e.type);case 16:return it("Lazy");case 13:return it("Suspense");case 19:return it("SuspenseList");case 0:case 2:case 15:return e=nt(e.type,!1);case 11:return e=nt(e.type.render,!1);case 1:return e=nt(e.type,!0);default:return""}}function Ii(e,t){if(e&&e.defaultProps){for(var i in t=n({},t),e=e.defaultProps)void 0===t[i]&&(t[i]=e[i]);return t}return t}var Mi=lt(null),zi=null,Li=null,Fi=null;function Ni(){Fi=Li=zi=null}function ji(e,t,i){Q?(ct(Mi,t._currentValue),t._currentValue=i):(ct(Mi,t._currentValue2),t._currentValue2=i)}function $i(e){var t=Mi.current;ut(Mi),Q?e._currentValue=t:e._currentValue2=t}function Bi(e,t,i){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===i)break;e=e.return}}function Di(e,t){zi=e,Fi=Li=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(Nn=!0),e.firstContext=null)}function Ui(e){var t=Q?e._currentValue:e._currentValue2;if(Fi!==e)if(e={context:e,memoizedValue:t,next:null},null===Li){if(null===zi)throw Error(a(308));Li=e,zi.dependencies={lanes:0,firstContext:e}}else Li=Li.next=e;return t}var Wi=null;function Hi(e){null===Wi?Wi=[e]:Wi.push(e)}function qi(e,t,i,r){var n=t.interleaved;return null===n?(i.next=i,Hi(t)):(i.next=n.next,n.next=i),t.interleaved=i,Vi(e,r)}function Vi(e,t){e.lanes|=t;var i=e.alternate;for(null!==i&&(i.lanes|=t),i=e,e=e.return;null!==e;)e.childLanes|=t,null!==(i=e.alternate)&&(i.childLanes|=t),i=e,e=e.return;return 3===i.tag?i.stateNode:null}var Qi=!1;function Yi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Gi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ki(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Xi(e,t,i){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!=(2&ao)){var n=r.pending;return null===n?t.next=t:(t.next=n.next,n.next=t),r.pending=t,Vi(e,i)}return null===(n=r.interleaved)?(t.next=t,Hi(r)):(t.next=n.next,n.next=t),r.interleaved=t,Vi(e,i)}function Zi(e,t,i){if(null!==(t=t.updateQueue)&&(t=t.shared,0!=(4194240&i))){var r=t.lanes;i|=r&=e.pendingLanes,t.lanes=i,Ft(e,i)}}function Ji(e,t){var i=e.updateQueue,r=e.alternate;if(null!==r&&i===(r=r.updateQueue)){var n=null,a=null;if(null!==(i=i.firstBaseUpdate)){do{var o={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};null===a?n=a=o:a=a.next=o,i=i.next}while(null!==i);null===a?n=a=t:a=a.next=t}else n=a=t;return i={baseState:r.baseState,firstBaseUpdate:n,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=i)}null===(e=i.lastBaseUpdate)?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function er(e,t,i,r){var a=e.updateQueue;Qi=!1;var o=a.firstBaseUpdate,s=a.lastBaseUpdate,l=a.shared.pending;if(null!==l){a.shared.pending=null;var u=l,c=u.next;u.next=null,null===s?o=c:s.next=c,s=u;var h=e.alternate;null!==h&&((l=(h=h.updateQueue).lastBaseUpdate)!==s&&(null===l?h.firstBaseUpdate=c:l.next=c,h.lastBaseUpdate=u))}if(null!==o){var d=a.baseState;for(s=0,h=c=u=null,l=o;;){var p=l.lane,f=l.eventTime;if((r&p)===p){null!==h&&(h=h.next={eventTime:f,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=e,m=l;switch(p=t,f=i,m.tag){case 1:if("function"==typeof(g=m.payload)){d=g.call(f,d,p);break e}d=g;break e;case 3:g.flags=-65537&g.flags|128;case 0:if(null==(p="function"==typeof(g=m.payload)?g.call(f,d,p):g))break e;d=n({},d,p);break e;case 2:Qi=!0}}null!==l.callback&&0!==l.lane&&(e.flags|=64,null===(p=a.effects)?a.effects=[l]:p.push(l))}else f={eventTime:f,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===h?(c=h=f,u=d):h=h.next=f,s|=p;if(null===(l=l.next)){if(null===(l=a.shared.pending))break;l=(p=l).next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}if(null===h&&(u=d),a.baseState=u,a.firstBaseUpdate=c,a.lastBaseUpdate=h,null!==(t=a.shared.interleaved)){a=t;do{s|=a.lane,a=a.next}while(a!==t)}else null===o&&(a.shared.lanes=0);fo|=s,e.lanes=s,e.memoizedState=d}}function tr(e,t,i){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],n=r.callback;if(null!==n){if(r.callback=null,r=i,"function"!=typeof n)throw Error(a(191,n));n.call(r)}}}var ir=(new i.Component).refs;function rr(e,t,i,r){i=null==(i=i(r,t=e.memoizedState))?t:n({},t,i),e.memoizedState=i,0===e.lanes&&(e.updateQueue.baseState=i)}var nr={isMounted:function(e){return!!(e=e._reactInternals)&&k(e)===e},enqueueSetState:function(e,t,i){e=e._reactInternals;var r=zo(),n=Lo(e),a=Ki(r,n);a.payload=t,null!=i&&(a.callback=i),null!==(t=Xi(e,a,n))&&(Fo(t,e,n,r),Zi(t,e,n))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var r=zo(),n=Lo(e),a=Ki(r,n);a.tag=1,a.payload=t,null!=i&&(a.callback=i),null!==(t=Xi(e,a,n))&&(Fo(t,e,n,r),Zi(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=zo(),r=Lo(e),n=Ki(i,r);n.tag=2,null!=t&&(n.callback=t),null!==(t=Xi(e,n,r))&&(Fo(t,e,r,i),Zi(t,e,r))}};function ar(e,t,i,r,n,a,o){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!Ti(i,r)||!Ti(n,a))}function or(e,t,i){var r=!1,n=ht,a=t.contextType;return"object"==typeof a&&null!==a?a=Ui(a):(n=mt(t)?ft:dt.current,a=(r=null!=(r=t.contextTypes))?gt(e,n):ht),t=new t(i,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=nr,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=a),t}function sr(e,t,i,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(i,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(i,r),t.state!==e&&nr.enqueueReplaceState(t,t.state,null)}function lr(e,t,i,r){var n=e.stateNode;n.props=i,n.state=e.memoizedState,n.refs=ir,Yi(e);var a=t.contextType;"object"==typeof a&&null!==a?n.context=Ui(a):(a=mt(t)?ft:dt.current,n.context=gt(e,a)),n.state=e.memoizedState,"function"==typeof(a=t.getDerivedStateFromProps)&&(rr(e,t,a,i),n.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof n.getSnapshotBeforeUpdate||"function"!=typeof n.UNSAFE_componentWillMount&&"function"!=typeof n.componentWillMount||(t=n.state,"function"==typeof n.componentWillMount&&n.componentWillMount(),"function"==typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount(),t!==n.state&&nr.enqueueReplaceState(n,n.state,null),er(e,i,n,r),n.state=e.memoizedState),"function"==typeof n.componentDidMount&&(e.flags|=4194308)}function ur(e,t,i){if(null!==(e=i.ref)&&"function"!=typeof e&&"object"!=typeof e){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(a(309));var r=i.stateNode}if(!r)throw Error(a(147,e));var n=r,o=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===o?t.ref:((t=function(e){var t=n.refs;t===ir&&(t=n.refs={}),null===e?delete t[o]:t[o]=e})._stringRef=o,t)}if("string"!=typeof e)throw Error(a(284));if(!i._owner)throw Error(a(290,e))}return e}function cr(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function hr(e){return(0,e._init)(e._payload)}function dr(e){function t(t,i){if(e){var r=t.deletions;null===r?(t.deletions=[i],t.flags|=16):r.push(i)}}function i(i,r){if(!e)return null;for(;null!==r;)t(i,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function n(e,t){return(e=ds(e,t)).index=0,e.sibling=null,e}function o(t,i,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<i?(t.flags|=2,i):r:(t.flags|=2,i):(t.flags|=1048576,i)}function c(t){return e&&null===t.alternate&&(t.flags|=2),t}function h(e,t,i,r){return null===t||6!==t.tag?((t=ms(i,e.mode,r)).return=e,t):((t=n(t,i)).return=e,t)}function d(e,t,i,r){var a=i.type;return a===u?f(e,t,i.props.children,r,i.key):null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===y&&hr(a)===t.type)?((r=n(t,i.props)).ref=ur(e,t,i),r.return=e,r):((r=ps(i.type,i.key,i.props,null,e.mode,r)).ref=ur(e,t,i),r.return=e,r)}function p(e,t,i,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==i.containerInfo||t.stateNode.implementation!==i.implementation?((t=vs(i,e.mode,r)).return=e,t):((t=n(t,i.children||[])).return=e,t)}function f(e,t,i,r,a){return null===t||7!==t.tag?((t=fs(i,e.mode,r,a)).return=e,t):((t=n(t,i)).return=e,t)}function g(e,t,i){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=ms(""+t,e.mode,i)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case s:return(i=ps(t.type,t.key,t.props,null,e.mode,i)).ref=ur(e,null,t),i.return=e,i;case l:return(t=vs(t,e.mode,i)).return=e,t;case y:return g(e,(0,t._init)(t._payload),i)}if(I(t)||_(t))return(t=fs(t,e.mode,i,null)).return=e,t;cr(e,t)}return null}function m(e,t,i,r){var n=null!==t?t.key:null;if("string"==typeof i&&""!==i||"number"==typeof i)return null!==n?null:h(e,t,""+i,r);if("object"==typeof i&&null!==i){switch(i.$$typeof){case s:return i.key===n?d(e,t,i,r):null;case l:return i.key===n?p(e,t,i,r):null;case y:return m(e,t,(n=i._init)(i._payload),r)}if(I(i)||_(i))return null!==n?null:f(e,t,i,r,null);cr(e,i)}return null}function v(e,t,i,r,n){if("string"==typeof r&&""!==r||"number"==typeof r)return h(t,e=e.get(i)||null,""+r,n);if("object"==typeof r&&null!==r){switch(r.$$typeof){case s:return d(t,e=e.get(null===r.key?i:r.key)||null,r,n);case l:return p(t,e=e.get(null===r.key?i:r.key)||null,r,n);case y:return v(e,t,i,(0,r._init)(r._payload),n)}if(I(r)||_(r))return f(t,e=e.get(i)||null,r,n,null);cr(t,r)}return null}return function h(d,p,f,b){if("object"==typeof f&&null!==f&&f.type===u&&null===f.key&&(f=f.props.children),"object"==typeof f&&null!==f){switch(f.$$typeof){case s:e:{for(var w=f.key,x=p;null!==x;){if(x.key===w){if((w=f.type)===u){if(7===x.tag){i(d,x.sibling),(p=n(x,f.props.children)).return=d,d=p;break e}}else if(x.elementType===w||"object"==typeof w&&null!==w&&w.$$typeof===y&&hr(w)===x.type){i(d,x.sibling),(p=n(x,f.props)).ref=ur(d,x,f),p.return=d,d=p;break e}i(d,x);break}t(d,x),x=x.sibling}f.type===u?((p=fs(f.props.children,d.mode,b,f.key)).return=d,d=p):((b=ps(f.type,f.key,f.props,null,d.mode,b)).ref=ur(d,p,f),b.return=d,d=b)}return c(d);case l:e:{for(x=f.key;null!==p;){if(p.key===x){if(4===p.tag&&p.stateNode.containerInfo===f.containerInfo&&p.stateNode.implementation===f.implementation){i(d,p.sibling),(p=n(p,f.children||[])).return=d,d=p;break e}i(d,p);break}t(d,p),p=p.sibling}(p=vs(f,d.mode,b)).return=d,d=p}return c(d);case y:return h(d,p,(x=f._init)(f._payload),b)}if(I(f))return function(n,a,s,l){for(var u=null,c=null,h=a,d=a=0,p=null;null!==h&&d<s.length;d++){h.index>d?(p=h,h=null):p=h.sibling;var f=m(n,h,s[d],l);if(null===f){null===h&&(h=p);break}e&&h&&null===f.alternate&&t(n,h),a=o(f,a,d),null===c?u=f:c.sibling=f,c=f,h=p}if(d===s.length)return i(n,h),vi&&hi(n,d),u;if(null===h){for(;d<s.length;d++)null!==(h=g(n,s[d],l))&&(a=o(h,a,d),null===c?u=h:c.sibling=h,c=h);return vi&&hi(n,d),u}for(h=r(n,h);d<s.length;d++)null!==(p=v(h,n,d,s[d],l))&&(e&&null!==p.alternate&&h.delete(null===p.key?d:p.key),a=o(p,a,d),null===c?u=p:c.sibling=p,c=p);return e&&h.forEach((function(e){return t(n,e)})),vi&&hi(n,d),u}(d,p,f,b);if(_(f))return function(n,s,l,u){var c=_(l);if("function"!=typeof c)throw Error(a(150));if(null==(l=c.call(l)))throw Error(a(151));for(var h=c=null,d=s,p=s=0,f=null,y=l.next();null!==d&&!y.done;p++,y=l.next()){d.index>p?(f=d,d=null):f=d.sibling;var b=m(n,d,y.value,u);if(null===b){null===d&&(d=f);break}e&&d&&null===b.alternate&&t(n,d),s=o(b,s,p),null===h?c=b:h.sibling=b,h=b,d=f}if(y.done)return i(n,d),vi&&hi(n,p),c;if(null===d){for(;!y.done;p++,y=l.next())null!==(y=g(n,y.value,u))&&(s=o(y,s,p),null===h?c=y:h.sibling=y,h=y);return vi&&hi(n,p),c}for(d=r(n,d);!y.done;p++,y=l.next())null!==(y=v(d,n,p,y.value,u))&&(e&&null!==y.alternate&&d.delete(null===y.key?p:y.key),s=o(y,s,p),null===h?c=y:h.sibling=y,h=y);return e&&d.forEach((function(e){return t(n,e)})),vi&&hi(n,p),c}(d,p,f,b);cr(d,f)}return"string"==typeof f&&""!==f||"number"==typeof f?(f=""+f,null!==p&&6===p.tag?(i(d,p.sibling),(p=n(p,f)).return=d,d=p):(i(d,p),(p=ms(f,d.mode,b)).return=d,d=p),c(d)):i(d,p)}}var pr=dr(!0),fr=dr(!1),gr={},mr=lt(gr),vr=lt(gr),yr=lt(gr);function br(e){if(e===gr)throw Error(a(174));return e}function wr(e,t){ct(yr,t),ct(vr,e),ct(mr,gr),e=z(t),ut(mr),ct(mr,e)}function xr(){ut(mr),ut(vr),ut(yr)}function _r(e){var t=br(yr.current),i=br(mr.current);i!==(t=L(i,e.type,t))&&(ct(vr,e),ct(mr,t))}function Sr(e){vr.current===e&&(ut(mr),ut(vr))}var Er=lt(0);function kr(e){for(var t=e;null!==t;){if(13===t.tag){var i=t.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||Ne(i)||je(i)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Cr=[];function Ar(){for(var e=0;e<Cr.length;e++){var t=Cr[e];Q?t._workInProgressVersionPrimary=null:t._workInProgressVersionSecondary=null}Cr.length=0}var Pr=o.ReactCurrentDispatcher,Or=o.ReactCurrentBatchConfig,Tr=0,Rr=null,Ir=null,Mr=null,zr=!1,Lr=!1,Fr=0,Nr=0;function jr(){throw Error(a(321))}function $r(e,t){if(null===t)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!Kt(e[i],t[i]))return!1;return!0}function Br(e,t,i,r,n,o){if(Tr=o,Rr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Pr.current=null===e||null===e.memoizedState?En:kn,e=i(r,n),Lr){o=0;do{if(Lr=!1,Fr=0,25<=o)throw Error(a(301));o+=1,Mr=Ir=null,t.updateQueue=null,Pr.current=Cn,e=i(r,n)}while(Lr)}if(Pr.current=Sn,t=null!==Ir&&null!==Ir.next,Tr=0,Mr=Ir=Rr=null,zr=!1,t)throw Error(a(300));return e}function Dr(){var e=0!==Fr;return Fr=0,e}function Ur(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Mr?Rr.memoizedState=Mr=e:Mr=Mr.next=e,Mr}function Wr(){if(null===Ir){var e=Rr.alternate;e=null!==e?e.memoizedState:null}else e=Ir.next;var t=null===Mr?Rr.memoizedState:Mr.next;if(null!==t)Mr=t,Ir=e;else{if(null===e)throw Error(a(310));e={memoizedState:(Ir=e).memoizedState,baseState:Ir.baseState,baseQueue:Ir.baseQueue,queue:Ir.queue,next:null},null===Mr?Rr.memoizedState=Mr=e:Mr=Mr.next=e}return Mr}function Hr(e,t){return"function"==typeof t?t(e):t}function qr(e){var t=Wr(),i=t.queue;if(null===i)throw Error(a(311));i.lastRenderedReducer=e;var r=Ir,n=r.baseQueue,o=i.pending;if(null!==o){if(null!==n){var s=n.next;n.next=o.next,o.next=s}r.baseQueue=n=o,i.pending=null}if(null!==n){o=n.next,r=r.baseState;var l=s=null,u=null,c=o;do{var h=c.lane;if((Tr&h)===h)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var d={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=d,s=r):u=u.next=d,Rr.lanes|=h,fo|=h}c=c.next}while(null!==c&&c!==o);null===u?s=r:u.next=l,Kt(r,t.memoizedState)||(Nn=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=u,i.lastRenderedState=r}if(null!==(e=i.interleaved)){n=e;do{o=n.lane,Rr.lanes|=o,fo|=o,n=n.next}while(n!==e)}else null===n&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function Vr(e){var t=Wr(),i=t.queue;if(null===i)throw Error(a(311));i.lastRenderedReducer=e;var r=i.dispatch,n=i.pending,o=t.memoizedState;if(null!==n){i.pending=null;var s=n=n.next;do{o=e(o,s.action),s=s.next}while(s!==n);Kt(o,t.memoizedState)||(Nn=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),i.lastRenderedState=o}return[o,r]}function Qr(){}function Yr(e,t){var i=Rr,r=Wr(),n=t(),o=!Kt(r.memoizedState,n);if(o&&(r.memoizedState=n,Nn=!0),r=r.queue,sn(Xr.bind(null,i,r,e),[e]),r.getSnapshot!==t||o||null!==Mr&&1&Mr.memoizedState.tag){if(i.flags|=2048,tn(9,Kr.bind(null,i,r,n,t),void 0,null),null===oo)throw Error(a(349));0!=(30&Tr)||Gr(i,t,n)}return n}function Gr(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},null===(t=Rr.updateQueue)?(t={lastEffect:null,stores:null},Rr.updateQueue=t,t.stores=[e]):null===(i=t.stores)?t.stores=[e]:i.push(e)}function Kr(e,t,i,r){t.value=i,t.getSnapshot=r,Zr(t)&&Jr(e)}function Xr(e,t,i){return i((function(){Zr(t)&&Jr(e)}))}function Zr(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!Kt(e,i)}catch(e){return!0}}function Jr(e){var t=Vi(e,1);null!==t&&Fo(t,e,1,-1)}function en(e){var t=Ur();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hr,lastRenderedState:e},t.queue=e,e=e.dispatch=bn.bind(null,Rr,e),[t.memoizedState,e]}function tn(e,t,i,r){return e={tag:e,create:t,destroy:i,deps:r,next:null},null===(t=Rr.updateQueue)?(t={lastEffect:null,stores:null},Rr.updateQueue=t,t.lastEffect=e.next=e):null===(i=t.lastEffect)?t.lastEffect=e.next=e:(r=i.next,i.next=e,e.next=r,t.lastEffect=e),e}function rn(){return Wr().memoizedState}function nn(e,t,i,r){var n=Ur();Rr.flags|=e,n.memoizedState=tn(1|t,i,void 0,void 0===r?null:r)}function an(e,t,i,r){var n=Wr();r=void 0===r?null:r;var a=void 0;if(null!==Ir){var o=Ir.memoizedState;if(a=o.destroy,null!==r&&$r(r,o.deps))return void(n.memoizedState=tn(t,i,a,r))}Rr.flags|=e,n.memoizedState=tn(1|t,i,a,r)}function on(e,t){return nn(8390656,8,e,t)}function sn(e,t){return an(2048,8,e,t)}function ln(e,t){return an(4,2,e,t)}function un(e,t){return an(4,4,e,t)}function cn(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function hn(e,t,i){return i=null!=i?i.concat([e]):null,an(4,4,cn.bind(null,t,e),i)}function dn(){}function pn(e,t){var i=Wr();t=void 0===t?null:t;var r=i.memoizedState;return null!==r&&null!==t&&$r(t,r[1])?r[0]:(i.memoizedState=[e,t],e)}function fn(e,t){var i=Wr();t=void 0===t?null:t;var r=i.memoizedState;return null!==r&&null!==t&&$r(t,r[1])?r[0]:(e=e(),i.memoizedState=[e,t],e)}function gn(e,t,i){return 0==(21&Tr)?(e.baseState&&(e.baseState=!1,Nn=!0),e.memoizedState=i):(Kt(i,t)||(i=Mt(),Rr.lanes|=i,fo|=i,e.baseState=!0),t)}function mn(e,t){var i=Nt;Nt=0!==i&&4>i?i:4,e(!0);var r=Or.transition;Or.transition={};try{e(!1),t()}finally{Nt=i,Or.transition=r}}function vn(){return Wr().memoizedState}function yn(e,t,i){var r=Lo(e);if(i={lane:r,action:i,hasEagerState:!1,eagerState:null,next:null},wn(e))xn(t,i);else if(null!==(i=qi(e,t,i,r))){Fo(i,e,r,zo()),_n(i,t,r)}}function bn(e,t,i){var r=Lo(e),n={lane:r,action:i,hasEagerState:!1,eagerState:null,next:null};if(wn(e))xn(t,n);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=a(o,i);if(n.hasEagerState=!0,n.eagerState=s,Kt(s,o)){var l=t.interleaved;return null===l?(n.next=n,Hi(t)):(n.next=l.next,l.next=n),void(t.interleaved=n)}}catch(e){}null!==(i=qi(e,t,n,r))&&(Fo(i,e,r,n=zo()),_n(i,t,r))}}function wn(e){var t=e.alternate;return e===Rr||null!==t&&t===Rr}function xn(e,t){Lr=zr=!0;var i=e.pending;null===i?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function _n(e,t,i){if(0!=(4194240&i)){var r=t.lanes;i|=r&=e.pendingLanes,t.lanes=i,Ft(e,i)}}var Sn={readContext:Ui,useCallback:jr,useContext:jr,useEffect:jr,useImperativeHandle:jr,useInsertionEffect:jr,useLayoutEffect:jr,useMemo:jr,useReducer:jr,useRef:jr,useState:jr,useDebugValue:jr,useDeferredValue:jr,useTransition:jr,useMutableSource:jr,useSyncExternalStore:jr,useId:jr,unstable_isNewReconciler:!1},En={readContext:Ui,useCallback:function(e,t){return Ur().memoizedState=[e,void 0===t?null:t],e},useContext:Ui,useEffect:on,useImperativeHandle:function(e,t,i){return i=null!=i?i.concat([e]):null,nn(4194308,4,cn.bind(null,t,e),i)},useLayoutEffect:function(e,t){return nn(4194308,4,e,t)},useInsertionEffect:function(e,t){return nn(4,2,e,t)},useMemo:function(e,t){var i=Ur();return t=void 0===t?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var r=Ur();return t=void 0!==i?i(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=yn.bind(null,Rr,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Ur().memoizedState=e},useState:en,useDebugValue:dn,useDeferredValue:function(e){return Ur().memoizedState=e},useTransition:function(){var e=en(!1),t=e[0];return e=mn.bind(null,e[1]),Ur().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var r=Rr,n=Ur();if(vi){if(void 0===i)throw Error(a(407));i=i()}else{if(i=t(),null===oo)throw Error(a(349));0!=(30&Tr)||Gr(r,t,i)}n.memoizedState=i;var o={value:i,getSnapshot:t};return n.queue=o,on(Xr.bind(null,r,o,e),[e]),r.flags|=2048,tn(9,Kr.bind(null,r,o,i,t),void 0,null),i},useId:function(){var e=Ur(),t=oo.identifierPrefix;if(vi){var i=ci;t=":"+t+"R"+(i=(ui&~(1<<32-_t(ui)-1)).toString(32)+i),0<(i=Fr++)&&(t+="H"+i.toString(32)),t+=":"}else t=":"+t+"r"+(i=Nr++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},kn={readContext:Ui,useCallback:pn,useContext:Ui,useEffect:sn,useImperativeHandle:hn,useInsertionEffect:ln,useLayoutEffect:un,useMemo:fn,useReducer:qr,useRef:rn,useState:function(){return qr(Hr)},useDebugValue:dn,useDeferredValue:function(e){return gn(Wr(),Ir.memoizedState,e)},useTransition:function(){return[qr(Hr)[0],Wr().memoizedState]},useMutableSource:Qr,useSyncExternalStore:Yr,useId:vn,unstable_isNewReconciler:!1},Cn={readContext:Ui,useCallback:pn,useContext:Ui,useEffect:sn,useImperativeHandle:hn,useInsertionEffect:ln,useLayoutEffect:un,useMemo:fn,useReducer:Vr,useRef:rn,useState:function(){return Vr(Hr)},useDebugValue:dn,useDeferredValue:function(e){var t=Wr();return null===Ir?t.memoizedState=e:gn(t,Ir.memoizedState,e)},useTransition:function(){return[Vr(Hr)[0],Wr().memoizedState]},useMutableSource:Qr,useSyncExternalStore:Yr,useId:vn,unstable_isNewReconciler:!1};function An(e,t){try{var i="",r=t;do{i+=Ri(r),r=r.return}while(r);var n=i}catch(e){n="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:n,digest:null}}function Pn(e,t,i){return{value:e,source:null,stack:null!=i?i:null,digest:null!=t?t:null}}function On(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}var Tn="function"==typeof WeakMap?WeakMap:Map;function Rn(e,t,i){(i=Ki(-1,i)).tag=3,i.payload={element:null};var r=t.value;return i.callback=function(){Eo||(Eo=!0,ko=r),On(0,t)},i}function In(e,t,i){(i=Ki(-1,i)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var n=t.value;i.payload=function(){return r(n)},i.callback=function(){On(0,t)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(i.callback=function(){On(0,t),"function"!=typeof r&&(null===Co?Co=new Set([this]):Co.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),i}function Mn(e,t,i){var r=e.pingCache;if(null===r){r=e.pingCache=new Tn;var n=new Set;r.set(t,n)}else void 0===(n=r.get(t))&&(n=new Set,r.set(t,n));n.has(i)||(n.add(i),e=ns.bind(null,e,t,i),t.then(e,e))}function zn(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function Ln(e,t,i,r,n){return 0==(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,1===i.tag&&(null===i.alternate?i.tag=17:((t=Ki(-1,1)).tag=2,Xi(i,t,1))),i.lanes|=1),e):(e.flags|=65536,e.lanes=n,e)}var Fn=o.ReactCurrentOwner,Nn=!1;function jn(e,t,i,r){t.child=null===e?fr(t,null,i,r):pr(t,e.child,i,r)}function $n(e,t,i,r,n){i=i.render;var a=t.ref;return Di(t,n),r=Br(e,t,i,r,a,n),i=Dr(),null===e||Nn?(vi&&i&&pi(t),t.flags|=1,jn(e,t,r,n),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,la(e,t,n))}function Bn(e,t,i,r,n){if(null===e){var a=i.type;return"function"!=typeof a||hs(a)||void 0!==a.defaultProps||null!==i.compare||void 0!==i.defaultProps?((e=ps(i.type,null,r,t,t.mode,n)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Dn(e,t,a,r,n))}if(a=e.child,0==(e.lanes&n)){var o=a.memoizedProps;if((i=null!==(i=i.compare)?i:Ti)(o,r)&&e.ref===t.ref)return la(e,t,n)}return t.flags|=1,(e=ds(a,r)).ref=t.ref,e.return=t,t.child=e}function Dn(e,t,i,r,n){if(null!==e){var a=e.memoizedProps;if(Ti(a,r)&&e.ref===t.ref){if(Nn=!1,t.pendingProps=r=a,0==(e.lanes&n))return t.lanes=e.lanes,la(e,t,n);0!=(131072&e.flags)&&(Nn=!0)}}return Hn(e,t,i,r,n)}function Un(e,t,i){var r=t.pendingProps,n=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0==(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ct(co,uo),uo|=i;else{if(0==(1073741824&i))return e=null!==a?a.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ct(co,uo),uo|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:i,ct(co,uo),uo|=r}else null!==a?(r=a.baseLanes|i,t.memoizedState=null):r=i,ct(co,uo),uo|=r;return jn(e,t,n,i),t.child}function Wn(e,t){var i=t.ref;(null===e&&null!==i||null!==e&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function Hn(e,t,i,r,n){var a=mt(i)?ft:dt.current;return a=gt(t,a),Di(t,n),i=Br(e,t,i,r,a,n),r=Dr(),null===e||Nn?(vi&&r&&pi(t),t.flags|=1,jn(e,t,i,n),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,la(e,t,n))}function qn(e,t,i,r,n){if(mt(i)){var a=!0;wt(t)}else a=!1;if(Di(t,n),null===t.stateNode)sa(e,t),or(t,i,r),lr(t,i,r,n),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,u=i.contextType;"object"==typeof u&&null!==u?u=Ui(u):u=gt(t,u=mt(i)?ft:dt.current);var c=i.getDerivedStateFromProps,h="function"==typeof c||"function"==typeof o.getSnapshotBeforeUpdate;h||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s!==r||l!==u)&&sr(t,o,r,u),Qi=!1;var d=t.memoizedState;o.state=d,er(t,r,o,n),l=t.memoizedState,s!==r||d!==l||pt.current||Qi?("function"==typeof c&&(rr(t,i,c,r),l=t.memoizedState),(s=Qi||ar(t,i,s,r,d,l,u))?(h||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(t.flags|=4194308)):("function"==typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=u,r=s):("function"==typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Gi(e,t),s=t.memoizedProps,u=t.type===t.elementType?s:Ii(t.type,s),o.props=u,h=t.pendingProps,d=o.context,"object"==typeof(l=i.contextType)&&null!==l?l=Ui(l):l=gt(t,l=mt(i)?ft:dt.current);var p=i.getDerivedStateFromProps;(c="function"==typeof p||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s!==h||d!==l)&&sr(t,o,r,l),Qi=!1,d=t.memoizedState,o.state=d,er(t,r,o,n);var f=t.memoizedState;s!==h||d!==f||pt.current||Qi?("function"==typeof p&&(rr(t,i,p,r),f=t.memoizedState),(u=Qi||ar(t,i,u,r,d,f,l)||!1)?(c||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(r,f,l),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,f,l)),"function"==typeof o.componentDidUpdate&&(t.flags|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),o.props=r,o.state=f,o.context=l,r=u):("function"!=typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Vn(e,t,i,r,a,n)}function Vn(e,t,i,r,n,a){Wn(e,t);var o=0!=(128&t.flags);if(!r&&!o)return n&&xt(t,i,!1),la(e,t,a);r=t.stateNode,Fn.current=t;var s=o&&"function"!=typeof i.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=pr(t,e.child,null,a),t.child=pr(t,null,s,a)):jn(e,t,s,a),t.memoizedState=r.state,n&&xt(t,i,!0),t.child}function Qn(e){var t=e.stateNode;t.pendingContext?yt(0,t.pendingContext,t.pendingContext!==t.context):t.context&&yt(0,t.context,!1),wr(e,t.containerInfo)}function Yn(e,t,i,r,n){return Ai(),Pi(n),t.flags|=256,jn(e,t,i,r),t.child}var Gn,Kn,Xn,Zn,Jn={dehydrated:null,treeContext:null,retryLane:0};function ea(e){return{baseLanes:e,cachePool:null,transitions:null}}function ta(e,t,i){var r,n=t.pendingProps,o=Er.current,s=!1,l=0!=(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!=(2&o)),r?(s=!0,t.flags&=-129):(null===e||null!==e.memoizedState)&&(o|=1),ct(Er,1&o),null===e)return Si(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0==(1&t.mode)?t.lanes=1:je(e)?t.lanes=8:t.lanes=1073741824,null):(l=n.children,e=n.fallback,s?(n=t.mode,s=t.child,l={mode:"hidden",children:l},0==(1&n)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=gs(l,n,0,null),e=fs(e,n,i,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=ea(i),t.memoizedState=Jn,e):ia(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,i,r,n,o,s){if(i)return 256&t.flags?(t.flags&=-257,r=Pn(Error(a(422))),ra(e,t,s,r)):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,n=t.mode,r=gs({mode:"visible",children:r.children},n,0,null),o=fs(o,n,s,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!=(1&t.mode)&&pr(t,e.child,null,s),t.child.memoizedState=ea(s),t.memoizedState=Jn,o);if(0==(1&t.mode))return ra(e,t,s,null);if(je(n))return r=$e(n).digest,o=Error(a(419)),r=Pn(o,r,void 0),ra(e,t,s,r);if(i=0!=(s&e.childLanes),Nn||i){if(null!==(r=oo)){switch(s&-s){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}0!==(n=0!=(n&(r.suspendedLanes|s))?0:n)&&n!==o.retryLane&&(o.retryLane=n,Vi(e,n),Fo(r,e,n,-1))}return Yo(),ra(e,t,s,r=Pn(Error(a(421))))}return Ne(n)?(t.flags|=128,t.child=e.child,t=os.bind(null,e),Be(n,t),null):(e=o.treeContext,K&&(mi=He(n),gi=t,vi=!0,bi=null,yi=!1,null!==e&&(oi[si++]=ui,oi[si++]=ci,oi[si++]=li,ui=e.id,ci=e.overflow,li=t)),t=ia(t,r.children),t.flags|=4096,t)}(e,t,l,n,r,o,i);if(s){s=n.fallback,l=t.mode,r=(o=e.child).sibling;var u={mode:"hidden",children:n.children};return 0==(1&l)&&t.child!==o?((n=t.child).childLanes=0,n.pendingProps=u,t.deletions=null):(n=ds(o,u)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=ds(r,s):(s=fs(s,l,i,null)).flags|=2,s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,l=null===(l=e.child.memoizedState)?ea(i):{baseLanes:l.baseLanes|i,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~i,t.memoizedState=Jn,n}return e=(s=e.child).sibling,n=ds(s,{mode:"visible",children:n.children}),0==(1&t.mode)&&(n.lanes=i),n.return=t,n.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=n,t.memoizedState=null,n}function ia(e,t){return(t=gs({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function ra(e,t,i,r){return null!==r&&Pi(r),pr(t,e.child,null,i),(e=ia(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function na(e,t,i){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Bi(e.return,t,i)}function aa(e,t,i,r,n){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:i,tailMode:n}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=i,a.tailMode=n)}function oa(e,t,i){var r=t.pendingProps,n=r.revealOrder,a=r.tail;if(jn(e,t,r.children,i),0!=(2&(r=Er.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!=(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&na(e,i,t);else if(19===e.tag)na(e,i,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ct(Er,r),0==(1&t.mode))t.memoizedState=null;else switch(n){case"forwards":for(i=t.child,n=null;null!==i;)null!==(e=i.alternate)&&null===kr(e)&&(n=i),i=i.sibling;null===(i=n)?(n=t.child,t.child=null):(n=i.sibling,i.sibling=null),aa(t,!1,n,i,a);break;case"backwards":for(i=null,n=t.child,t.child=null;null!==n;){if(null!==(e=n.alternate)&&null===kr(e)){t.child=n;break}e=n.sibling,n.sibling=i,i=n,n=e}aa(t,!0,i,null,a);break;case"together":aa(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function sa(e,t){0==(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function la(e,t,i){if(null!==e&&(t.dependencies=e.dependencies),fo|=t.lanes,0==(i&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(i=ds(e=t.child,e.pendingProps),t.child=i,i.return=t;null!==e.sibling;)e=e.sibling,(i=i.sibling=ds(e,e.pendingProps)).return=t;i.sibling=null}return t.child}function ua(e){e.flags|=4}function ca(e,t){if(null!==e&&e.child===t.child)return!0;if(0!=(16&t.flags))return!1;for(e=t.child;null!==e;){if(0!=(12854&e.flags)||0!=(12854&e.subtreeFlags))return!1;e=e.sibling}return!0}if(Y)Gn=function(e,t){for(var i=t.child;null!==i;){if(5===i.tag||6===i.tag)$(e,i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},Kn=function(){},Xn=function(e,t,i,r,n){if((e=e.memoizedProps)!==r){var a=t.stateNode,o=br(mr.current);i=D(a,i,e,r,n,o),(t.updateQueue=i)&&ua(t)}},Zn=function(e,t,i,r){i!==r&&ua(t)};else if(G){Gn=function(e,t,i,r){for(var n=t.child;null!==n;){if(5===n.tag){var a=n.stateNode;i&&r&&(a=Re(a,n.type,n.memoizedProps,n)),$(e,a)}else if(6===n.tag)a=n.stateNode,i&&r&&(a=Ie(a,n.memoizedProps,n)),$(e,a);else if(4!==n.tag)if(22===n.tag&&null!==n.memoizedState)null!==(a=n.child)&&(a.return=n),Gn(e,n,!0,!0);else if(null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};var ha=function(e,t,i,r){for(var n=t.child;null!==n;){if(5===n.tag){var a=n.stateNode;i&&r&&(a=Re(a,n.type,n.memoizedProps,n)),Pe(e,a)}else if(6===n.tag)a=n.stateNode,i&&r&&(a=Ie(a,n.memoizedProps,n)),Pe(e,a);else if(4!==n.tag)if(22===n.tag&&null!==n.memoizedState)null!==(a=n.child)&&(a.return=n),ha(e,n,!0,!0);else if(null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Kn=function(e,t){var i=t.stateNode;if(!ca(e,t)){e=i.containerInfo;var r=Ae(e);ha(r,t,!1,!1),i.pendingChildren=r,ua(t),Oe(e,r)}},Xn=function(e,t,i,r,n){var a=e.stateNode,o=e.memoizedProps;if((e=ca(e,t))&&o===r)t.stateNode=a;else{var s=t.stateNode,l=br(mr.current),u=null;o!==r&&(u=D(s,i,o,r,n,l)),e&&null===u?t.stateNode=a:(a=Ce(a,u,i,o,r,t,e,s),B(a,i,r,n,l)&&ua(t),t.stateNode=a,e?ua(t):Gn(a,t,!1,!1))}},Zn=function(e,t,i,r){i!==r?(e=br(yr.current),i=br(mr.current),t.stateNode=W(r,e,i,t),ua(t)):t.stateNode=e.stateNode}}else Kn=function(){},Xn=function(){},Zn=function(){};function da(e,t){if(!vi)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;null!==t;)null!==t.alternate&&(i=t),t=t.sibling;null===i?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var r=null;null!==i;)null!==i.alternate&&(r=i),i=i.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function pa(e){var t=null!==e.alternate&&e.alternate.child===e.child,i=0,r=0;if(t)for(var n=e.child;null!==n;)i|=n.lanes|n.childLanes,r|=14680064&n.subtreeFlags,r|=14680064&n.flags,n.return=e,n=n.sibling;else for(n=e.child;null!==n;)i|=n.lanes|n.childLanes,r|=n.subtreeFlags,r|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=r,e.childLanes=i,t}function fa(e,t,i){var r=t.pendingProps;switch(fi(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pa(t),null;case 1:case 17:return mt(t.type)&&vt(),pa(t),null;case 3:return i=t.stateNode,xr(),ut(pt),ut(dt),Ar(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(null===e||null===e.child)&&(ki(t)?ua(t):null===e||e.memoizedState.isDehydrated&&0==(256&t.flags)||(t.flags|=1024,null!==bi&&(Bo(bi),bi=null))),Kn(e,t),pa(t),null;case 5:Sr(t),i=br(yr.current);var n=t.type;if(null!==e&&null!=t.stateNode)Xn(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return pa(t),null}if(e=br(mr.current),ki(t)){if(!K)throw Error(a(175));e=qe(t.stateNode,t.type,t.memoizedProps,i,e,t,!yi),t.updateQueue=e,null!==e&&ua(t)}else{var o=j(n,r,i,e,t);Gn(o,t,!1,!1),t.stateNode=o,B(o,n,r,i,e)&&ua(t)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return pa(t),null;case 6:if(e&&null!=t.stateNode)Zn(e,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(a(166));if(e=br(yr.current),i=br(mr.current),ki(t)){if(!K)throw Error(a(176));if(e=t.stateNode,i=t.memoizedProps,(r=Ve(e,i,t,!yi))&&null!==(n=gi))switch(n.tag){case 3:et(n.stateNode.containerInfo,e,i,0!=(1&n.mode));break;case 5:tt(n.type,n.memoizedProps,n.stateNode,e,i,0!=(1&n.mode))}r&&ua(t)}else t.stateNode=W(r,e,i,t)}return pa(t),null;case 13:if(ut(Er),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(vi&&null!==mi&&0!=(1&t.mode)&&0==(128&t.flags))Ci(),Ai(),t.flags|=98560,n=!1;else if(n=ki(t),null!==r&&null!==r.dehydrated){if(null===e){if(!n)throw Error(a(318));if(!K)throw Error(a(344));if(!(n=null!==(n=t.memoizedState)?n.dehydrated:null))throw Error(a(317));Qe(n,t)}else Ai(),0==(128&t.flags)&&(t.memoizedState=null),t.flags|=4;pa(t),n=!1}else null!==bi&&(Bo(bi),bi=null),n=!0;if(!n)return 65536&t.flags?t:null}return 0!=(128&t.flags)?(t.lanes=i,t):((i=null!==r)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!=(1&t.mode)&&(null===e||0!=(1&Er.current)?0===ho&&(ho=3):Yo())),null!==t.updateQueue&&(t.flags|=4),pa(t),null);case 4:return xr(),Kn(e,t),null===e&&Z(t.stateNode.containerInfo),pa(t),null;case 10:return $i(t.type._context),pa(t),null;case 19:if(ut(Er),null===(n=t.memoizedState))return pa(t),null;if(r=0!=(128&t.flags),null===(o=n.rendering))if(r)da(n,!1);else{if(0!==ho||null!==e&&0!=(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=kr(e))){for(t.flags|=128,da(n,!1),null!==(e=o.updateQueue)&&(t.updateQueue=e,t.flags|=4),t.subtreeFlags=0,e=i,i=t.child;null!==i;)n=e,(r=i).flags&=14680066,null===(o=r.alternate)?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,n=o.dependencies,r.dependencies=null===n?null:{lanes:n.lanes,firstContext:n.firstContext}),i=i.sibling;return ct(Er,1&Er.current|2),t.child}e=e.sibling}null!==n.tail&&Wt()>wo&&(t.flags|=128,r=!0,da(n,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=kr(o))){if(t.flags|=128,r=!0,null!==(e=e.updateQueue)&&(t.updateQueue=e,t.flags|=4),da(n,!0),null===n.tail&&"hidden"===n.tailMode&&!o.alternate&&!vi)return pa(t),null}else 2*Wt()-n.renderingStartTime>wo&&1073741824!==i&&(t.flags|=128,r=!0,da(n,!1),t.lanes=4194304);n.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=n.last)?e.sibling=o:t.child=o,n.last=o)}return null!==n.tail?(t=n.tail,n.rendering=t,n.tail=t.sibling,n.renderingStartTime=Wt(),t.sibling=null,e=Er.current,ct(Er,r?1&e|2:1&e),t):(pa(t),null);case 22:case 23:return Ho(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!=(1&t.mode)?0!=(1073741824&uo)&&(pa(t),Y&&6&t.subtreeFlags&&(t.flags|=8192)):pa(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function ga(e,t){switch(fi(t),t.tag){case 1:return mt(t.type)&&vt(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return xr(),ut(pt),ut(dt),Ar(),0!=(65536&(e=t.flags))&&0==(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Sr(t),null;case 13:if(ut(Er),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));Ai()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return ut(Er),null;case 4:return xr(),null;case 10:return $i(t.type._context),null;case 22:case 23:return Ho(),null;default:return null}}var ma=!1,va=!1,ya="function"==typeof WeakSet?WeakSet:Set,ba=null;function wa(e,t){var i=e.ref;if(null!==i)if("function"==typeof i)try{i(null)}catch(i){rs(e,t,i)}else i.current=null}function xa(e,t,i){try{i()}catch(i){rs(e,t,i)}}var _a=!1;function Sa(e,t,i){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var n=r=r.next;do{if((n.tag&e)===e){var a=n.destroy;n.destroy=void 0,void 0!==a&&xa(t,i,a)}n=n.next}while(n!==r)}}function Ea(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var i=t=t.next;do{if((i.tag&e)===e){var r=i.create;i.destroy=r()}i=i.next}while(i!==t)}}function ka(e){var t=e.ref;if(null!==t){var i=e.stateNode;if(5===e.tag)e=M(i);else e=i;"function"==typeof t?t(e):t.current=e}}function Ca(e){var t=e.alternate;null!==t&&(e.alternate=null,Ca(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&ee(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Aa(e){return 5===e.tag||3===e.tag||4===e.tag}function Pa(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Aa(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags||null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Oa(e,t,i){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?ve(i,e,t):de(i,e);else if(4!==r&&null!==(e=e.child))for(Oa(e,t,i),e=e.sibling;null!==e;)Oa(e,t,i),e=e.sibling}function Ta(e,t,i){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?me(i,e,t):he(i,e);else if(4!==r&&null!==(e=e.child))for(Ta(e,t,i),e=e.sibling;null!==e;)Ta(e,t,i),e=e.sibling}var Ra=null,Ia=!1;function Ma(e,t,i){for(i=i.child;null!==i;)za(e,t,i),i=i.sibling}function za(e,t,i){if(Gt&&"function"==typeof Gt.onCommitFiberUnmount)try{Gt.onCommitFiberUnmount(Yt,i)}catch(e){}switch(i.tag){case 5:va||wa(i,t);case 6:if(Y){var r=Ra,n=Ia;Ra=null,Ma(e,t,i),Ia=n,null!==(Ra=r)&&(Ia?be(Ra,i.stateNode):ye(Ra,i.stateNode))}else Ma(e,t,i);break;case 18:Y&&null!==Ra&&(Ia?Ze(Ra,i.stateNode):Xe(Ra,i.stateNode));break;case 4:Y?(r=Ra,n=Ia,Ra=i.stateNode.containerInfo,Ia=!0,Ma(e,t,i),Ra=r,Ia=n):(G&&(r=i.stateNode.containerInfo,n=Ae(r),Te(r,n)),Ma(e,t,i));break;case 0:case 11:case 14:case 15:if(!va&&(null!==(r=i.updateQueue)&&null!==(r=r.lastEffect))){n=r=r.next;do{var a=n,o=a.destroy;a=a.tag,void 0!==o&&(0!=(2&a)||0!=(4&a))&&xa(i,t,o),n=n.next}while(n!==r)}Ma(e,t,i);break;case 1:if(!va&&(wa(i,t),"function"==typeof(r=i.stateNode).componentWillUnmount))try{r.props=i.memoizedProps,r.state=i.memoizedState,r.componentWillUnmount()}catch(e){rs(i,t,e)}Ma(e,t,i);break;case 21:Ma(e,t,i);break;case 22:1&i.mode?(va=(r=va)||null!==i.memoizedState,Ma(e,t,i),va=r):Ma(e,t,i);break;default:Ma(e,t,i)}}function La(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var i=e.stateNode;null===i&&(i=e.stateNode=new ya),t.forEach((function(t){var r=ss.bind(null,e,t);i.has(t)||(i.add(t),t.then(r,r))}))}}function Fa(e,t){var i=t.deletions;if(null!==i)for(var r=0;r<i.length;r++){var n=i[r];try{var o=e,s=t;if(Y){var l=s;e:for(;null!==l;){switch(l.tag){case 5:Ra=l.stateNode,Ia=!1;break e;case 3:case 4:Ra=l.stateNode.containerInfo,Ia=!0;break e}l=l.return}if(null===Ra)throw Error(a(160));za(o,s,n),Ra=null,Ia=!1}else za(o,s,n);var u=n.alternate;null!==u&&(u.return=null),n.return=null}catch(e){rs(n,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)Na(t,e),t=t.sibling}function Na(e,t){var i=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Fa(t,e),ja(e),4&r){try{Sa(3,e,e.return),Ea(3,e)}catch(t){rs(e,e.return,t)}try{Sa(5,e,e.return)}catch(t){rs(e,e.return,t)}}break;case 1:Fa(t,e),ja(e),512&r&&null!==i&&wa(i,i.return);break;case 5:if(Fa(t,e),ja(e),512&r&&null!==i&&wa(i,i.return),Y){if(32&e.flags){var n=e.stateNode;try{we(n)}catch(t){rs(e,e.return,t)}}if(4&r&&null!=(n=e.stateNode)){var o=e.memoizedProps;if(i=null!==i?i.memoizedProps:o,r=e.type,t=e.updateQueue,e.updateQueue=null,null!==t)try{ge(n,t,r,i,o,e)}catch(t){rs(e,e.return,t)}}}break;case 6:if(Fa(t,e),ja(e),4&r&&Y){if(null===e.stateNode)throw Error(a(162));n=e.stateNode,o=e.memoizedProps,i=null!==i?i.memoizedProps:o;try{pe(n,i,o)}catch(t){rs(e,e.return,t)}}break;case 3:if(Fa(t,e),ja(e),4&r){if(Y&&K&&null!==i&&i.memoizedState.isDehydrated)try{Ge(t.containerInfo)}catch(t){rs(e,e.return,t)}if(G){n=t.containerInfo,o=t.pendingChildren;try{Te(n,o)}catch(t){rs(e,e.return,t)}}}break;case 4:if(Fa(t,e),ja(e),4&r&&G){n=(o=e.stateNode).containerInfo,o=o.pendingChildren;try{Te(n,o)}catch(t){rs(e,e.return,t)}}break;case 13:Fa(t,e),ja(e),8192&(n=e.child).flags&&(o=null!==n.memoizedState,n.stateNode.isHidden=o,!o||null!==n.alternate&&null!==n.alternate.memoizedState||(bo=Wt())),4&r&&La(e);break;case 22:var s=null!==i&&null!==i.memoizedState;if(1&e.mode?(va=(i=va)||s,Fa(t,e),va=i):Fa(t,e),ja(e),8192&r){if(i=null!==e.memoizedState,(e.stateNode.isHidden=i)&&!s&&0!=(1&e.mode))for(ba=e,r=e.child;null!==r;){for(t=ba=r;null!==ba;){var l=(s=ba).child;switch(s.tag){case 0:case 11:case 14:case 15:Sa(4,s,s.return);break;case 1:wa(s,s.return);var u=s.stateNode;if("function"==typeof u.componentWillUnmount){var c=s,h=s.return;try{var d=c;u.props=d.memoizedProps,u.state=d.memoizedState,u.componentWillUnmount()}catch(e){rs(c,h,e)}}break;case 5:wa(s,s.return);break;case 22:if(null!==s.memoizedState){Ua(t);continue}}null!==l?(l.return=s,ba=l):Ua(t)}r=r.sibling}if(Y)e:if(r=null,Y)for(t=e;;){if(5===t.tag){if(null===r){r=t;try{n=t.stateNode,i?xe(n):Se(t.stateNode,t.memoizedProps)}catch(t){rs(e,e.return,t)}}}else if(6===t.tag){if(null===r)try{o=t.stateNode,i?_e(o):Ee(o,t.memoizedProps)}catch(t){rs(e,e.return,t)}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}}break;case 19:Fa(t,e),ja(e),4&r&&La(e);break;case 21:break;default:Fa(t,e),ja(e)}}function ja(e){var t=e.flags;if(2&t){try{if(Y){e:{for(var i=e.return;null!==i;){if(Aa(i)){var r=i;break e}i=i.return}throw Error(a(160))}switch(r.tag){case 5:var n=r.stateNode;32&r.flags&&(we(n),r.flags&=-33),Ta(e,Pa(e),n);break;case 3:case 4:var o=r.stateNode.containerInfo;Oa(e,Pa(e),o);break;default:throw Error(a(161))}}}catch(t){rs(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function $a(e,t,i){ba=e,Ba(e,t,i)}function Ba(e,t,i){for(var r=0!=(1&e.mode);null!==ba;){var n=ba,a=n.child;if(22===n.tag&&r){var o=null!==n.memoizedState||ma;if(!o){var s=n.alternate,l=null!==s&&null!==s.memoizedState||va;s=ma;var u=va;if(ma=o,(va=l)&&!u)for(ba=n;null!==ba;)l=(o=ba).child,22===o.tag&&null!==o.memoizedState?Wa(n):null!==l?(l.return=o,ba=l):Wa(n);for(;null!==a;)ba=a,Ba(a,t,i),a=a.sibling;ba=n,ma=s,va=u}Da(e)}else 0!=(8772&n.subtreeFlags)&&null!==a?(a.return=n,ba=a):Da(e)}}function Da(e){for(;null!==ba;){var t=ba;if(0!=(8772&t.flags)){var i=t.alternate;try{if(0!=(8772&t.flags))switch(t.tag){case 0:case 11:case 15:va||Ea(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!va)if(null===i)r.componentDidMount();else{var n=t.elementType===t.type?i.memoizedProps:Ii(t.type,i.memoizedProps);r.componentDidUpdate(n,i.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&tr(t,o,r);break;case 3:var s=t.updateQueue;if(null!==s){if(i=null,null!==t.child)switch(t.child.tag){case 5:i=M(t.child.stateNode);break;case 1:i=t.child.stateNode}tr(t,s,i)}break;case 5:var l=t.stateNode;null===i&&4&t.flags&&fe(l,t.type,t.memoizedProps,t);break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(K&&null===t.memoizedState){var u=t.alternate;if(null!==u){var c=u.memoizedState;if(null!==c){var h=c.dehydrated;null!==h&&Ke(h)}}}break;default:throw Error(a(163))}va||512&t.flags&&ka(t)}catch(e){rs(t,t.return,e)}}if(t===e){ba=null;break}if(null!==(i=t.sibling)){i.return=t.return,ba=i;break}ba=t.return}}function Ua(e){for(;null!==ba;){var t=ba;if(t===e){ba=null;break}var i=t.sibling;if(null!==i){i.return=t.return,ba=i;break}ba=t.return}}function Wa(e){for(;null!==ba;){var t=ba;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{Ea(4,t)}catch(e){rs(t,i,e)}break;case 1:var r=t.stateNode;if("function"==typeof r.componentDidMount){var n=t.return;try{r.componentDidMount()}catch(e){rs(t,n,e)}}var a=t.return;try{ka(t)}catch(e){rs(t,a,e)}break;case 5:var o=t.return;try{ka(t)}catch(e){rs(t,o,e)}}}catch(e){rs(t,t.return,e)}if(t===e){ba=null;break}var s=t.sibling;if(null!==s){s.return=t.return,ba=s;break}ba=t.return}}var Ha=0,qa=1,Va=2,Qa=3,Ya=4;if("function"==typeof Symbol&&Symbol.for){var Ga=Symbol.for;Ha=Ga("selector.component"),qa=Ga("selector.has_pseudo_class"),Va=Ga("selector.role"),Qa=Ga("selector.test_id"),Ya=Ga("selector.text")}function Ka(e){var t=X(e);if(null!=t){if("string"!=typeof t.memoizedProps["data-testname"])throw Error(a(364));return t}if(null===(e=ne(e)))throw Error(a(362));return e.stateNode.current}function Xa(e,t){switch(t.$$typeof){case Ha:if(e.type===t.value)return!0;break;case qa:e:{t=t.value,e=[e,0];for(var i=0;i<e.length;){var r=e[i++],n=e[i++],o=t[n];if(5!==r.tag||!se(r)){for(;null!=o&&Xa(r,o);)o=t[++n];if(n===t.length){t=!0;break e}for(r=r.child;null!==r;)e.push(r,n),r=r.sibling}}t=!1}return t;case Va:if(5===e.tag&&le(e.stateNode,t.value))return!0;break;case Ya:if((5===e.tag||6===e.tag)&&(null!==(e=oe(e))&&0<=e.indexOf(t.value)))return!0;break;case Qa:if(5===e.tag&&("string"==typeof(e=e.memoizedProps["data-testname"])&&e.toLowerCase()===t.value.toLowerCase()))return!0;break;default:throw Error(a(365))}return!1}function Za(e){switch(e.$$typeof){case Ha:return"<"+(S(e.value)||"Unknown")+">";case qa:return":has("+(Za(e)||"")+")";case Va:return'[role="'+e.value+'"]';case Ya:return'"'+e.value+'"';case Qa:return'[data-testname="'+e.value+'"]';default:throw Error(a(365))}}function Ja(e,t){var i=[];e=[e,0];for(var r=0;r<e.length;){var n=e[r++],a=e[r++],o=t[a];if(5!==n.tag||!se(n)){for(;null!=o&&Xa(n,o);)o=t[++a];if(a===t.length)i.push(n);else for(n=n.child;null!==n;)e.push(n,a),n=n.sibling}}return i}function eo(e,t){if(!re)throw Error(a(363));e=Ja(e=Ka(e),t),t=[],e=Array.from(e);for(var i=0;i<e.length;){var r=e[i++];if(5===r.tag)se(r)||t.push(r.stateNode);else for(r=r.child;null!==r;)e.push(r),r=r.sibling}return t}var to=Math.ceil,io=o.ReactCurrentDispatcher,ro=o.ReactCurrentOwner,no=o.ReactCurrentBatchConfig,ao=0,oo=null,so=null,lo=0,uo=0,co=lt(0),ho=0,po=null,fo=0,go=0,mo=0,vo=null,yo=null,bo=0,wo=1/0,xo=null;function _o(){wo=Wt()+500}var So,Eo=!1,ko=null,Co=null,Ao=!1,Po=null,Oo=0,To=0,Ro=null,Io=-1,Mo=0;function zo(){return 0!=(6&ao)?Wt():-1!==Io?Io:Io=Wt()}function Lo(e){return 0==(1&e.mode)?1:0!=(2&ao)&&0!==lo?lo&-lo:null!==Oi.transition?(0===Mo&&(Mo=Mt()),Mo):0!==(e=Nt)?e:J()}function Fo(e,t,i,r){if(50<To)throw To=0,Ro=null,Error(a(185));Lt(e,i,r),(0==(2&ao)||e!==oo)&&(e===oo&&(0==(2&ao)&&(go|=i),4===ho&&Do(e,lo)),No(e,r),1===i&&0===ao&&0==(1&t.mode)&&(_o(),Zt&&ti()))}function No(e,t){var i=e.callbackNode;!function(e,t){for(var i=e.suspendedLanes,r=e.pingedLanes,n=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-_t(a),s=1<<o,l=n[o];-1===l?(0==(s&i)||0!=(s&r))&&(n[o]=Rt(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}}(e,t);var r=Tt(e,e===oo?lo:0);if(0===r)null!==i&&Bt(i),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=i&&Bt(i),1===t)0===e.tag?function(e){Zt=!0,ei(e)}(Uo.bind(null,e)):ei(Uo.bind(null,e)),te?ie((function(){0==(6&ao)&&ti()})):$t(Ht,ti),i=null;else{switch(jt(r)){case 1:i=Ht;break;case 4:i=qt;break;case 16:default:i=Vt;break;case 536870912:i=Qt}i=ls(i,jo.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function jo(e,t){if(Io=-1,Mo=0,0!=(6&ao))throw Error(a(327));var i=e.callbackNode;if(ts()&&e.callbackNode!==i)return null;var r=Tt(e,e===oo?lo:0);if(0===r)return null;if(0!=(30&r)||0!=(r&e.expiredLanes)||t)t=Go(e,r);else{t=r;var n=ao;ao|=2;var o=Qo();for((oo!==e||lo!==t)&&(xo=null,_o(),qo(e,t));;)try{Xo();break}catch(t){Vo(e,t)}Ni(),io.current=o,ao=n,null!==so?t=0:(oo=null,lo=0,t=ho)}if(0!==t){if(2===t&&(0!==(n=It(e))&&(r=n,t=$o(e,n))),1===t)throw i=po,qo(e,0),Do(e,r),No(e,Wt()),i;if(6===t)Do(e,r);else{if(n=e.current.alternate,0==(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var i=t.updateQueue;if(null!==i&&null!==(i=i.stores))for(var r=0;r<i.length;r++){var n=i[r],a=n.getSnapshot;n=n.value;try{if(!Kt(a(),n))return!1}catch(e){return!1}}}if(i=t.child,16384&t.subtreeFlags&&null!==i)i.return=t,t=i;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(n)&&(2===(t=Go(e,r))&&(0!==(o=It(e))&&(r=o,t=$o(e,o))),1===t))throw i=po,qo(e,0),Do(e,r),No(e,Wt()),i;switch(e.finishedWork=n,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:es(e,yo,xo);break;case 3:if(Do(e,r),(130023424&r)===r&&10<(t=bo+500-Wt())){if(0!==Tt(e,0))break;if(((n=e.suspendedLanes)&r)!==r){zo(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=H(es.bind(null,e,yo,xo),t);break}es(e,yo,xo);break;case 4:if(Do(e,r),(4194240&r)===r)break;for(t=e.eventTimes,n=-1;0<r;){var s=31-_t(r);o=1<<s,(s=t[s])>n&&(n=s),r&=~o}if(r=n,10<(r=(120>(r=Wt()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*to(r/1960))-r)){e.timeoutHandle=H(es.bind(null,e,yo,xo),r);break}es(e,yo,xo);break;default:throw Error(a(329))}}}return No(e,Wt()),e.callbackNode===i?jo.bind(null,e):null}function $o(e,t){var i=vo;return e.current.memoizedState.isDehydrated&&(qo(e,t).flags|=256),2!==(e=Go(e,t))&&(t=yo,yo=i,null!==t&&Bo(t)),e}function Bo(e){null===yo?yo=e:yo.push.apply(yo,e)}function Do(e,t){for(t&=~mo,t&=~go,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-_t(t),r=1<<i;e[i]=-1,t&=~r}}function Uo(e){if(0!=(6&ao))throw Error(a(327));ts();var t=Tt(e,0);if(0==(1&t))return No(e,Wt()),null;var i=Go(e,t);if(0!==e.tag&&2===i){var r=It(e);0!==r&&(t=r,i=$o(e,r))}if(1===i)throw i=po,qo(e,0),Do(e,t),No(e,Wt()),i;if(6===i)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,es(e,yo,xo),No(e,Wt()),null}function Wo(e){null!==Po&&0===Po.tag&&0==(6&ao)&&ts();var t=ao;ao|=1;var i=no.transition,r=Nt;try{if(no.transition=null,Nt=1,e)return e()}finally{Nt=r,no.transition=i,0==(6&(ao=t))&&ti()}}function Ho(){uo=co.current,ut(co)}function qo(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==V&&(e.timeoutHandle=V,q(i)),null!==so)for(i=so.return;null!==i;){var r=i;switch(fi(r),r.tag){case 1:null!=(r=r.type.childContextTypes)&&vt();break;case 3:xr(),ut(pt),ut(dt),Ar();break;case 5:Sr(r);break;case 4:xr();break;case 13:case 19:ut(Er);break;case 10:$i(r.type._context);break;case 22:case 23:Ho()}i=i.return}if(oo=e,so=e=ds(e.current,null),lo=uo=t,ho=0,po=null,mo=go=fo=0,yo=vo=null,null!==Wi){for(t=0;t<Wi.length;t++)if(null!==(r=(i=Wi[t]).interleaved)){i.interleaved=null;var n=r.next,a=i.pending;if(null!==a){var o=a.next;a.next=n,r.next=o}i.pending=r}Wi=null}return e}function Vo(e,t){for(;;){var i=so;try{if(Ni(),Pr.current=Sn,zr){for(var r=Rr.memoizedState;null!==r;){var n=r.queue;null!==n&&(n.pending=null),r=r.next}zr=!1}if(Tr=0,Mr=Ir=Rr=null,Lr=!1,Fr=0,ro.current=null,null===i||null===i.return){ho=1,po=t,so=null;break}e:{var o=e,s=i.return,l=i,u=t;if(t=lo,l.flags|=32768,null!==u&&"object"==typeof u&&"function"==typeof u.then){var c=u,h=l,d=h.tag;if(0==(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=zn(s);if(null!==f){f.flags&=-257,Ln(f,s,l,0,t),1&f.mode&&Mn(o,c,t),u=c;var g=(t=f).updateQueue;if(null===g){var m=new Set;m.add(u),t.updateQueue=m}else g.add(u);break e}if(0==(1&t)){Mn(o,c,t),Yo();break e}u=Error(a(426))}else if(vi&&1&l.mode){var v=zn(s);if(null!==v){0==(65536&v.flags)&&(v.flags|=256),Ln(v,s,l,0,t),Pi(An(u,l));break e}}o=u=An(u,l),4!==ho&&(ho=2),null===vo?vo=[o]:vo.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Ji(o,Rn(0,u,t));break e;case 1:l=u;var y=o.type,b=o.stateNode;if(0==(128&o.flags)&&("function"==typeof y.getDerivedStateFromError||null!==b&&"function"==typeof b.componentDidCatch&&(null===Co||!Co.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Ji(o,In(o,l,t));break e}}o=o.return}while(null!==o)}Jo(i)}catch(e){t=e,so===i&&null!==i&&(so=i=i.return);continue}break}}function Qo(){var e=io.current;return io.current=Sn,null===e?Sn:e}function Yo(){(0===ho||3===ho||2===ho)&&(ho=4),null===oo||0==(268435455&fo)&&0==(268435455&go)||Do(oo,lo)}function Go(e,t){var i=ao;ao|=2;var r=Qo();for((oo!==e||lo!==t)&&(xo=null,qo(e,t));;)try{Ko();break}catch(t){Vo(e,t)}if(Ni(),ao=i,io.current=r,null!==so)throw Error(a(261));return oo=null,lo=0,ho}function Ko(){for(;null!==so;)Zo(so)}function Xo(){for(;null!==so&&!Dt();)Zo(so)}function Zo(e){var t=So(e.alternate,e,uo);e.memoizedProps=e.pendingProps,null===t?Jo(e):so=t,ro.current=null}function Jo(e){var t=e;do{var i=t.alternate;if(e=t.return,0==(32768&t.flags)){if(null!==(i=fa(i,t,uo)))return void(so=i)}else{if(null!==(i=ga(i,t)))return i.flags&=32767,void(so=i);if(null===e)return ho=6,void(so=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(so=t);so=t=e}while(null!==t);0===ho&&(ho=5)}function es(e,t,i){var r=Nt,n=no.transition;try{no.transition=null,Nt=1,function(e,t,i,r){do{ts()}while(null!==Po);if(0!=(6&ao))throw Error(a(327));i=e.finishedWork;var n=e.finishedLanes;if(null===i)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var o=i.lanes|i.childLanes;if(function(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<i;){var n=31-_t(i),a=1<<n;t[n]=0,r[n]=-1,e[n]=-1,i&=~a}}(e,o),e===oo&&(so=oo=null,lo=0),0==(2064&i.subtreeFlags)&&0==(2064&i.flags)||Ao||(Ao=!0,ls(Vt,(function(){return ts(),null}))),o=0!=(15990&i.flags),0!=(15990&i.subtreeFlags)||o){o=no.transition,no.transition=null;var s=Nt;Nt=1;var l=ao;ao|=4,ro.current=null,function(e,t){for(F(e.containerInfo),ba=t;null!==ba;)if(t=(e=ba).child,0!=(1028&e.subtreeFlags)&&null!==t)t.return=e,ba=t;else for(;null!==ba;){e=ba;try{var i=e.alternate;if(0!=(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==i){var r=i.memoizedProps,n=i.memoizedState,o=e.stateNode,s=o.getSnapshotBeforeUpdate(e.elementType===e.type?r:Ii(e.type,r),n);o.__reactInternalSnapshotBeforeUpdate=s}break;case 3:Y&&ke(e.stateNode.containerInfo);break;default:throw Error(a(163))}}catch(t){rs(e,e.return,t)}if(null!==(t=e.sibling)){t.return=e.return,ba=t;break}ba=e.return}i=_a,_a=!1}(e,i),Na(i,e),N(e.containerInfo),e.current=i,$a(i,e,n),Ut(),ao=l,Nt=s,no.transition=o}else e.current=i;if(Ao&&(Ao=!1,Po=e,Oo=n),o=e.pendingLanes,0===o&&(Co=null),function(e){if(Gt&&"function"==typeof Gt.onCommitFiberRoot)try{Gt.onCommitFiberRoot(Yt,e,void 0,128==(128&e.current.flags))}catch(e){}}(i.stateNode),No(e,Wt()),null!==t)for(r=e.onRecoverableError,i=0;i<t.length;i++)n=t[i],r(n.value,{componentStack:n.stack,digest:n.digest});if(Eo)throw Eo=!1,e=ko,ko=null,e;0!=(1&Oo)&&0!==e.tag&&ts(),o=e.pendingLanes,0!=(1&o)?e===Ro?To++:(To=0,Ro=e):To=0,ti()}(e,t,i,r)}finally{no.transition=n,Nt=r}return null}function ts(){if(null!==Po){var e=jt(Oo),t=no.transition,i=Nt;try{if(no.transition=null,Nt=16>e?16:e,null===Po)var r=!1;else{if(e=Po,Po=null,Oo=0,0!=(6&ao))throw Error(a(331));var n=ao;for(ao|=4,ba=e.current;null!==ba;){var o=ba,s=o.child;if(0!=(16&ba.flags)){var l=o.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for(ba=c;null!==ba;){var h=ba;switch(h.tag){case 0:case 11:case 15:Sa(8,h,o)}var d=h.child;if(null!==d)d.return=h,ba=d;else for(;null!==ba;){var p=(h=ba).sibling,f=h.return;if(Ca(h),h===c){ba=null;break}if(null!==p){p.return=f,ba=p;break}ba=f}}}var g=o.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}ba=o}}if(0!=(2064&o.subtreeFlags)&&null!==s)s.return=o,ba=s;else e:for(;null!==ba;){if(0!=(2048&(o=ba).flags))switch(o.tag){case 0:case 11:case 15:Sa(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,ba=y;break e}ba=o.return}}var b=e.current;for(ba=b;null!==ba;){var w=(s=ba).child;if(0!=(2064&s.subtreeFlags)&&null!==w)w.return=s,ba=w;else e:for(s=b;null!==ba;){if(0!=(2048&(l=ba).flags))try{switch(l.tag){case 0:case 11:case 15:Ea(9,l)}}catch(e){rs(l,l.return,e)}if(l===s){ba=null;break e}var x=l.sibling;if(null!==x){x.return=l.return,ba=x;break e}ba=l.return}}if(ao=n,ti(),Gt&&"function"==typeof Gt.onPostCommitFiberRoot)try{Gt.onPostCommitFiberRoot(Yt,e)}catch(e){}r=!0}return r}finally{Nt=i,no.transition=t}}return!1}function is(e,t,i){e=Xi(e,t=Rn(0,t=An(i,t),1),1),t=zo(),null!==e&&(Lt(e,1,t),No(e,t))}function rs(e,t,i){if(3===e.tag)is(e,e,i);else for(;null!==t;){if(3===t.tag){is(t,e,i);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Co||!Co.has(r))){t=Xi(t,e=In(t,e=An(i,e),1),1),e=zo(),null!==t&&(Lt(t,1,e),No(t,e));break}}t=t.return}}function ns(e,t,i){var r=e.pingCache;null!==r&&r.delete(t),t=zo(),e.pingedLanes|=e.suspendedLanes&i,oo===e&&(lo&i)===i&&(4===ho||3===ho&&(130023424&lo)===lo&&500>Wt()-bo?qo(e,0):mo|=i),No(e,t)}function as(e,t){0===t&&(0==(1&e.mode)?t=1:(t=Ct,0==(130023424&(Ct<<=1))&&(Ct=4194304)));var i=zo();null!==(e=Vi(e,t))&&(Lt(e,t,i),No(e,i))}function os(e){var t=e.memoizedState,i=0;null!==t&&(i=t.retryLane),as(e,i)}function ss(e,t){var i=0;switch(e.tag){case 13:var r=e.stateNode,n=e.memoizedState;null!==n&&(i=n.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),as(e,i)}function ls(e,t){return $t(e,t)}function us(e,t,i,r){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cs(e,t,i,r){return new us(e,t,i,r)}function hs(e){return!(!(e=e.prototype)||!e.isReactComponent)}function ds(e,t){var i=e.alternate;return null===i?((i=cs(e.tag,t,e.key,e.mode)).elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=14680064&e.flags,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function ps(e,t,i,r,n,o){var s=2;if(r=e,"function"==typeof e)hs(e)&&(s=1);else if("string"==typeof e)s=5;else e:switch(e){case u:return fs(i.children,n,o,t);case c:s=8,n|=8;break;case h:return(e=cs(12,i,t,2|n)).elementType=h,e.lanes=o,e;case g:return(e=cs(13,i,t,n)).elementType=g,e.lanes=o,e;case m:return(e=cs(19,i,t,n)).elementType=m,e.lanes=o,e;case b:return gs(i,n,o,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case d:s=10;break e;case p:s=9;break e;case f:s=11;break e;case v:s=14;break e;case y:s=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=cs(s,i,t,n)).elementType=e,t.type=r,t.lanes=o,t}function fs(e,t,i,r){return(e=cs(7,e,r,t)).lanes=i,e}function gs(e,t,i,r){return(e=cs(22,e,r,t)).elementType=b,e.lanes=i,e.stateNode={isHidden:!1},e}function ms(e,t,i){return(e=cs(6,e,null,t)).lanes=i,e}function vs(e,t,i){return(t=cs(4,null!==e.children?e.children:[],e.key,t)).lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ys(e,t,i,r,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=V,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zt(0),this.expirationTimes=zt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zt(0),this.identifierPrefix=r,this.onRecoverableError=n,K&&(this.mutableSourceEagerHydrationData=null)}function bs(e,t,i,r,n,a,o,s,l){return e=new ys(e,t,i,s,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=cs(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Yi(a),e}function ws(e){if(!e)return ht;e:{if(k(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(mt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var i=e.type;if(mt(i))return bt(e,i,t)}return t}function xs(e){var t=e._reactInternals;if(void 0===t)throw"function"==typeof e.render?Error(a(188)):(e=Object.keys(e).join(","),Error(a(268,e)));return null===(e=P(t))?null:e.stateNode}function _s(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var i=e.retryLane;e.retryLane=0!==i&&i<t?i:t}}function Ss(e,t){_s(e,t),(e=e.alternate)&&_s(e,t)}function Es(e){return null===(e=P(e))?null:e.stateNode}function ks(){return null}return So=function(e,t,i){if(null!==e)if(e.memoizedProps!==t.pendingProps||pt.current)Nn=!0;else{if(0==(e.lanes&i)&&0==(128&t.flags))return Nn=!1,function(e,t,i){switch(t.tag){case 3:Qn(t),Ai();break;case 5:_r(t);break;case 1:mt(t.type)&&wt(t);break;case 4:wr(t,t.stateNode.containerInfo);break;case 10:ji(0,t.type._context,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(ct(Er,1&Er.current),t.flags|=128,null):0!=(i&t.child.childLanes)?ta(e,t,i):(ct(Er,1&Er.current),null!==(e=la(e,t,i))?e.sibling:null);ct(Er,1&Er.current);break;case 19:if(r=0!=(i&t.childLanes),0!=(128&e.flags)){if(r)return oa(e,t,i);t.flags|=128}var n=t.memoizedState;if(null!==n&&(n.rendering=null,n.tail=null,n.lastEffect=null),ct(Er,Er.current),r)break;return null;case 22:case 23:return t.lanes=0,Un(e,t,i)}return la(e,t,i)}(e,t,i);Nn=0!=(131072&e.flags)}else Nn=!1,vi&&0!=(1048576&t.flags)&&di(t,ai,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;sa(e,t),e=t.pendingProps;var n=gt(t,dt.current);Di(t,i),n=Br(null,t,r,e,n,i);var o=Dr();return t.flags|=1,"object"==typeof n&&null!==n&&"function"==typeof n.render&&void 0===n.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,mt(r)?(o=!0,wt(t)):o=!1,t.memoizedState=null!==n.state&&void 0!==n.state?n.state:null,Yi(t),n.updater=nr,t.stateNode=n,n._reactInternals=t,lr(t,r,e,i),t=Vn(null,t,r,!0,o,i)):(t.tag=0,vi&&o&&pi(t),jn(null,t,n,i),t=t.child),t;case 16:r=t.elementType;e:{switch(sa(e,t),e=t.pendingProps,r=(n=r._init)(r._payload),t.type=r,n=t.tag=function(e){if("function"==typeof e)return hs(e)?1:0;if(null!=e){if((e=e.$$typeof)===f)return 11;if(e===v)return 14}return 2}(r),e=Ii(r,e),n){case 0:t=Hn(null,t,r,e,i);break e;case 1:t=qn(null,t,r,e,i);break e;case 11:t=$n(null,t,r,e,i);break e;case 14:t=Bn(null,t,r,Ii(r.type,e),i);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,n=t.pendingProps,Hn(e,t,r,n=t.elementType===r?n:Ii(r,n),i);case 1:return r=t.type,n=t.pendingProps,qn(e,t,r,n=t.elementType===r?n:Ii(r,n),i);case 3:e:{if(Qn(t),null===e)throw Error(a(387));r=t.pendingProps,n=(o=t.memoizedState).element,Gi(e,t),er(t,r,null,i);var s=t.memoizedState;if(r=s.element,K&&o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Yn(e,t,r,i,n=An(Error(a(423)),t));break e}if(r!==n){t=Yn(e,t,r,i,n=An(Error(a(424)),t));break e}for(K&&(mi=We(t.stateNode.containerInfo),gi=t,vi=!0,bi=null,yi=!1),i=fr(t,null,r,i),t.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(Ai(),r===n){t=la(e,t,i);break e}jn(e,t,r,i)}t=t.child}return t;case 5:return _r(t),null===e&&Si(t),r=t.type,n=t.pendingProps,o=null!==e?e.memoizedProps:null,s=n.children,U(r,n)?s=null:null!==o&&U(r,o)&&(t.flags|=32),Wn(e,t),jn(e,t,s,i),t.child;case 6:return null===e&&Si(t),null;case 13:return ta(e,t,i);case 4:return wr(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=pr(t,null,r,i):jn(e,t,r,i),t.child;case 11:return r=t.type,n=t.pendingProps,$n(e,t,r,n=t.elementType===r?n:Ii(r,n),i);case 7:return jn(e,t,t.pendingProps,i),t.child;case 8:case 12:return jn(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(r=t.type._context,n=t.pendingProps,o=t.memoizedProps,ji(0,r,s=n.value),null!==o)if(Kt(o.value,s)){if(o.children===n.children&&!pt.current){t=la(e,t,i);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){s=o.child;for(var u=l.firstContext;null!==u;){if(u.context===r){if(1===o.tag){(u=Ki(-1,i&-i)).tag=2;var c=o.updateQueue;if(null!==c){var h=(c=c.shared).pending;null===h?u.next=u:(u.next=h.next,h.next=u),c.pending=u}}o.lanes|=i,null!==(u=o.alternate)&&(u.lanes|=i),Bi(o.return,i,t),l.lanes|=i;break}u=u.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(a(341));s.lanes|=i,null!==(l=s.alternate)&&(l.lanes|=i),Bi(s,i,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}jn(e,t,n.children,i),t=t.child}return t;case 9:return n=t.type,r=t.pendingProps.children,Di(t,i),r=r(n=Ui(n)),t.flags|=1,jn(e,t,r,i),t.child;case 14:return n=Ii(r=t.type,t.pendingProps),Bn(e,t,r,n=Ii(r.type,n),i);case 15:return Dn(e,t,t.type,t.pendingProps,i);case 17:return r=t.type,n=t.pendingProps,n=t.elementType===r?n:Ii(r,n),sa(e,t),t.tag=1,mt(r)?(e=!0,wt(t)):e=!1,Di(t,i),or(t,r,n),lr(t,r,n,i),Vn(null,t,r,!0,e,i);case 19:return oa(e,t,i);case 22:return Un(e,t,i)}throw Error(a(156,t.tag))},t.attemptContinuousHydration=function(e){if(13===e.tag){var t=Vi(e,134217728);if(null!==t)Fo(t,e,134217728,zo());Ss(e,134217728)}},t.attemptDiscreteHydration=function(e){if(13===e.tag){var t=Vi(e,1);if(null!==t)Fo(t,e,1,zo());Ss(e,1)}},t.attemptHydrationAtCurrentPriority=function(e){if(13===e.tag){var t=Lo(e),i=Vi(e,t);if(null!==i)Fo(i,e,t,zo());Ss(e,t)}},t.attemptSynchronousHydration=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=Pt(t.pendingLanes);0!==i&&(Ft(t,1|i),No(t,Wt()),0==(6&ao)&&(_o(),ti()))}break;case 13:Wo((function(){var t=Vi(e,1);if(null!==t){var i=zo();Fo(t,e,1,i)}})),Ss(e,1)}},t.batchedUpdates=function(e,t){var i=ao;ao|=1;try{return e(t)}finally{0===(ao=i)&&(_o(),Zt&&ti())}},t.createComponentSelector=function(e){return{$$typeof:Ha,value:e}},t.createContainer=function(e,t,i,r,n,a,o){return bs(e,t,!1,null,0,r,0,a,o)},t.createHasPseudoClassSelector=function(e){return{$$typeof:qa,value:e}},t.createHydrationContainer=function(e,t,i,r,n,a,o,s,l){return(e=bs(i,r,!0,e,0,a,0,s,l)).context=ws(null),i=e.current,(a=Ki(r=zo(),n=Lo(i))).callback=null!=t?t:null,Xi(i,a,n),e.current.lanes=n,Lt(e,n,r),No(e,r),e},t.createPortal=function(e,t,i){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:l,key:null==r?null:""+r,children:e,containerInfo:t,implementation:i}},t.createRoleSelector=function(e){return{$$typeof:Va,value:e}},t.createTestNameSelector=function(e){return{$$typeof:Qa,value:e}},t.createTextSelector=function(e){return{$$typeof:Ya,value:e}},t.deferredUpdates=function(e){var t=Nt,i=no.transition;try{return no.transition=null,Nt=16,e()}finally{Nt=t,no.transition=i}},t.discreteUpdates=function(e,t,i,r,n){var a=Nt,o=no.transition;try{return no.transition=null,Nt=1,e(t,i,r,n)}finally{Nt=a,no.transition=o,0===ao&&_o()}},t.findAllNodes=eo,t.findBoundingRects=function(e,t){if(!re)throw Error(a(363));t=eo(e,t),e=[];for(var i=0;i<t.length;i++)e.push(ae(t[i]));for(t=e.length-1;0<t;t--)for(var r=(i=e[t]).x,n=r+i.width,o=i.y,s=o+i.height,l=t-1;0<=l;l--)if(t!==l){var u=e[l],c=u.x,h=c+u.width,d=u.y,p=d+u.height;if(r>=c&&o>=d&&n<=h&&s<=p){e.splice(t,1);break}if(!(r!==c||i.width!==u.width||p<o||d>s)){d>o&&(u.height+=d-o,u.y=o),p<s&&(u.height=s-d),e.splice(t,1);break}if(!(o!==d||i.height!==u.height||h<r||c>n)){c>r&&(u.width+=c-r,u.x=r),h<n&&(u.width=n-c),e.splice(t,1);break}}return e},t.findHostInstance=xs,t.findHostInstanceWithNoPortals=function(e){return null===(e=null!==(e=A(e))?T(e):null)?null:e.stateNode},t.findHostInstanceWithWarning=function(e){return xs(e)},t.flushControlled=function(e){var t=ao;ao|=1;var i=no.transition,r=Nt;try{no.transition=null,Nt=1,e()}finally{Nt=r,no.transition=i,0===(ao=t)&&(_o(),ti())}},t.flushPassiveEffects=ts,t.flushSync=Wo,t.focusWithin=function(e,t){if(!re)throw Error(a(363));for(t=Ja(e=Ka(e),t),t=Array.from(t),e=0;e<t.length;){var i=t[e++];if(!se(i)){if(5===i.tag&&ue(i.stateNode))return!0;for(i=i.child;null!==i;)t.push(i),i=i.sibling}}return!1},t.getCurrentUpdatePriority=function(){return Nt},t.getFindAllNodesFailureDescription=function(e,t){if(!re)throw Error(a(363));var i=0,r=[];e=[Ka(e),0];for(var n=0;n<e.length;){var o=e[n++],s=e[n++],l=t[s];if((5!==o.tag||!se(o))&&(Xa(o,l)&&(r.push(Za(l)),++s>i&&(i=s)),s<t.length))for(o=o.child;null!==o;)e.push(o,s),o=o.sibling}if(i<t.length){for(e=[];i<t.length;i++)e.push(Za(t[i]));return"findAllNodes was able to match part of the selector:\n  "+r.join(" > ")+"\n\nNo matching component was found for:\n  "+e.join(" > ")}return null},t.getPublicRootInstance=function(e){return(e=e.current).child?5===e.child.tag?M(e.child.stateNode):e.child.stateNode:null},t.injectIntoDevTools=function(e){if(e={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:Es,findFiberByHostInstance:e.findFiberByHostInstance||ks,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")e=!1;else{var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)e=!0;else{try{Yt=t.inject(e),Gt=t}catch(e){}e=!!t.checkDCE}}return e},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(e,t,i,r){if(!re)throw Error(a(363));e=eo(e,t);var n=ce(e,i,r).disconnect;return{disconnect:function(){n()}}},t.registerMutableSourceForHydration=function(e,t){var i=t._getVersion;i=i(t._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i)},t.runWithPriority=function(e,t){var i=Nt;try{return Nt=e,t()}finally{Nt=i}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(e,t,i,r){var n=t.current,a=zo(),o=Lo(n);return i=ws(i),null===t.context?t.context=i:t.pendingContext=i,(t=Ki(a,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Xi(n,t,o))&&(Fo(e,n,o,a),Zi(e,n,o)),o},t}})),Rt=v(((e,t)=>{"use strict";t.exports=Tt()})),It=v((e=>{"use strict";var t=(At(),w(Fe));e.createRoot=t.createRoot,e.hydrateRoot=t.hydrateRoot})),Mt=v(((e,t)=>{!function(i,r){"object"==typeof e&&typeof t<"u"?r(e):"function"==typeof define&&define.amd?define(["exports"],r):r((i=i||self).TypesafeActions={})}(e,(function(e){"use strict";function t(e){return null==e}function i(e){throw new Error("Argument "+e+" is empty.")}function r(e){return"function"==typeof e&&"getType"in e}function n(e){throw new Error("Argument "+e+' is invalid, it should be an action-creator instance from "typesafe-actions"')}function a(e,t){if(null==e)throw new Error("Argument contains array with empty element at index "+t);if(null==e.getType)throw new Error("Argument contains array with invalid element at index "+t+', it should be an action-creator instance from "typesafe-actions"')}function o(e){return"string"==typeof e||"symbol"==typeof e}function s(e){return!o(e)}function l(e){throw new Error("Argument "+e+" is invalid, it should be an action type of type: string | symbol")}function u(e,t){if(null==e)throw new Error("Argument contains array with empty element at index "+t);if("string"!=typeof e&&"symbol"!=typeof e)throw new Error("Argument contains array with invalid element at index "+t+", it should be of type: string | symbol")}function c(e,r,a,o){return t(e)&&i(1),s(e)&&n(1),{type:e,payload:r,meta:a,error:o}}function h(e,r){return t(e)&&i(1),s(e)&&l(1),Object.assign((function(){var t=null!=r?r.apply(void 0,arguments):void 0;return Object.assign({type:e},t)}),{getType:function(){return e},toString:function(){return e}})}function d(e,r,n){return t(e)&&i(1),s(e)&&l(1),function(){return h(e,(function(){var e=arguments.length<=0?void 0:arguments[0],t=arguments.length<=1?void 0:arguments[1];return null==r&&null==n||(e=null!=r?r.apply(void 0,arguments):void 0,t=null!=n?n.apply(void 0,arguments):void 0),Object.assign({},void 0!==e&&{payload:e},{},void 0!==t&&{meta:t})}))}}function p(e){return t(e)&&i(1),r(e)||n(1),e.getType()}function f(e,r){t(e)&&i(1),s(e)&&l(1);var n=null!=r?r(e):function(){return{type:e}};return Object.assign(n,{getType:function(){return e},toString:function(){return e}})}var g={createAction:function(e,t){var i=null==t?function(){return c(e)}:t(c.bind(null,e));return Object.assign(i,{getType:function(){return e},toString:function(){return e}})},createCustomAction:f,createStandardAction:function(e){return t(e)&&i(1),s(e)&&l(1),Object.assign((function(){return f(e,(function(e){return function(t,i){return{type:e,payload:t,meta:i}}}))}),{map:function(t){return f(e,(function(e){return function(i,r){return Object.assign(t(i,r),{type:e})}}))}})}};e.action=c,e.createAction=d,e.createAsyncAction=function(e,t,i,r){return function(){var n=[e,t,i,r].map((function(e,t){return Array.isArray(e)?d(e[0],e[1],e[2])():"string"==typeof e||"symbol"==typeof e?d(e)():void(t<3&&function(e){throw new Error("Argument "+e+' is invalid, it should be an action type of "string | symbol" or a tuple of "[string | symbol, Function, Function?]"')}(t))}));return{request:n[0],success:n[1],failure:n[2],cancel:n[3]}}},e.createCustomAction=h,e.createReducer=function e(t,i){void 0===i&&(i={});var n=Object.assign({},i),a=function(i,a){var s=Array.isArray(i)?i:[i],l={};return s.map((function(e,t){return r(e)?p(e):o(e)?e:function(e){throw new Error("Argument "+e+' is invalid, it should be an action-creator instance from "typesafe-actions" or action type of type: string | symbol')}(t+1)})).forEach((function(e){return l[e]=a})),e(t,Object.assign({},n,{},l))};return Object.assign((function(e,i){if(void 0===e&&(e=t),n.hasOwnProperty(i.type)){var r=n[i.type];if("function"!=typeof r)throw Error('Reducer under "'+i.type+'" key is not a valid reducer');return r(e,i)}return e}),{handlers:Object.assign({},n),handleAction:a,handleType:a})},e.deprecated=g,e.getType=p,e.isActionOf=function(e,r){t(e)&&i(1);var n=Array.isArray(e)?e:[e];n.forEach(a);var o=function(e){return n.some((function(t){return e.type===t.getType()}))};return void 0===r?o:o(r)},e.isOfType=function(e,r){t(e)&&i(1);var n=Array.isArray(e)?e:[e];n.forEach(u);var a=function(e){return n.includes(e.type)};return void 0===r?a:a(r)}}))})),zt=v(((e,t)=>{!function(i,r){"object"==typeof e&&typeof t<"u"?r(e,(At(),w(Fe))):"function"==typeof define&&define.amd?define(["exports","react"],r):r((i=typeof globalThis<"u"?globalThis:i||self).ReactErrorBoundary={},i.React)}(e,(function(e,t){"use strict";var i=function(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(i){if("default"!==i){var r=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return e[i]}})}})),t.default=e,Object.freeze(t)}(t);function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var n={error:null},a=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state=n,t.resetErrorBoundary=function(){for(var e,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];null==t.props.onReset||(e=t.props).onReset.apply(e,r),t.reset()},t}!function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}(t,e),t.getDerivedStateFromError=function(e){return{error:e}};var a=t.prototype;return a.reset=function(){this.setState(n)},a.componentDidCatch=function(e,t){var i,r;null==(i=(r=this.props).onError)||i.call(r,e,t)},a.componentDidUpdate=function(e,t){var i,r,n=this.state.error,a=this.props.resetKeys;null!==n&&null!==t.error&&function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=[]),e.length!==t.length||e.some((function(e,i){return!Object.is(e,t[i])}))}(e.resetKeys,a)&&(null==(i=(r=this.props).onResetKeysChange)||i.call(r,e.resetKeys,a),this.reset())},a.render=function(){var e=this.state.error,t=this.props,r=t.fallbackRender,n=t.FallbackComponent,a=t.fallback;if(null!==e){var o={error:e,resetErrorBoundary:this.resetErrorBoundary};if(i.isValidElement(a))return a;if("function"==typeof r)return r(o);if(n)return i.createElement(n,o);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},t}(i.Component);e.ErrorBoundary=a,e.useErrorHandler=function(e){var t=i.useState(null),r=t[0],n=t[1];if(null!=e)throw e;if(null!=r)throw r;return n},e.withErrorBoundary=function(e,t){var r=function(r){return i.createElement(a,t,i.createElement(e,r))},n=e.displayName||e.name||"Unknown";return r.displayName="withErrorBoundary("+n+")",r},Object.defineProperty(e,"__esModule",{value:!0})}))}));function Lt(e,t,i,r){function n(){let t=Reflect.construct(HTMLElement,[],n);return t._vdomComponent=e,t._shadowEnabled=r&&r.shadow,t._root=t._shadowEnabled?t.attachShadow({mode:"open"}):t,r.onConstruct&&r.onConstruct(t),t.ready=!1,t.whenReady=e=>{t.ready?e():t.addEventListener("ready",e)},t}n.prototype=Object.create(HTMLElement.prototype),n.prototype.constructor=n,n.prototype.connectedCallback=Nt,n.prototype.attributeChangedCallback=$t,n.prototype.disconnectedCallback=Bt,i=i||e.observedAttributes||Object.keys(e.propTypes||{}),n.observedAttributes=i,i.forEach((e=>{Object.defineProperty(n.prototype,e,{get(){return this._vdom?this._vdom.props[e]:(this._props||(this._props={}),this._props[e])},set(t){this._vdom?(this._props[e]=t,this.attributeChangedCallback(e,null,t)):(this._props||(this._props={}),this._props[e]=t,this._props[jt(e)]=t);let i=typeof t;(null==t||"string"===i||"boolean"===i||"number"===i)&&this.setAttribute(e,t)}})})),r.beforeCreate&&r.beforeCreate(n);let a=t||e.tagName||e.displayName||e.name;if(!customElements.get(a))return customElements.define(t||e.tagName||e.displayName||e.name,n)}function Ft(e){this.getChildContext=()=>e.context;let t=e,{context:i,children:r}=t;return Y(r,g(t,["context","children"]))}function Nt(){let e=new CustomEvent("_preact",{detail:{},bubbles:!0,cancelable:!0});this.dispatchEvent(e);let t=e.detail.context;this._vdom=E(Ft,p(d({},this._props),{context:t}),Ut(this,this._vdomComponent,this._shadowEnabled)),(this.hasAttribute("hydrate")?Q:V)(this._vdom,this._root),this.ready||(this.ready=!0,this.dispatchEvent(new CustomEvent("ready",{detail:{},bubbles:!1,cancelable:!1})))}function jt(e){return e.replace(/-(\w)/g,((e,t)=>t?t.toUpperCase():""))}function $t(e,t,i){if(!this._vdom)return;i=null==i?void 0:i;let r={};r[e]=i,r[jt(e)]=i,this._vdom=Y(this._vdom,r),V(this._vdom,this._root)}function Bt(){V(this._vdom=null,this._root)}function Dt(e,t){let i=e,{shadow:r,addContextListener:n,removeContextListener:a}=i,o=g(i,["shadow","addContextListener","removeContextListener"]);return!r&&!this._listener&&(this._listener=e=>{e.stopPropagation(),e.detail.context=t},n(this._listener)),E(r?"slot":A,p(d({},o),{ref:e=>{e?(this.ref=e,this._listener||(this._listener=e=>{e.stopPropagation(),e.detail.context=t},n(this._listener,this.ref))):a(this._listener,this.ref)}}))}function Ut(e,t,i){if(3===e.nodeType)return e.data;if(1!==e.nodeType)return null;let r=[],n={},a=0,o=e.attributes,s=e.childNodes;for(a=o.length;a--;)"slot"!==o[a].name&&(n[o[a].name]=o[a].value,n[jt(o[a].name)]=o[a].value);for(a=s.length;a--;){let e=s[a],t=Ut(e,null,i),o=e.slot;o?n[o]=E(Dt,{name:o,shadow:i,addContextListener(t,i=e){i.addEventListener("_preact",t)},removeContextListener(t,i=e){i.removeEventListener("_preact",t)}},t):r[a]=t}let l=t?E(Dt,{shadow:i,addContextListener(t,i=e){i.addEventListener("_preact",t)},removeContextListener(t,i=e){i.removeEventListener("_preact",t)}},r):r;return!i&&t&&(e.innerHTML=""),E(t||e.nodeName.toLowerCase(),n,l)}oe(),At(),At(),At(),At(),At();var Wt,Ht,qt=b(Rt(),1),Vt=["onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onScroll","onWheel","onClick","onDragStart","onDragEnd","onDragEnter","onDragExit","onDrag","onDragOver"];var Qt=Vt.reduce(((e,t)=>(e[t.slice(2).toLowerCase()]=t,e[t]=t,e)),{}),Yt=(e,t,i)=>{let r=e.length,n=i||Gt(r);for(let i=0;i<r;i++)n[i]=i%5==0?e[i+1]<t[3]&&e[i+3]>t[1]&&e[i+2]<t[4]&&e[i+4]>t[2]?1:0:e[i];return n};function Gt(e,t,i){return new Float32Array(e,t,i)}var Kt=(e,t,i)=>{let r=i||Gt(9);return r[0]=e[0]*t[0]+e[1]*t[3]+e[2]*t[6],r[1]=e[0]*t[1]+e[1]*t[4]+e[2]*t[7],r[2]=e[0]*t[2]+e[1]*t[5]+e[2]*t[8],r[3]=e[3]*t[0]+e[4]*t[3]+e[5]*t[6],r[4]=e[3]*t[1]+e[4]*t[4]+e[5]*t[7],r[5]=e[3]*t[2]+e[4]*t[5]+e[5]*t[8],r[6]=e[6]*t[0]+e[7]*t[3]+e[8]*t[6],r[7]=e[6]*t[1]+e[7]*t[4]+e[8]*t[7],r[8]=e[6]*t[2]+e[7]*t[5]+e[8]*t[8],r},Xt=class{constructor(e){this.index=0,this.length=e,this.points=Gt(this.length)}static grid(e=1,t=1){return new Xt(5*e*t)}static point(e,t){let i=Gt(5);return i[0]=1,i[1]=e,i[2]=t,i[3]=e,i[4]=t,i}static positionPair(e){let t=Gt(5);return t[0]=1,t[1]=e.x1,t[2]=e.y1,t[3]=e.x2,t[4]=e.y2,t}static projection(e){return Xt.singleBox(e.width,e.height,e.x,e.y)}static singleBox(e,t,i=0,r=0){let n=Gt(5);return n[0]=1,n[1]=i,n[2]=r,n[3]=e+i,n[4]=t+r,n}row(e){return e(this)}addPoints(e,t,i,r){return this.points[this.index]=1,this.points[1+this.index]=e,this.points[2+this.index]=t,this.points[3+this.index]=i,this.points[4+this.index]=r,this.index+=5,this}addBox(e,t,i,r){return this.addPoints(e,t,e+i,t+r),this}build(){return this.points}},Zt=(e,t)=>{let i=e.length;for(let r=0;r<i;r++)e[r]=r%5==0?t[6]*e[r+1]+t[7]*e[r+2]+t[8]*e[r]:r%5%2==1?t[0]*e[r]+t[1]*e[r+1]+t[2]:t[3]*e[r-1]+t[4]*e[r]+t[5];return e},Jt=e=>{let t=Gt(9);return t[0]=e,t[4]=e,t[8]=1,t},ei=(e,t)=>{let i=Gt(9);return i[0]=1,i[2]=e,i[4]=1,i[5]=t,i[8]=1,i},ti=(e,t,i)=>Kt(ei((1-e)*t,(1-e)*i),Jt(e)),ii=(e,t,i)=>{let r=e.length,n=i&&i.length>=r?i.slice(0,r):Gt(r);for(let i=0;i<r;i++)n[i]=i%5==0?t[6]*e[i+1]+t[7]*e[i+2]+t[8]*e[i]:i%5%2==1?t[0]*e[i]+t[1]*e[i+1]+t[2]:t[3]*e[i-1]+t[4]*e[i]+t[5];return n},ri=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"),""),ni=class{constructor(){this.__revision=0,this.__owner={value:void 0},this.__state={},this.scale=1,this.layers=[],this.time=[],this.addEventListener=(e,t,i)=>{let r=Qt[e];if(!this.eventHandlers[r])throw new Error(`Unknown event ${r}`);-1===this.eventHandlers[r].indexOf(t)&&this.eventHandlers[r].push(t)},this.removeEventListener=(e,t)=>{let i=Qt[e];this.eventHandlers[i]?-1!==this.eventHandlers[i].indexOf(t)&&(this.eventHandlers[i]=this.eventHandlers[i].filter((e=>e!==t))):console.warn(`Unknown event ${i}`)},this.id=this.__id=ri(),this.eventHandlers=Vt.reduce(((e,t)=>(e[t]=[],e)),{})}get crop(){return this._crop}set crop(e){this._crop=e}getObjectsAt(e){return[]}getAllPointsAt(e,t,i){return[]}getScheduledUpdates(e,t){return[]}dispatchEvent(e,t){let i=this.eventHandlers[e],r=i?i.length:0,n=!1;if(r)for(let a=0;a<r;a++)try{i[a](t),n=!0}catch(t){console.error(e,t)}return n}get x(){return this.points[1]}get y(){return this.points[2]}get width(){return this.points[3]-this.points[1]}get height(){return this.points[4]-this.points[2]}translate(e,t){Zt(this.points,ei(e,t))}atScale(e){Zt(this.points,ti(e,this.x,this.y)),this.scale*=e}transform(e){Zt(this.points,e)}applyProps(e){this.__revision++}appendChild(e){}removeChild(e){}insertBefore(e,t){}hideInstance(){}},ai=class extends ni{constructor(e){if(super(),this.type="spacial-content",this.style={opacity:1},e){let t=e.scale||1;this.id=e.id||e.uri,this.uri=e.uri,this.points=Xt.singleBox(e.width,e.height,e.x,e.y),this.display={x:0,y:0,scale:t,width:e.width/t,height:e.height/t,points:Xt.singleBox(e.width/t,e.height/t),rotation:null==e?void 0:e.rotation}}else this.id="",this.uri="",this.display={x:0,y:0,scale:1,width:0,height:0,points:Gt(5)},this.points=Gt(5)}applyProps(e){let t=e.display?e.display.width:e.target.width,i=e.target.width/t;if(this.id=e.id||e.uri,this.uri=e.uri,this.points.set(Xt.singleBox(e.target.width,e.target.height,e.target.x,e.target.y)),e.style&&typeof e.style.opacity<"u"&&(this.style.opacity=e.style.opacity),e.crop){this.cropData=e.crop;let t=Xt.singleBox(e.crop.width,e.crop.height,e.crop.x,e.crop.y);Zt(t,ei(-e.crop.x,-e.crop.y)),this.crop?this.crop.set(t):this.crop=Gt(t)}e.display?(this.display.scale=i,this.display.width=e.display.width,this.display.height=e.display.height,this.display.rotation=e.display.rotation,this.display.points=Xt.singleBox(e.display.width,e.display.height)):(this.display.scale=i,this.display.width=e.target.width/i,this.display.height=e.target.height/i,this.display.points=Xt.singleBox(e.target.width/i,e.target.height/i))}getAllPointsAt(e,t,i){return[[this,this.crop||this.points,t]]}static fromSvg(e,t,i,r){return ai.fromImage("data:image/svg+xml;base64,"+btoa(e),t,i,r)}static fromImage(e,t,i,r){let n=new ai;return n.applyProps({uri:e,id:r,display:i,target:t}),n}getImageUrl(){return this.uri}},oi=class extends ni{constructor(e){if(super(),this.type="spacial-content",this.getTexture=()=>({source:void 0,hash:-1}),e){let t=e.scale||1;this.id=e.id||e.uri,this.uri=e.uri,this.points=Xt.singleBox(e.width,e.height),this.display={x:0,y:0,scale:t,width:e.width/t,height:e.height/t,points:1!==t?Xt.singleBox(e.width/t,e.height/t):this.points}}else this.id="",this.uri="",this.display={x:0,y:0,scale:1,width:0,height:0,points:Gt(5)},this.points=Gt(5)}applyProps(e){let t=e.display?e.display.width:e.target.width,i=e.target.width/t;this.id=e.id,this.points.set(Xt.singleBox(e.target.width,e.target.height)),this.display.scale=i,this.display.width=e.target.width/i,this.display.height=e.target.height/i,this.getTexture=e.getTexture,this.display.points=1!==i?Xt.singleBox(e.target.width/i,e.target.height/i):this.points}getAllPointsAt(e,t,i){return[[this,this.points,t]]}};function si(e,t){return Math.abs(e-t)}function li(e,t){let i=si(e.x,t.x),r=si(e.y,t.y);return Math.sqrt(Math.pow(i,2)+Math.pow(r,2))}function ui(...e){return t=>e.forEach((e=>{return r=t,void("function"==typeof(i=e)?i(r):null!=i&&(i.current=r));var i,r}))}function ci(...e){return ge(ui(...e),e)}function hi(){return hi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},hi.apply(this,arguments)}var di=De(((e,t)=>{let i=e,{children:r}=i,n=g(i,["children"]);return lt.toArray(r).some(gi)?E(A,null,lt.map(r,(e=>gi(e)?E(pi,hi({},n,{ref:t}),e.props.children):e))):E(pi,hi({},n,{ref:t}),r)}));di.displayName="Slot";var pi=De(((e,t)=>{let i=e,{children:r}=i,n=g(i,["children"]);return tt(r)?it(r,p(d({},function(e,t){let i=d({},t);for(let r in t){let n=e[r],a=t[r];/^on[A-Z]/.test(r)?i[r]=(...e)=>{null==a||a(...e),null==n||n(...e)}:"style"===r?i[r]=d(d({},n),a):"className"===r&&(i[r]=[n,a].filter(Boolean).join(" "))}return d(d({},e),i)}(n,r.props)),{ref:ui(t,r.ref)})):lt.count(r)>1?lt.only(null):null}));pi.displayName="SlotClone";var fi=({children:e})=>E(A,null,e);function gi(e){return tt(e)&&e.type===fi}var mi=Boolean(null==globalThis?void 0:globalThis.document)?he:()=>{},vi=function(e,t,i,r){this.name=e,this.fn=t,this.args=i,this.modifiers=r};function yi(e,t){return void 0===t&&(t="simple"),"object"==typeof e?e[t]:e}function bi(e,t,i){if(e.length){var r=e.shift(),n=bi(e,t,i);return r.perform(n,i)}return yi(t)}function wi(e,t,i){if(e.length){var r=e.shift(),n=wi(e,t,i);return r.performAsync(n,i)}return function(e){return Promise.resolve(yi(t,"async")(e))}}vi.prototype._test=function(e){var t=this.fn;try{bi(this.modifiers.slice(),t,this)(e)}catch(e){t=function(){return!1}}try{return bi(this.modifiers.slice(),t,this)(e)}catch(e){return!1}},vi.prototype._check=function(e){try{bi(this.modifiers.slice(),this.fn,this)(e)}catch(e){if(bi(this.modifiers.slice(),(function(e){return e}),this)(!1))return}if(!bi(this.modifiers.slice(),this.fn,this)(e))throw null},vi.prototype._testAsync=function(e){var t=this;return new Promise((function(i,r){wi(t.modifiers.slice(),t.fn,t)(e).then((function(t){t?i(e):r(null)})).catch((function(e){return r(e)}))}))};var xi=function(e,t,i){this.name=e,this.perform=t,this.performAsync=i},_i=function(e){function t(i,r,n,a){for(var o=[],s=arguments.length-4;s-- >0;)o[s]=arguments[s+4];e.call(this,o),e.captureStackTrace&&e.captureStackTrace(this,t),this.rule=i,this.value=r,this.cause=n,this.target=a}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),Si=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]),this.chain=e,this.nextRuleModifiers=t};function Ei(e,t,i,r){if(t.length){var n=t.shift();n._testAsync(e).then((function(){Ei(e,t,i,r)}),(function(t){r(new _i(n,e,t))}))}else i(e)}Si.prototype._applyRule=function(e,t){var i=this;return function(){for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];return i.chain.push(new vi(t,e.apply(i,r),r,i.nextRuleModifiers)),i.nextRuleModifiers=[],i}},Si.prototype._applyModifier=function(e,t){return this.nextRuleModifiers.push(new xi(t,e.simple,e.async)),this},Si.prototype._clone=function(){return new Si(this.chain.slice(),this.nextRuleModifiers.slice())},Si.prototype.test=function(e){return this.chain.every((function(t){return t._test(e)}))},Si.prototype.testAll=function(e){var t=[];return this.chain.forEach((function(i){try{i._check(e)}catch(r){t.push(new _i(i,e,r))}})),t},Si.prototype.check=function(e){this.chain.forEach((function(t){try{t._check(e)}catch(i){throw new _i(t,e,i)}}))},Si.prototype.testAsync=function(e){var t=this;return new Promise((function(i,r){Ei(e,t.chain.slice(),i,r)}))};var ki=function(e,t){return!(!t||"string"!=typeof e||0!==e.trim().length)||null==e};function Ci(){return typeof Proxy<"u"?Pi(new Si):Oi(new Si)}var Ai={};function Pi(e){return new Proxy(e,{get:function(t,i){if(i in t)return t[i];var r=Pi(e._clone());return i in Ti?r._applyModifier(Ti[i],i):i in Ai?r._applyRule(Ai[i],i):i in Mi?r._applyRule(Mi[i],i):void 0}})}function Oi(e){var t=function(e,t){return Object.keys(e).forEach((function(i){t[i]=function(){for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];return Oi(t._clone())._applyRule(e[i],i).apply(void 0,r)}})),t},i=t(Mi,e),r=t(Ai,i);return Object.keys(Ti).forEach((function(e){Object.defineProperty(r,e,{get:function(){return Oi(r._clone())._applyModifier(Ti[e],e)}})})),r}Ci.extend=function(e){Object.assign(Ai,e)},Ci.clearCustomRules=function(){Ai={}};var Ti={not:{simple:function(e){return function(t){return!e(t)}},async:function(e){return function(t){return Promise.resolve(e(t)).then((function(e){return!e})).catch((function(){return!0}))}}},some:{simple:function(e){return function(t){return Ii(t).some((function(t){try{return e(t)}catch(e){return!1}}))}},async:function(e){return function(t){return Promise.all(Ii(t).map((function(t){try{return e(t).catch((function(){return!1}))}catch(e){return!1}}))).then((function(e){return e.some(Boolean)}))}}},every:{simple:function(e){return function(t){return!1!==t&&Ii(t).every(e)}},async:function(e){return function(t){return Promise.all(Ii(t).map(e)).then((function(e){return e.every(Boolean)}))}}},strict:{simple:function(e,t){return function(i){return Ri(t)&&i&&"object"==typeof i?Object.keys(t.args[0]).length===Object.keys(i).length&&e(i):e(i)}},async:function(e,t){return function(i){return Promise.resolve(e(i)).then((function(e){return Ri(t)&&i&&"object"==typeof i?Object.keys(t.args[0]).length===Object.keys(i).length&&e:e})).catch((function(){return!1}))}}}};function Ri(e){return e&&"schema"===e.name&&e.args.length>0&&"object"==typeof e.args[0]}function Ii(e){return"string"==typeof e?e.split(""):e}var Mi={equal:function(e){return function(t){return t==e}},exact:function(e){return function(t){return t===e}},number:function(e){return void 0===e&&(e=!0),function(t){return"number"==typeof t&&(e||isFinite(t))}},integer:function(){return function(e){return(Number.isInteger||Li)(e)}},numeric:function(){return function(e){return!isNaN(parseFloat(e))&&isFinite(e)}},string:function(){return zi("string")},boolean:function(){return zi("boolean")},undefined:function(){return zi("undefined")},null:function(){return zi("null")},array:function(){return zi("array")},object:function(){return zi("object")},instanceOf:function(e){return function(t){return t instanceof e}},pattern:function(e){return function(t){return e.test(t)}},lowercase:function(){return function(e){return"boolean"==typeof e||e===e.toLowerCase()&&""!==e.trim()}},uppercase:function(){return function(e){return e===e.toUpperCase()&&""!==e.trim()}},vowel:function(){return function(e){return/^[aeiou]+$/i.test(e)}},consonant:function(){return function(e){return/^(?=[^aeiou])([a-z]+)$/i.test(e)}},first:function(e){return function(t){return t[0]==e}},last:function(e){return function(t){return t[t.length-1]==e}},empty:function(){return function(e){return 0===e.length}},length:function(e,t){return function(i){return i.length>=e&&i.length<=(t||e)}},minLength:function(e){return function(t){return t.length>=e}},maxLength:function(e){return function(t){return t.length<=e}},negative:function(){return function(e){return e<0}},positive:function(){return function(e){return e>=0}},between:function(e,t){return function(i){return i>=e&&i<=t}},range:function(e,t){return function(i){return i>=e&&i<=t}},lessThan:function(e){return function(t){return t<e}},lessThanOrEqual:function(e){return function(t){return t<=e}},greaterThan:function(e){return function(t){return t>e}},greaterThanOrEqual:function(e){return function(t){return t>=e}},even:function(){return function(e){return e%2==0}},odd:function(){return function(e){return e%2!=0}},includes:function(e){return function(t){return~t.indexOf(e)}},schema:function(e){return function(e){return{simple:function(t){var i=[];if(Object.keys(e).forEach((function(r){var n=e[r];try{n.check((t||{})[r])}catch(e){e.target=r,i.push(e)}})),i.length>0)throw i;return!0},async:function(t){var i=[],r=Object.keys(e).map((function(r){return e[r].testAsync((t||{})[r]).catch((function(e){e.target=r,i.push(e)}))}));return Promise.all(r).then((function(){if(i.length>0)throw i;return!0}))}}}(e)},passesAnyOf:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return function(t){return e.some((function(e){return e.test(t)}))}},optional:function(e,t){return void 0===t&&(t=!1),{simple:function(i){return ki(i,t)||void 0===e.check(i)},async:function(i){return ki(i,t)||e.testAsync(i)}}}};function zi(e){return function(t){return Array.isArray(t)&&"array"===e||null===t&&"null"===e||typeof t===e}}function Li(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}var Fi="colors",Ni="sizes",ji="space",$i={gap:ji,gridGap:ji,columnGap:ji,gridColumnGap:ji,rowGap:ji,gridRowGap:ji,inset:ji,insetBlock:ji,insetBlockEnd:ji,insetBlockStart:ji,insetInline:ji,insetInlineEnd:ji,insetInlineStart:ji,margin:ji,marginTop:ji,marginRight:ji,marginBottom:ji,marginLeft:ji,marginBlock:ji,marginBlockEnd:ji,marginBlockStart:ji,marginInline:ji,marginInlineEnd:ji,marginInlineStart:ji,padding:ji,paddingTop:ji,paddingRight:ji,paddingBottom:ji,paddingLeft:ji,paddingBlock:ji,paddingBlockEnd:ji,paddingBlockStart:ji,paddingInline:ji,paddingInlineEnd:ji,paddingInlineStart:ji,top:ji,right:ji,bottom:ji,left:ji,scrollMargin:ji,scrollMarginTop:ji,scrollMarginRight:ji,scrollMarginBottom:ji,scrollMarginLeft:ji,scrollMarginX:ji,scrollMarginY:ji,scrollMarginBlock:ji,scrollMarginBlockEnd:ji,scrollMarginBlockStart:ji,scrollMarginInline:ji,scrollMarginInlineEnd:ji,scrollMarginInlineStart:ji,scrollPadding:ji,scrollPaddingTop:ji,scrollPaddingRight:ji,scrollPaddingBottom:ji,scrollPaddingLeft:ji,scrollPaddingX:ji,scrollPaddingY:ji,scrollPaddingBlock:ji,scrollPaddingBlockEnd:ji,scrollPaddingBlockStart:ji,scrollPaddingInline:ji,scrollPaddingInlineEnd:ji,scrollPaddingInlineStart:ji,fontSize:"fontSizes",background:Fi,backgroundColor:Fi,backgroundImage:Fi,borderImage:Fi,border:Fi,borderBlock:Fi,borderBlockEnd:Fi,borderBlockStart:Fi,borderBottom:Fi,borderBottomColor:Fi,borderColor:Fi,borderInline:Fi,borderInlineEnd:Fi,borderInlineStart:Fi,borderLeft:Fi,borderLeftColor:Fi,borderRight:Fi,borderRightColor:Fi,borderTop:Fi,borderTopColor:Fi,caretColor:Fi,color:Fi,columnRuleColor:Fi,fill:Fi,outline:Fi,outlineColor:Fi,stroke:Fi,textDecorationColor:Fi,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:Ni,minBlockSize:Ni,maxBlockSize:Ni,inlineSize:Ni,minInlineSize:Ni,maxInlineSize:Ni,width:Ni,minWidth:Ni,maxWidth:Ni,height:Ni,minHeight:Ni,maxHeight:Ni,flexBasis:Ni,gridTemplateColumns:Ni,gridTemplateRows:Ni,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},Bi=(e,t)=>"function"==typeof t?{"()":Function.prototype.toString.call(t)}:t,Di=()=>{let e=Object.create(null);return(t,i,...r)=>{let n=(a=t,JSON.stringify(a,Bi));var a;return n in e?e[n]:e[n]=i(t,...r)}},Ui=Symbol.for("sxs.internal"),Wi=(e,t)=>Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)),Hi=e=>{for(let t in e)return!0;return!1},{hasOwnProperty:qi}=Object.prototype,Vi=e=>e.includes("-")?e:e.replace(/[A-Z]/g,(e=>"-"+e.toLowerCase())),Qi=/\s+(?![^()]*\))/,Yi=e=>t=>e(..."string"==typeof t?String(t).split(Qi):[t]),Gi={appearance:e=>({WebkitAppearance:e,appearance:e}),backfaceVisibility:e=>({WebkitBackfaceVisibility:e,backfaceVisibility:e}),backdropFilter:e=>({WebkitBackdropFilter:e,backdropFilter:e}),backgroundClip:e=>({WebkitBackgroundClip:e,backgroundClip:e}),boxDecorationBreak:e=>({WebkitBoxDecorationBreak:e,boxDecorationBreak:e}),clipPath:e=>({WebkitClipPath:e,clipPath:e}),content:e=>({content:e.includes('"')||e.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(e)?e:`"${e}"`}),hyphens:e=>({WebkitHyphens:e,hyphens:e}),maskImage:e=>({WebkitMaskImage:e,maskImage:e}),maskSize:e=>({WebkitMaskSize:e,maskSize:e}),tabSize:e=>({MozTabSize:e,tabSize:e}),textSizeAdjust:e=>({WebkitTextSizeAdjust:e,textSizeAdjust:e}),userSelect:e=>({WebkitUserSelect:e,userSelect:e}),marginBlock:Yi(((e,t)=>({marginBlockStart:e,marginBlockEnd:t||e}))),marginInline:Yi(((e,t)=>({marginInlineStart:e,marginInlineEnd:t||e}))),maxSize:Yi(((e,t)=>({maxBlockSize:e,maxInlineSize:t||e}))),minSize:Yi(((e,t)=>({minBlockSize:e,minInlineSize:t||e}))),paddingBlock:Yi(((e,t)=>({paddingBlockStart:e,paddingBlockEnd:t||e}))),paddingInline:Yi(((e,t)=>({paddingInlineStart:e,paddingInlineEnd:t||e})))},Ki=/([\d.]+)([^]*)/,Xi=(e,t)=>e.length?e.reduce(((e,i)=>(e.push(...t.map((e=>e.includes("&")?e.replace(/&/g,/[ +>|~]/.test(i)&&/&.*&/.test(e)?`:is(${i})`:i):i+" "+e))),e)),[]):t,Zi=(e,t)=>e in Ji&&"string"==typeof t?t.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,((t,i,r,n)=>i+("stretch"===r?`-moz-available${n};${Vi(e)}:${i}-webkit-fill-available`:`-moz-fit-content${n};${Vi(e)}:${i}fit-content`)+n)):String(t),Ji={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},er=e=>e?e+"-":"",tr=(e,t,i)=>e.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,((e,r,n,a,o)=>"$"==a==!!n?e:(r||"--"==a?"calc(":"")+"var(--"+("$"===a?er(t)+(o.includes("$")?"":er(i))+o.replace(/\$/g,"-"):o)+")"+(r||"--"==a?"*"+(r||"")+(n||"1")+")":""))),ir=/\s*,\s*(?![^()]*\))/,rr=Object.prototype.toString,nr=(e,t,i,r,n)=>{let a,o,s,l=(e,t,i)=>{let u,c,h=e=>{for(u in e){let f=64===u.charCodeAt(0),g=f&&Array.isArray(e[u])?e[u]:[e[u]];for(c of g){let e=/[A-Z]/.test(p=u)?p:p.replace(/-[^]/g,(e=>e[1].toUpperCase())),g="object"==typeof c&&c&&c.toString===rr&&(!r.utils[e]||!t.length);if(e in r.utils&&!g){let t=r.utils[e];if(t!==o){o=t,h(t(c)),o=null;continue}}else if(e in Gi){let t=Gi[e];if(t!==s){s=t,h(t(c)),s=null;continue}}if(f&&(d=u.slice(1)in r.media?"@media "+r.media[u.slice(1)]:u,u=d.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,((e,t,i,r,n,a)=>{let o=Ki.test(t),s=.0625*(o?-1:1),[l,u]=o?[r,t]:[t,r];return"("+("="===i[0]?"":">"===i[0]===o?"max-":"min-")+l+":"+("="!==i[0]&&1===i.length?u.replace(Ki,((e,t,r)=>Number(t)+s*(">"===i?1:-1)+r)):u)+(n?") and ("+(">"===n[0]?"min-":"max-")+l+":"+(1===n.length?a.replace(Ki,((e,t,i)=>Number(t)+s*(">"===n?-1:1)+i)):a):"")+")"}))),g){let e=f?i.concat(u):[...i],r=f?[...t]:Xi(t,u.split(ir));void 0!==a&&n(ar(...a)),a=void 0,l(c,r,e)}else void 0===a&&(a=[[],t,i]),u=f||36!==u.charCodeAt(0)?u:`--${er(r.prefix)}${u.slice(1).replace(/\$/g,"-")}`,c=g?c:"number"==typeof c?c&&e in or?String(c)+"px":String(c):tr(Zi(e,null==c?"":c),r.prefix,r.themeMap[e]),a[0].push(`${f?`${u} `:`${Vi(u)}:`}${c}`)}}var d,p};h(e),void 0!==a&&n(ar(...a)),a=void 0};l(e,t,i)},ar=(e,t,i)=>`${i.map((e=>`${e}{`)).join("")}${t.length?`${t.join(",")}{`:""}${e.join(";")}${t.length?"}":""}${Array(i.length?i.length+1:0).join("}")}`,or={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},sr=e=>String.fromCharCode(e+(e>25?39:97)),lr=e=>(e=>{let t,i="";for(t=Math.abs(e);t>52;t=t/52|0)i=sr(t%52)+i;return sr(t%52)+i})(((e,t)=>{let i=t.length;for(;i;)e=33*e^t.charCodeAt(--i);return e})(5381,JSON.stringify(e))>>>0),ur=["themed","global","styled","onevar","resonevar","allvar","inline"],cr=e=>{if(e.href&&!e.href.startsWith(location.origin))return!1;try{return!!e.cssRules}catch(e){return!1}},hr=e=>{let t,i=()=>{let{cssRules:e}=t.sheet;return[].map.call(e,((i,r)=>{let{cssText:n}=i,a="";if(n.startsWith("--sxs"))return"";if(e[r-1]&&(a=e[r-1].cssText).startsWith("--sxs")){if(!i.cssRules.length)return"";for(let e in t.rules)if(t.rules[e].group===i)return`--sxs{--sxs:${[...t.rules[e].cache].join(" ")}}${n}`;return i.cssRules.length?`${a}${n}`:""}return n})).join("")},r=()=>{if(t){let{rules:e,sheet:i}=t;if(!i.deleteRule){for(;3===Object(Object(i.cssRules)[0]).type;)i.cssRules.splice(0,1);i.cssRules=[]}for(let t in e)delete e[t]}let n=Object(e).styleSheets||[];for(let e of n)if(cr(e)){for(let n=0,a=e.cssRules;a[n];++n){let o=Object(a[n]);if(1!==o.type)continue;let s=Object(a[n+1]);if(4!==s.type)continue;++n;let{cssText:l}=o;if(!l.startsWith("--sxs"))continue;let u=l.slice(14,-3).trim().split(/\s+/),c=ur[u[0]];c&&(t||(t={sheet:e,reset:r,rules:{},toString:i}),t.rules[c]={group:s,index:n,cache:new Set(u)})}if(t)break}if(!t){let n=(e,t)=>({type:t,cssRules:[],insertRule(e,t){this.cssRules.splice(t,0,n(e,{import:3,undefined:1}[(e.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return"@media{}"===e?`@media{${[].map.call(this.cssRules,(e=>e.cssText)).join("")}}`:e}});t={sheet:e?(e.head||e).appendChild(document.createElement("style")).sheet:n("","text/css"),rules:{},reset:r,toString:i}}let{sheet:a,rules:o}=t;for(let e=ur.length-1;e>=0;--e){let t=ur[e];if(!o[t]){let i=ur[e+1],r=o[i]?o[i].index:a.cssRules.length;a.insertRule("@media{}",r),a.insertRule(`--sxs{--sxs:${e}}`,r),o[t]={group:a.cssRules[r+1],index:r,cache:new Set([e])}}dr(o[t])}};return r(),t},dr=e=>{let t=e.group,i=t.cssRules.length;e.apply=e=>{try{t.insertRule(e,i),++i}catch(e){}}},pr=Symbol(),fr=Di(),gr=(e,t)=>fr(e,(()=>(...i)=>{let r={type:null,composers:new Set};for(let t of i)if(null!=t)if(t[Ui]){null==r.type&&(r.type=t[Ui].type);for(let e of t[Ui].composers)r.composers.add(e)}else t.constructor!==Object||t.$$typeof?null==r.type&&(r.type=t):r.composers.add(mr(t,e));return null==r.type&&(r.type="span"),r.composers.size||r.composers.add(["PJLV",{},[],[],{},[]]),vr(e,r,t)})),mr=(e,t)=>{var i=e,{variants:r,compoundVariants:n,defaultVariants:a}=i,o=g(i,["variants","compoundVariants","defaultVariants"]);let s=`${er(t.prefix)}c-${lr(o)}`,l=[],u=[],c=Object.create(null),h=[];for(let e in a)c[e]=String(a[e]);if("object"==typeof r&&r)for(let e in r){d=c,p=e,qi.call(d,p)||(c[e]="undefined");let t=r[e];for(let i in t){let r={[e]:String(i)};"undefined"===String(i)&&h.push(e);let n=t[i],a=[r,n,!Hi(n)];l.push(a)}}var d,p;if("object"==typeof n&&n)for(let e of n){let t=e,{css:i}=t,r=g(t,["css"]);i="object"==typeof i&&i||{};for(let e in r)r[e]=String(r[e]);let n=[r,i,!Hi(i)];u.push(n)}return[s,o,l,u,c,h]},vr=(e,t,i)=>{let[r,n,a,o]=yr(t.composers),s="function"==typeof t.type||t.type.$$typeof?(e=>{function t(){for(let i=0;i<t[pr].length;i++){let[r,n]=t[pr][i];e.rules[r].apply(n)}return t[pr]=[],null}return t[pr]=[],t.rules={},ur.forEach((e=>t.rules[e]={apply:i=>t[pr].push([e,i])})),t})(i):null,l=(s||i).rules,u=`.${r}${n.length>1?`:where(.${n.slice(1).join(".")})`:""}`,c=c=>{let h=c="object"==typeof c&&c||wr,{css:p}=h,f=g(h,["css"]),m={};for(let e in a)if(delete f[e],e in c){let t=c[e];"object"==typeof t&&t?m[e]=d({"@initial":a[e]},t):(t=String(t),m[e]="undefined"!==t||o.has(e)?t:a[e])}else m[e]=a[e];let v=new Set([...n]);for(let[r,n,a,o]of t.composers){i.rules.styled.cache.has(r)||(i.rules.styled.cache.add(r),nr(n,[`.${r}`],[],e,(e=>{l.styled.apply(e)})));let t=br(a,m,e.media),s=br(o,m,e.media,!0);for(let n of t)if(void 0!==n)for(let[t,a,o]of n){let n=`${r}-${lr(a)}-${t}`;v.add(n);let s=(o?i.rules.resonevar:i.rules.onevar).cache,u=o?l.resonevar:l.onevar;s.has(n)||(s.add(n),nr(a,[`.${n}`],[],e,(e=>{u.apply(e)})))}for(let t of s)if(void 0!==t)for(let[n,a]of t){let t=`${r}-${lr(a)}-${n}`;v.add(t),i.rules.allvar.cache.has(t)||(i.rules.allvar.cache.add(t),nr(a,[`.${t}`],[],e,(e=>{l.allvar.apply(e)})))}}if("object"==typeof p&&p){let t=`${r}-i${lr(p)}-css`;v.add(t),i.rules.inline.cache.has(t)||(i.rules.inline.cache.add(t),nr(p,[`.${t}`],[],e,(e=>{l.inline.apply(e)})))}for(let e of String(c.className||"").trim().split(/\s+/))e&&v.add(e);let y=f.className=[...v].join(" ");return{type:t.type,className:y,selector:u,props:f,toString:()=>y,deferredInjector:s}};return Wi(c,{className:r,selector:u,[Ui]:t,toString:()=>(i.rules.styled.cache.has(r)||c(),r)})},yr=e=>{let t="",i=[],r={},n=[];for(let[a,,,,o,s]of e){""===t&&(t=a),i.push(a),n.push(...s);for(let e in o){let t=o[e];(void 0===r[e]||"undefined"!==t||s.includes(t))&&(r[e]=t)}}return[t,i,r,new Set(n)]},br=(e,t,i,r)=>{let n=[];e:for(let[a,o,s]of e){if(s)continue;let e,l=0,u=!1;for(e in a){let r=a[e],n=t[e];if(n!==r){if("object"!=typeof n||!n)continue e;{let e,t,a=0;for(let o in n){if(r===String(n[o])){if("@initial"!==o){let e=o.slice(1);(t=t||[]).push(e in i?i[e]:o.replace(/^@media ?/,"")),u=!0}l+=a,e=!0}++a}if(t&&t.length&&(o={["@media "+t.join(", ")]:o}),!e)continue e}}}(n[l]=n[l]||[]).push([r?"cv":`${e}-${a[e]}`,o,u])}return n},wr={},xr=Di(),_r=(e,t)=>xr(e,(()=>(...i)=>{let r=()=>{for(let r of i){r="object"==typeof r&&r||{};let i=lr(r);if(!t.rules.global.cache.has(i)){if(t.rules.global.cache.add(i),"@import"in r){let e=[].indexOf.call(t.sheet.cssRules,t.rules.themed.group)-1;for(let i of[].concat(r["@import"]))i=i.includes('"')||i.includes("'")?i:`"${i}"`,t.sheet.insertRule(`@import ${i};`,e++);delete r["@import"]}nr(r,[],[],e,(e=>{t.rules.global.apply(e)}))}}return""};return Wi(r,{toString:r})})),Sr=Di(),Er=(e,t)=>Sr(e,(()=>i=>{let r=`${er(e.prefix)}k-${lr(i)}`,n=()=>{if(!t.rules.global.cache.has(r)){t.rules.global.cache.add(r);let n=[];nr(i,[],[],e,(e=>n.push(e)));let a=`@keyframes ${r}{${n.join("")}}`;t.rules.global.apply(a)}return r};return Wi(n,{get name(){return n()},toString:n})})),kr=class{constructor(e,t,i,r){this.token=null==e?"":String(e),this.value=null==t?"":String(t),this.scale=null==i?"":String(i),this.prefix=null==r?"":String(r)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+er(this.prefix)+er(this.scale)+this.token}toString(){return this.computedValue}},Cr=Di(),Ar=(e,t)=>Cr(e,(()=>(i,r)=>{r="object"==typeof i&&i||Object(r);let n=`.${i=(i="string"==typeof i?i:"")||`${er(e.prefix)}t-${lr(r)}`}`,a={},o=[];for(let t in r){a[t]={};for(let i in r[t]){let n=`--${er(e.prefix)}${t}-${i}`,s=tr(String(r[t][i]),e.prefix,t);a[t][i]=new kr(i,s,t,e.prefix),o.push(`${n}:${s}`)}}let s=()=>{if(o.length&&!t.rules.themed.cache.has(i)){t.rules.themed.cache.add(i);let n=`${r===e.theme?":root,":""}.${i}{${o.join(";")}}`;t.rules.themed.apply(n)}return i};return p(d({},a),{get className(){return s()},selector:n,toString:s})})),Pr=Di(),Or=Di();var Tr={toVector:(e,t)=>(void 0===e&&(e=t),Array.isArray(e)?e:[e,e]),add:(e,t)=>[e[0]+t[0],e[1]+t[1]],sub:(e,t)=>[e[0]-t[0],e[1]-t[1]],addTo(e,t){e[0]+=t[0],e[1]+=t[1]},subTo(e,t){e[0]-=t[0],e[1]-=t[1]}};function Rr(e,t,i){return 0===t||Math.abs(t)===1/0?Math.pow(e,5*i):e*t*i/(t+i*e)}function Ir(e,t,i,r=.15){return 0===r?function(e,t,i){return Math.max(t,Math.min(e,i))}(e,t,i):e<t?-Rr(t-e,i-t,r)+t:e>i?+Rr(e-i,i-t,r)+i:e}function Mr(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function zr(e,t,i){return(t=Mr(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Lr(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Fr(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Lr(Object(i),!0).forEach((function(t){zr(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Lr(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Nr={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function jr(e){return e?e[0].toUpperCase()+e.slice(1):""}var $r=["enter","leave"];function Br(e,t="",i=!1){let r=Nr[e],n=r&&r[t]||t;return"on"+jr(e)+jr(n)+(function(e=!1,t){return e&&!$r.includes(t)}(i,n)?"Capture":"")}var Dr=["gotpointercapture","lostpointercapture"];function Ur(e){let t=e.substring(2).toLowerCase(),i=!!~t.indexOf("passive");i&&(t=t.replace("passive",""));let r=Dr.includes(t)?"capturecapture":"capture",n=!!~t.indexOf(r);return n&&(t=t.replace("capture","")),{device:t,capture:n,passive:i}}function Wr(e){return"touches"in e}function Hr(e){return Wr(e)?"touch":"pointerType"in e?e.pointerType:"mouse"}function qr(e){return Wr(e)?function(e){return"touchend"===e.type||"touchcancel"===e.type?e.changedTouches:e.targetTouches}(e)[0]:e}function Vr(e){return function(e){return Array.from(e.touches).filter((t=>{var i,r;return t.target===e.currentTarget||(null===(i=e.currentTarget)||void 0===i||null===(r=i.contains)||void 0===r?void 0:r.call(i,t.target))}))}(e).map((e=>e.identifier))}function Qr(e){let t=qr(e);return Wr(e)?t.identifier:t.pointerId}function Yr(e){let t=qr(e);return[t.clientX,t.clientY]}function Gr(e,...t){return"function"==typeof e?e(...t):e}function Kr(){}function Xr(...e){return 0===e.length?Kr:1===e.length?e[0]:function(){let t;for(let i of e)t=i.apply(this,arguments)||t;return t}}function Zr(e,t){return Object.assign({},t,e||{})}var Jr=class{constructor(e,t,i){this.ctrl=e,this.args=t,this.key=i,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){let{state:e,shared:t,ingKey:i,args:r}=this;t[i]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=r,e.axis=void 0,e.memo=void 0,e.elapsedTime=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){let t=this.state,i=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=e.target,t.currentTarget=e.currentTarget,t.lastOffset=i.from?Gr(i.from,t):t.offset,t.offset=t.lastOffset),t.startTime=t.timeStamp=e.timeStamp}computeValues(e){let t=this.state;t._values=e,t.values=this.config.transform(e)}computeInitial(){let e=this.state;e._initial=e._values,e.initial=e.values}compute(e){let{state:t,config:i,shared:r}=this;t.args=this.args;let n=0;if(e&&(t.event=e,i.preventDefault&&e.cancelable&&t.event.preventDefault(),t.type=e.type,r.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,r.locked=!!document.pointerLockElement,Object.assign(r,function(e){let t={};if("buttons"in e&&(t.buttons=e.buttons),"shiftKey"in e){let{shiftKey:i,altKey:r,metaKey:n,ctrlKey:a}=e;Object.assign(t,{shiftKey:i,altKey:r,metaKey:n,ctrlKey:a})}return t}(e)),r.down=r.pressed=r.buttons%2==1||r.touches>0,n=e.timeStamp-t.timeStamp,t.timeStamp=e.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){let e=t._delta.map(Math.abs);Tr.addTo(t._distance,e)}this.axisIntent&&this.axisIntent(e);let[a,o]=t._movement,[s,l]=i.threshold,{_step:u,values:c}=t;if(i.hasCustomTransform?(!1===u[0]&&(u[0]=Math.abs(a)>=s&&c[0]),!1===u[1]&&(u[1]=Math.abs(o)>=l&&c[1])):(!1===u[0]&&(u[0]=Math.abs(a)>=s&&Math.sign(a)*s),!1===u[1]&&(u[1]=Math.abs(o)>=l&&Math.sign(o)*l)),t.intentional=!1!==u[0]||!1!==u[1],!t.intentional)return;let h=[0,0];if(i.hasCustomTransform){let[e,t]=c;h[0]=!1!==u[0]?e-u[0]:0,h[1]=!1!==u[1]?t-u[1]:0}else h[0]=!1!==u[0]?a-u[0]:0,h[1]=!1!==u[1]?o-u[1]:0;this.restrictToAxis&&!t._blocked&&this.restrictToAxis(h);let d=t.offset,p=t._active&&!t._blocked||t.active;p&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=r[this.ingKey]=t._active,e&&(t.first&&("bounds"in i&&(t._bounds=Gr(i.bounds,t)),this.setup&&this.setup()),t.movement=h,this.computeOffset()));let[f,g]=t.offset,[[m,v],[y,b]]=t._bounds;t.overflow=[f<m?-1:f>v?1:0,g<y?-1:g>b?1:0],t._movementBound[0]=!!t.overflow[0]&&(!1===t._movementBound[0]?t._movement[0]:t._movementBound[0]),t._movementBound[1]=!!t.overflow[1]&&(!1===t._movementBound[1]?t._movement[1]:t._movementBound[1]);let w=t._active&&i.rubberband||[0,0];if(t.offset=function(e,[t,i],[r,n]){let[[a,o],[s,l]]=e;return[Ir(t,a,o,r),Ir(i,s,l,n)]}(t._bounds,t.offset,w),t.delta=Tr.sub(t.offset,d),this.computeMovement(),p&&(!t.last||n>32)){t.delta=Tr.sub(t.offset,d);let e=t.delta.map(Math.abs);Tr.addTo(t.distance,e),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&n>0&&(t.velocity=[e[0]/n,e[1]/n])}}emit(){let e=this.state,t=this.shared,i=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!i.triggerAllEvents)return;let r=this.handler(Fr(Fr(Fr({},t),e),{},{[this.aliasKey]:e.values}));void 0!==r&&(e.memo=r)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}};var en=class extends Jr{constructor(...e){super(...e),zr(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=Tr.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=Tr.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){let t=this.state,i=this.config;if(!t.axis&&e){let r="object"==typeof i.axisThreshold?i.axisThreshold[Hr(e)]:i.axisThreshold;t.axis=function([e,t],i){let r=Math.abs(e),n=Math.abs(t);return r>n&&r>i?"x":n>r&&n>i?"y":void 0}(t._movement,r)}t._blocked=(i.lockDirection||!!i.axis)&&!t.axis||!!i.axis&&i.axis!==t.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0}}},tn=e=>e,rn={enabled:(e=!0)=>e,eventOptions:(e,t,i)=>Fr(Fr({},i.shared.eventOptions),e),preventDefault:(e=!1)=>e,triggerAllEvents:(e=!1)=>e,rubberband(e=0){switch(e){case!0:return[.15,.15];case!1:return[0,0];default:return Tr.toVector(e)}},from:e=>"function"==typeof e?e:null!=e?Tr.toVector(e):void 0,transform(e,t,i){let r=e||i.shared.transform;return this.hasCustomTransform=!!r,r||tn},threshold:e=>Tr.toVector(e,0)},nn=Fr(Fr({},rn),{},{axis(e,t,{axis:i}){if(this.lockDirection="lock"===i,!this.lockDirection)return i},axisThreshold:(e=0)=>e,bounds(e={}){if("function"==typeof e)return t=>nn.bounds(e(t));if("current"in e)return()=>e.current;if("function"==typeof HTMLElement&&e instanceof HTMLElement)return e;let{left:t=-1/0,right:i=1/0,top:r=-1/0,bottom:n=1/0}=e;return[[t,i],[r,n]]}}),an={ArrowRight:(e,t=1)=>[e*t,0],ArrowLeft:(e,t=1)=>[-1*e*t,0],ArrowUp:(e,t=1)=>[0,-1*e*t],ArrowDown:(e,t=1)=>[0,e*t]};var on=typeof window<"u"&&window.document&&window.document.createElement;function sn(){return on&&"ontouchstart"in window||on&&window.navigator.maxTouchPoints>1}var ln={isBrowser:on,gesture:function(){try{return"constructor"in GestureEvent}catch(e){return!1}}(),touch:sn(),touchscreen:sn(),pointer:on&&"onpointerdown"in window,pointerLock:on&&"exitPointerLock"in window.document},un={mouse:0,touch:0,pen:8},cn=Fr(Fr({},nn),{},{device(e,t,{pointer:{touch:i=!1,lock:r=!1,mouse:n=!1}={}}){return this.pointerLock=r&&ln.pointerLock,ln.touch&&i?"touch":this.pointerLock?"mouse":ln.pointer&&!n?"pointer":ln.touch?"touch":"mouse"},preventScrollAxis(e,t,{preventScroll:i}){if(this.preventScrollDelay="number"==typeof i?i:i||void 0===i&&e?250:void 0,ln.touchscreen&&!1!==i)return e||(void 0!==i?"y":void 0)},pointerCapture(e,t,{pointer:{capture:i=!0,buttons:r=1,keys:n=!0}={}}){return this.pointerButtons=r,this.keys=n,!this.pointerLock&&"pointer"===this.device&&i},threshold(e,t,{filterTaps:i=!1,tapsThreshold:r=3,axis:n}){let a=Tr.toVector(e,i?r:n?1:0);return this.filterTaps=i,this.tapsThreshold=r,a},swipe({velocity:e=.5,distance:t=50,duration:i=250}={}){return{velocity:this.transform(Tr.toVector(e)),distance:this.transform(Tr.toVector(t)),duration:i}},delay(e=0){switch(e){case!0:return 180;case!1:return 0;default:return e}},axisThreshold:e=>e?Fr(Fr({},un),e):un,keyboardDisplacement:(e=10)=>e});Fr(Fr({},rn),{},{device(e,t,{shared:i,pointer:{touch:r=!1}={}}){if(i.target&&!ln.touch&&ln.gesture)return"gesture";if(ln.touch&&r)return"touch";if(ln.touchscreen){if(ln.pointer)return"pointer";if(ln.touch)return"touch"}},bounds(e,t,{scaleBounds:i={},angleBounds:r={}}){let n=e=>{let t=Zr(Gr(i,e),{min:-1/0,max:1/0});return[t.min,t.max]},a=e=>{let t=Zr(Gr(r,e),{min:-1/0,max:1/0});return[t.min,t.max]};return"function"!=typeof i&&"function"!=typeof r?[n(),a()]:e=>[n(e),a(e)]},threshold(e,t,i){return this.lockDirection="lock"===i.axis,Tr.toVector(e,this.lockDirection?[.1,3]:0)},modifierKey:e=>void 0===e?"ctrlKey":e,pinchOnWheel:(e=!0)=>e}),Fr(Fr({},nn),{},{mouseOnly:(e=!0)=>e}),Fr(Fr({},nn),{},{mouseOnly:(e=!0)=>e});var hn=new Map,dn=new Map;var pn={key:"drag",engine:class extends en{constructor(...e){super(...e),zr(this,"ingKey","dragging")}reset(){super.reset();let e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){let e=this.state;if(e._bounds instanceof HTMLElement){let t=e._bounds.getBoundingClientRect(),i=e.currentTarget.getBoundingClientRect(),r={left:t.left-i.left+e.offset[0],right:t.right-i.right+e.offset[0],top:t.top-i.top+e.offset[1],bottom:t.bottom-i.bottom+e.offset[1]};e._bounds=nn.bounds(r)}}cancel(){let e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout((()=>{this.compute(),this.emit()}),0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){let t=this.config,i=this.state;if(null!=e.buttons&&(Array.isArray(t.pointerButtons)?!t.pointerButtons.includes(e.buttons):-1!==t.pointerButtons&&t.pointerButtons!==e.buttons))return;let r=this.ctrl.setEventIds(e);t.pointerCapture&&e.target.setPointerCapture(e.pointerId),!(r&&r.size>1&&i._pointerActive)&&(this.start(e),this.setupPointer(e),i._pointerId=Qr(e),i._pointerActive=!0,this.computeValues(Yr(e)),this.computeInitial(),t.preventScrollAxis&&"mouse"!==Hr(e)?(i._active=!1,this.setupScrollPrevention(e)):t.delay>0?(this.setupDelayTrigger(e),t.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){let t=this.state;t._active=!0,t._preventScroll=!0,t._delayed=!1,this.compute(e),this.emit()}pointerMove(e){let t=this.state,i=this.config;if(!t._pointerActive||t.type===e.type&&e.timeStamp===t.timeStamp)return;let r=Qr(e);if(void 0!==t._pointerId&&r!==t._pointerId)return;let n=Yr(e);return document.pointerLockElement===e.target?t._delta=[e.movementX,e.movementY]:(t._delta=Tr.sub(n,t._values),this.computeValues(n)),Tr.addTo(t._movement,t._delta),this.compute(e),t._delayed&&t.intentional?(this.timeoutStore.remove("dragDelay"),t.active=!1,void this.startPointerDrag(e)):i.preventScrollAxis&&!t._preventScroll?t.axis?t.axis===i.preventScrollAxis||"xy"===i.preventScrollAxis?(t._active=!1,void this.clean()):(this.timeoutStore.remove("startPointerDrag"),void this.startPointerDrag(e)):void 0:void this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch(e){}let t=this.state,i=this.config;if(!t._active||!t._pointerActive)return;let r=Qr(e);if(void 0!==t._pointerId&&r!==t._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);let[n,a]=t._distance;if(t.tap=n<=i.tapsThreshold&&a<=i.tapsThreshold,t.tap&&i.filterTaps)t._force=!0;else{let[e,r]=t.direction,[n,a]=t.velocity,[o,s]=t.movement,[l,u]=i.swipe.velocity,[c,h]=i.swipe.distance,d=i.swipe.duration;t.elapsedTime<d&&(Math.abs(n)>l&&Math.abs(o)>c&&(t.swipe[0]=e),Math.abs(a)>u&&Math.abs(s)>h&&(t.swipe[1]=r))}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){let t=this.config,i=t.device;t.pointerLock&&e.currentTarget.requestPointerLock(),t.pointerCapture||(this.eventStore.add(this.sharedConfig.window,i,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,i,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,i,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,function(e){"persist"in e&&"function"==typeof e.persist&&e.persist()}(e);let t=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",t),this.eventStore.add(this.sharedConfig.window,"touch","cancel",t),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",(()=>{this.state._step=[0,0],this.startPointerDrag(e)}),this.config.delay)}keyDown(e){let t=an[e.key];if(t){let i=this.state,r=e.shiftKey?10:e.altKey?.1:1;this.start(e),i._delta=t(this.config.keyboardDisplacement,r),i._keyboardActive=!0,Tr.addTo(i._movement,i._delta),this.compute(e),this.emit()}}keyUp(e){e.key in an&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){let t=this.config.device;e(t,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(t,"change",this.pointerMove.bind(this)),e(t,"end",this.pointerUp.bind(this)),e(t,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}},resolver:cn};function fn(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i,r,n={},a=Object.keys(e);for(r=0;r<a.length;r++)i=a[r],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)i=a[r],!(t.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,i)||(n[i]=e[i]))}return n}var gn={target(e){if(e)return()=>"current"in e?e.current:e},enabled:(e=!0)=>e,window:(e=(ln.isBrowser?window:void 0))=>e,eventOptions:({passive:e=!0,capture:t=!1}={})=>({passive:e,capture:t}),transform:e=>e},mn=["target","eventOptions","window","enabled","transform"];function vn(e={},t){let i={};for(let[r,n]of Object.entries(t))switch(typeof n){case"function":i[r]=n.call(i,e[r],r,e);break;case"object":i[r]=vn(e[r],n);break;case"boolean":n&&(i[r]=e[r])}return i}var yn=class{constructor(e,t){zr(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=t}add(e,t,i,r,n){let a=this._listeners,o=function(e,t=""){let i=Nr[e];return e+(i&&i[t]||t)}(t,i),s=Fr(Fr({},this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{}),n);e.addEventListener(o,r,s);let l=()=>{e.removeEventListener(o,r,s),a.delete(l)};return a.add(l),l}clean(){this._listeners.forEach((e=>e())),this._listeners.clear()}},bn=class{constructor(){zr(this,"_timeouts",new Map)}add(e,t,i=140,...r){this.remove(e),this._timeouts.set(e,window.setTimeout(t,i,...r))}remove(e){let t=this._timeouts.get(e);t&&window.clearTimeout(t)}clean(){this._timeouts.forEach((e=>{window.clearTimeout(e)})),this._timeouts.clear()}},wn=class{constructor(e){zr(this,"gestures",new Set),zr(this,"_targetEventStore",new yn(this)),zr(this,"gestureEventStores",{}),zr(this,"gestureTimeoutStores",{}),zr(this,"handlers",{}),zr(this,"config",{}),zr(this,"pointerIds",new Set),zr(this,"touchIds",new Set),zr(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),function(e,t){t.drag&&xn(e,"drag"),t.wheel&&xn(e,"wheel"),t.scroll&&xn(e,"scroll"),t.move&&xn(e,"move"),t.pinch&&xn(e,"pinch"),t.hover&&xn(e,"hover")}(this,e)}setEventIds(e){return Wr(e)?(this.touchIds=new Set(Vr(e)),this.touchIds):"pointerId"in e?("pointerup"===e.type||"pointercancel"===e.type?this.pointerIds.delete(e.pointerId):"pointerdown"===e.type&&this.pointerIds.add(e.pointerId),this.pointerIds):void 0}applyHandlers(e,t){this.handlers=e,this.nativeHandlers=t}applyConfig(e,t){this.config=function(e,t,i={}){let r=e,{target:n,eventOptions:a,window:o,enabled:s,transform:l}=r,u=fn(r,mn);if(i.shared=vn({target:n,eventOptions:a,window:o,enabled:s,transform:l},gn),t){let e=dn.get(t);i[t]=vn(Fr({shared:i.shared},u),e)}else for(let e in u){let t=dn.get(e);t&&(i[e]=vn(Fr({shared:i.shared},u[e]),t))}return i}(e,t,this.config)}clean(){this._targetEventStore.clean();for(let e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){let t,i=this.config.shared,r={};if(!i.target||(t=i.target(),t)){if(i.enabled){for(let i of this.gestures){let n=this.config[i],a=_n(r,n.eventOptions,!!t);if(n.enabled){new(hn.get(i))(this,e,i).bind(a)}}let n=_n(r,i.eventOptions,!!t);for(let t in this.nativeHandlers)n(t,"",(i=>this.nativeHandlers[t](Fr(Fr({},this.state.shared),{},{event:i,args:e}))),void 0,!0)}for(let e in r)r[e]=Xr(...r[e]);if(!t)return r;for(let e in r){let{device:i,capture:n,passive:a}=Ur(e);this._targetEventStore.add(t,i,"",r[e],{capture:n,passive:a})}}}};function xn(e,t){e.gestures.add(t),e.gestureEventStores[t]=new yn(e,t),e.gestureTimeoutStores[t]=new bn}var _n=(e,t,i)=>(r,n,a,o={},s=!1)=>{var l,u;let c=null!==(l=o.capture)&&void 0!==l?l:t.capture,h=null!==(u=o.passive)&&void 0!==u?u:t.passive,d=s?r:Br(r,n,c);i&&h&&(d+="Passive"),e[d]=e[d]||[],e[d].push(a)};function Sn(e,t){return function(e){hn.set(e.key,e.engine),dn.set(e.key,e.resolver)}(pn),function(e,t={},i,r){let n=Ct.useMemo((()=>new wn(e)),[]);if(n.applyHandlers(e,r),n.applyConfig(t,i),Ct.useEffect(n.effect.bind(n)),Ct.useEffect((()=>n.clean.bind(n)),[]),void 0===t.target)return n.bind.bind(n)}({drag:e},t||{},"drag")}var En=Fe["useId".toString()]||(()=>{}),kn=0;var Cn=["a","button","div","h2","h3","img","li","nav","p","span","svg","ul"].reduce(((e,t)=>p(d({},e),{[t]:De(((e,i)=>{let r=e,{asChild:n}=r,a=g(r,["asChild"]),o=n?di:t;return ce((()=>{window[Symbol.for("radix-ui")]=!0}),[]),e.as&&console.error(An),E(o,hi({},a,{ref:i}))}))})),{}),An="Warning: The `as` prop has been removed in favour of `asChild`. For details, see https://radix-ui.com/docs/primitives/overview/styling#changing-the-rendered-element",Pn=De(((e,t)=>E(Cn.span,hi({},e,{ref:t,style:p(d({},e.style),{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"})})))),On=Pn,Tn=De(((e,t)=>{var i,r;let n=e,{containerRef:a,style:o}=n,s=g(n,["containerRef","style"]),l=null!==(i=null==a?void 0:a.current)&&void 0!==i?i:null==globalThis||null===(r=globalThis.document)||void 0===r?void 0:r.body,[,u]=le({});return mi((()=>{u({})}),[]),l?Ct.createPortal(E(Cn.div,hi({"data-radix-portal":""},s,{ref:t,style:l===document.body?d({position:"absolute",top:0,left:0,zIndex:2147483647},o):void 0})),l):null})),Rn=De(((e,t)=>{let i=e,{children:r,width:n=10,height:a=5}=i,o=g(i,["children","width","height"]);return E(Cn.svg,hi({},o,{ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),e.asChild?r:E("polygon",{points:"0,0 30,0 15,10"}))})),In=Rn;function Mn(e){let[t,i]=le(void 0);return ce((()=>{if(e){let t=new ResizeObserver((t=>{if(!Array.isArray(t)||!t.length)return;let r,n,a=t[0];if("borderBoxSize"in a){let e=a.borderBoxSize,t=Array.isArray(e)?e[0]:e;r=t.inlineSize,n=t.blockSize}else{let t=e.getBoundingClientRect();r=t.width,n=t.height}i({width:r,height:n})}));return t.observe(e,{box:"border-box"}),()=>{i(void 0),t.unobserve(e)}}}),[e]),t}var zn,Ln=new Map;function Fn(){let e=[];Ln.forEach(((t,i)=>{let r=i.getBoundingClientRect();var n,a;a=r,((n=t.rect).width!==a.width||n.height!==a.height||n.top!==a.top||n.right!==a.right||n.bottom!==a.bottom||n.left!==a.left)&&(t.rect=r,e.push(t))})),e.forEach((e=>{e.callbacks.forEach((t=>t(e.rect)))})),zn=requestAnimationFrame(Fn)}function Nn(e){let[t,i]=le();return ce((()=>{if(e){let t=function(e,t){let i=Ln.get(e);return void 0===i?(Ln.set(e,{rect:{},callbacks:[t]}),1===Ln.size&&(zn=requestAnimationFrame(Fn))):(i.callbacks.push(t),t(e.getBoundingClientRect())),()=>{let i=Ln.get(e);if(void 0===i)return;let r=i.callbacks.indexOf(t);r>-1&&i.callbacks.splice(r,1),0===i.callbacks.length&&(Ln.delete(e),0===Ln.size&&cancelAnimationFrame(zn))}}(e,i);return()=>{i(void 0),t()}}}),[e]),t}function jn(e,t=[]){let i=[],r=()=>{let t=i.map((e=>G(e)));return function(i){let r=(null==i?void 0:i[e])||t;return fe((()=>({[`__scope${e}`]:p(d({},i),{[e]:r})})),[i,r])}};return r.scopeName=e,[function(t,r){let n=G(r),a=i.length;function o(t){let i=t,{scope:r,children:o}=i,s=g(i,["scope","children"]),l=(null==r?void 0:r[e][a])||n,u=fe((()=>s),Object.values(s));return E(l.Provider,{value:u},o)}return i=[...i,r],o.displayName=t+"Provider",[o,function(i,o){let s=me((null==o?void 0:o[e][a])||n);if(s)return s;if(void 0!==r)return r;throw new Error(`\`${i}\` must be used within \`${t}\``)}]},$n(r,...t)]}function $n(...e){let t=e[0];if(1===e.length)return t;let i=()=>{let i=e.map((e=>({useScope:e(),scopeName:e.scopeName})));return function(e){let r=i.reduce(((t,{useScope:i,scopeName:r})=>d(d({},t),i(e)[`__scope${r}`])),{});return fe((()=>({[`__scope${t.scopeName}`]:r})),[r])}};return i.scopeName=t.scopeName,i}function Bn(e,t,i){let r=e["x"===i?"left":"top"],n="x"===i?"width":"height",a=e[n],o=t[n];return{before:r-o,start:r,center:r+(a-o)/2,end:r+a-o,after:r+a}}function Dn(e){return{position:"absolute",top:0,left:0,minWidth:"max-content",willChange:"transform",transform:`translate3d(${Math.round(e.x+window.scrollX)}px, ${Math.round(e.y+window.scrollY)}px, 0)`}}function Un(e,t,i,r,n){let a="top"===t||"bottom"===t,o=n?n.width:0,s=n?n.height:0,l=o/2+r,u="",c="";return a?(u={start:`${l}px`,center:"center",end:e.width-l+"px"}[i],c="top"===t?`${e.height+s}px`:-s+"px"):(u="left"===t?`${e.width+s}px`:-s+"px",c={start:`${l}px`,center:"center",end:e.height-l+"px"}[i]),`${u} ${c}`}var Wn={position:"fixed",top:0,left:0,opacity:0,transform:"translate3d(0, -200%, 0)"},Hn={position:"absolute",opacity:0};function qn({popperSize:e,arrowSize:t,arrowOffset:i,side:r,align:n}){let a=(e.width-t.width)/2,o=(e.height-t.width)/2,s={top:0,right:90,bottom:180,left:-90}[r],l=Math.max(t.width,t.height),u={width:`${l}px`,height:`${l}px`,transform:`rotate(${s}deg)`,willChange:"transform",position:"absolute",[r]:"100%",direction:Vn(r,n)};return"top"!==r&&"bottom"!==r||("start"===n&&(u.left=`${i}px`),"center"===n&&(u.left=`${a}px`),"end"===n&&(u.right=`${i}px`)),"left"!==r&&"right"!==r||("start"===n&&(u.top=`${i}px`),"center"===n&&(u.top=`${o}px`),"end"===n&&(u.bottom=`${i}px`)),u}function Vn(e,t){return("top"!==e&&"right"!==e||"end"!==t)&&("bottom"!==e&&"left"!==e||"end"===t)?"ltr":"rtl"}function Qn(e){return{top:"bottom",right:"left",bottom:"top",left:"right"}[e]}function Yn(e,t){return{top:e.top<t.top,right:e.right>t.right,bottom:e.bottom>t.bottom,left:e.left<t.left}}var[Gn,Kn]=jn("Popper"),[Xn,Zn]=Gn("Popper"),Jn=De(((e,t)=>{let i=e,{__scopePopper:r,virtualRef:n}=i,a=g(i,["__scopePopper","virtualRef"]),o=Zn("PopperAnchor",r),s=de(null),l=ci(t,s);return ce((()=>{o.onAnchorChange((null==n?void 0:n.current)||s.current)})),n?null:E(Cn.div,hi({},a,{ref:l}))})),[ea,ta]=Gn("PopperContent"),ia=De(((e,t)=>{let i=e,{__scopePopper:r,side:n="bottom",sideOffset:a,align:o="center",alignOffset:s,collisionTolerance:l,avoidCollisions:u=!0}=i,c=g(i,["__scopePopper","side","sideOffset","align","alignOffset","collisionTolerance","avoidCollisions"]),h=Zn("PopperContent",r),[f,m]=le(),v=Nn(h.anchor),[y,b]=le(null),w=Mn(y),[x,_]=le(null),S=Mn(x),k=ci(t,(e=>b(e))),C=function(){let[e,t]=le(void 0);return ce((()=>{let e;function i(){t({width:window.innerWidth,height:window.innerHeight})}function r(){window.clearTimeout(e),e=window.setTimeout(i,100)}return i(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)}),[]),e}(),A=C?DOMRect.fromRect(p(d({},C),{x:0,y:0})):void 0,{popperStyles:P,arrowStyles:O,placedSide:T,placedAlign:R}=function({anchorRect:e,popperSize:t,arrowSize:i,arrowOffset:r=0,side:n,sideOffset:a=0,align:o,alignOffset:s=0,shouldAvoidCollisions:l=!0,collisionBoundariesRect:u,collisionTolerance:c=0}){if(!e||!t||!u)return{popperStyles:Wn,arrowStyles:Hn};let h=function(e,t,i=0,r=0,n){let a=n?n.height:0,o=Bn(t,e,"x"),s=Bn(t,e,"y"),l=s.before-i-a,u=s.after+i+a,c=o.before-i-a,h=o.after+i+a;return{top:{start:{x:o.start+r,y:l},center:{x:o.center,y:l},end:{x:o.end-r,y:l}},right:{start:{x:h,y:s.start+r},center:{x:h,y:s.center},end:{x:h,y:s.end-r}},bottom:{start:{x:o.start+r,y:u},center:{x:o.center,y:u},end:{x:o.end-r,y:u}},left:{start:{x:c,y:s.start+r},center:{x:c,y:s.center},end:{x:c,y:s.end-r}}}}(t,e,a,s,i),f=h[n][o];if(!1===l){let e=Dn(f),a=Hn;return i&&(a=qn({popperSize:t,arrowSize:i,arrowOffset:r,side:n,align:o})),{popperStyles:p(d({},e),{"--radix-popper-transform-origin":Un(t,n,o,r,i)}),arrowStyles:a,placedSide:n,placedAlign:o}}let g=DOMRect.fromRect(d(d({},t),f)),m=(v=u,y=c,DOMRect.fromRect({width:v.width-2*y,height:v.height-2*y,x:v.left+y,y:v.top+y}));var v,y;let b=Yn(g,m),w=h[Qn(n)][o],x=function(e,t,i){let r=Qn(e);return t[e]&&!i[r]?r:e}(n,b,Yn(DOMRect.fromRect(d(d({},t),w)),m)),_=function(e,t,i,r,n){let a="top"===i||"bottom"===i,o=a?"left":"top",s=a?"right":"bottom",l=a?"width":"height",u=t[l]>e[l];return"start"!==r&&"center"!==r||!(n[o]&&u||n[s]&&!u)?"end"!==r&&"center"!==r||!(n[s]&&u||n[o]&&!u)?r:"start":"end"}(t,e,n,o,b),S=Dn(h[x][_]),E=Hn;return i&&(E=qn({popperSize:t,arrowSize:i,arrowOffset:r,side:x,align:_})),{popperStyles:p(d({},S),{"--radix-popper-transform-origin":Un(t,x,_,r,i)}),arrowStyles:E,placedSide:x,placedAlign:_}}({anchorRect:v,popperSize:w,arrowSize:S,arrowOffset:f,side:n,sideOffset:a,align:o,alignOffset:s,shouldAvoidCollisions:u,collisionBoundariesRect:A,collisionTolerance:l}),I=void 0!==T;return E("div",{style:P,"data-radix-popper-content-wrapper":""},E(ea,{scope:r,arrowStyles:O,onArrowChange:_,onArrowOffsetChange:m},E(Cn.div,hi({"data-side":T,"data-align":R},c,{style:p(d({},c.style),{animation:I?void 0:"none"}),ref:k}))))})),ra=De((function(e,t){let i=e,{__scopePopper:r,offset:n}=i,a=g(i,["__scopePopper","offset"]),o=ta("PopperArrow",r),{onArrowOffsetChange:s}=o;return ce((()=>s(n)),[s,n]),E("span",{style:p(d({},o.arrowStyles),{pointerEvents:"none"})},E("span",{ref:o.onArrowChange,style:{display:"inline-block",verticalAlign:"top",pointerEvents:"auto"}},E(In,hi({},a,{ref:t,style:p(d({},a.style),{display:"block"})}))))})),na=e=>{let{__scopePopper:t,children:i}=e,[r,n]=le(null);return E(Xn,{scope:t,anchor:r,onAnchorChange:n},i)},aa=Jn,oa=ia,sa=ra,la=e=>{let{present:t,children:i}=e,r=function(e){let[t,i]=le(),r=de({}),n=de(e),a=de("none"),o=e?"mounted":"unmounted",[s,l]=(u={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},ue(((e,t)=>{let i=u[e][t];return null!=i?i:e}),o));var u;return ce((()=>{let e=ua(r.current);a.current="mounted"===s?e:"none"}),[s]),mi((()=>{let t=r.current,i=n.current;if(i!==e){let r=a.current,o=ua(t);e?l("MOUNT"):"none"===o||"none"===(null==t?void 0:t.display)?l("UNMOUNT"):l(i&&r!==o?"ANIMATION_OUT":"UNMOUNT"),n.current=e}}),[e,l]),mi((()=>{if(t){let e=e=>{let i=ua(r.current).includes(e.animationName);e.target===t&&i&&l("ANIMATION_END")},i=e=>{e.target===t&&(a.current=ua(r.current))};return t.addEventListener("animationstart",i),t.addEventListener("animationcancel",e),t.addEventListener("animationend",e),()=>{t.removeEventListener("animationstart",i),t.removeEventListener("animationcancel",e),t.removeEventListener("animationend",e)}}}),[t,l]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:ge((e=>{e&&(r.current=getComputedStyle(e)),i(e)}),[])}}(t),n="function"==typeof i?i({present:r.isPresent}):lt.only(i),a=ci(r.ref,n.ref);return"function"==typeof i||r.isPresent?it(n,{ref:a}):null};function ua(e){return(null==e?void 0:e.animationName)||"none"}function ca(e){let t=de(e);return ce((()=>{t.current=e}),[e]),t.current}function ha(e){let t=de(e);return ce((()=>{t.current=e})),fe((()=>(...e)=>{var i;return null===(i=t.current)||void 0===i?void 0:i.call(t,...e)}),[])}function da(e,t,{checkForDefaultPrevented:i=!0}={}){return function(r){if(null==e||e(r),!1===i||!r.defaultPrevented)return null==t?void 0:t(r)}}la.displayName="Presence";var[pa,fa]=jn("Tooltip",[Kn]),ga=Kn(),[ma,va]=pa("TooltipProvider",{isOpenDelayed:!0,delayDuration:700,onOpen:()=>{},onClose:()=>{}}),[ya,ba]=pa("Tooltip"),wa=De(((e,t)=>{let i=e,{__scopeTooltip:r}=i,n=g(i,["__scopeTooltip"]),a=ba("TooltipTrigger",r),o=ga(r),s=ci(t,a.onTriggerChange),l=de(!1),u=ge((()=>l.current=!1),[]);return ce((()=>()=>document.removeEventListener("mouseup",u)),[u]),E(aa,hi({asChild:!0},o),E(Cn.button,hi({"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute},n,{ref:s,onMouseEnter:da(e.onMouseEnter,a.onTriggerEnter),onMouseLeave:da(e.onMouseLeave,a.onClose),onMouseDown:da(e.onMouseDown,(()=>{a.onClose(),l.current=!0,document.addEventListener("mouseup",u,{once:!0})})),onFocus:da(e.onFocus,(()=>{l.current||a.onOpen()})),onBlur:da(e.onBlur,a.onClose),onClick:da(e.onClick,a.onClose)})))})),xa=De(((e,t)=>{let i=e,{forceMount:r}=i,n=g(i,["forceMount"]),a=ba("TooltipContent",e.__scopeTooltip);return E(la,{present:r||a.open},E(_a,hi({ref:t},n)))})),_a=De(((e,t)=>{let i=e,{__scopeTooltip:r,children:n,"aria-label":a,portalled:o=!0}=i,s=g(i,["__scopeTooltip","children","aria-label","portalled"]),l=ba("TooltipContent",r),u=ga(r),c=o?Tn:A,{onClose:h}=l;return function(e){let t=ha(e);ce((()=>{let e=e=>{"Escape"===e.key&&t(e)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[t])}((()=>h())),ce((()=>(document.addEventListener("tooltip.open",h),()=>document.removeEventListener("tooltip.open",h))),[h]),E(c,null,E(Ea,{__scopeTooltip:r}),E(oa,hi({"data-state":l.stateAttribute},u,s,{ref:t,style:p(d({},s.style),{"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)"})}),E(fi,null,n),E(On,{id:l.contentId,role:"tooltip"},a||n)))})),Sa=De(((e,t)=>{let i=e,{__scopeTooltip:r}=i,n=g(i,["__scopeTooltip"]),a=ga(r);return E(sa,hi({},a,n,{ref:t}))}));function Ea(e){let{__scopeTooltip:t}=e,i=ba("CheckTriggerMoved",t),r=Nn(i.trigger),n=null==r?void 0:r.left,a=ca(n),o=null==r?void 0:r.top,s=ca(o),l=i.onClose;return ce((()=>{(void 0!==a&&a!==n||void 0!==s&&s!==o)&&l()}),[l,a,s,n,o]),null}var ka,Ca=e=>{let{__scopeTooltip:t,children:i,open:r,defaultOpen:n=!1,onOpenChange:a,delayDuration:o}=e,s=va("Tooltip",t),l=ga(t),[u,c]=le(null),h=function(e){let[t,i]=le(En());return mi((()=>{e||i((e=>null!=e?e:String(kn++)))}),[e]),e||(t?`radix-${t}`:"")}(),d=de(0),p=null!=o?o:s.delayDuration,f=de(!1),{onOpen:g,onClose:m}=s,[v=!1,y]=function({prop:e,defaultProp:t,onChange:i=(()=>{})}){let[r,n]=function({defaultProp:e,onChange:t}){let i=le(e),[r]=i,n=de(r),a=ha(t);return ce((()=>{n.current!==r&&(a(r),n.current=r)}),[r,n,a]),i}({defaultProp:t,onChange:i}),a=void 0!==e,o=a?e:r,s=ha(i);return[o,ge((t=>{if(a){let i="function"==typeof t?t(e):t;i!==e&&s(i)}else n(t)}),[a,e,n,s])]}({prop:r,defaultProp:n,onChange:e=>{e&&(document.dispatchEvent(new CustomEvent("tooltip.open")),g()),null==a||a(e)}}),b=fe((()=>v?f.current?"delayed-open":"instant-open":"closed"),[v]),w=ge((()=>{window.clearTimeout(d.current),f.current=!1,y(!0)}),[y]),x=ge((()=>{window.clearTimeout(d.current),d.current=window.setTimeout((()=>{f.current=!0,y(!0)}),p)}),[p,y]);return ce((()=>()=>window.clearTimeout(d.current)),[]),E(na,l,E(ya,{scope:t,contentId:h,open:v,stateAttribute:b,trigger:u,onTriggerChange:c,onTriggerEnter:ge((()=>{s.isOpenDelayed?x():w()}),[s.isOpenDelayed,x,w]),onOpen:ge(w,[w]),onClose:ge((()=>{window.clearTimeout(d.current),y(!1),m()}),[y,m])},i))},Aa=wa,Pa=xa,Oa=Sa;function Ta(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i,r,n={},a=Object.keys(e);for(r=0;r<a.length;r++)i=a[r],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)i=a[r],!(t.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,i)||(n[i]=e[i]))}return n}!function(e){e[e.UNSUPPORTED_INPUT=0]="UNSUPPORTED_INPUT",e[e.NO_COMPONENT_FOR_TYPE=1]="NO_COMPONENT_FOR_TYPE",e[e.UNKNOWN_INPUT=2]="UNKNOWN_INPUT",e[e.DUPLICATE_KEYS=3]="DUPLICATE_KEYS",e[e.ALREADY_REGISTERED_TYPE=4]="ALREADY_REGISTERED_TYPE",e[e.CLIPBOARD_ERROR=5]="CLIPBOARD_ERROR",e[e.THEME_ERROR=6]="THEME_ERROR",e[e.PATH_DOESNT_EXIST=7]="PATH_DOESNT_EXIST",e[e.INPUT_TYPE_OVERRIDE=8]="INPUT_TYPE_OVERRIDE",e[e.EMPTY_KEY=9]="EMPTY_KEY"}(ka||(ka={}));var Ra={[ka.UNSUPPORTED_INPUT]:(e,t)=>[`An input with type \`${e}\` input was found at path \`${t}\` but it's not supported yet.`],[ka.NO_COMPONENT_FOR_TYPE]:(e,t)=>[`Type \`${e}\` found at path \`${t}\` can't be displayed in panel because no component supports it yet.`],[ka.UNKNOWN_INPUT]:(e,t)=>[`input at path \`${e}\` is not recognized.`,t],[ka.DUPLICATE_KEYS]:(e,t,i)=>[`Key \`${e}\` of path \`${t}\` already exists at path \`${i}\`. Even nested keys need to be unique. Rename one of the keys.`],[ka.ALREADY_REGISTERED_TYPE]:e=>[`Type ${e} has already been registered. You can't register a component with the same type.`],[ka.CLIPBOARD_ERROR]:e=>["Error copying the value",e],[ka.THEME_ERROR]:(e,t)=>[`Error accessing the theme \`${e}.${t}\` value.`],[ka.PATH_DOESNT_EXIST]:e=>[`Error getting the value at path \`${e}\`. There is probably an error in your \`render\` function.`],[ka.PATH_DOESNT_EXIST]:e=>[`Error accessing the value at path \`${e}\``],[ka.INPUT_TYPE_OVERRIDE]:(e,t,i)=>[`Input at path \`${e}\` already exists with type: \`${t}\`. Its type cannot be overridden with type \`${i}\`.`],[ka.EMPTY_KEY]:()=>["Keys can not be empty, if you want to hide a label use whitespace."]};function Ia(e,t,...i){let[r,...n]=Ra[t](...i);console[e]("LEVA: "+r,...n)}var Ma=Ia.bind(null,"warn");function za(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function La(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Fa(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?La(Object(i),!0).forEach((function(t){za(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):La(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}Ia.bind(null,"log");var Na=(e,t,i)=>e>i?i:e<t?t:e,ja=e=>{if(""===e||"number"==typeof e)return e;try{let t=Xa(e);if(!isNaN(t))return t}catch(e){}return parseFloat(e)},$a=Math.log(10);function Ba(e){let t=Math.abs(+String(e).replace(".",""));if(0===t)return.01;for(;0!==t&&t%10==0;)t/=10;let i=Math.floor(Math.log(t)/$a)+1,r=Math.floor(Math.log10(Math.abs(e))),n=Math.pow(10,r-i);return Math.max(n,.001)}var Da,Ua,Wa=(e,t,i)=>i===t?0:(Na(e,t,i)-t)/(i-t),Ha=(e,t,i)=>e*(i-t)+t,qa=/\(([0-9+\-*/^ .]+)\)/,Va=/(\d+(?:\.\d+)?) ?\^ ?(\d+(?:\.\d+)?)/,Qa=/(\d+(?:\.\d+)?) ?\* ?(\d+(?:\.\d+)?)/,Ya=/(\d+(?:\.\d+)?) ?\/ ?(\d+(?:\.\d+)?)/,Ga=/(\d+(?:\.\d+)?) ?\+ ?(\d+(?:\.\d+)?)/,Ka=/(\d+(?:\.\d+)?) ?- ?(\d+(?:\.\d+)?)/;function Xa(e){if(isNaN(Number(e))){if(qa.test(e)){let t=e.replace(qa,((e,t)=>String(Xa(t))));return Xa(t)}if(Va.test(e)){return Xa(e.replace(Va,((e,t,i)=>String(Math.pow(Number(t),Number(i))))))}if(Qa.test(e)){return Xa(e.replace(Qa,((e,t,i)=>String(Number(t)*Number(i)))))}if(Ya.test(e)){return Xa(e.replace(Ya,((e,t,i)=>{if(0!=i)return String(Number(t)/Number(i));throw new Error("Division by zero")})))}if(Ga.test(e)){return Xa(e.replace(Ga,((e,t,i)=>String(Number(t)+Number(i)))))}if(Ka.test(e)){return Xa(e.replace(Ka,((e,t,i)=>String(Number(t)-Number(i)))))}return Number(e)}return Number(e)}!function(e){e.BUTTON="BUTTON",e.BUTTON_GROUP="BUTTON_GROUP",e.MONITOR="MONITOR",e.FOLDER="FOLDER"}(Da||(Da={})),function(e){e.SELECT="SELECT",e.IMAGE="IMAGE",e.NUMBER="NUMBER",e.COLOR="COLOR",e.STRING="STRING",e.BOOLEAN="BOOLEAN",e.INTERVAL="INTERVAL",e.VECTOR3D="VECTOR3D",e.VECTOR2D="VECTOR2D"}(Ua||(Ua={}));var Za=["value"],Ja=["min","max"],eo=(e,{step:t,initialValue:i})=>i+Math.round((e-i)/t)*t,to=Object.freeze({__proto__:null,schema:e=>{if("number"==typeof e)return!0;if("string"==typeof e){let t=parseFloat(e);return!isNaN(t)&&e.substring((""+t).length).trim().length<4}return!1},sanitize:(e,{min:t=-1/0,max:i=1/0,suffix:r})=>{let n=parseFloat(e);if(""===e||isNaN(n))throw Error("Invalid number");let a=Na(n,t,i);return r?a+r:a},format:(e,{pad:t=0,suffix:i})=>{let r=parseFloat(e).toFixed(t);return i?r+i:r},normalize:e=>{let{value:t}=e,i=Ta(e,Za),{min:r=-1/0,max:n=1/0}=i,a=Ta(i,Ja),o=parseFloat(t),s="string"==typeof t?t.substring((""+o).length):void 0;o=Na(o,r,n);let l=i.step;l||(Number.isFinite(r)?l=Number.isFinite(n)?+(Math.abs(n-r)/100).toPrecision(1):+(Math.abs(o-r)/100).toPrecision(1):Number.isFinite(n)&&(l=+(Math.abs(n-o)/100).toPrecision(1)));let u=l?10*Ba(l):Ba(o);return l=l||u/10,{value:s?o+s:o,settings:Fa({initialValue:o,step:l,pad:Math.round(Na(Math.log10(1/u),0,2)),min:r,max:n,suffix:s},a)}},sanitizeStep:eo});function io(){return io=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},io.apply(this,arguments)}var ro=G({});function no(){return me(ro)}var ao=G(null);G(null);var oo=G(null);function so(e,t){let[i,r]=e.split(" "),n={};return"none"!==i&&(n.boxShadow=`${t.inset?"inset ":""}0 0 0 $borderWidths${[t.key]} $colors${"default"!==i&&i||t.borderColor}`),r&&(n.backgroundColor=r),n}var lo={$inputStyle:()=>e=>so(e,{key:"$input",borderColor:"$highlight1",inset:!0}),$focusStyle:()=>e=>so(e,{key:"$focus",borderColor:"$accent2"}),$hoverStyle:()=>e=>so(e,{key:"$hover",borderColor:"$accent1",inset:!0}),$activeStyle:()=>e=>so(e,{key:"$active",borderColor:"$accent1",inset:!0})},{styled:uo,css:co,createTheme:ho,globalCss:po,keyframes:fo}=(e=>{let t=(e=>{let t=!1,i=Pr(e,(e=>{t=!0;let i="prefix"in(e="object"==typeof e&&e||{})?String(e.prefix):"",r="object"==typeof e.media&&e.media||{},n="object"==typeof e.root?e.root||null:globalThis.document||null,a="object"==typeof e.theme&&e.theme||{},o={prefix:i,media:r,theme:a,themeMap:"object"==typeof e.themeMap&&e.themeMap||d({},$i),utils:"object"==typeof e.utils&&e.utils||{}},s=hr(n),l={css:gr(o,s),globalCss:_r(o,s),keyframes:Er(o,s),createTheme:Ar(o,s),reset(){s.reset(),l.theme.toString()},theme:{},sheet:s,config:o,prefix:i,getCssText:s.toString,toString:s.toString};return String(l.theme=l.createTheme(a)),l}));return t||i.reset(),i})(e);return t.styled=(({config:e,sheet:t})=>Or(e,(()=>{let i=gr(e,t);return(...e)=>{let t=i(...e),r=t[Ui].type,n=Ct.forwardRef(((e,i)=>{let n=e&&e.as||r,{props:a,deferredInjector:o}=t(e);return delete a.as,a.ref=i,o?Ct.createElement(Ct.Fragment,null,Ct.createElement(n,a),Ct.createElement(o,null)):Ct.createElement(n,a)}));return n.className=t.className,n.displayName=`Styled.${r.displayName||r.name||r}`,n.selector=t.selector,n.toString=()=>t.selector,n[Ui]=t[Ui],n}})))(t),t})({prefix:"leva",theme:{colors:{elevation1:"#292d39",elevation2:"#181c20",elevation3:"#373c4b",accent1:"#0066dc",accent2:"#007bff",accent3:"#3c93ff",highlight1:"#535760",highlight2:"#8c92a4",highlight3:"#fefefe",vivid1:"#ffcc00",folderWidgetColor:"$highlight2",folderTextColor:"$highlight3",toolTipBackground:"$highlight3",toolTipText:"$elevation2"},radii:{xs:"2px",sm:"3px",lg:"10px"},space:{xs:"3px",sm:"6px",md:"10px",rowGap:"7px",colGap:"7px"},fonts:{mono:"ui-monospace, SFMono-Regular, Menlo, 'Roboto Mono', monospace",sans:"system-ui, sans-serif"},fontSizes:{root:"11px",toolTip:"$root"},sizes:{rootWidth:"280px",controlWidth:"160px",numberInputMinWidth:"38px",scrubberWidth:"8px",scrubberHeight:"16px",rowHeight:"24px",folderTitleHeight:"20px",checkboxSize:"16px",joystickWidth:"100px",joystickHeight:"100px",colorPickerWidth:"$controlWidth",colorPickerHeight:"100px",imagePreviewWidth:"$controlWidth",imagePreviewHeight:"100px",monitorHeight:"60px",titleBarHeight:"39px"},shadows:{level1:"0 0 9px 0 #00000088",level2:"0 4px 14px #00000033"},borderWidths:{root:"0px",input:"1px",focus:"1px",hover:"1px",active:"1px",folder:"1px"},fontWeights:{label:"normal",folder:"normal",button:"normal"}},utils:Fa(Fa({},lo),{},{$flex:()=>({display:"flex",alignItems:"center"}),$flexCenter:()=>({display:"flex",alignItems:"center",justifyContent:"center"}),$reset:()=>({outline:"none",fontSize:"inherit",fontWeight:"inherit",color:"inherit",fontFamily:"inherit",border:"none",backgroundColor:"transparent",appearance:"none"}),$draggable:()=>({touchAction:"none",WebkitUserDrag:"none",userSelect:"none"}),$focus:e=>({"&:focus":lo.$focusStyle()(e)}),$focusWithin:e=>({"&:focus-within":lo.$focusStyle()(e)}),$hover:e=>({"&:hover":lo.$hoverStyle()(e)}),$active:e=>({"&:active":lo.$activeStyle()(e)})})});po({".leva__panel__dragged":{WebkitUserDrag:"none",userSelect:"none",input:{userSelect:"none"},"*":{cursor:"ew-resize !important"}}});var go=uo("input",{$reset:"",padding:"0 $sm",width:0,minWidth:0,flex:1,height:"100%",variants:{levaType:{number:{textAlign:"right"}},as:{textarea:{padding:"$sm"}}}}),mo=uo("div",{$draggable:"",height:"100%",$flexCenter:"",position:"relative",padding:"0 $xs",fontSize:"0.8em",opacity:.8,cursor:"default",touchAction:"none",[`& + ${go}`]:{paddingLeft:0}}),vo=uo(mo,{cursor:"ew-resize",marginRight:"-$xs",textTransform:"uppercase",opacity:.3,"&:hover":{opacity:1},variants:{dragging:{true:{backgroundColor:"$accent2",opacity:1}}}}),yo=uo("div",{$flex:"",position:"relative",borderRadius:"$sm",overflow:"hidden",color:"inherit",height:"$rowHeight",backgroundColor:"$elevation3",$inputStyle:"$elevation1",$hover:"",$focusWithin:"",variants:{textArea:{true:{height:"auto"}}}}),bo=["innerLabel","value","onUpdate","onChange","onKeyDown","type","id","inputType","rows"],wo=["onUpdate"];function xo(e){let{innerLabel:t,value:i,onUpdate:r,onChange:n,onKeyDown:a,type:o,id:s,inputType:l="text",rows:u=0}=e,c=Ta(e,bo),{id:h,emitOnEditStart:d,emitOnEditEnd:p,disabled:f}=no(),g=s||h,m=de(null),v=u>0,y=v?"textarea":"input",b=ge((e=>t=>{let i=t.currentTarget.value;e(i)}),[]);Ct.useEffect((()=>{let e=m.current,t=b((e=>{r(e),p()}));return null==e||e.addEventListener("blur",t),()=>null==e?void 0:e.removeEventListener("blur",t)}),[b,r,p]);let w=ge((e=>{"Enter"===e.key&&b(r)(e)}),[b,r]),x=Object.assign({as:y},v?{rows:u}:{},c);return Ct.createElement(yo,{textArea:v},t&&"string"==typeof t?Ct.createElement(mo,null,t):t,Ct.createElement(go,io({levaType:o,ref:m,id:g,type:l,autoComplete:"off",spellCheck:"false",value:i,onChange:b(n),onFocus:()=>d(),onKeyPress:w,onKeyDown:a,disabled:f},x)))}function _o(e){let{onUpdate:t}=e,i=Ta(e,wo),r=ge((e=>t(ja(e))),[t]),n=ge((e=>{let i="ArrowUp"===e.key?1:"ArrowDown"===e.key?-1:0;if(i){e.preventDefault();let r=e.altKey?.1:e.shiftKey?10:1;t((e=>parseFloat(e)+i*r))}}),[t]);return Ct.createElement(xo,io({},i,{onUpdate:r,onKeyDown:n,type:"number"}))}var So=uo("div",{}),Eo=uo("div",{position:"relative",background:"$elevation2",transition:"height 300ms ease",variants:{fill:{true:{},false:{}},flat:{false:{},true:{}},isRoot:{true:{},false:{paddingLeft:"$md","&::after":{content:'""',position:"absolute",left:0,top:0,width:"$borderWidths$folder",height:"100%",backgroundColor:"$folderWidgetColor",opacity:.4,transform:"translateX(-50%)"}}}},compoundVariants:[{isRoot:!0,fill:!1,css:{overflowY:"auto",maxHeight:"calc(100vh - 20px - $$titleBarHeight)"}},{isRoot:!0,flat:!1,css:{borderRadius:"$lg"}}]});uo("div",{$flex:"",color:"$folderTextColor",userSelect:"none",cursor:"pointer",height:"$folderTitleHeight",fontWeight:"$folder","> svg":{marginLeft:-4,marginRight:4,cursor:"pointer",fill:"$folderWidgetColor",opacity:.6},"&:hover > svg":{fill:"$folderWidgetColor"},[`&:hover + ${Eo}::after`]:{opacity:.6},[`${So}:hover > & + ${Eo}::after`]:{opacity:.6},[`${So}:hover > & > svg`]:{opacity:1}});var ko=uo("div",{position:"relative",display:"grid",gridTemplateColumns:"100%",rowGap:"$rowGap",transition:"opacity 250ms ease",variants:{toggled:{true:{opacity:1,transitionDelay:"250ms"},false:{opacity:0,transitionDelay:"0ms",pointerEvents:"none"}},isRoot:{true:{"& > div":{paddingLeft:"$md",paddingRight:"$md"},"& > div:first-of-type":{paddingTop:"$sm"},"& > div:last-of-type":{paddingBottom:"$sm"},[`> ${So}:not(:first-of-type)`]:{paddingTop:"$sm",marginTop:"$md",borderTop:"$borderWidths$folder solid $colors$elevation1"}}}}}),Co=uo("div",{position:"relative",zIndex:100,display:"grid",rowGap:"$rowGap",gridTemplateRows:"minmax($sizes$rowHeight, max-content)",alignItems:"center",color:"$highlight2",[`${ko} > &`]:{"&:first-of-type":{marginTop:"$rowGap"},"&:last-of-type":{marginBottom:"$rowGap"}},variants:{disabled:{true:{pointerEvents:"none"},false:{"&:hover,&:focus-within":{color:"$highlight3"}}}}}),Ao=uo(Co,{gridTemplateColumns:"auto $sizes$controlWidth",columnGap:"$colGap"}),Po=uo("div",{$flex:"",height:"100%",position:"relative",overflow:"hidden","& > div":{marginLeft:"$colGap",padding:"0 $xs",opacity:.4},"& > div:hover":{opacity:.8},"& > div > svg":{display:"none",cursor:"pointer",width:13,minWidth:13,height:13,backgroundColor:"$elevation2"},"&:hover > div > svg":{display:"block"},variants:{align:{top:{height:"100%",alignItems:"flex-start",paddingTop:"$sm"}}}}),Oo=uo("input",{$reset:"",height:0,width:0,opacity:0,margin:0,"& + label":{position:"relative",$flexCenter:"",height:"100%",userSelect:"none",cursor:"pointer",paddingLeft:2,paddingRight:"$sm",pointerEvents:"auto"},"& + label:after":{content:'""',width:6,height:6,backgroundColor:"$elevation3",borderRadius:"50%",$activeStyle:""},"&:focus + label:after":{$focusStyle:""},"& + label:active:after":{backgroundColor:"$accent1",$focusStyle:""},"&:checked + label:after":{backgroundColor:"$accent1"}}),To=uo("label",{fontWeight:"$label",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","& > svg":{display:"block"}});uo("div",{opacity:1,variants:{disabled:{true:{opacity:.6,pointerEvents:"none",[`& ${To}`]:{pointerEvents:"auto"}}}}}),uo("div",{position:"fixed",top:0,bottom:0,right:0,left:0,zIndex:1e3,userSelect:"none"});var Ro=uo("div",{background:"$toolTipBackground",fontFamily:"$sans",fontSize:"$toolTip",padding:"$xs $sm",color:"$toolTipText",borderRadius:"$xs",boxShadow:"$level2",maxWidth:260}),Io=uo(Oa,{fill:"$toolTipBackground"}),Mo=["align"];function zo(){let{id:e,disable:t,disabled:i}=no();return Ct.createElement(Ct.Fragment,null,Ct.createElement(Oo,{id:e+"__disable",type:"checkbox",checked:!i,onChange:()=>t(!i)}),Ct.createElement("label",{htmlFor:e+"__disable"}))}function Lo(e){let{id:t,optional:i,hint:r}=no(),n=e.htmlFor||(t?{htmlFor:t}:null),a=r||"string"!=typeof e.children?null:{title:e.children};return Ct.createElement(Ct.Fragment,null,i&&Ct.createElement(zo,null),void 0!==r?Ct.createElement(Ca,null,Ct.createElement(Aa,{asChild:!0},Ct.createElement(To,io({},n,e))),Ct.createElement(Pa,{side:"top",sideOffset:2},Ct.createElement(Ro,null,r,Ct.createElement(Io,null)))):Ct.createElement(To,io({},n,a,e)))}function Fo(e){let{align:t}=e,i=Ta(e,Mo),{value:r,label:n,key:a,disabled:o}=no(),{hideCopyButton:s}=me(oo),l=!s&&void 0!==a,[u,c]=le(!1);return Ct.createElement(Po,{align:t,onPointerLeave:()=>c(!1)},Ct.createElement(Lo,i),l&&!o&&Ct.createElement("div",{title:`Click to copy ${"string"==typeof n?n:a} value`},u?Ct.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},Ct.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),Ct.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})):Ct.createElement("svg",{onClick:async()=>{try{await navigator.clipboard.writeText(JSON.stringify({[a]:null!=r?r:""})),c(!0)}catch(e){Ma(ka.CLIPBOARD_ERROR,{[a]:r})}},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},Ct.createElement("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),Ct.createElement("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"}))))}var No=["toggled"],jo=uo("svg",{fill:"currentColor",transition:"transform 350ms ease, fill 250ms ease"});function $o(e){let{toggled:t}=e,i=Ta(e,No);return Ct.createElement(jo,io({width:"9",height:"5",viewBox:"0 0 9 5",xmlns:"http://www.w3.org/2000/svg",style:{transform:`rotate(${t?0:-90}deg)`}},i),Ct.createElement("path",{d:"M3.8 4.4c.4.3 1 .3 1.4 0L8 1.7A1 1 0 007.4 0H1.6a1 1 0 00-.7 1.7l3 2.7z"}))}var Bo=["input"];function Do(e){let{input:t}=e,i=Ta(e,Bo);return t?Ct.createElement(Ao,i):Ct.createElement(Co,i)}function Uo(e,t){let{emitOnEditStart:i,emitOnEditEnd:r}=no();return Sn((t=>{t.first&&(document.body.classList.add("leva__panel__dragged"),null==i||i());let n=e(t);return t.last&&(document.body.classList.remove("leva__panel__dragged"),null==r||r()),n}),t)}var Wo=uo("div",{variants:{hasRange:{true:{position:"relative",display:"grid",gridTemplateColumns:"auto $sizes$numberInputMinWidth",columnGap:"$colGap",alignItems:"center"}}}}),Ho=uo("div",{position:"relative",width:"100%",height:2,borderRadius:"$xs",backgroundColor:"$elevation1"}),qo=uo("div",{position:"absolute",width:"$scrubberWidth",height:"$scrubberHeight",borderRadius:"$xs",boxShadow:"0 0 0 2px $colors$elevation2",backgroundColor:"$accent2",cursor:"pointer",$active:"none $accent1",$hover:"none $accent3",variants:{position:{left:{borderTopRightRadius:0,borderBottomRightRadius:0,transform:"translateX(calc(-0.5 * ($sizes$scrubberWidth + 4px)))"},right:{borderTopLeftRadius:0,borderBottomLeftRadius:0,transform:"translateX(calc(0.5 * ($sizes$scrubberWidth + 4px)))"}}}}),Vo=uo("div",{position:"relative",$flex:"",height:"100%",cursor:"pointer",touchAction:"none"}),Qo=uo("div",{position:"absolute",height:"100%",backgroundColor:"$accent2"});function Yo({value:e,min:t,max:i,onDrag:r,step:n,initialValue:a}){let o=de(null),s=de(null),l=de(0),u=function(e,t){let{theme:i}=me(ao);if(!(e in i)||!(t in i[e]))return Ma(ka.THEME_ERROR,e,t),"";let r=t;for(;;){let t=i[e][r];if("string"!=typeof t||"$"!==t.charAt(0))return t;r=t.substr(1)}}("sizes","scrubberWidth"),c=Uo((({event:c,first:h,xy:[d],movement:[p],memo:f})=>{if(h){let{width:r,left:n}=o.current.getBoundingClientRect();l.current=r-parseFloat(u),f=(null==c?void 0:c.target)===s.current?e:Ha((d-n)/r,t,i)}let g=f+Ha(p/l.current,0,i-t);return r(eo(g,{step:n,initialValue:a})),f})),h=Wa(e,t,i);return Ct.createElement(Vo,io({ref:o},c()),Ct.createElement(Ho,null,Ct.createElement(Qo,{style:{left:0,right:100*(1-h)+"%"}})),Ct.createElement(qo,{ref:s,style:{left:`calc(${h} * (100% - ${u}))`}}))}var Go=Ct.memo((({label:e,onUpdate:t,step:i,innerLabelTrim:r})=>{let[n,a]=le(!1),o=Uo((({active:e,delta:[r],event:n,memo:o=0})=>(a(e),o+=r/2,Math.abs(o)>=1&&(t((e=>parseFloat(e)+Math.floor(o)*i*(e=>e.shiftKey?5:e.altKey?.2:1)(n))),o=0),o)));return Ct.createElement(vo,io({dragging:n,title:e.length>1?e:""},o()),e.slice(0,r))}));function Ko({label:e,id:t,displayValue:i,onUpdate:r,onChange:n,settings:a,innerLabelTrim:o=1}){let s=o>0&&Ct.createElement(Go,{label:e,step:a.step,onUpdate:r,innerLabelTrim:o});return Ct.createElement(_o,{id:t,value:String(i),onUpdate:r,onChange:n,innerLabel:s})}Fa({component:function(){let e=no(),{label:t,value:i,onUpdate:r,settings:n,id:a}=e,{min:o,max:s}=n,l=s!==1/0&&o!==-1/0;return Ct.createElement(Do,{input:!0},Ct.createElement(Fo,null,t),Ct.createElement(Wo,{hasRange:l},l&&Ct.createElement(Yo,io({value:parseFloat(i),onDrag:r},n)),Ct.createElement(Ko,io({},e,{id:a,label:"value",innerLabelTrim:l?0:1}))))}},Ta(to,["sanitizeStep"]));var Xo=Object.freeze({__proto__:null,schema:(e,t)=>Ci().schema({options:Ci().passesAnyOf(Ci().object(),Ci().array())}).test(t),sanitize:(e,{values:t})=>{if(t.indexOf(e)<0)throw Error("Selected value doesn't match Select options");return e},format:(e,{values:t})=>t.indexOf(e),normalize:e=>{let t,i,{value:r,options:n}=e;return Array.isArray(n)?(i=n,t=n.map((e=>String(e)))):(i=Object.values(n),t=Object.keys(n)),"value"in e?i.includes(r)||(t.unshift(String(r)),i.unshift(r)):r=i[0],Object.values(n).includes(r)||(n[String(r)]=r),{value:r,settings:{keys:t,values:i}}}}),Zo=uo("div",{$flexCenter:"",position:"relative","> svg":{pointerEvents:"none",position:"absolute",right:"$md"}}),Jo=uo("select",{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0}),es=uo("div",{display:"flex",alignItems:"center",width:"100%",height:"$rowHeight",backgroundColor:"$elevation3",borderRadius:"$sm",padding:"0 $sm",cursor:"pointer",[`${Jo}:focus + &`]:{$focusStyle:""},[`${Jo}:hover + &`]:{$hoverStyle:""}});function ts({displayValue:e,value:t,onUpdate:i,id:r,settings:n,disabled:a}){let{keys:o,values:s}=n,l=de();return t===s[e]&&(l.current=o[e]),Ct.createElement(Zo,null,Ct.createElement(Jo,{id:r,value:e,onChange:e=>i(s[Number(e.currentTarget.value)]),disabled:a},o.map(((e,t)=>Ct.createElement("option",{key:e,value:t},e)))),Ct.createElement(es,null,l.current),Ct.createElement($o,{toggled:!0}))}Fa({component:function(){let{label:e,value:t,displayValue:i,onUpdate:r,id:n,disabled:a,settings:o}=no();return Ct.createElement(Do,{input:!0},Ct.createElement(Fo,null,e),Ct.createElement(ts,{id:n,value:t,displayValue:i,onUpdate:r,settings:o,disabled:a}))}},Xo);var is=Object.freeze({__proto__:null,schema:e=>Ci().string().test(e),sanitize:e=>{if("string"!=typeof e)throw Error("Invalid string");return e},normalize:({value:e,editable:t=!0,rows:i=!1})=>({value:e,settings:{editable:t,rows:"number"==typeof i?i:i?5:0}})}),rs=["displayValue","onUpdate","onChange","editable"],ns=uo("div",{whiteSpace:"pre-wrap"});function as(e){let{displayValue:t,onUpdate:i,onChange:r,editable:n=!0}=e,a=Ta(e,rs);return n?Ct.createElement(xo,io({value:t,onUpdate:i,onChange:r},a)):Ct.createElement(ns,null,t)}Fa({component:function(){let{label:e,settings:t,displayValue:i,onUpdate:r,onChange:n}=no();return Ct.createElement(Do,{input:!0},Ct.createElement(Fo,null,e),Ct.createElement(as,io({displayValue:i,onUpdate:r,onChange:n},t)))}},is);var os=Object.freeze({__proto__:null,schema:e=>Ci().boolean().test(e),sanitize:e=>{if("boolean"!=typeof e)throw Error("Invalid boolean");return e}}),ss=uo("div",{position:"relative",$flex:"",height:"$rowHeight",input:{$reset:"",height:0,width:0,opacity:0,margin:0},label:{position:"relative",$flexCenter:"",userSelect:"none",cursor:"pointer",height:"$checkboxSize",width:"$checkboxSize",backgroundColor:"$elevation3",borderRadius:"$sm",$hover:""},"input:focus + label":{$focusStyle:""},"input:focus:checked + label, input:checked + label:hover":{$hoverStyle:"$accent3"},"input + label:active":{backgroundColor:"$accent1"},"input:checked + label:active":{backgroundColor:"$accent1"},"label > svg":{display:"none",width:"90%",height:"90%",stroke:"$highlight3"},"input:checked + label":{backgroundColor:"$accent2"},"input:checked + label > svg":{display:"block"}});function ls({value:e,onUpdate:t,id:i,disabled:r}){return Ct.createElement(ss,null,Ct.createElement("input",{id:i,type:"checkbox",checked:e,onChange:e=>t(e.currentTarget.checked),disabled:r}),Ct.createElement("label",{htmlFor:i},Ct.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ct.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}))))}Fa({component:function(){let{label:e,value:t,onUpdate:i,disabled:r,id:n}=no();return Ct.createElement(Do,{input:!0},Ct.createElement(Fo,null,e),Ct.createElement(ls,{value:t,onUpdate:i,id:n,disabled:r}))}},os),uo("div",{display:"grid",columnGap:"$colGap",gridAutoFlow:"column dense",alignItems:"center",variants:{withLock:{true:{gridTemplateColumns:"10px auto","> svg":{cursor:"pointer"}}}}});var us=class extends ni{constructor(e){super(),this.type="spacial-content",this.style={opacity:1},this.format="jpg",this.tileUrl=function(e){let t=e.length;return e.indexOf("/info.json")===t-10?e.slice(0,-10):e}(e.url),this.id=e.id||`${this.tileUrl}--${e.scaleFactor}`,this.points=e.displayPoints?e.displayPoints:ii(e.points,Jt(e.scaleFactor)),this.tileWidth=e.tileWidth,this.display={x:0,y:0,width:e.width/e.scaleFactor,height:e.height/e.scaleFactor,points:e.points,scale:e.scaleFactor},e.format&&(this.format=e.format)}applyProps(e){if(e.style&&typeof e.style.opacity<"u"&&(this.style.opacity=e.style.opacity),e.service!==this.service&&(this.service=e.service),e.format?this.format=e.format:this.format="jpg",e.crop){this.cropData=e.crop;let t=Gt([...this.points]),i=t.length/5,r=e.crop.x||0,n=e.crop.y||0,a=e.crop.x+e.crop.width,o=e.crop.y+e.crop.height;for(let e=0;e<i;e++){let i=5*e;t[i+1]<a&&t[i+3]>r&&t[i+2]<o&&t[i+4]>n?(t[i+1]=Na(t[i+1],r,a),t[i+3]=Na(t[i+3],r,a),t[i+2]=Na(t[i+2],n,o),t[i+4]=Na(t[i+4],n,o)):t[i]=0}Zt(t,ei(-e.crop.x,-e.crop.y)),this.crop?this.crop.set(t):this.crop=t}}static fromTile(e,t,i,r,n,a){i.height=i.height?i.height:i.width;let o=Math.ceil(t.width/r),s=Math.ceil(t.height/r),l=Math.ceil(o/i.width),u=Math.ceil(s/i.height),c=Xt.grid(l,u),h=Xt.grid(l,u);for(let e=0;e<u;e++)for(let n=0;n<l;n++){let a=n*i.width,d=e*i.height;h.addPoints(a*r,d*r,n===l-1?t.width:(a+i.width)*r,e===u-1?t.height:(d+i.height)*r),c.addPoints(a,d,n===l-1?o:a+i.width,e===u-1?s:d+i.height)}let d=new us({url:e,scaleFactor:r,points:c.build(),displayPoints:h.build(),width:t.width,height:t.height,tileWidth:i.width,format:a});return d.applyProps({service:n}),d}getImageUrl(e){let t=this.points.slice(5*e,5*e+5),i=t[3]-t[1],r=t[4]-t[2],n=Math.ceil(i/this.display.scale);return`${this.tileUrl}/${t[1]},${t[2]},${i},${r}/${n>this.tileWidth?this.tileWidth:n},/0/default.${this.format||"jpg"}`}getAllPointsAt(e,t,i){return[[this,Yt(this.crop||this.points,e),t]]}transform(e){Zt(this.points,e)}getScheduledUpdates(e,t){return[]}},cs=class extends ni{constructor(){super(...arguments),this.type="spacial-content"}getAllPointsAt(e,t,i){return[[this,this.points,t]]}},hs=class extends cs{constructor(e){super(),this.images=[],this.allImages=[],this.scaleFactors=[],this.aggregateBuffer=Gt(9),this.isFullyLoaded=!1,this.maxScaleFactor=0,this._scheduleSortByScales=!1,this._sortByScales=()=>{this._scheduleSortByScales=!1,this.allImages.sort(((e,t)=>t.display.width-e.display.width)),this.images=[];let e=.1;for(let t of this.allImages)if(!(t.display.width<this.renderOptions.minSize&&t.display.height<this.renderOptions.minSize&&!t.priority||t instanceof ai&&(t.display.width>this.renderOptions.maxImageSize||t.display.height>this.renderOptions.maxImageSize)&&!t.priority)){if(Math.abs(t.display.scale-e)<.25||t.priority){let e=this.images.pop();e&&(e instanceof ai||e.priority)?(t.priority&&this.images.push(t),this.images.push(e)):t&&this.images.push(t)}else t&&this.images.push(t);e=t.display.scale}0===this.images.length&&(this.images=[...this.allImages]),this.scaleFactors=this.images.map((e=>e.display.scale)),this.maxScaleFactor=Math.max(...this.scaleFactors)},this.loadFullResource=async()=>{if(!this.isFullyLoaded&&this.lazyLoader){this.isFullyLoaded=!0;let e=await this.lazyLoader();this.addImages(e)}},this.fallback=[this.loadFullResource],this.id=e.id,this.points=Xt.singleBox(e.width,e.height),this.lazyLoader=e.loadFullImages,e.loadFullImages||(this.isFullyLoaded=!0),this.display={x:0,y:0,points:Xt.singleBox(e.width,e.height),height:e.height,width:e.width,scale:1},this.renderOptions=d({renderSmallestFallback:!0,renderLayers:2,minSize:255,maxImageSize:1024,quality:1.75},e.renderOptions||{}),this.addImages(e.images)}applyProps(e){typeof e.renderSmallestFallback<"u"&&e.renderSmallestFallback!==this.renderOptions.renderSmallestFallback&&(this.renderOptions.renderSmallestFallback=e.renderSmallestFallback),typeof e.renderLayers<"u"&&e.renderLayers!==this.renderOptions.renderLayers&&(this.renderOptions.renderLayers=e.renderLayers),typeof e.minSize<"u"&&e.minSize!==this.renderOptions.minSize&&(this.renderOptions.minSize=e.minSize),typeof e.maxImageSize<"u"&&e.maxImageSize!==this.renderOptions.maxImageSize&&(this.renderOptions.maxImageSize=e.maxImageSize),typeof e.quality<"u"&&e.quality!==this.renderOptions.quality&&(this.renderOptions.quality=e.quality)}appendChild(e){this.addImages([e])}removeChild(e){-1!==this.images.indexOf(e)&&(this.images=this.images.filter((t=>t!==e)),this.sortByScales())}insertBefore(e,t){this.addImages([e])}hideInstance(){}addImages(e){for(let t of e)t.__parent=this,t.__owner=this.__owner;this.allImages.push(...e.filter(Boolean)),this.sortByScales()}sortByScales(){this._scheduleSortByScales=!0}getScheduledUpdates(e,t){return this._scheduleSortByScales?[this._sortByScales]:this.isFullyLoaded?[]:t>1/this.maxScaleFactor?this.fallback:[]}getAllPointsAt(e,t,i){if(0===this.images.length)return[];let r=function(e,t,i=1){let r=t.length;if(0===r)throw new Error("No resources passed in.");let n=0;for(let a=0;a<r&&t[a]&&t[a].display;a++)n=Math.abs(t[a].display.scale-e)*i<Math.abs(t[n].display.scale-e)?a:n;return n}(1/(i||1)/(window.devicePixelRatio||1),this.images,this.renderOptions.quality),n=this.images.length,a=t?Kt(t,ei(this.x,this.y)):ei(this.x,this.y);if(r!==this.images.length-1&&this.images[r+1]){let t=[];for(let e=n-1;e>=r;e--)t.push(e);let o=t[0];this.renderOptions.renderLayers&&(t=t.slice(-Math.min(t.length,this.renderOptions.renderLayers))),this.renderOptions.renderSmallestFallback&&-1===t.indexOf(o)&&t.unshift(o);let s=[];for(let r=0;r<t.length;r++)s.push(...this.images[t[r]].getAllPointsAt(e,a,i));return s}return this.images[r].getAllPointsAt(e,a,i)}};function ds(e,t,i,r,n){let a=Math.PI/180*n,o=Math.cos(a),s=Math.sin(a);return[o*(i-e)+s*(r-t)+e,o*(r-t)-s*(i-e)+t]}var ps,fs,gs,ms,vs,ys,bs,ws,xs,_s,Ss,Es,ks,Cs,As,Ps=class extends ni{constructor(e,t){super(),this.type="world-object",this.intersectionBuffer=Gt(5),this.aggregateBuffer=Gt(9),this.invertedBuffer=Gt(9),this.rotation=0,this._updatedList=[];let{x:i=0,y:r=0}=t||{};e?(this.id=e.id||"",this.scale=1,this.layers=e.layers,this.points=Gt([1,i,r,i+e.width,r+e.height]),this.worldPoints=Gt([1,i,r,i+e.width,r+e.height]),this.filteredPointsBuffer=Gt(5*e.layers.length)):(this.id="",this.scale=1,this.layers=[],this.points=Gt(5),this.worldPoints=Gt(5),this.filteredPointsBuffer=Gt(5))}static createWithProps(e){let t=new Ps;return t.applyProps(e),t}applyProps(e){let t=e.x||0,i=e.y||0;this.id=e.id;let r=typeof e.scale<"u"?e.scale:this.scale;this.points[0]=1,this.points[1]=t,this.points[2]=i,this.points[3]=t+e.width,this.points[4]=i+e.height,this.rotation=e.rotation||0,this.worldPoints[3]=this.worldPoints[1]+e.width,this.worldPoints[4]=this.worldPoints[2]+e.height,e.scale&&1!==e.scale&&this.atScale(r),this.scale=r}appendChild(e){0===e.points[0]&&e.points.set(this.points),e.__owner.value=this,this.addLayers([e])}removeChild(e){this.layers=this.layers.filter((t=>t!==e)),this.filteredPointsBuffer=Gt(5*this.layers.length)}insertBefore(e,t){let i=this.layers.indexOf(t);if(-1===i||-1!==this.layers.indexOf(e))return;let r=this.layers.slice(0,i),n=this.layers.slice(i);this.layers=[...r,e,...n]}hideInstance(){console.warn("hideInstance: not yet implemented")}getObjectsAt(e,t){if(this.rotation&&(e=this.applyRotation(e)),0===Yt(this.points,e,this.filteredPointsBuffer)[0])return[];let i=this.layers.length,r=[];for(let n=0;n<i;n++){let i=this.layers[n];if(t&&i.isShape){let t=ii(i.points,ei(this.x,this.y));if(!i.intersects([e[1]-t[1],e[2]-t[2]]))continue}if(0!==Yt(ii(i.points,ei(this.x,this.y)),e,this.filteredPointsBuffer)[0]&&r.push(i),t){let n=i;r.push(...n.getObjectsAt(e,t))}}return r}applyRotation(e){if(this.rotation){let t={x:e[1],y:e[2]},i={x:e[1],y:e[4]},r={x:e[3],y:e[2]},n={x:e[3],y:e[4]},a=this.points[1]+(this.points[3]-this.points[1])/2,o=this.points[2]+(this.points[4]-this.points[2])/2,[s,l]=ds(a,o,t.x,t.y,this.rotation),[u,c]=ds(a,o,i.x,i.y,this.rotation),[h,d]=ds(a,o,r.x,r.y,this.rotation),[p,f]=ds(a,o,n.x,n.y,this.rotation),g=Math.min(s,u,h,p),m=Math.max(s,u,h,p),v=Math.min(l,c,d,f),y=Math.max(l,c,d,f);return Gt([e[0],g,v,m,y])}return e}getAllPointsAt(e,t,i){let r=Kt(ei(this.x,this.y),Jt(this.scale),this.aggregateBuffer);this.rotation&&(e=this.applyRotation(e));let n=((e,t,i)=>{let r=e[1]<=t[3]&&e[3]>=t[1]&&e[2]<=t[4]&&e[4]>=t[2],n=i||Gt(5);return r?(n[0]=1,n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n[3]=Math.min(e[3],t[3]),n[4]=Math.min(e[4],t[4]),n):(n[0]=0,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n)})(e,this.points,this.intersectionBuffer),a=this.layers.length,o=[],s=ii(n,Kt(Jt(1/this.scale),ei(-this.x,-this.y),this.invertedBuffer)),l=t?Kt(t,r,this.aggregateBuffer):r,u=i*this.scale;for(let e=0;e<a;e++)o.push(...this.layers[e].getAllPointsAt(s,l,u));return o}addLayers(e){let t=[];for(let i of e)-1===this.layers.indexOf(i)&&(t.push(i),5===i.points.length&&(i.points[1]<this.worldPoints[1]/this.scale||i.points[2]<this.worldPoints[2]/this.scale||i.points[3]>this.worldPoints[3]/this.scale||i.points[4]>this.worldPoints[4]/this.scale)&&(i.crop=i.crop||Gt([1,Math.max(this.worldPoints[1]/this.scale,i.points[1]),Math.max(this.worldPoints[2]/this.scale,i.points[2]),Math.min(this.worldPoints[3]/this.scale,i.points[3]),Math.min(this.worldPoints[4]/this.scale,i.points[4])])));this.layers=this.layers.concat(t),this.filteredPointsBuffer=Gt(5*this.layers.length)}getScheduledUpdates(e,t){let i=this.layers.length;this._updatedList=[];let r=t*this.scale;for(let t=0;t<i;t++){let i=this.layers[t].getScheduledUpdates(e,r);i&&this._updatedList.push(...i)}return this._updatedList}},Os=class extends ni{constructor(e=0,t=0,i=100,r="left-to-right"){super(),this.id="world",this.aggregateBuffer=Gt(9),this.isDirty=!1,this.zones=[],this.triggerQueue=[],this.activatedEvents=[],this._updatedList=[],this.translationBuffer=Gt(9),this.needsRecalculate=!0,this.emptyPaintables=[],this.renderOrder=[],this.objects=[],this.subscriptions=[],this._propagateEventTargets=[],this._alreadyFlushed=[],this._width=e,this._height=t,this.aspectRatio=Number.isNaN(e/t)?1:e/t,this.viewingDirection=r,this.points=Gt(5*i),this.filteredPointsBuffer=Gt(5*i)}get x(){return 0}get y(){return 0}get width(){return this._width}get height(){return this._height}static withProps(e){let t=new Os;return t.applyProps(e),t}applyProps(e){typeof e.width<"u"&&typeof e.height<"u"&&(e.width!==this._width||e.height!==this._height)&&this.resize(e.width,e.height),e.viewingDirection!==this.viewingDirection&&(this.viewingDirection=e.viewingDirection,this.triggerRepaint())}propagateTouchEvent(e,t,i){let r=[];for(let e of i)if(e.x&&e.y){let t=Xt.singleBox(1,1,e.x,e.y);r.push(this.getObjectsAt(t,!0).reverse())}return r.map((i=>this.propagateEvent(e,t,i,{bubbles:!0,cancelable:!0})))}propagatePointerEvent(e,t,i,r,n={}){let a=Xt.singleBox(1,1,i,r),o=this.getObjectsAt(a,!0).reverse();return this.propagateEvent(e,t,o,n)}propagateEvent(e,t,i,{bubbles:r=!1,cancelable:n=!1}={}){t.atlasTarget=this,this._propagateEventTargets.length=1,this._propagateEventTargets[0]=this;let a=!1;t.stopPropagation=()=>{a=!0};for(let e=i.length-1;e>=0;e--){this._propagateEventTargets.unshift(i[e][0]);let t=i[e][1].length;if(t)for(let r=0;r<t;r++)this._propagateEventTargets.unshift(i[e][1][r])}let o=this._propagateEventTargets.length,s=!1;for(let i=0;i<o&&(t.atlasTarget=this._propagateEventTargets[i],t.atlasWorld=this,s=this._propagateEventTargets[i].dispatchEvent(e,t)||s,!a);i++);return s&&this.triggerRepaint(),this._propagateEventTargets}appendChild(e){let t=this.appendWorldObject(e);this.renderOrder.push(t/5)}removeChild(e){let t=this.objects.indexOf(e);if(-1!==t)this.objects[t]=null,this.renderOrder=this.renderOrder.filter((e=>e!==t)),this.points[5*t]=0,this.triggerRepaint(),this.needsRecalculate=!0;else for(let t of this.objects)if(t&&t.id===e.id)return void this.removeChild(t)}insertBefore(e,t){let i=this.objects.indexOf(t);if(-1===i)return;let r=this.appendWorldObject(e);this.renderOrder.splice(i-1,0,r/5)}hideInstance(){}asWorldObject(){return null}addZone(e){this.zones.push(e)}selectZone(e){if("string"==typeof e){let t=this.zones.length;for(let i=0;i<t;i++)if(this.zones[i].id===e)return this.selectedZone=i,void this.trigger("zone-changed")}else this.zones[e]&&(this.selectedZone=e,this.trigger("zone-changed"))}deselectZone(){this.selectedZone=void 0}getActiveZone(){if(this.selectedZone)return this.zones[this.selectedZone]}hasActiveZone(){return typeof this.selectedZone<"u"}checkResizeInternalBuffer(){if((e=>e.length/5)(this.points)===this.objects.length){let e=this.points,t=Gt(2*this.points.length);t.set(e,0),this.points=t}}appendWorldObject(e){this.checkResizeInternalBuffer();let t=5*this.objects.length,i=e.points;return e.points=this.points.subarray(5*this.objects.length,5*this.objects.length+5),e.points[1]=i[1],e.points[2]=i[2],e.points[3]=i[3],e.points[4]=i[4],this.objects.push(e),this.filteredPointsBuffer=Gt(5*this.objects.length),this.needsRecalculate=!0,this.triggerRepaint(),t}recalculateWorldSize(){let e=!1;if(this.needsRecalculate){let t=new Int32Array(this.objects.length),i=new Int32Array(this.objects.length),r=this.renderOrder.length;for(let e=0;e<r;e++){let r=this.renderOrder[e];this.objects[r]&&(t[e]=this.points[5*r+3],i[e]=this.points[5*r+4])}let n=Math.max(...t);n!==this._width&&(this._width=n,e=!0);let a=Math.max(...i);a!==this._height&&(this._height=a,e=!0),e&&this.trigger("recalculate-world-size",{width:n,height:a}),this.needsRecalculate=!1}return e}addObjectAt(e,t){t.width&&!t.height?t.height=t.width/e.width*e.height:t.height&&!t.width&&(t.width=t.height/e.height*e.width),(!t||!t.width||!t.height)&&(t.width=e.width,t.height=e.height);let{width:i,x:r,y:n}=t,a=i/e.width;this.checkResizeInternalBuffer(),this.points.set(Xt.singleBox(e.width,e.height,0,0),5*this.objects.length);let o=new Ps(e);return o.points=this.points.subarray(5*this.objects.length,5*this.objects.length+5),this.objects.push(o),this.scaleWorldObject(this.objects.length-1,a),this.translateWorldObject(this.objects.length-1,r,n),this.filteredPointsBuffer=Gt(2*this.points.length),this.triggerRepaint(),this.needsRecalculate=!0,o}scaleWorldObject(e,t){Zt(this.points.subarray(5*e,5*e+5),ti(t,this.points[5*e+1],this.points[5*e+2]));let i=this.objects[e];i&&(i.atScale(t),this.triggerRepaint())}translateWorldObject(e,t,i){Zt(this.points.subarray(5*e,5*e+5),ei(t,i));let r=this.objects[e];r&&(r.translate(t,i),this.triggerRepaint())}resize(e,t){return this._width=e,this._height=t,this.aspectRatio=e/t,this.triggerRepaint(),this}getObjects(){return this.objects}getPoints(){return this.points}getPointsFromViewer(e,t){let i=Xt.singleBox(e.width,e.height,e.x,e.y);return this.getPointsAt(i,t,e.scale)}addLayoutSubscriber(e){return this.subscriptions.push(e),()=>{this.subscriptions.splice(this.subscriptions.indexOf(e),1)}}getScheduledUpdates(e,t){let i=Yt(this.points,e,this.filteredPointsBuffer),r=this.objects.length;this._updatedList=[];for(let n=0;n<r;n++)if(0!==i[5*n]){if(!this.objects[n])continue;this._updatedList.push(...this.objects[n].getScheduledUpdates(e,t))}return this._updatedList}getObjectsAt(e,t=!1){let i=this.getActiveZone(),r=Yt(this.points,e,this.filteredPointsBuffer),n=this.renderOrder.length,a=[];for(let o=0;o<n;o++){let n=this.renderOrder[o];if(0!==r[5*n]){let r=this.objects[n];if(!r||i&&-1===i.objects.indexOf(r))continue;if("world-object"!==r.type){a.push([r,[r]]);continue}t?a.push([r,r.getObjectsAt(e,t)]):a.push([r,this.emptyPaintables])}}return a}getPointsAt(e,t,i=1){let r=this.getObjectsAt(e),n=Kt(Jt(i),ei(-e[1],-e[2]),this.translationBuffer),a=t?Kt(t,n,this.aggregateBuffer):n,o=r.length,s=[];for(let t=0;t<o;t++)r[t]&&s.push(...r[t][0].getAllPointsAt(e,a,i));return s}flushSubscriptions(){if(this.triggerQueue.length){this._alreadyFlushed=[];let e=this.triggerQueue.length;for(let t=0;t<e;t++){if(-1!==this._alreadyFlushed.indexOf(this.triggerQueue[t][0]))continue;typeof this.triggerQueue[t][1]>"u"&&this._alreadyFlushed.push(this.triggerQueue[t][0]);let e=this.subscriptions.length;for(let i=0;i<e;i++)this.subscriptions[i].apply(null,this.triggerQueue[t])}this.triggerQueue=[]}}trigger(e,t){this.triggerQueue.push([e,t])}triggerEventActivation(){this.trigger("event-activation")}triggerRepaint(){this.trigger("repaint")}gotoRegion(e){this.trigger("goto-region",e)}goHome(e=!1){this.trigger("go-home",{immediate:e})}zoomTo(e,t,i){this.trigger("zoom-to",{point:t,factor:e,stream:i})}zoomIn(e){this.trigger("zoom-to",{point:e,factor:.5})}zoomOut(e){this.trigger("zoom-to",{point:e,factor:2})}constraintBounds(e){this.trigger("constrain-bounds",{immediate:e})}},Ts=/([0-9]+(px|em)\s+)+(solid)\s+(.*)/g,Rs={},Is=["backgroundColor","opacity","boxShadow","borderColor","borderWidth","borderStyle","outlineColor","outlineWidth","outlineOffset","outlineStyle"],Ms=class extends ni{constructor(){super(),this.type="spacial-content",this.hoverEvents=!1,this.activeEvents=!1,this.display={x:0,y:0,scale:1,width:-1,height:-1,points:Gt(5)},this._parsed={border:{id:null,match:[]},outline:{id:null,match:[]}},this.props={},this.addHover=()=>{this.hovering=!0,this.__revision++},this.removeHover=()=>{this.hovering=!1,this.pressing=!1,this.__revision++},this.addPress=()=>{this.pressing=!0,this.__revision++},this.removePress=()=>{this.pressing=!1,this.__revision++},this.id=ri(12),this.points=Gt(5)}getAllPointsAt(e,t){return[[this,this.points,t]]}applyProps(e={}){let t=!1;if(e.interactive!==this.props.interactive&&(t=!0,this.props.interactive=e.interactive),e.style){let i=e.border||e.style.border;if(i!==this._parsed.border.id)if(i){let e=Rs[i]||Ts.exec(i)||Ts.exec(i);e&&(this._parsed.border.id=i,this._parsed.border.match=Rs[i]=e)}else this._parsed.border.id=null,this._parsed.border.match=[];if(this._parsed.border.id&&(e.style.borderWidth=this._parsed.border.match[1],e.style.borderStyle="solid",e.style.borderColor=this._parsed.border.match[4]),e.style.outline!==this._parsed.outline.id)if(e.style.outline){let t=Rs[e.style.outline]||Ts.exec(e.style.outline)||Ts.exec(e.style.outline);t&&(this._parsed.outline.id=e.style.outline,this._parsed.outline.match=Rs[e.style.outline]=t)}else this._parsed.outline.id=null,this._parsed.outline.match=[];this._parsed.outline.id&&(e.style.outlineWidth=this._parsed.outline.match[1],e.style.outlineStyle="solid",e.style.outlineColor=this._parsed.outline.match[4]),this.props.style=e.style,e.backgroundColor&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.backgroundColor,t=!0),e.style.background&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.style.background,t=!0);for(let i of Is)if(this.props.style[i]!==e.style[i]){t=!0;break}e.style[":hover"]!==this.props.hoverStyles&&(this.props.hoverStyles=e.style[":hover"],this.hoverEvents||(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),t=!0),e.style[":active"]!==this.props.pressStyles&&(this.props.pressStyles=e.style[":active"],this.activeEvents||(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0)}e.href!==this.props.href&&(this.props.href=e.href,t=!0),e.hrefTarget!==this.props.hrefTarget&&(this.props.hrefTarget=e.hrefTarget,t=!0),e.title!==this.props.title&&(this.props.title=e.title,t=!0),e.className!==this.props.className&&(this.props.className=e.className,e.className&&!this.hoverEvents&&(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),e.className&&!this.activeEvents&&(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0),e.relativeSize!==this.props.relativeSize&&(this.props.relativeSize=e.relativeSize,t=!0),e.relativeStyle!==this.props.relativeStyle&&(this.props.relativeStyle=e.relativeStyle,t=!0),e.html!==this.props.html&&(this.props.html=e.html,t=!0),e.target&&(e.target.width!==this.display.width||e.target.height!==this.display.height||e.target.x!==this.points[1]||e.target.y!==this.points[2])&&(t=!0,this.points=Xt.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.points=Xt.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.width=e.target.width,this.display.height=e.target.height),t&&this.__revision++}},zs=/([0-9]+(px|em)\s+)+(solid)\s+(.*)/g,Ls={},Fs=["backgroundColor","opacity","boxShadow","borderColor","borderWidth","borderStyle","outlineColor","outlineWidth","outlineOffset","outlineStyle"],Ns=class extends ni{constructor(){super(),this.type="spacial-content",this.isShape=!0,this.hoverEvents=!1,this.activeEvents=!1,this.display={x:0,y:0,scale:1,width:-1,height:-1,points:Gt(5)},this.boundingBox=null,this._parsed={border:{id:null,match:[]},outline:{id:null,match:[]}},this.props={},this.shape={type:"none"},this.addHover=()=>{this.hovering=!0,this.__revision++},this.removeHover=()=>{this.hovering=!1,this.pressing=!1,this.__revision++},this.addPress=()=>{this.pressing=!0,this.__revision++},this.removePress=()=>{this.pressing=!1,this.__revision++},this.id=ri(12),this.points=Gt(5),this.shape={type:"none"}}updateBoundingBox(){if("none"===this.shape.type)return;let e=this.shape.points;if(this.shape.points.length>2){let t=Math.min(...e.map((e=>e[0]))),i=Math.min(...e.map((e=>e[1]))),r=Math.max(0,...e.map((e=>e[0]))),n=Math.max(0,...e.map((e=>e[1])));this.boundingBox={x:t,y:i,width:r-t,height:n-i}}else this.boundingBox=null}intersects(e){if(!e||"none"===this.shape.type)return!1;let[t,i]=e,r=this.shape.points,n=this.boundingBox;if(n||(this.updateBoundingBox(),n=this.boundingBox),!n||t<n.x||t>n.x+n.width||i<n.y||i>n.height+n.y)return!1;let a=!1;for(let e=0,n=r.length-1;e<r.length;n=e++)r[e][1]>i!=r[n][1]>i&&t<(r[n][0]-r[e][0])*(i-r[e][1])/(r[n][1]-r[e][1])+r[e][0]&&(a=!a);return a}getAllPointsAt(e,t){return e[3]-e[1]==1&&e[4]-e[2]==1?this.intersects([e[1],e[2]])?[[this,this.points,t]]:[]:[[this,this.points,t]]}applyProps(e={}){let t=!1;if(e.points)if("polygon"!==this.shape.type||this.shape.points.length!==e.points.length)this.shape={type:"polygon",points:e.points,open:e.open},this.updateBoundingBox();else{let t=!1,i=e.points.length;for(let r=0;r<i;r++)if(e.points[r][0]!==this.shape.points[r][0]||e.points[r][1]!==this.shape.points[r][1]){t=!0;break}t&&(this.shape={type:"polygon",points:e.points,open:e.open},this.updateBoundingBox())}if(e.interactive!==this.props.interactive&&(t=!0,this.props.interactive=e.interactive),(e.open||!1===e.open)&&(t=!0,this.shape.open=e.open),e.style){let i=e.border||e.style.border;if(i!==this._parsed.border.id)if(i){let e=Ls[i]||zs.exec(i)||zs.exec(i);e&&(this._parsed.border.id=i,this._parsed.border.match=Ls[i]=e)}else this._parsed.border.id=null,this._parsed.border.match=[];if(this._parsed.border.id&&(e.style.borderWidth=this._parsed.border.match[1],e.style.borderStyle="solid",e.style.borderColor=this._parsed.border.match[4]),e.style.outline!==this._parsed.outline.id)if(e.style.outline){let t=Ls[e.style.outline]||zs.exec(e.style.outline)||zs.exec(e.style.outline);t&&(this._parsed.outline.id=e.style.outline,this._parsed.outline.match=Ls[e.style.outline]=t)}else this._parsed.outline.id=null,this._parsed.outline.match=[];this._parsed.outline.id&&(e.style.outlineWidth=this._parsed.outline.match[1],e.style.outlineStyle="solid",e.style.outlineColor=this._parsed.outline.match[4]),this.props.style=e.style,e.backgroundColor&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.backgroundColor,t=!0),e.style.background&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.style.background,t=!0);for(let i of Fs)if(this.props.style[i]!==e.style[i]){t=!0;break}e.style[":hover"]!==this.props.hoverStyles&&(this.props.hoverStyles=e.style[":hover"],this.hoverEvents||(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),t=!0),e.style[":active"]!==this.props.pressStyles&&(this.props.pressStyles=e.style[":active"],this.activeEvents||(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0)}e.href!==this.props.href&&(this.props.href=e.href,t=!0),e.hrefTarget!==this.props.hrefTarget&&(this.props.hrefTarget=e.hrefTarget,t=!0),e.title!==this.props.title&&(this.props.title=e.title,t=!0),e.className!==this.props.className&&(this.props.className=e.className,e.className&&!this.hoverEvents&&(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),e.className&&!this.activeEvents&&(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0),e.relativeSize!==this.props.relativeSize&&(this.props.relativeSize=e.relativeSize,t=!0),e.relativeStyle!==this.props.relativeStyle&&(this.props.relativeStyle=e.relativeStyle,t=!0),e.html!==this.props.html&&(this.props.html=e.html,t=!0),e.target&&(e.target.width!==this.display.width||e.target.height!==this.display.height||e.target.x!==this.points[1]||e.target.y!==this.points[2])&&(t=!0,this.points=Xt.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.points=Xt.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.width=e.target.width,this.display.height=e.target.height),t&&this.__revision++}},js=class extends ni{constructor(){super(),this.type="spacial-content",this.color="#000",this.text="",this.display={x:0,y:0,scale:1,width:100,height:100,points:Gt(5)},this.interactive=!1,this.props={font:"18px Arial, sans-serif",lineHeight:1,textAlign:"left",verticalAlign:"top",paddingX:0,paddingY:0,fitParent:!1,lineBreak:"auto",strokeText:!1,sizeToFill:!1,maxFontSizeToFill:void 0,allowNewLine:!0,justifyLines:!1,renderHDPI:!1,textDecoration:"none",interactive:!1,relativeSize:!1},this.id="",this.points=Gt(5)}getAllPointsAt(e,t){return[[this,this.points,t]]}applyProps(e){var t=e,{id:i,target:r,text:n,color:a,backgroundColor:o,fontSize:s=18,interactive:l,fontFamily:u="Arial, sans-serif"}=t,c=g(t,["id","target","text","color","backgroundColor","fontSize","interactive","fontFamily"]);c.font=`${s}px ${u}`,this.interactive=l||!1,typeof n<"u"&&(this.text=n||""),a&&(this.color=a),o&&(this.backgroundColor=o),i&&(this.id=i),r&&(this.points=Xt.singleBox(r.width,r.height,r.x,r.y),this.display.points=this.points,this.display.width=r.width,this.display.height=r.height),this.props=d(d({},this.props),c),this.__revision++}},$s=Math.pow,Bs=Math.sqrt,Ds=Math.sin,Us=Math.cos,Ws=Math.PI,Hs=1.70158,qs=1.525*Hs,Vs=Hs+1,Qs=2*Ws/3,Ys=2*Ws/4.5,Gs=function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},Ks={linear:e=>e,easeInQuad:function(e){return e*e},easeOutQuad:function(e){return 1-(1-e)*(1-e)},easeInOutQuad:function(e){return e<.5?2*e*e:1-$s(-2*e+2,2)/2},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return 1-$s(1-e,3)},easeInOutCubic:function(e){return e<.5?4*e*e*e:1-$s(-2*e+2,3)/2},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1-$s(1-e,4)},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-$s(-2*e+2,4)/2},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1-$s(1-e,5)},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1-$s(-2*e+2,5)/2},easeInSine:function(e){return 1-Us(e*Ws/2)},easeOutSine:function(e){return Ds(e*Ws/2)},easeInOutSine:function(e){return-(Us(Ws*e)-1)/2},easeInExpo:function(e){return 0===e?0:$s(2,10*e-10)},easeOutExpo:function(e){return 1===e?1:1-$s(2,-10*e)},easeInOutExpo:function(e){return 0===e?0:1===e?1:e<.5?$s(2,20*e-10)/2:(2-$s(2,-20*e+10))/2},easeInCirc:function(e){return 1-Bs(1-$s(e,2))},easeOutCirc:function(e){return Bs(1-$s(e-1,2))},easeInOutCirc:function(e){return e<.5?(1-Bs(1-$s(2*e,2)))/2:(Bs(1-$s(-2*e+2,2))+1)/2},easeInBack:function(e){return Vs*e*e*e-Hs*e*e},easeOutBack:function(e){return 1+Vs*$s(e-1,3)+Hs*$s(e-1,2)},easeInOutBack:function(e){return e<.5?$s(2*e,2)*(7.189819*e-qs)/2:($s(2*e-2,2)*((qs+1)*(2*e-2)+qs)+2)/2},easeInElastic:function(e){return 0===e?0:1===e?1:-$s(2,10*e-10)*Ds((10*e-10.75)*Qs)},easeOutElastic:function(e){return 0===e?0:1===e?1:$s(2,-10*e)*Ds((10*e-.75)*Qs)+1},easeInOutElastic:function(e){return 0===e?0:1===e?1:e<.5?-$s(2,20*e-10)*Ds((20*e-11.125)*Ys)/2:$s(2,-20*e+10)*Ds((20*e-11.125)*Ys)/2+1},easeInBounce:function(e){return 1-Gs(1-e)},easeOutBounce:Gs,easeInOutBounce:function(e){return e<.5?(1-Gs(1-2*e))/2:(1+Gs(2*e-1))/2}},Xs=class{constructor(e,t,i,r=[],n){this.id=ri(),this.ready=!1,this.transformBuffer=Gt(500),this.lastTarget=Gt(5),this.zoomBuffer=Gt(5),this.logNextRender=!1,this.pendingUpdate=!0,this.isCommitting=!1,this.firstRender=!0,this.mode="explore",this.controllers=[],this.controllersRunning=!1,this.controllerStopFunctions=[],this.maxScaleFactor=1,this._viewerToWorld={x:0,y:0},this._lastGoodScale=1,this.hooks={useFrame:[],useBeforeFrame:[],useAfterPaint:[],useAfterFrame:[]},this.hookOptions={filters:{grayscale:0,contrast:0,brightness:0,saturate:0,sepia:0,invert:0,hueRotate:0,blur:0}},this._viewport={x:0,y:0,width:0,height:0},this.setViewport=e=>{let t=Math.round(typeof e.x>"u"?this.target[1]:e.x),i=Math.round(typeof e.y>"u"?this.target[2]:e.y);e.width?this.target[3]=t+e.width:this.target[3]=this.target[3]-this.target[1]+t,e.height?this.target[4]=i+e.height:this.target[4]=this.target[4]-this.target[2]+i,Math.abs(this.target[1]-t)>.01&&(this.target[1]=t),Math.abs(this.target[2]-i)>.01&&(this.target[2]=i),this.pendingUpdate=!0},this.render=e=>{let t=e-this.lastTime;if(this.isCommitting||this.fpsLimit&&t<1e3/this.fpsLimit)return void(this.stopId=window.requestAnimationFrame(this.render));this.lastTime=e,this.world.flushSubscriptions(),this.stopId=window.requestAnimationFrame(this.render),this.hook("useFrame",t);let i=this.pendingUpdate,r=this.renderer.pendingUpdate();if(this.transitionManager.hasPending()&&(this.transitionManager.runTransition(this.target,t),this.pendingUpdate=!0,this.updateControllerPosition()),!this.firstRender&&!i&&!r&&this.target[0]===this.lastTarget[0]&&this.target[1]===this.lastTarget[1]&&this.target[2]===this.lastTarget[2]&&this.target[3]===this.lastTarget[3]&&this.target[4]===this.lastTarget[4])return;this.hook("useBeforeFrame",t),this.renderer.beforeFrame(this.world,t,this.target,this.hookOptions);let n=this.getScaleFactor(),a=this.renderer.getPointsAt(this.world,this.target,this.aggregate,n),o=a.length;for(let e=0;e<o;e++){let t=a[e][0],i=a[e][1],r=a[e][2],n=r?ii(i,r,this.transformBuffer):i;this.renderer.prepareLayer(t,t.__parent&&r?ii(t.__parent.crop||t.__parent.points,r):n);let o=n.length/5;for(let e=0;e<o;e++){let i=5*e;0!==n[i]&&(this.renderer.paint(t,e,n[i+1],n[i+2],n[i+3]-n[i+1],n[i+4]-n[i+2]),this.hook("useAfterPaint",t))}this.renderer.finishLayer(t,i)}this.renderer.afterFrame(this.world,t,this.target,this.hookOptions),this.hook("useAfterFrame",t),this.lastTarget[0]=this.target[0],this.lastTarget[1]=this.target[1],this.lastTarget[2]=this.target[2],this.lastTarget[3]=this.target[3],this.lastTarget[4]=this.target[4],this.firstRender=!1,this.pendingUpdate=!1,this.logNextRender=!1,this.renderer.isReady()&&(this.ready=!0,this.world.trigger("ready")),this.world.flushSubscriptions();let s=this.world.getScheduledUpdates(this.target,n),l=s.length;if(l>0)for(let e=0;e<l;e++){let t=s[l-e-1]();t?t.then((()=>{this.pendingUpdate=!0})):this.pendingUpdate=!0}},this.renderer=e,this.world=t,this.options=d({maxOverZoom:1,maxUnderZoom:1,visibilityRatio:1.5},n||{}),this.target=Xt.projection(i),this.manualHomePosition=!1,this.pendingUpdate=!0,this.homePosition=Xt.projection(this.world),this.manualFocalPosition=!1,this.focalPosition=this.target,this.updateFocalPosition(),this.transitionManager=new class{constructor(e){this.runtime=e,this.pendingTransition={from:Gt(5),to:Gt(5),elapsed_time:0,done:!0,total_time:0,timingFunction:Ks.easeInOutQuad,constrain:!1}}hasPending(){return!this.pendingTransition.done}getPendingTransition(){return this.pendingTransition}getPendingFrom(){return this.pendingTransition.from}customTransition(e){e(this.pendingTransition)}stopTransition(){this.pendingTransition.from=Gt(this.runtime.target),this.pendingTransition.to=Gt(this.runtime.target),this.pendingTransition.done=!0,this.pendingTransition.elapsed_time=0,this.pendingTransition.total_time=0}runTransition(e,t){if(!this.pendingTransition.done){let i=this.pendingTransition,r=0===i.total_time?0:(i.elapsed_time+t)/i.total_time,n=0===i.total_time?1:0===r?0:i.timingFunction(r);e[1]=i.from[1]+(i.to[1]-i.from[1])*n,e[2]=i.from[2]+(i.to[2]-i.from[2])*n,e[3]=i.from[3]+(i.to[3]-i.from[3])*n,e[4]=i.from[4]+(i.to[4]-i.from[4])*n,this.pendingTransition.elapsed_time+=t,this.pendingTransition.elapsed_time>=this.pendingTransition.total_time&&(this.pendingTransition.done=!0,this.pendingTransition.constrain&&this.constrainBounds({transition:{duration:0===this.pendingTransition.total_time?0:500,easing:Ks.easeOutExpo}}))}}zoomTo(e,{origin:t,stream:i=!1,transition:r}={}){let n=this.runtime.getZoomedPosition(e,{origin:t}),a=Math.abs(1-e);this.applyTransition(n,r,{duration:2e3*a,easing:Ks.easeOutExpo,constrain:!0},{stream:!1})}constrainBounds({transition:e,panPadding:t=0}={}){let[i,r]=this.runtime.constrainBounds(this.runtime.target,{panPadding:t});i&&(this.applyTransition(r,e,{duration:500,easing:Ks.easeOutQuart,constrain:!1}),this.runtime.updateNextFrame())}applyTransition(e,t,i,{stream:r}={}){this.pendingTransition.from=Gt(this.runtime.target),this.pendingTransition.to=e,r||(this.pendingTransition.elapsed_time=0),this.pendingTransition.done=!1,this.pendingTransition.total_time=typeof(null==t?void 0:t.duration)<"u"?t.duration:typeof(null==i?void 0:i.duration)<"u"?i.duration:1e3,this.pendingTransition.constrain=typeof(null==t?void 0:t.constrain)<"u"?t.constrain:typeof(null==i?void 0:i.constrain)<"u"&&i.constrain,this.pendingTransition.timingFunction=(null==t?void 0:t.easing)||(null==i?void 0:i.easing)||Ks.easeInOutSine}goToRegion(e,{transition:t}={}){let i=this.runtime.clampRegion(e);this.applyTransition(Xt.singleBox(i.width,i.height,i.x,i.y),t,{duration:1e3,easing:Ks.easeOutExpo,constrain:!0}),this.runtime.updateNextFrame()}}(this),this.aggregate=Jt(1),this.world.addLayoutSubscriber((e=>{"repaint"===e&&(this.pendingUpdate=!0),"recalculate-world-size"===e&&(this.manualHomePosition||(this.setHomePosition(),this.goHome()),this.updateFocalPosition())})),this.lastTime=performance.now(),this.controllers=r,this.render(this.lastTime),this.startControllers()}get x(){return this.target[1]}set x(e){this.target[1]=e}get y(){return this.target[2]}set y(e){this.target[2]=e}get x2(){return this.target[3]}set x2(e){this.target[3]=e}get y2(){return this.target[4]}set y2(e){this.target[4]=e}get width(){return this.target[3]-this.target[1]}set width(e){this.target[3]=this.target[1]+e}get height(){return this.target[4]-this.target[2]}set height(e){this.target[4]=this.target[2]=e}setHomePosition(e){this.homePosition.set(Xt.projection(e||this.world)),this.pendingUpdate=!0}startControllers(){if(!this.controllersRunning){for(let e of this.controllers)this.controllerStopFunctions.push(e.start(this));this.controllersRunning=!0}}stopControllers(){if(this.controllersRunning){for(let e of this.controllerStopFunctions)e();this.controllersRunning=!1,this.controllerStopFunctions=[]}}updateControllerPosition(){for(let e of this.controllers)e.updatePosition(this.x,this.y,this.width,this.height)}triggerResize(){this.renderer.triggerResize&&this.renderer.triggerResize(),this.pendingUpdate=!0}addController(e){this.controllers.push(e),this.controllersRunning&&e.start(this),this.pendingUpdate=!0}cover(){return this.goHome({cover:!0})}getRendererScreenPosition(){return this.renderer.getRendererScreenPosition()}updateRendererScreenPosition(){this.pendingUpdate=!0,this.renderer.resize()}setOptions(e){this.options=d(d({},this.options),e)}goHome(e={}){if(this.world.width<=0||this.world.height<=0)return;let t=this.getScaleFactor(),i=e.position?{x:e.position[1],y:e.position[2],width:e.position[3]-e.position[1],height:e.position[4]-e.position[2]}:{x:this.homePosition[1],y:this.homePosition[2],width:this.homePosition[3]-this.homePosition[1],height:this.homePosition[4]-this.homePosition[2]},r=this.width*t,n=this.height*t,a=i.width/r,o=i.height/n,s=r/n;if(e.cover?a>o:a<o){let e=s*i.height,t=(e-i.width)/2;this.target[1]=Math.round(-t+i.x),this.target[2]=Math.round(i.y),this.target[3]=Math.round(e-t+i.x),this.target[4]=Math.round(i.height+i.y)}else{let e=i.width/s,t=(e-i.height)/2;this.target[1]=Math.round(i.x),this.target[2]=Math.round(i.y-t),this.target[3]=Math.round(i.x+i.width),this.target[4]=Math.round(i.y+e-t)}this.constrainBounds(this.target),this.updateControllerPosition()}resize(e,t,i,r){this.updateFocalPosition(e-t,i-r);let n=t/e,a=r/i;this.target[3]=this.target[1]+(this.target[3]-this.target[1])*n,this.target[4]=this.target[2]+(this.target[4]-this.target[2])*a,this.goHome({position:this.focalPosition}),this.renderer.resize(t,r),this.pendingUpdate=!0}updateFocalPosition(e,t){if(!this.manualFocalPosition){let e=this.width,t=this.height,i=Math.min(e,t),r=0,n=0,a=this.x+r,o=this.y+n;if(e<t){let e=this.height-this.width;this.focalPosition=Xt.projection({x:a,y:o+e/2,width:i-2*r,height:i-2*n}),this.pendingUpdate=!0}else{let e=this.width-this.height;this.focalPosition=Xt.projection({x:a+e/2,y:o,width:i-2*r,height:i-2*n}),this.pendingUpdate=!0}}}getViewport(){return this._viewport.x=this.target[1],this._viewport.y=this.target[2],this._viewport.width=this.target[3]-this.target[1],this._viewport.height=this.target[4]-this.target[2],this._viewport}constrainBounds(e,{panPadding:t=0,ref:i=!1}={}){let{minX:r,maxX:n,minY:a,maxY:o}=this.getBounds({target:e,padding:t}),s=!1,l=i?e:Gt(e),u=Math.round(e[3]-e[1]),c=Math.round(e[4]-e[2]);return r>e[1]&&(s=!0,l[1]=r,l[3]=r+u),a>e[2]&&(s=!0,l[2]=a,l[4]=a+c),n<e[1]&&(s=!0,l[1]=n,l[3]=n+u),o<e[2]&&(s=!0,l[2]=o,l[4]=o+c),[s,l]}getBounds(e){let t=e.target||this.target,i=e.padding,r=this.options.visibilityRatio,n=Math.abs(1-r);if(this.world.hasActiveZone()){let e=this.world.getActiveZone();if(e){let r=t[3]-t[1]<e.points[3]-e.points[1],n=t[4]-t[2]<e.points[4]-e.points[2];return{minX:r?e.points[1]-i:e.points[1]+(e.points[3]-e.points[1])/2-(t[3]-t[1])/2,maxX:n?e.points[2]-i:e.points[2]+(e.points[4]-e.points[2])/2-(t[4]-t[2])/2,minY:r?e.points[3]+i:e.points[1]+(e.points[3]-e.points[1])/2-(t[3]-t[1])/2,maxY:n?e.points[4]+i:e.points[2]+(e.points[4]-e.points[2])/2-(t[4]-t[2])/2}}}let a=t[3]-t[1],o=-a*n,s=this.world.width-a-o,l=t[4]-t[2],u=-l*n,c=this.world.height-l-u,h=Math.round(Math.max(o,s)),d=Math.round(Math.min(o,s)),p=Math.round(Math.max(u,c));return{minX:d,maxX:h,minY:Math.round(Math.min(u,c)),maxY:p}}getScaleFactor(e=!1){let t=this.renderer.getScale(this.target[3]-this.target[1],this.target[4]-this.target[2],e);return 0===t?this._lastGoodScale:(this._lastGoodScale=t,t)}getZoomedPosition(e,{origin:t,fromPos:i}){var r;let n=i?{width:i[3]-i[1],height:i[4]-i[2]}:void 0,a=n?this.renderer.getScale(n.width,n.height):this.getScaleFactor(),o=n?n.width:this.width,s=n?n.height:this.height,l=null==(r=this.getRendererScreenPosition())?void 0:r.width,u=this.world.width,c=l?l/u:1,h=this.options.maxUnderZoom,d=Math.max(c||1,this.options.maxOverZoom),p=1/e,f=a*p;if(p<1){let t=o*a,i=s*a;if(this.world.width/t>this.world.height/i){this.world.width*f<~~(o*a)*h&&(e=this.world.width*a/(o*a*h))}else{this.world.height*f<~~(s*a)*h&&(e=this.world.height*a/(s*a*h))}}else f>d&&(e=a/d);let g=ii(this.target,ti(e,t?t.x:this.target[1]+(this.target[3]-this.target[1])/2,t?t.y:this.target[2]+(this.target[4]-this.target[2])/2),this.zoomBuffer);return this.constrainBounds(g,{ref:!0,panPadding:100}),g}clampRegion({x:e,y:t,width:i,height:r,padding:n=0}){let a=this.width,o=this.height,s=e-n,l=t-n,u=i+2*n,c=r+2*n;if(i/a<r/o){let e=c/o*a;return{x:s-(e-u)/2,y:l,width:e,height:c}}let h=u/a*o;return{x:s,y:l-(h-c)/2,width:u,height:h}}viewerToWorld(e,t){let i=this.getScaleFactor();return this._viewerToWorld.x=this.target[1]+e/i,this._viewerToWorld.y=this.target[2]+t/i,this._viewerToWorld}worldToViewer(e,t,i,r){let n=Xt.singleBox(i,r,e,t);return Zt(n,Kt(Jt(this.getScaleFactor()),ei(-this.target[1],-this.target[2]))),{x:n[1],y:n[2],width:n[3]-n[1],height:n[4]-n[2],strand:n}}setScale(e,t){Zt(this.target,ti(e,t?t.x:this.target[1]+(this.target[3]-this.target[1])/2,t?t.y:this.target[2]+(this.target[4]-this.target[2])/2)),this.pendingUpdate=!0}syncTo(e){let t=this.target;return this.target=e.target,this.pendingUpdate=!0,()=>{this.target=t}}stop(){return typeof this.stopId<"u"&&(window.cancelAnimationFrame(this.stopId),this.stopId=void 0),()=>{this.render(performance.now())}}reset(){this.renderer.reset()}selectZone(e){this.world.selectZone(e),this.pendingUpdate=!0}deselectZone(){this.world.deselectZone(),this.pendingUpdate=!0}hook(e,t){let i=this.hooks[e].length;if(0!==i)for(let r=0;r<i;r++)this.hooks[e][r](t)}registerHook(e,t){return this.hooks[e].push(t),()=>{this.hooks[e]=this.hooks[e].filter((e=>e!==t))}}updateNextFrame(){this.pendingUpdate=!0}},Zs="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,Js="function"==typeof AbortController?AbortController:class{constructor(){this.signal=new il}abort(e=new Error("This operation was aborted")){this.signal.reason=e,this.signal.dispatchEvent({type:"abort",target:this.signal})}},el="function"==typeof AbortSignal,tl="function"==typeof Js.AbortSignal,il=el?AbortSignal:tl?Js.AbortController:class{constructor(){this.reason=void 0,this.aborted=!1,this._listeners=[]}dispatchEvent(e){"abort"===e.type&&(this.aborted=!0,this.onabort(e),this._listeners.forEach((t=>t(e)),this))}onabort(){}addEventListener(e,t){"abort"===e&&this._listeners.push(t)}removeEventListener(e,t){"abort"===e&&(this._listeners=this._listeners.filter((e=>e!==t)))}},rl=new Set,nl=(e,t)=>{let i=`LRU_CACHE_OPTION_${e}`;sl(i)&&ll(i,`${e} option`,`options.${t}`,dl)},al=(e,t)=>{let i=`LRU_CACHE_METHOD_${e}`;if(sl(i)){let{prototype:r}=dl,{get:n}=Object.getOwnPropertyDescriptor(r,e);ll(i,`${e} method`,`cache.${t}()`,n)}},ol=(...e)=>{"object"==typeof process&&process&&"function"==typeof process.emitWarning?process.emitWarning(...e):console.error(...e)},sl=e=>!rl.has(e),ll=(e,t,i,r)=>{rl.add(e),ol(`The ${t} is deprecated. Please use ${i} instead.`,"DeprecationWarning",e,r)},ul=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),cl=e=>ul(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?hl:null:null,hl=class extends Array{constructor(e){super(e),this.fill(0)}},dl=class{constructor(e={}){let{max:t=0,ttl:i,ttlResolution:r=1,ttlAutopurge:n,updateAgeOnGet:a,updateAgeOnHas:o,allowStale:s,dispose:l,disposeAfter:u,noDisposeOnSet:c,noUpdateTTL:h,maxSize:d=0,maxEntrySize:p=0,sizeCalculation:f,fetchMethod:g,fetchContext:m,noDeleteOnFetchRejection:v,noDeleteOnStaleGet:y,allowStaleOnFetchRejection:b,allowStaleOnFetchAbort:w,ignoreFetchAbort:x}=e,{length:_,maxAge:S,stale:E}=e instanceof dl?{}:e;if(0!==t&&!ul(t))throw new TypeError("max option must be a nonnegative integer");let k=t?cl(t):Array;if(!k)throw new Error("invalid max value: "+t);if(this.max=t,this.maxSize=d,this.maxEntrySize=p||this.maxSize,this.sizeCalculation=f||_,this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=g||null,this.fetchMethod&&"function"!=typeof this.fetchMethod)throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=m,!this.fetchMethod&&void 0!==m)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(t).fill(null),this.valList=new Array(t).fill(null),this.next=new k(t),this.prev=new k(t),this.head=0,this.tail=0,this.free=new class{constructor(e){if(0===e)return[];let t=cl(e);this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}(t),this.initialFill=1,this.size=0,"function"==typeof l&&(this.dispose=l),"function"==typeof u?(this.disposeAfter=u,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!c,this.noUpdateTTL=!!h,this.noDeleteOnFetchRejection=!!v,this.allowStaleOnFetchRejection=!!b,this.allowStaleOnFetchAbort=!!w,this.ignoreFetchAbort=!!x,0!==this.maxEntrySize){if(0!==this.maxSize&&!ul(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");if(!ul(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!s||!!E,this.noDeleteOnStaleGet=!!y,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!o,this.ttlResolution=ul(r)||0===r?r:1,this.ttlAutopurge=!!n,this.ttl=i||S||0,this.ttl){if(!ul(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(0===this.max&&0===this.ttl&&0===this.maxSize)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){let e="LRU_CACHE_UNBOUNDED";sl(e)&&(rl.add(e),ol("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",e,dl))}E&&nl("stale","allowStale"),S&&nl("maxAge","ttl"),_&&nl("length","sizeCalculation")}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new hl(this.max),this.starts=new hl(this.max),this.setItemTTL=(e,t,i=Zs.now())=>{if(this.starts[e]=0!==t?i:0,this.ttls[e]=t,0!==t&&this.ttlAutopurge){let i=setTimeout((()=>{this.isStale(e)&&this.delete(this.keyList[e])}),t+1);i.unref&&i.unref()}},this.updateItemAge=e=>{this.starts[e]=0!==this.ttls[e]?Zs.now():0};let e=0,t=()=>{let t=Zs.now();if(this.ttlResolution>0){e=t;let i=setTimeout((()=>e=0),this.ttlResolution);i.unref&&i.unref()}return t};this.getRemainingTTL=i=>{let r=this.keyMap.get(i);return void 0===r?0:0===this.ttls[r]||0===this.starts[r]?1/0:this.starts[r]+this.ttls[r]-(e||t())},this.isStale=i=>0!==this.ttls[i]&&0!==this.starts[i]&&(e||t())-this.starts[i]>this.ttls[i]}updateItemAge(e){}setItemTTL(e,t,i){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new hl(this.max),this.removeItemSize=e=>{this.calculatedSize-=this.sizes[e],this.sizes[e]=0},this.requireSize=(e,t,i,r)=>{if(this.isBackgroundFetch(t))return 0;if(!ul(i)){if(!r)throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");if("function"!=typeof r)throw new TypeError("sizeCalculation must be a function");if(i=r(t,e),!ul(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return i},this.addItemSize=(e,t)=>{if(this.sizes[e]=t,this.maxSize){let t=this.maxSize-this.sizes[e];for(;this.calculatedSize>t;)this.evict(!0)}this.calculatedSize+=this.sizes[e]}}removeItemSize(e){}addItemSize(e,t){}requireSize(e,t,i,r){if(i||r)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.tail;this.isValidIndex(t)&&((e||!this.isStale(t))&&(yield t),t!==this.head);)t=this.prev[t]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.head;this.isValidIndex(t)&&((e||!this.isStale(t))&&(yield t),t!==this.tail);)t=this.next[t]}isValidIndex(e){return this.keyMap.get(this.keyList[e])===e}*entries(){for(let e of this.indexes())this.isBackgroundFetch(this.valList[e])||(yield[this.keyList[e],this.valList[e]])}*rentries(){for(let e of this.rindexes())this.isBackgroundFetch(this.valList[e])||(yield[this.keyList[e],this.valList[e]])}*keys(){for(let e of this.indexes())this.isBackgroundFetch(this.valList[e])||(yield this.keyList[e])}*rkeys(){for(let e of this.rindexes())this.isBackgroundFetch(this.valList[e])||(yield this.keyList[e])}*values(){for(let e of this.indexes())this.isBackgroundFetch(this.valList[e])||(yield this.valList[e])}*rvalues(){for(let e of this.rindexes())this.isBackgroundFetch(this.valList[e])||(yield this.valList[e])}[Symbol.iterator](){return this.entries()}find(e,t={}){for(let i of this.indexes())if(e(this.valList[i],this.keyList[i],this))return this.get(this.keyList[i],t)}forEach(e,t=this){for(let i of this.indexes())e.call(t,this.valList[i],this.keyList[i],this)}rforEach(e,t=this){for(let i of this.rindexes())e.call(t,this.valList[i],this.keyList[i],this)}get prune(){return al("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(let t of this.rindexes({allowStale:!0}))this.isStale(t)&&(this.delete(this.keyList[t]),e=!0);return e}dump(){let e=[];for(let t of this.indexes({allowStale:!0})){let i=this.keyList[t],r=this.valList[t],n=this.isBackgroundFetch(r)?r.__staleWhileFetching:r;if(void 0===n)continue;let a={value:n};if(this.ttls){a.ttl=this.ttls[t];let e=Zs.now()-this.starts[t];a.start=Math.floor(Date.now()-e)}this.sizes&&(a.size=this.sizes[t]),e.unshift([i,a])}return e}load(e){this.clear();for(let[t,i]of e){if(i.start){let e=Date.now()-i.start;i.start=Zs.now()-e}this.set(t,i.value,i)}}dispose(e,t,i){}set(e,t,{ttl:i=this.ttl,start:r,noDisposeOnSet:n=this.noDisposeOnSet,size:a=0,sizeCalculation:o=this.sizeCalculation,noUpdateTTL:s=this.noUpdateTTL}={}){if(a=this.requireSize(e,t,a,o),this.maxEntrySize&&a>this.maxEntrySize)return this.delete(e),this;let l=0===this.size?void 0:this.keyMap.get(e);if(void 0===l)l=this.newIndex(),this.keyList[l]=e,this.valList[l]=t,this.keyMap.set(e,l),this.next[this.tail]=l,this.prev[l]=this.tail,this.tail=l,this.size++,this.addItemSize(l,a),s=!1;else{this.moveToTail(l);let i=this.valList[l];t!==i&&(this.isBackgroundFetch(i)?i.__abortController.abort(new Error("replaced")):n||(this.dispose(i,e,"set"),this.disposeAfter&&this.disposed.push([i,e,"set"])),this.removeItemSize(l),this.valList[l]=t,this.addItemSize(l,a))}if(0!==i&&0===this.ttl&&!this.ttls&&this.initializeTTLTracking(),s||this.setItemTTL(l,i,r),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return 0===this.size?this.tail:this.size===this.max&&0!==this.max?this.evict(!1):0!==this.free.length?this.free.pop():this.initialFill++}pop(){if(this.size){let e=this.valList[this.head];return this.evict(!0),e}}evict(e){let t=this.head,i=this.keyList[t],r=this.valList[t];return this.isBackgroundFetch(r)?r.__abortController.abort(new Error("evicted")):(this.dispose(r,i,"evict"),this.disposeAfter&&this.disposed.push([r,i,"evict"])),this.removeItemSize(t),e&&(this.keyList[t]=null,this.valList[t]=null,this.free.push(t)),this.head=this.next[t],this.keyMap.delete(i),this.size--,t}has(e,{updateAgeOnHas:t=this.updateAgeOnHas}={}){let i=this.keyMap.get(e);return void 0!==i&&!this.isStale(i)&&(t&&this.updateItemAge(i),!0)}peek(e,{allowStale:t=this.allowStale}={}){let i=this.keyMap.get(e);if(void 0!==i&&(t||!this.isStale(i))){let e=this.valList[i];return this.isBackgroundFetch(e)?e.__staleWhileFetching:e}}backgroundFetch(e,t,i,r){let n=void 0===t?void 0:this.valList[t];if(this.isBackgroundFetch(n))return n;let a=new Js;i.signal&&i.signal.addEventListener("abort",(()=>a.abort(i.signal.reason)));let o={signal:a.signal,options:i,context:r},s=(r,n=!1)=>{let{aborted:s}=a.signal,c=i.ignoreFetchAbort&&void 0!==r;return!s||c||n?(this.valList[t]===u&&(void 0===r?u.__staleWhileFetching?this.valList[t]=u.__staleWhileFetching:this.delete(e):this.set(e,r,o.options)),r):l(a.signal.reason)},l=r=>{let{aborted:n}=a.signal,o=n&&i.allowStaleOnFetchAbort,s=o||i.allowStaleOnFetchRejection,l=s||i.noDeleteOnFetchRejection;if(this.valList[t]===u&&(l&&void 0!==u.__staleWhileFetching?o||(this.valList[t]=u.__staleWhileFetching):this.delete(e)),s)return u.__staleWhileFetching;if(u.__returned===u)throw r},u=new Promise(((t,r)=>{this.fetchMethod(e,n,o).then((e=>t(e)),r),a.signal.addEventListener("abort",(()=>{(!i.ignoreFetchAbort||i.allowStaleOnFetchAbort)&&(t(),i.allowStaleOnFetchAbort&&(t=e=>s(e,!0)))}))})).then(s,l);return u.__abortController=a,u.__staleWhileFetching=n,u.__returned=null,void 0===t?(this.set(e,u,o.options),t=this.keyMap.get(e)):this.valList[t]=u,u}isBackgroundFetch(e){return e&&"object"==typeof e&&"function"==typeof e.then&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(e,"__returned")&&(e.__returned===e||null===e.__returned)}async fetch(e,{allowStale:t=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:r=this.noDeleteOnStaleGet,ttl:n=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:o=0,sizeCalculation:s=this.sizeCalculation,noUpdateTTL:l=this.noUpdateTTL,noDeleteOnFetchRejection:u=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:c=this.allowStaleOnFetchRejection,ignoreFetchAbort:h=this.ignoreFetchAbort,allowStaleOnFetchAbort:d=this.allowStaleOnFetchAbort,fetchContext:p=this.fetchContext,forceRefresh:f=!1,signal:g}={}){if(!this.fetchMethod)return this.get(e,{allowStale:t,updateAgeOnGet:i,noDeleteOnStaleGet:r});let m={allowStale:t,updateAgeOnGet:i,noDeleteOnStaleGet:r,ttl:n,noDisposeOnSet:a,size:o,sizeCalculation:s,noUpdateTTL:l,noDeleteOnFetchRejection:u,allowStaleOnFetchRejection:c,allowStaleOnFetchAbort:d,ignoreFetchAbort:h,signal:g},v=this.keyMap.get(e);if(void 0===v){let t=this.backgroundFetch(e,v,m,p);return t.__returned=t}{let r=this.valList[v];if(this.isBackgroundFetch(r))return t&&void 0!==r.__staleWhileFetching?r.__staleWhileFetching:r.__returned=r;if(!f&&!this.isStale(v))return this.moveToTail(v),i&&this.updateItemAge(v),r;let n=this.backgroundFetch(e,v,m,p);return t&&void 0!==n.__staleWhileFetching?n.__staleWhileFetching:n.__returned=n}}get(e,{allowStale:t=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:r=this.noDeleteOnStaleGet}={}){let n=this.keyMap.get(e);if(void 0!==n){let a=this.valList[n],o=this.isBackgroundFetch(a);return this.isStale(n)?o?t?a.__staleWhileFetching:void 0:(r||this.delete(e),t?a:void 0):o?void 0:(this.moveToTail(n),i&&this.updateItemAge(n),a)}}connect(e,t){this.prev[t]=e,this.next[e]=t}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return al("del","delete"),this.delete}delete(e){let t=!1;if(0!==this.size){let i=this.keyMap.get(e);if(void 0!==i)if(t=!0,1===this.size)this.clear();else{this.removeItemSize(i);let t=this.valList[i];this.isBackgroundFetch(t)?t.__abortController.abort(new Error("deleted")):(this.dispose(t,e,"delete"),this.disposeAfter&&this.disposed.push([t,e,"delete"])),this.keyMap.delete(e),this.keyList[i]=null,this.valList[i]=null,i===this.tail?this.tail=this.prev[i]:i===this.head?this.head=this.next[i]:(this.next[this.prev[i]]=this.next[i],this.prev[this.next[i]]=this.prev[i]),this.size--,this.free.push(i)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return t}clear(){for(let e of this.rindexes({allowStale:!0})){let t=this.valList[e];if(this.isBackgroundFetch(t))t.__abortController.abort(new Error("deleted"));else{let i=this.keyList[e];this.dispose(t,i,"delete"),this.disposeAfter&&this.disposed.push([t,i,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return al("reset","clear"),this.clear}get length(){return((e,t)=>{let i=`LRU_CACHE_PROPERTY_${e}`;if(sl(i)){let{prototype:r}=dl,{get:n}=Object.getOwnPropertyDescriptor(r,e);ll(i,`${e} property`,`cache.${t}`,n)}})("length","size"),this.size}static get AbortController(){return Js}static get AbortSignal(){return il}},pl=dl,fl=/(-?[0-9]+(px|em)\s+|0\s+)(-?[0-9]+(px|em)\s+|0\s+)(-?[0-9]+(px|em)\s+|0\s+)?(-?[0-9]+(px|em)\s+|0\s+)?(.*)/g,gl={},ml=typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes("firefox"),vl={},yl=class{constructor(e,t){this.imagesPending=0,this.imagesLoaded=0,this.imageIdsLoaded=[],this.frameIsRendering=!1,this.pendingDrawCall=!1,this.firstMeaningfulPaint=!1,this.parallelTasks=8,this.frameTasks=0,this.loadingQueueOrdered=!0,this.loadingQueue=[],this.currentTask=Promise.resolve(),this.tasksRunning=0,this.averageJobTime=64,this.lastKnownScale=1,this.visible=[],this.previousVisible=[],this.drawCalls=[],this.invalidated=[],this._worker=()=>{if(this.loadingQueue.length){let e=this.loadingQueue.pop();e&&(this.tasksRunning++,this.frameTasks++,this.currentTask=e.task().then((()=>{this.tasksRunning--})).catch((()=>{this.tasksRunning--})))}},this._scheduled=0,this._doWork=()=>{0===this.loadingQueue.length&&0===this.tasksRunning&&this._scheduled&&(clearInterval(this._scheduled),this._scheduled=0);let e=this.parallelTasks||1;!this.firstMeaningfulPaint&&this.loadingQueue.length&&(e=this.loadingQueue.length);for(let t=0;t<=e;t++)this._worker()},this.canvas=e,this.rendererPosition=e.getBoundingClientRect(),this.ctx=e.getContext("2d",{alpha:!0}),this.ctx.imageSmoothingEnabled=!0,this.options=t||{},this.canvas.style.opacity="0",this.canvas.style.transition="opacity .3s",this.dpi=(null==t?void 0:t.dpi)||1,this.hostCache=null!=t&&t.lruCache?new pl({maxSize:268435456,dispose:(e,t,i)=>{this.invalidated.push(t),e.width=0,e.height=0},sizeCalculation:(e,t)=>e.width*e.height}):{store:{},get(e){return this.store[e]},set(e,t){this.store[e]=t}}}getCanvasDims(){return{width:this.canvas.width/this.dpi,height:this.canvas.height/this.dpi}}resize(){this.rendererPosition=this.canvas.getBoundingClientRect()}isReady(){return this.firstMeaningfulPaint}afterFrame(e){if(this.clearTransform(),this.lastPaintedObject=void 0,this.frameIsRendering=!1,this.imagesPending=Math.max(0,this.imagesPending-this.imagesLoaded),this.imagesLoaded=0,this.loadingQueueOrdered||(this.loadingQueue=this.loadingQueue.sort(((e,t)=>e.network&&e.scale===t.scale?t.distance-e.distance:e.scale<t.scale?-1:1)),this.loadingQueueOrdered=!0),this.previousVisible=this.visible,this.pendingDrawCall=!!this.drawCalls.length,this.pendingDrawCall)for(let e=0;e<this.drawCalls.length;e++){let e=this.drawCalls.shift();e&&e()}this.doOffscreenWork(),this.options.debug&&this.stats&&this.stats.end()}doOffscreenWork(){this.frameTasks=0,this.loadingQueue.length&&(this._worker(),this.loadingQueue.length&&(this._scheduled||(this._scheduled=setInterval(this._doWork,0))))}getScale(e,t,i){if(Number.isNaN(e)||Number.isNaN(t))return this.lastKnownScale;let r=this.getCanvasDims(),n=r.width/e,a=r.height/t,o=(n<a?a:n)*(i&&this.dpi||1);return Number.isNaN(o)||(this.lastKnownScale=o),this.lastKnownScale}beforeFrame(e,t,i,r){this.options.debug&&this.stats&&this.stats.begin(),this.frameIsRendering=!0,this.visible=[],this.options.beforeFrame&&this.options.beforeFrame(t);let n=this.getCanvasDims();if(this.ctx.globalAlpha=1,this.ctx.fillStyle=this.options.background||"rgb(0, 0, 0)",this.ctx.fillRect(0,0,n.width,n.height),r.enableFilters&&(r.filters.brightness||r.filters.contrast||r.filters.grayscale||r.filters.invert||r.filters.sepia||r.filters.saturate||r.filters.hueRotate||r.filters.blur)){let e="";r.filters.brightness&&(e+=`brightness(${~~(100+100*r.filters.brightness)}%) `),r.filters.contrast&&(e+=`contrast(${~~(100+100*r.filters.contrast)}%) `),r.filters.grayscale&&(e+=`grayscale(${~~(100*r.filters.grayscale)}%) `),r.filters.invert&&(e+=`invert(${~~(100*r.filters.invert)}%) `),r.filters.sepia&&(e+=`sepia(${~~(100*r.filters.sepia)}%) `),r.filters.saturate&&(e+=`saturate(${~~(100+100*r.filters.saturate)}%) `),r.filters.hueRotate&&(e+=`hue-rotate(${r.filters.hueRotate}deg) `),r.filters.blur&&(e+=`blur(${r.filters.blur}px) `),this.ctx.filter=e}else this.ctx.filter="none"}applyTransform(e,t,i,r,n){let a=e.__owner.value;if(a&&a.rotation){this.ctx.save();let e=t+r/2,o=i+n/2;this.ctx.translate(e,o),this.ctx.rotate(a.rotation*Math.PI/180),this.ctx.translate(-e,-o),this.lastPaintedObject=a}}clearTransform(){this.lastPaintedObject&&(this.lastPaintedObject.rotation&&this.ctx.restore(),this.lastPaintedObject=void 0)}paint(e,t,i,r,n,a){let o=this.ctx.globalAlpha;if(e instanceof ai||e instanceof us){if(e.display.rotation){this.ctx.save();let o=i+n/2,s=r+a/2;e.crop&&(o-=e.crop[5*t+1],s-=e.crop[5*t+2]),this.ctx.translate(o,s),this.ctx.rotate(e.display.rotation*Math.PI/180),this.ctx.translate(-o,-s)}if(this.visible.push(e),e.style,"undefined"!==e.style.opacity){if(!e.style.opacity)return;this.ctx.globalAlpha=e.style.opacity}try{let o=e.__host.canvas,s=this.getCanvasDims();if((-1===o.indices.indexOf(t)||-1!==this.invalidated.indexOf(o.canvases[t]))&&this.schedulePaintToCanvas(o,e,t,li({x:i+n/2,y:r+n/2},{x:s.width/2,y:s.height/2})),!this.firstMeaningfulPaint)return;let l=this.hostCache.get(o.canvases[t]);if(l)if(e.crop&&e.cropData){if(e.crop[5*t]){let o=[e.crop[5*t+1]/e.display.scale-e.display.points[5*t+1],e.crop[5*t+2]/e.display.scale-e.display.points[5*t+2],1+(e.crop[5*t+3]-e.crop[5*t+1])/e.display.scale,1+(e.crop[5*t+4]-e.crop[5*t+2])/e.display.scale];o[0]+=e.cropData.x/e.display.scale,o[1]+=e.cropData.y/e.display.scale;let s=e.x*this.lastKnownScale,u=e.y*this.lastKnownScale,c=[i+s,r+u,n,a];c[0]+=s,c[1]+=u,this.ctx.drawImage(l,o[0],o[1],o[2],o[3],c[0],c[1],c[2]+1,c[3]+1)}}else ml?this.ctx.drawImage(l,0,0,e.display.points[5*t+3]-e.display.points[5*t+1],e.display.points[5*t+4]-e.display.points[5*t+2],i,r,n+1,a+1):this.ctx.drawImage(l,0,0,e.display.points[5*t+3]-e.display.points[5*t+1],e.display.points[5*t+4]-e.display.points[5*t+2],i,r,n+Number.MIN_VALUE+.5,a+Number.MIN_VALUE+.5)}catch(e){}e.display.rotation&&this.ctx.restore()}let s=e instanceof Ms&&this.options.box,l=e instanceof Ns&&this.options.polygon;if((s||l)&&!e.props.className&&!e.props.html&&!e.props.href){if(this.visible.push(e),e.props.style){let t=Object.assign({},e.props.style||{},e.hovering?e.props.hoverStyles:{},e.pressing?e.props.pressStyles:{}),o=e.props.relativeStyle?1:n/e.width;typeof t.opacity<"u"&&(this.ctx.globalAlpha=t.opacity);let s=0;typeof t.borderWidth<"u"&&(s=parseInt(t.borderWidth,10)*o);let u=0;typeof t.outlineWidth<"u"&&(u=parseInt(t.outlineWidth,10)*o);let c=0;if(typeof t.outlineOffset<"u"&&(c=parseInt(t.outlineOffset,10)*o),t.borderColor&&(this.ctx.strokeStyle=t.borderColor),t.boxShadow){let e=t.boxShadow.split(/,(?![^(]*\))/);for(let t of e){let e=gl[t]||fl.exec(t)||fl.exec(t);gl[t]=e,e&&(this.ctx.save(),this.ctx.shadowOffsetX=parseInt(e[1])*this.dpi*o,this.ctx.shadowOffsetY=parseInt(e[3])*this.dpi*o,this.ctx.shadowBlur=parseInt(e[5])*this.dpi*o,this.ctx.shadowColor=e[9],this.ctx.fillStyle="rgba(0,0,0,1)",this.ctx.fillRect(i+s,r+s,n,a),this.ctx.restore())}}if(this.ctx.fillStyle=t.backgroundColor||"transparent",this.ctx.lineWidth=s,l){let t=e.shape,n=t.points||[],a=n.length;this.ctx.beginPath();for(let e=0;e<a;e++)this.ctx.lineTo(i+n[e][0]*this.lastKnownScale,r+n[e][1]*this.lastKnownScale);t.open||this.ctx.closePath(),s&&this.ctx.stroke(),t.open||this.ctx.fill()}else s&&this.ctx.strokeRect(i+s/2,r+s/2,n+s,a+s),this.ctx.fillRect(i+s,r+s,n,a);u&&(t.outlineColor&&(this.ctx.strokeStyle=t.outlineColor),this.ctx.lineWidth=u,this.ctx.strokeRect(i-u/2-c,r-u/2-c,n+2*s+u+2*c,a+2*s+u+2*c))}this.ctx.globalAlpha=o}}loadImage(e,t,i,r=!1){if(vl[e]&&vl[e].naturalWidth>0)t(vl[e]);else try{let n=!1;r||setTimeout((()=>{n||this.loadImage(e,t,i,!0)}),3e3);let a=document.createElement("img");a.decoding="auto",a.onload=function(){n=!0,t(a),vl[e]=a,a.onload=null},this.options.crossOrigin&&(a.crossOrigin="anonymous"),a.src=e,a.complete&&a.onload({}),a.width}catch(e){console.log("image error",e),i(e)}}schedulePaintToCanvas(e,t,i,r){this.imagesPending++,e.indices.push(i);let n=`${t.id}--${t.display.scale}-${i}`,a=this.invalidated.indexOf(n);-1!==a&&this.invalidated.splice(a,1),e.canvases[i]=n,t.__host.canvas.loading=!0,this.loadingQueueOrdered=!1,this.loadingQueue.push({id:n,scale:t.display.scale,network:!0,distance:r,task:()=>new Promise((a=>{if(-1===this.visible.indexOf(t))return this.imagesPending--,e.indices.splice(e.indices.indexOf(i),1),void a();let o=t.getImageUrl(i);this.loadImage(o,(o=>{this.loadingQueue.push({id:n,scale:t.display.scale,distance:r,task:()=>new Promise((r=>{this.imageIdsLoaded.includes(n)||(this.imagesLoaded++,this.imageIdsLoaded.push(n)),e.loaded.push(i),e.loaded.length===e.indices.length&&(e.loading=!1);let a=t.display.points.slice(5*i,5*i+5),s=document.createElement("canvas"),l=s.getContext("2d");s.width=a[3]-a[1],s.height=a[4]-a[2],this.hostCache.set(e.canvases[i],s),this.drawCalls.push((()=>{l.drawImage(o,0,0,a[3]-a[1],a[4]-a[2]),r()}))}))}),a()}),(t=>{this.imagesPending--,e.indices.splice(e.indices.indexOf(i),1),a()}))}))})}afterPaintLayer(e,t){}prepareLayer(e,t){e.__owner.value&&(e.cropData?(this.lastKnownScale,e.display.scale,this.applyTransform(e,t[1],t[2],t[3]-t[1],t[4]-t[2])):this.applyTransform(e,t[1],t[2],t[3]-t[1],t[4]-t[2])),(!e.__host||!e.__host.canvas)&&(e instanceof ai||e instanceof us)&&this.createImageHost(e)}finishLayer(){this.lastPaintedObject&&this.clearTransform()}createImageHost(e){e.__host=e.__host?e.__host:{},e.__host.canvas={canvas:void 0,canvases:[],indices:[],loaded:[],loading:!1}}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}getViewportBounds(e,t,i){let r=e.getActiveZone();if(r){let e=t[3]-t[1]<r.points[3]-r.points[1],n=t[4]-t[2]<r.points[4]-r.points[2];return{x1:e?r.points[1]-i:r.points[1]+(r.points[3]-r.points[1])/2-(t[3]-t[1])/2,y1:n?r.points[2]-i:r.points[2]+(r.points[4]-r.points[2])/2-(t[4]-t[2])/2,x2:e?r.points[3]+i:r.points[1]+(r.points[3]-r.points[1])/2-(t[3]-t[1])/2,y2:n?r.points[4]+i:r.points[2]+(r.points[4]-r.points[2])/2-(t[4]-t[2])/2}}return null}pendingUpdate(){let e=!this.pendingDrawCall&&0===this.drawCalls.length&&0===this.imagesPending&&0===this.loadingQueue.length&&0===this.tasksRunning;return!e&&0===this.visible.length&&setTimeout((()=>{this.canvas.style.opacity="1",this.firstMeaningfulPaint=!0}),500),!this.firstMeaningfulPaint&&e&&this.visible.length?(this.canvas.style.opacity="1",this.firstMeaningfulPaint=e,!0):!!this.options.debug||!e}getRendererScreenPosition(){return this.rendererPosition}reset(){this.loadingQueue=[],this.drawCalls=[]}},bl=class{constructor(e){this.renderers=[];for(let t of e)t&&this.renderers.push(t);this.length=this.renderers.length}afterFrame(e,t,i,r){for(let n=0;n<this.length;n++)this.renderers[n].afterFrame(e,t,i,r)}afterPaintLayer(e,t){for(let i=0;i<this.length;i++)this.renderers[i].afterPaintLayer(e,t)}beforeFrame(e,t,i,r){for(let n=0;n<this.length;n++)this.renderers[n].beforeFrame(e,t,i,r)}triggerResize(){for(let e=0;e<this.length;e++){let t=this.renderers[e];t.triggerResize&&t.triggerResize()}}getPointsAt(e,t,i,r){return this.renderers[0].getPointsAt(e,t,i,r)}getScale(e,t){return this.renderers[0].getScale(e,t)}getViewportBounds(e,t,i){return this.renderers[0].getViewportBounds(e,t,i)}getRendererScreenPosition(){return this.renderers[0].getRendererScreenPosition()}isReady(){for(let e=0;e<this.length;e++)if(!this.renderers[e].isReady())return!1;return!0}paint(e,t,i,r,n,a){for(let o=0;o<this.length;o++)this.renderers[o].paint(e,t,i,r,n,a)}pendingUpdate(){for(let e=0;e<this.length;e++)if(this.renderers[e].pendingUpdate())return!0;return!1}prepareLayer(e,t){for(let i=0;i<this.length;i++)this.renderers[i].prepareLayer(e,t)}finishLayer(e,t){for(let i=0;i<this.length;i++)this.renderers[i].finishLayer(e,t)}resize(e,t){for(let i=0;i<this.length;i++)this.renderers[i].resize(e,t)}reset(){for(let e=0;e<this.length;e++)this.renderers[e].reset()}},wl=class{constructor(e){this.heightRatio=1,this.widthRatio=1,this.target=new Float32Array(5),this.delta=0,this.renderNextFrame=!0,this.canvas=e,this.initialWidth=e.width,this.initialHeight=e.height,this.context=e.getContext("2d"),this.context.globalAlpha=.5,this.aggregate=Jt(1)}isReady(){return!0}resize(){this.initialWidth=this.canvas.width,this.initialHeight=this.canvas.height,this.renderNextFrame=!0}afterFrame(e,t,i){if(this.renderNextFrame){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);let t=this.initialWidth/e.width,r=this.initialHeight/e.height,n=this.widthRatio>this.heightRatio?t:r;if(this.target=i,this.bounds){let t=e.getPointsAt(this.bounds,this.aggregate,n);for(let[e,i]of t)if(e instanceof ai&&e.__host.canvas){let t=i.length/5;for(let r=0;r<t;r++)e.__host.canvas.canvases[r]&&(i[r+1],i[r+2],i[r+3],i[r+1],i[r+4],i[r+2])}}e.getPoints().forEach(((e,t,i)=>{if(t%5==0&&e){let e={x1:i[t+1]*n,y1:i[t+2]*n,x2:i[t+3]*n,y2:i[t+4]*n,width:(i[t+3]-i[t+1])*n,height:(i[t+4]-i[t+2])*n};this.context.strokeStyle="red",this.context.strokeRect(e.x1,e.y1,e.width,e.height)}})),i&&(this.context.strokeStyle="red",this.context.lineWidth=window.devicePixelRatio||1,this.context.strokeRect(i[1]*n,i[2]*n,(i[3]-i[1])*n,(i[4]-i[2])*n))}}getActiveZone(e){return null}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}getScale(e,t){return 1}beforeFrame(e,t){this.bounds=Xt.singleBox(e.width,e.height)}drawImage(){}afterPaintLayer(e,t){}paint(e,t,i,r,n,a){this.renderNextFrame=!0}prepareLayer(e){}pendingUpdate(){return!1}hasActiveZone(){return!1}getViewportBounds(e,t,i){return null}getRendererScreenPosition(){return this.canvas.getBoundingClientRect()}finishLayer(){}reset(){}},xl=!1;function _l(){if(!xl){xl=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),i=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(Es=/\b(iPhone|iP[ao]d)/.exec(e),ks=/\b(iP[ao]d)/.exec(e),_s=/Android/i.exec(e),Cs=/FBAN\/\w+;/i.exec(e),As=/Mobile/i.exec(e),Ss=!!/Win64/.exec(e),t){(ps=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):NaN)&&document&&document.documentMode&&(ps=document.documentMode);var r=/(?:Trident\/(\d+.\d+))/.exec(e);ys=r?parseFloat(r[1])+4:ps,fs=t[2]?parseFloat(t[2]):NaN,gs=t[3]?parseFloat(t[3]):NaN,(ms=t[4]?parseFloat(t[4]):NaN)?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),vs=t&&t[1]?parseFloat(t[1]):NaN):vs=NaN}else ps=fs=gs=vs=ms=NaN;if(i){if(i[1]){var n=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);bs=!n||parseFloat(n[1].replace("_","."))}else bs=!1;ws=!!i[2],xs=!!i[3]}else bs=ws=xs=!1}}var Sl,El={ie:function(){return _l()||ps},ieCompatibilityMode:function(){return _l()||ys>ps},ie64:function(){return El.ie()&&Ss},firefox:function(){return _l()||fs},opera:function(){return _l()||gs},webkit:function(){return _l()||ms},safari:function(){return El.webkit()},chrome:function(){return _l()||vs},windows:function(){return _l()||ws},osx:function(){return _l()||bs},linux:function(){return _l()||xs},iphone:function(){return _l()||Es},mobile:function(){return _l()||Es||ks||_s||As},nativeApp:function(){return _l()||Cs},android:function(){return _l()||_s},ipad:function(){return _l()||ks}},kl=El,Cl=!!(typeof window<"u"&&window.document&&window.document.createElement),Al={canUseDOM:Cl,canUseWorkers:typeof Worker<"u",canUseEventListeners:Cl&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:Cl&&!!window.screen,isInWorker:!Cl};Al.canUseDOM&&(Sl=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("",""));var Pl=function(e,t){if(!Al.canUseDOM||t&&!("addEventListener"in document))return!1;var i="on"+e,r=i in document;if(!r){var n=document.createElement("div");n.setAttribute(i,"return;"),r="function"==typeof n[i]}return!r&&Sl&&"wheel"===e&&(r=document.implementation.hasFeature("Events.wheel","3.0")),r},Ol=kl,Tl=Pl;function Rl(e){var t=0,i=0,r=0,n=0;return"detail"in e&&(i=e.detail),"wheelDelta"in e&&(i=-e.wheelDelta/120),"wheelDeltaY"in e&&(i=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=i,i=0),r=10*t,n=10*i,"deltaY"in e&&(n=e.deltaY),"deltaX"in e&&(r=e.deltaX),(r||n)&&e.deltaMode&&(1==e.deltaMode?(r*=40,n*=40):(r*=800,n*=800)),r&&!t&&(t=r<1?-1:1),n&&!i&&(i=n<1?-1:1),{spinX:t,spinY:i,pixelX:r,pixelY:n}}Rl.getEventType=function(){return Ol.firefox()?"DOMMouseScroll":Tl("wheel")?"wheel":"mousewheel"};var Il=Rl;var Ml="scroll",zl={zoomOutFactor:.8,zoomInFactor:1.25,maxZoomFactor:1,minZoomFactor:.05,zoomDuration:300,zoomWheelConstant:20,zoomClamp:.6,panBounceStiffness:120,panBounceDamping:15,panTimeConstant:240,panPower:.1,nudgeDistance:100,panPadding:0,devicePixelRatio:1,enableWheel:!0,enableClickToZoom:!0,ignoreSingleFingerTouch:!1,enablePanOnWait:!1,requireMetaKeyForWheelZoom:!1,panOnWaitDelay:40,onPanInSketchMode:()=>{},parentElement:null},Ll=(e={})=>({start:function(t){let{zoomWheelConstant:i,enableWheel:r,enableClickToZoom:n,ignoreSingleFingerTouch:a,enablePanOnWait:o,panOnWaitDelay:s,parentElement:l,requireMetaKeyForWheelZoom:u}=d(d({},zl),e),c={pointerStart:{x:0,y:0},isPressing:!1,mousemoveBuffer:Gt(5),multiTouch:{distance:0}};function h(){m=0,y="",w(),w(void 0,"notice"),v=0}function p(){t.world.constraintBounds(),h()}function f(e){e.which>1?c.isPressing=!1:"explore"===t.mode&&(e.preventDefault(),c.pointerStart.x=e.atlas.x,c.pointerStart.y=e.atlas.y,t.transitionManager.stopTransition(),c.isPressing=!0)}function g(){h(),c.isPressing&&("explore"===t.mode&&t.world.constraintBounds(),c.isPressing=!1)}t.world.activatedEvents.push("onMouseUp","onMouseDown","onMouseMove","onTouchStart","onTouchEnd","onTouchMove");let m=0,v=0,y="";function b(e){if("explore"===t.mode){if(1===e.atlasTouches.length&&(v=performance.now(),0==a&&e.preventDefault(),c.pointerStart.x=e.atlasTouches[0].x,c.pointerStart.y=e.atlasTouches[0].y),2===e.atlasTouches.length){y="gesture",e.preventDefault();let t=e.atlasTouches[0].x,i=e.atlasTouches[1].x;c.pointerStart.x=(t+i)/2;let r=e.atlasTouches[0].y,n=e.atlasTouches[1].y;c.pointerStart.y=(r+n)/2,m=li({x:e.touches[0].clientX,y:e.touches[0].clientY},{x:e.touches[1].clientX,y:e.touches[1].clientY})}t.transitionManager.stopTransition(),c.isPressing=!0}}function w(e,t="intent"){l&&(l.dataset[t]=e)}function x(e){if(c.isPressing){let i=t.getRendererScreenPosition();if(i){let{x:r,y:n}=t.viewerToWorld(e.clientX-i.x,e.clientY-i.y);t.transitionManager.customTransition((e=>{e.from=Gt(t.target),e.to=ii(e.from,ei(c.pointerStart.x-r,c.pointerStart.y-n),c.mousemoveBuffer),e.elapsed_time=0,e.total_time=0,e.timingFunction=Ks.easeInOutExpo,e.done=!1}))}}}function _(e){"explore"===t.mode&&t.world.zoomIn(e.atlas)}function S(e){let r=1+Il(e).spinY/i;t.world.zoomTo(r,e.atlas,!0)}function E(e){return!u||0!=e.metaKey||(w("meta-required","notice"),e.stopPropagation(),!1)}t.world.addEventListener("mouseup",p),t.world.addEventListener("touchend",p),t.world.addEventListener("touchstart",b),t.world.addEventListener("mousedown",f),window.addEventListener("touchend",g),window.addEventListener("mouseup",g),window.addEventListener("mousemove",x),l&&l.addEventListener("touchmove",(function(e){let i=null,r=null,n=0;if(c.isPressing&&2===e.touches.length){i=(e.touches[0].clientX+e.touches[1].clientX)/2,r=(e.touches[0].clientY+e.touches[1].clientY)/2,n=li({x:e.touches[0].clientX,y:e.touches[0].clientY},{x:e.touches[1].clientX,y:e.touches[1].clientY})}if(w(y),c.isPressing&&1===e.touches.length){if(o&&(performance.now()-v<s&&""==y&&(y=Ml),""==y&&(y="pan")),w(y),""==y&&1==a||y==Ml)return void w("require-two-finger","notice");let t=e.touches[0];i=t.clientX,r=t.clientY}if(null!==i&&null!==r){let e=t.getRendererScreenPosition();if(e){let{x:a,y:o}=t.viewerToWorld(i-e.x,r-e.y),s=n&&m?n/m:1;t.transitionManager.customTransition((e=>{e.from=Gt(t.target),e.to=ii(e.from,Kt(ei(c.pointerStart.x-a,c.pointerStart.y-o),ti(1/s,a,o)),c.mousemoveBuffer),e.elapsed_time=0,e.total_time=0,e.timingFunction=Ks.easeInOutExpo,e.done=!1}))}m=n}"pan"==y&&e.preventDefault()})),n&&(t.world.activatedEvents.push("onClick"),t.world.addEventListener("click",_)),r&&(t.world.activatedEvents.push("onWheel"),u&&(null==l||l.addEventListener("wheel",E,{passive:!0,capture:!0})),t.world.addEventListener("wheel",S));let k=t.world.addLayoutSubscriber(((e,i)=>{if("zone-changed"===e&&t.transitionManager.constrainBounds({transition:{duration:0}}),"zoom-to"===e&&i&&t.transitionManager.zoomTo(i.factor,{origin:i.point,stream:i.stream}),"go-home"===e){let e=i.immediate?{duration:0}:void 0;t.transitionManager.goToRegion(function(e){return{x:e[1],y:e[2],width:e[3]-e[1],height:e[4]-e[2]}}(t.homePosition),{transition:e})}if("goto-region"===e&&i){let e=i.immediate?{duration:0}:{};t.transitionManager.goToRegion(i,{transition:e})}"constrain-bounds"===e&&t.transitionManager.constrainBounds({transition:null!=i&&i.immediate?{duration:0}:void 0})}));return()=>{t.world.removeEventListener("mouseup",p),t.world.removeEventListener("touchend",p),t.world.removeEventListener("touchstart",b),t.world.removeEventListener("mousedown",f),window.removeEventListener("touchend",g),window.removeEventListener("mouseup",g),t.world.removeEventListener("mousemove",x),l&&(l.removeEventListener("touchmove",x),l.removeEventListener("wheel",E,{passive:!0,capture:!0})),n&&t.world.removeEventListener("click",_),r&&t.world.removeEventListener("wheel",S),k()}},updatePosition(){}}),Fl=Ct.createContext("explore");Fl.displayName="Mode";var Nl=()=>me(Fl);function jl(e,t,i){var r,n,a,o,s;function l(){var u=Date.now()-o;u<t&&u>=0?r=setTimeout(l,t-u):(r=null,i||(s=e.apply(a,n),a=n=null))}null==t&&(t=100);var u=function(){a=this,n=arguments,o=Date.now();var u=i&&!r;return r||(r=setTimeout(l,t)),u&&(s=e.apply(a,n),a=n=null),s};return u.clear=function(){r&&(clearTimeout(r),r=null)},u.flush=function(){r&&(s=e.apply(a,n),a=n=null,clearTimeout(r),r=null)},u}jl.debounce=jl;var $l=jl;function Bl(e){let{debounce:t,scroll:i,polyfill:r,offsetSize:n}=void 0===e?{debounce:0,scroll:!1,offsetSize:!1}:e,a=r||(typeof window>"u"?class{}:window.ResizeObserver);if(!a)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");let[o,s]=le({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=de({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o}),u=t?"number"==typeof t?t:t.scroll:null,c=t?"number"==typeof t?t:t.resize:null,h=de(!1);ce((()=>(h.current=!0,()=>{h.current=!1})));let[d,p,f]=fe((()=>{let e=()=>{if(!l.current.element)return;let{left:e,top:t,width:i,height:r,bottom:a,right:o,x:u,y:c}=l.current.element.getBoundingClientRect(),d={left:e,top:t,width:i,height:r,bottom:a,right:o,x:u,y:c};l.current.element instanceof HTMLElement&&n&&(d.height=l.current.element.offsetHeight,d.width=l.current.element.offsetWidth),Object.freeze(d),h.current&&!Wl(l.current.lastBounds,d)&&s(l.current.lastBounds=d)};return[e,c?$l(e,c):e,u?$l(e,u):e]}),[s,n,u,c]);function g(){l.current.scrollContainers&&(l.current.scrollContainers.forEach((e=>e.removeEventListener("scroll",f,!0))),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null)}function m(){!l.current.element||(l.current.resizeObserver=new a(f),l.current.resizeObserver.observe(l.current.element),i&&l.current.scrollContainers&&l.current.scrollContainers.forEach((e=>e.addEventListener("scroll",f,{capture:!0,passive:!0}))))}return function(e,t){ce((()=>{if(t){let t=e;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",t,!0)}}}),[e,t])}(f,Boolean(i)),function(e){ce((()=>{let t=e;return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}}),[e])}(p),ce((()=>{g(),m()}),[i,f,p]),ce((()=>g),[]),[e=>{!e||e===l.current.element||(g(),l.current.element=e,l.current.scrollContainers=Dl(e),m())},o,d]}function Dl(e){let t=[];if(!e||e===document.body)return t;let{overflow:i,overflowX:r,overflowY:n}=window.getComputedStyle(e);return[i,r,n].some((e=>"auto"===e||"scroll"===e))&&t.push(e),[...t,...Dl(e.parentElement)]}var Ul=["x","y","top","bottom","left","right","width","height"],Wl=(e,t)=>Ul.every((i=>e[i]===t[i])),Hl=Ct.createContext(null);Hl.displayName="Atlas";var ql,Vl=Ct.createContext(null);if(Vl.displayName="Bounds","object"==typeof performance&&"function"==typeof performance.now){let e=performance;ql=()=>e.now()}else{let e=Date,t=e.now();ql=()=>e.now()-t}var Ql={exports:{}},Yl={};function Gl(e,t){e&&e.appendChild&&t&&e.appendChild(t)}function Kl(e,t){e&&e.removeChild&&t&&e.removeChild(t)}function Xl(e,t,i){e&&e instanceof Xs&&(e=e.world),e&&e.insertBefore&&e.insertBefore(t,i)}function Zl(e,t,i){if(i&&(e.applyProps&&e.applyProps(i),e instanceof ni))for(let r of Vt){let n=r.slice(2).toLowerCase();i[r]!==t[r]&&(t[r]&&e.removeEventListener(n,t[r]),e.addEventListener(n,i[r]))}}function Jl(e,t){let i=Object.keys(t),r=!1;for(let t of i)if(-1!==Vt.indexOf(t)){let i=Qt[t];if(i){if(-1!==e.activatedEvents.indexOf(i))continue;r=!0,e.activatedEvents.push(i)}}r&&e.triggerEventActivation()}Yl.ConcurrentRoot=1,Yl.ContinuousEventPriority=4,Yl.DefaultEventPriority=16,Yl.DiscreteEventPriority=1,Yl.IdleEventPriority=536870912,Yl.LegacyRoot=0,Ql.exports=Yl;var eu=new Map,tu={};var iu=(0,qt.default)({unstable_now:ql,now:ql,createInstance:function(e,t,i,r,n){var a=t,{args:o=[]}=a,s=g(a,["args"]);if(!(i instanceof Xs)&&n){let e=t=>t.return?e(t.return):t.stateNode&&t.stateNode.containerInfo;i=e(n)}let l,u=i.world;switch(e){case"world":l=Os.withProps({width:s.width,height:s.height,viewingDirection:"left-to-right"}),l.activatedEvents=u.activatedEvents,l.eventHandlers=u.eventHandlers,l.subscriptions=u.subscriptions,l.triggerEventActivation(),u=l;break;case"box":l=new Ms;break;case"shape":l=new Ns;break;case"worldObject":case"world-object":l=new Ps;break;case"worldImage":case"world-image":l=new ai;break;case"texture":l=new oi;break;case"compositeImage":case"composite-image":l=new hs({id:s.id,width:s.width,height:s.height,images:[],renderOptions:s.renderOptions});break;case"tiledImage":case"tiled-image":l=us.fromTile(s.uri,s.display,s.tile,s.scaleFactor,void 0,s.format);break;case"paragraph":l=new js,l.text=s.children;break;default:return}return Jl(u,s),Zl(l,{},s),l},removeChild:Kl,appendChild:Gl,appendInitialChild:Gl,insertBefore:Xl,warnsIfNotActing:!0,supportsMutation:!0,isPrimaryRenderer:!1,scheduleTimeout:typeof setTimeout<"u"?setTimeout:void 0,cancelTimeout:typeof clearTimeout<"u"?clearTimeout:void 0,setTimeout:typeof setTimeout<"u"?setTimeout:void 0,clearTimeout:typeof clearTimeout<"u"?clearTimeout:void 0,noTimeout:-1,appendChildToContainer:function(e,t){if(t instanceof Os)e.world=t;else if(t instanceof Ps)e.world.appendChild(t);else if(t)throw new Error("Invalid root")},removeChildFromContainer:function(e,t){return Kl(e.world,t)},createTextInstance(){},insertInContainerBefore:function(e,t,i){return Xl(e.world,t,i)},prepareUpdate:(e,t,i,r,n)=>(Jl(n.world,r),r),commitUpdate(e,t,i,r,n,a){e.applyProps&&t&&Zl(e,r,t)},finalizeInitialChildren:e=>null==e?void 0:e.__handlers,getChildHostContext:()=>tu,getRootHostContext:()=>tu,prepareForCommit:e=>(e.isCommitting=!0,null),preparePortalMount(){},hideInstance(e){e&&e.points&&(e.points[0]=0)},unhideInstance(e,t){e&&e.points&&(e.points[0]=1)},getPublicInstance:e=>e,hideTextInstance(){throw new Error("Text is not allowed in the react-three-fibre tree. You may have extraneous whitespace between components.")},resetAfterCommit(e){e.isCommitting=!1,e.pendingUpdate=!0,e.world&&e.world.needsRecalculate&&(e.world.recalculateWorldSize(),e.world.triggerRepaint())},shouldSetTextContent:()=>!1,clearContainer:()=>!1,supportsHydration:!1,supportsPersistence:!1,detachDeletedInstance(e){},afterActiveInstanceBlur(){},beforeActiveInstanceBlur(){},getCurrentEventPriority:()=>(console.log("getCurrentEventPriority"),Ql.exports.DefaultEventPriority),getInstanceFromNode(e){throw console.log("getInstanceFromNode",e),new Error("Not implemented")},getInstanceFromScope(e){throw console.log("getInstanceFromScope",e),new Error("Not implemented")},prepareScopeUpdate(e,t){throw console.log("prepareScopeUpdate",e,t),new Error("Not implemented")},logRecoverableError(){},requestPostPaintCallback(){}});function ru(e,t){let i=eu.get(e);i&&iu.updateContainer(null,i,null,(()=>{eu.delete(e),t&&t(e)}))}iu.injectIntoDevTools({bundleType:0,version:_t,rendererPackageName:"@atlas-viewer/atlas"});var nu={render(e,t){let i=eu.get(t);if(i)iu.updateContainer(e,i,null);else{let i=iu.createContainer(t,0,null,!1,null,"",(()=>{}),null);iu.updateContainer(e,i,null),eu.set(t,i)}},unmountComponentAtNode(e,t){ru(e,t)}},au=typeof window<"u"&&((null==(Wt=window.document)?void 0:Wt.createElement)||"ReactNative"===(null==(Ht=window.navigator)?void 0:Ht.product))?he:ce,ou=Ct.memo((({children:e,setIsReady:t,onCreated:i,bounds:r,preset:n,mode:a="explore"})=>{let o=ge((function(e){let r=de(!1),a=()=>{t(!0)};return ce((()=>{if(!n||r.current)return()=>{};{n.runtime.goHome();let e=i&&i(n);e&&e.then?e.then(a):a()}}),[]),ce((()=>{r.current=!0}),[]),e.children}),[n]);return au((()=>{if(n){let t=n.runtime;a!==t.mode&&(t.mode=a),nu.render(Ct.createElement(Ct.StrictMode,null,Ct.createElement(o,null,Ct.createElement(Vl.Provider,{value:r},Ct.createElement(Fl.Provider,{value:a},Ct.createElement(Hl.Provider,{value:n},e))))),t)}}),[n,a,e]),au((()=>{if(n){let e=n.runtime;return()=>{nu.unmountComponentAtNode(e)}}return()=>{}}),[n]),null})),su=class{constructor(e,t){this.fragmentShaderSource="\n    precision mediump float;\n\n    uniform sampler2D u_image;\n    varying vec2 v_texCoord;\n\n    void main() {\n        gl_FragColor = texture2D(u_image, v_texCoord);\n    }\n  ",this.vertexShaderSource="\n    attribute vec2 a_position;\n    uniform vec2 u_resolution;\n    varying vec4 v_color;\n    uniform sampler2D u_texture;\n\n    attribute vec2 a_texCoord;\n    varying vec2 v_texCoord;\n\n    void main() {\n\n        // convert the position from pixels to 0.0 to 1.0\n        vec2 zeroToOne = a_position / u_resolution;\n\n        // convert from 0->1 to 0->2\n        vec2 zeroToTwo = zeroToOne * 2.0;\n\n        // convert from 0->2 to -1->+1 (clip space)\n        vec2 clipSpace = zeroToTwo - 1.0;\n\n        gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n        \n        v_texCoord = a_texCoord;\n    }\n  ",this.lastResize=0,this.lastKnownScale=1,this.canvas=e,this.rendererPosition=e.getBoundingClientRect(),this.gl=e.getContext("webgl2"),this.fragmentShader=this.createShader(this.gl.FRAGMENT_SHADER,this.fragmentShaderSource),this.vertexShader=this.createShader(this.gl.VERTEX_SHADER,this.vertexShaderSource),this.program=this.createProgram(this.vertexShader,this.fragmentShader),this.dpi=(null==t?void 0:t.dpi)||1,this.attributes={position:this.gl.getAttribLocation(this.program,"a_position"),texCoord:this.gl.getAttribLocation(this.program,"a_texCoord")},this.uniforms={resolution:this.gl.getUniformLocation(this.program,"u_resolution"),texture:this.gl.getUniformLocation(this.program,"u_texture")},this.buffers={position:this.createArrayBuffer(),texCoord:this.createArrayBuffer(new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]))},this.rectBuffer=new Float32Array(12),this.resize(),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.useProgram(this.program),this.gl.enableVertexAttribArray(this.attributes.position)}resize(){this.resizeCanvasToDisplaySize(),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.rendererPosition=this.canvas.getBoundingClientRect()}isReady(){return!0}beforeFrame(e,t,i){this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.vertexAttribPointer(this.attributes.position,2,this.gl.FLOAT,!1,0,0),this.gl.uniform2f(this.uniforms.resolution,this.gl.canvas.width,this.gl.canvas.height),this.lastResize>1e3&&(this.lastResize=0,this.resizeCanvasToDisplaySize()),this.lastResize+=t}prepareLayer(e){(!e.__host||!e.__host.webgl)&&((e instanceof ai||e instanceof us)&&this.createImageHost(e),e instanceof oi&&this.createTextureHost(e))}createTextureHost(e){e.__host=e.__host?e.__host:{};let t,i=this.gl,r=this.gl.createTexture();if(i.bindTexture(i.TEXTURE_2D,r),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1),e instanceof oi){let r=e.getTexture();r.source&&i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,r.source),t=r}i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),e.__host.webgl={height:e.height,width:e.width,texture:r,lastImage:t}}createImageHost(e){let t=[...new Array(e.points.length/5)];e.__host=e.__host?e.__host:{},e.__host.webgl={height:e.height,width:e.width,textures:t,loading:[],loaded:[],lastLevelRendered:-1,onLoad:(t,i)=>{let r=this.gl,n=this.gl.createTexture();r.bindTexture(r.TEXTURE_2D,n),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.bindTexture(r.TEXTURE_2D,null),e.__host.webgl.textures[t]=n,e.__host.webgl.loaded.push(t)}}}paint(e,t,i,r,n,a){if("spacial-content"===e.type&&e.__host&&e.__host.webgl){if(e.getTexture){let t=null==e?void 0:e.getTexture();if(t&&e.__host.webgl.lastImage!==t.hash&&t.source&&!e.__host.webgl.error)try{let i=this.gl.RGBA,r=this.gl.RGBA,n=this.gl.UNSIGNED_BYTE;this.gl.bindTexture(this.gl.TEXTURE_2D,e.__host.webgl.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,i,r,n,t.source),e.__host.webgl.lastImage=t.hash}catch(t){e.__host.webgl.error=t}}if(e.__host.webgl.loading&&-1===e.__host.webgl.loading.indexOf(t)&&e.getImageUrl){e.__host.webgl.loading.push(t);let i=document.createElement("img");i.decoding="async",i.crossOrigin="anonymous",i.src=e.getImageUrl(t),i.onload=()=>(i.onload=null,e.__host.webgl.onLoad(t,i))}let o=e.__host.webgl.texture?e.__host.webgl.texture:e.__host.webgl.textures[t];o&&(this.gl.enableVertexAttribArray(this.attributes.texCoord),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffers.texCoord),this.gl.enableVertexAttribArray(this.attributes.texCoord),this.gl.vertexAttribPointer(this.attributes.texCoord,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffers.position),this.gl.enableVertexAttribArray(this.attributes.position),this.gl.vertexAttribPointer(this.attributes.position,2,this.gl.FLOAT,!1,0,0),this.gl.bindTexture(this.gl.TEXTURE_2D,o),this.gl.uniform1i(this.uniforms.texture,0),this.setRectangle(i,r,n,a),this.gl.drawArrays(this.gl.TRIANGLES,0,6))}}afterPaintLayer(e,t){}pendingUpdate(){return!0}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}afterFrame(){}getScale(e,t,i){if(Number.isNaN(e)||Number.isNaN(t))return this.lastKnownScale;let r=this.getCanvasDims(),n=r.width/e,a=r.height/t,o=(n<a?a:n)*(i&&this.dpi||1);return Number.isNaN(o)||(this.lastKnownScale=o),this.lastKnownScale}getCanvasDims(){return{width:this.canvas.width/this.dpi,height:this.canvas.height/this.dpi}}getViewportBounds(e,t,i){return null}createShader(e,t){let i=this.gl.createShader(e);if(i){if(this.gl.shaderSource(i,t),this.gl.compileShader(i),this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS))return i;let e=this.gl.getShaderInfoLog(i);if(this.gl.deleteShader(i),e)throw new Error(e)}throw new Error("Invalid shader")}createProgram(e,t){let i=this.gl.createProgram();if(i){if(this.gl.attachShader(i,e),this.gl.attachShader(i,t),this.gl.linkProgram(i),this.gl.getProgramParameter(i,this.gl.LINK_STATUS))return i;let r=this.gl.getProgramInfoLog(i);if(this.gl.deleteProgram(i),r)throw new Error(r)}throw new Error("Invalid program")}resizeCanvasToDisplaySize(){let e=this.gl.canvas,t=e.clientWidth,i=e.clientHeight,r=e.width!==t||e.height!==i;return r&&(e.width=t,e.height=i),r}createArrayBuffer(e){let t=this.gl.createBuffer();if(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),e&&this.gl.bufferData(this.gl.ARRAY_BUFFER,e,this.gl.STATIC_DRAW),!t)throw new Error("Cannot create buffer");return t}setRectangle(e,t,i,r){this.gl.bufferData(this.gl.ARRAY_BUFFER,this.getRectangle(e,t,i,r),this.gl.STATIC_DRAW)}getRectangle(e,t,i,r){let n=e,a=e+i,o=t,s=t+r;return this.rectBuffer.set([n,o,a,o,n,s,n,s,a,o,a,s]),this.rectBuffer}getRendererScreenPosition(){return this.rendererPosition}finishLayer(){}reset(){}};function lu(e,t){let i=t?e:JSON.stringify(e),r=5381,n=i.length;for(;n;)r=33*r^i.charCodeAt(--n);let a=(r>>>0).toString(16);return a.length%2?"0"+a:a}var uu=class{constructor(e){this.sheetPrefix=(null==e?void 0:e.sheetPrefix)||"a-",this.$element=document.createElement("style"),this.stylesheetClasses=[],this.activeStylesheetClasses=[],this.sheetsDidUpdate=!1,this.stylesheetEntries={}}getElement(){return this.$element}addStylesheet(e){let t=e.replace(/\s\s+/g," ").replace(/: /g,":").replace(/; /g,";").trim(),i=this.sheetPrefix+lu(t,!0);return-1!==this.stylesheetClasses.indexOf(i)||(this.stylesheetClasses.push(i),this.activeStylesheetClasses.push(i),this.stylesheetEntries[i]=t,this.sheetsDidUpdate=!0),i}removeStylesheet(e){let t=this.sheetPrefix+lu(e,!0);this.stylesheetClasses.indexOf(t)&&(this.stylesheetClasses=this.stylesheetClasses.filter((e=>e!==t))),this.sheetsDidUpdate=!0}clearClasses(){this.activeStylesheetClasses=[]}didUpdateActive(){if(this.activeStylesheetClasses.length){for(let e of this.activeStylesheetClasses)if(-1===this.stylesheetClasses.indexOf(e))return!0;for(let e of this.stylesheetClasses)if(-1===this.activeStylesheetClasses.indexOf(e))return!0}return!1}updateSheet(){(this.sheetsDidUpdate||this.didUpdateActive())&&(this.$element.innerText=this.activeStylesheetClasses.map((e=>`.${e}{${this.stylesheetEntries[e]}}`)).join(""),this.sheetsDidUpdate=!1,this.stylesheetClasses=[...this.activeStylesheetClasses])}},cu=class{constructor(e,t){this.visible=[],this.previousVisible=[],this.htmlIds=[],this.firstMeaningfulPaint=!1,this.paintTx=1,this.zIndex=0,this.htmlContainer=e,this.htmlContainer.innerHTML="",this.rendererPosition=this.htmlContainer.getBoundingClientRect(),this.options=d({triggerResize:()=>{},box:!1,text:!1,sheetPrefix:"",inlineStyles:!1,background:""},t||{}),this.stylesheet=new uu({sheetPrefix:this.options.sheetPrefix}),this.options.inlineStyles||this.htmlContainer.appendChild(this.stylesheet.getElement()),this.options.background&&this.htmlContainer.classList.add(this.stylesheet.addStylesheet(`\n        background: ${this.options.background};\n      `)),this.classes={hostClassName:this.stylesheet.addStylesheet("\n        position: absolute;\n        transform-origin: 0px 0px;\n      "),interactive:this.stylesheet.addStylesheet("pointer-events: all"),nonInteractive:this.stylesheet.addStylesheet("pointer-events: none")},this.stylesheet.updateSheet()}createHtmlHost(e){if(this.htmlContainer&&(this.options.box||e.props.className||e.props.html||e.props.href)){let t=document.createElement(e.props.href?"a":"div");if(e.props.href){t.style.display="block",t.href=e.props.href;let i=e.props.hrefTarget||"_blank";t.target=i,"_self"!==i&&(t.rel="noopener noreferrer")}t.title=e.props.title||"",this.options.inlineStyles?(t.style.display="block",t.style.position="absolute",t.style.overflow="hidden",t.style.transformOrigin="0px 0px"):t.classList.add(this.classes.hostClassName),e.__host={element:t,revision:null,relative:!1},this.updateHtmlHost(e,e.width,e.height),e.__onCreate&&e.__onCreate()}}triggerResize(){this.options.triggerResize()}updateHtmlHost(e,t,i){if(e.__revision!==e.__host.revision){let r=e.__host.element,n=[this.classes.hostClassName];if(e.props.interactive?this.options.inlineStyles?r.style.pointerEvents="all":n.push(this.classes.interactive):this.options.inlineStyles?r.style.pointerEvents="none":n.push(this.classes.nonInteractive),e.props.href){r.style.display="block",r.href=e.props.href;let t=e.props.hrefTarget||"_blank";r.target=t,r.rel="_self"!==t?"noopener noreferrer":""}else r.href&&r.removeAttribute("href");if(e.props.title&&(r.title=e.props.title||""),e.props.className&&(n.push(e.props.className),e.hovering&&n.push(`${e.props.className}--hover`),e.pressing&&n.push(`${e.props.className}--active`)),e.props.relativeStyle?(r.style.width=`${t||e.width}px`,r.style.height=`${i||e.height}px`):(r.style.width=`${e.width}px`,r.style.height=`${e.height}px`),e.props.style)return void Object.assign(r.style,e.props.style||{},e.hovering&&e.props.hoverStyles||{},e.pressing&&e.props.pressStyles||{});if(this.options.text&&e instanceof js){e.text&&(r.innerText=e.text),e.backgroundColor&&(r.style.backgroundColor=e.backgroundColor),e.color&&(r.style.color=e.color),e.props.font&&(r.style.font=e.props.font),e.props.textAlign&&(r.style.textAlign=e.props.textAlign),e.__host.revision=e.__revision;let t=n.join(" ");r.className=t,r.part=t}e instanceof Ms&&(this.options.box||e.props.className||e.props.html)&&(e.props.backgroundColor&&(r.style.backgroundColor=e.props.backgroundColor),e.props.border!==r.style.border&&(r.style.border=e.props.border));let a=n.join(" ");r.className=a,r.part=a}}afterFrame(e,t,i){this.stylesheet.updateSheet();for(let e of this.previousVisible)-1===this.visible.indexOf(e)&&this.htmlContainer&&e.__id&&-1!==this.htmlIds.indexOf(e.__id)&&this.htmlContainer.removeChild(e.__host.element);this.previousVisible=this.visible}afterPaintLayer(e,t){}beforeFrame(e,t,i){this.stylesheet.clearClasses(),this.paintTx++,this.zIndex=0,this.visible=[]}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}getScale(e,t){let i=this.rendererPosition.width/e,r=this.rendererPosition.height/t;return i<r?r:i}getViewportBounds(e,t,i){return null}isReady(){return!1}paint(e,t,i,r,n,a){if(this.zIndex++,(this.options.text&&e instanceof js||e instanceof Ms&&(this.options.box||e.props.className||e.props.html))&&e.__host.tx!==this.paintTx&&(this.visible.push(e),e.__host.tx=this.paintTx,this.htmlContainer)){this.updateHtmlHost(e,n,a);let t=n/e.width,o=e.__host.element;o.style.zIndex=`${this.zIndex}`,e.props.relativeStyle?o.style.transform=`translate(${Math.round(i)}px, ${Math.round(r)}px)`:o.style.transform=`translate(${Math.round(i)}px, ${Math.round(r)}px) scale(${t})`,-1===this.previousVisible.indexOf(e)&&this.htmlContainer.appendChild(o),-1===this.htmlIds.indexOf(e.__id)&&this.htmlIds.push(e.__id)}}pendingUpdate(){return!1}prepareLayer(e){e.__host||(e instanceof js||e instanceof Ms)&&this.createHtmlHost(e)}resize(e,t){typeof e<"u"&&typeof t<"u"&&(this.htmlContainer.style.width=`${e}px`,this.htmlContainer.style.height=`${t}px`),this.rendererPosition=this.htmlContainer.getBoundingClientRect()}getRendererScreenPosition(){return this.rendererPosition}finishLayer(){}reset(){}},hu=class{constructor(e,t,i){this.activatedEvents=[],this.eventHandlers=[],this.pointerMoveEvent=void 0,this.pointerEventState={isClicking:!1,isDragging:!1,isPressed:!1,mousedOver:[],itemsBeingDragged:[],mouseDownStart:{x:0,y:0},lastTouches:[]},this._realPointerMove=e=>{this.pointerMoveEvent=e},this.onWheelEvent=e=>{e.preventDefault(),this.onPointerEvent(e)},this.onTouchEvent=e=>{let t=Qt[e.type],i=[],r=e.touches.length;for(let t=0;t<r;t++){let r=e.touches.item(t);if(!r)continue;let{x:n,y:a}=this.runtime.viewerToWorld(r.clientX-this.bounds.left,r.clientY-this.bounds.top),o={id:r.identifier,x:n,y:a};i.push(o)}i.length&&this.assignToEvent(e,i[0].x,i[0].y),"onTouchEnd"!==t?(this.pointerEventState.lastTouches=i,e.atlasTouches=i,this.runtime.world.propagateTouchEvent(t,e,i)):(e.atlasTouches=[],this.runtime.world.propagateTouchEvent(t,e,this.pointerEventState.lastTouches),this.pointerEventState.lastTouches=[])},this.onPointerEvent=e=>{let t=Qt[e.type];if(t&&-1!==this.runtime.world.activatedEvents.indexOf(t)){let{x:i,y:r}=this.runtime.viewerToWorld(e.clientX-this.bounds.left,e.clientY-this.bounds.top);this.assignToEvent(e,i,r),this.runtime.world.propagatePointerEvent(t,e,i,r)}},this.onPointerDown=e=>{this.pointerEventState.isPressed=!0,this.pointerEventState.isClicking=!0,this.pointerEventState.mouseDownStart.x=e.clientX,this.pointerEventState.mouseDownStart.y=e.clientY,setTimeout((()=>{this.runtime&&(this.pointerEventState.isClicking=!1)}),250),setTimeout((()=>{if(this.runtime&&this.pointerEventState.isPressed&&!this.pointerEventState.isDragging){let t=this.runtime.viewerToWorld(this.pointerEventState.mouseDownStart.x-this.bounds.left,this.pointerEventState.mouseDownStart.y-this.bounds.top);this.pointerEventState.isDragging=!0,this.pointerEventState.itemsBeingDragged=this.runtime.world.propagatePointerEvent("onDragStart",e,t.x,t.y)}}),800),this.onPointerEvent(e)},this.onPointerUp=e=>{if(this.pointerEventState.isClicking){let{x:t,y:i}=this.runtime.viewerToWorld(e.clientX-this.bounds.left,e.clientY-this.bounds.top);this.assignToEvent(e,t,i),this.runtime.world.propagatePointerEvent("onClick",e,t,i)}if(this.pointerEventState.isDragging){for(let t of this.pointerEventState.itemsBeingDragged)t.dispatchEvent("onDragEnd",e);this.pointerEventState.isDragging=!1}this.pointerEventState.isClicking=!1,this.pointerEventState.isPressed=!1,this.pointerEventState.itemsBeingDragged=[],this.onPointerEvent(e)},this.onPointerMove=e=>{this.pointerMoveEvent=void 0;let{x:t,y:i}=this.runtime.viewerToWorld(e.clientX-this.bounds.left,e.clientY-this.bounds.top);if(Number.isNaN(t)||Number.isNaN(i))return;this.assignToEvent(e,t,i),this.runtime.world.propagatePointerEvent("onPointerMove",e,t,i);let r=this.runtime.world.propagatePointerEvent("onMouseMove",e,t,i),n=[],a=[];for(let t of r)n.push(t.id),a.push(t),-1===this.pointerEventState.mousedOver.indexOf(t)&&(t.dispatchEvent("onMouseEnter",e),t.dispatchEvent("onPointerEnter",e),t.dispatchEvent("onMouseOver",e),t.dispatchEvent("onPointerOver",e));for(let t of this.pointerEventState.mousedOver)-1===n.indexOf(t.id)&&(t.dispatchEvent("onMouseLeave",e),t.dispatchEvent("onPointerLeave",e),t.dispatchEvent("onMouseOut",e),t.dispatchEvent("onPointerOut",e));if(this.pointerEventState.isDragging)for(let t of this.pointerEventState.itemsBeingDragged)t.dispatchEvent("onDrag",e);if(this.pointerEventState.isPressed&&!this.pointerEventState.isDragging&&li(this.pointerEventState.mouseDownStart,{x:e.clientX,y:e.clientY})>50){let t=this.runtime.viewerToWorld(this.pointerEventState.mouseDownStart.x-this.bounds.left,this.pointerEventState.mouseDownStart.y-this.bounds.top);this.pointerEventState.isDragging=!0,this.pointerEventState.itemsBeingDragged=this.runtime.world.propagatePointerEvent("onDragStart",p(d({},e),{atlas:{x:t.x,y:t.y}}),t.x,t.y)}this.pointerEventState.mousedOver=a},this.element=e,this.runtime=t,this.unsubscribe=t.world.addLayoutSubscriber(this.layoutSubscriber.bind(this)),this.bounds=e.getBoundingClientRect(),this.listening=!1,this.options=d({simulationRate:0},i||{});let r=0;t.registerHook("useFrame",(e=>{r+=e,r>this.options.simulationRate&&this.pointerMoveEvent&&(r=0,t.updateNextFrame())})),t.registerHook("useBeforeFrame",(()=>{this.pointerMoveEvent&&this.onPointerMove(this.pointerMoveEvent)})),this.activateEvents()}updateBounds(){this.bounds=this.element.getBoundingClientRect(),this.runtime.updateRendererScreenPosition()}layoutSubscriber(e){"event-activation"===e&&0==this.listening&&this.activateEvents()}assignToEvent(e,t,i){hu.eventPool.atlas.x=t,hu.eventPool.atlas.y=i,e.atlas=hu.eventPool.atlas}activateEvents(){this.listening=!0,this.element.addEventListener("pointermove",this._realPointerMove),this.element.addEventListener("pointerup",this.onPointerUp),this.element.addEventListener("pointerdown",this.onPointerDown),this.element.addEventListener("mousedown",this.onPointerEvent),this.element.addEventListener("mouseup",this.onPointerEvent),this.element.addEventListener("pointercancel",this.onPointerEvent),this.element.addEventListener("wheel",this.onWheelEvent),this.element.addEventListener("touchstart",this.onTouchEvent),this.element.addEventListener("touchcancel",this.onTouchEvent),this.element.addEventListener("touchend",this.onTouchEvent),this.element.addEventListener("touchmove",this.onTouchEvent)}normalizeEventName(e){return e.startsWith("on")?e.slice(2).toLowerCase():e.toLowerCase()}stop(){this.listening=!1,this.element.removeEventListener("pointermove",this._realPointerMove),this.element.removeEventListener("pointerup",this.onPointerUp),this.element.removeEventListener("pointerdown",this.onPointerDown),this.element.removeEventListener("mousedown",this.onPointerEvent),this.element.removeEventListener("mouseup",this.onPointerEvent),this.element.removeEventListener("pointercancel",this.onPointerEvent),this.element.removeEventListener("wheel",this.onWheelEvent),this.element.removeEventListener("touchstart",this.onTouchEvent),this.element.removeEventListener("touchcancel",this.onTouchEvent),this.element.removeEventListener("touchend",this.onTouchEvent),this.element.removeEventListener("touchmove",this.onTouchEvent),this.unsubscribe();for(let[e,t]of this.eventHandlers)this.element.removeEventListener(this.normalizeEventName(e),t)}},du=hu;function pu({interactive:e=!0,viewport:t,forceRefresh:i,canvasElement:r,overlayElement:n,controllerConfig:a,unstable_webglRenderer:o,dpi:s,debug:l,canvasBox:u=!0,polygon:c=!0,navigatorElement:h,background:p,runtimeOptions:f}){if(!r)throw new Error("Invalid container");r.style.userSelect="none";let g=e?Ll(d({minZoomFactor:.5,maxZoomFactor:3,enableClickToZoom:!1,parentElement:r},a||{})):void 0,m=new bl([o?new su(r,{dpi:s}):new yl(r,{dpi:s,debug:l,box:u,polygon:c,background:p}),n?new cu(n,{box:o||!u,text:!0,triggerResize:i}):void 0,h?new wl(h):void 0]),v=new Xs(m,new Os(1024,1024),t,g?[g]:[],f),y=new du(r,v);return{name:"default-preset",em:y,runtime:v,renderer:m,controller:g,canvas:r,navigator:h,unmount(){ru(v),v.stopControllers(),v.stop(),v.reset(),y&&y.stop()}}}du.eventPool={atlas:{x:0,y:0}};var fu=1+Number.MIN_VALUE;var gu={"default-preset":pu,"static-preset":function({interactive:e,viewport:t,forceRefresh:i,containerElement:r,overlayElement:n,controllerConfig:a,background:o}){if(!r)throw new Error("Invalid container");r.style.userSelect="none";let s=e?Ll(d({minZoomFactor:.5,maxZoomFactor:3,enableClickToZoom:!1,parentElement:r},a||{})):void 0,l=new class{constructor(e,t){this.pending=!0,this.zIndex=0,this.lastKnownScale=1,this.currentlyVisible=[],this.previouslyVisible=[],this.container=e,this.rendererPosition=e.getBoundingClientRect();let{width:i,height:r}=this.rendererPosition;this.width=i,this.height=r,this.options=d({addPart:!1,setDraggableFalse:!1,imageClass:"",widthStylesheet:!1,sheetPrefix:"position-",background:"#000"},t||{}),this.stylesheet=new uu({sheetPrefix:this.options.sheetPrefix}),this.container.classList.add(this.stylesheet.addStylesheet(`\n        background: ${this.options.background};\n      `)),this.options.widthStylesheet&&this.container.appendChild(this.stylesheet.getElement())}isReady(){return!0}resize(){this.rendererPosition=this.container.getBoundingClientRect(),this.width=this.rendererPosition.width,this.height=this.rendererPosition.height}getRendererScreenPosition(){return this.rendererPosition}afterFrame(e,t,i){this.stylesheet.updateSheet();for(let e of this.previouslyVisible)-1===this.currentlyVisible.indexOf(e)&&this.container.removeChild(e);for(let e of this.currentlyVisible)-1===this.previouslyVisible.indexOf(e)&&this.container.appendChild(e);this.previouslyVisible=this.currentlyVisible,this.currentlyVisible=[]}afterPaintLayer(e,t){}beforeFrame(e,t,i){this.stylesheet.clearClasses(),this.zIndex=0}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}getScale(e,t){if(Number.isNaN(e)||Number.isNaN(t))return this.lastKnownScale;let i=this.width/e,r=this.height/t,n=i<r?r:i;return Number.isNaN(n)||(this.lastKnownScale=n),this.lastKnownScale}getViewportBounds(e,t,i){return null}createImage(){let e=document.createElement("img");return this.options.imageClass?(e.className=this.options.imageClass,this.options.addPart&&e.setAttribute("part",this.options.imageClass)):(e.style.position="absolute",e.style.pointerEvents="none",e.style.userSelect="none"),this.options.setDraggableFalse&&e.setAttribute("draggable","false"),e}paint(e,t,i,r,n,a){if(this.pending=!1,this.zIndex++,e instanceof ai){if(!e.__host){let t=this.createImage();t.src=e.uri,e.__host=t,this.container.appendChild(e.__host)}let t=e.__host;this.currentlyVisible.push(t),t.style.zIndex=`${this.zIndex}`,t.style.opacity=`${e.style.opacity}`,this.options.widthStylesheet?t.className=this.options.imageClass+" "+this.stylesheet.addStylesheet(`width:${(n+fu).toFixed(2)}px;height:${(a+fu).toFixed(2)}px;`):(t.style.width=`${n+fu}px`,t.style.height=`${a+fu}px`),t.style.transform=`translate(${i}px, ${r}px)`}if(e instanceof us){if(e.__host||(e.__host={images:[]}),!e.__host.images[t]){let i=e.getImageUrl(t),r=this.createImage();r.src=i,e.__host.images[t]=r,this.container.appendChild(r)}let o=e.__host.images[t];o.style.zIndex=`${this.zIndex}`,o.style.opacity=`${e.style.opacity}`,this.currentlyVisible.push(o),this.options.widthStylesheet?o.className=this.options.imageClass+" "+this.stylesheet.addStylesheet(`width:${(n+fu).toFixed(2)}px;height:${(a+fu).toFixed(2)}px;`):(o.style.width=`${n+fu}px`,o.style.height=`${a+fu}px`),o.style.transform=`translate(${i}px, ${r}px)`}}pendingUpdate(){return this.pending}prepareLayer(e){}finishLayer(e){}reset(){}}(r,{addPart:!1,setDraggableFalse:!1,imageClass:"atlas-static-image",background:o}),u=n?new bl([l,new cu(n,{box:!0,text:!0,triggerResize:i})]):l,c=new Xs(u,new Os(1024,1024),t,s?[s]:[]),h=new du(r,c);return{name:"static-preset",em:h,runtime:c,renderer:u,controller:s,container:r,overlay:n,unmount(){ru(c),c.stopControllers(),c.stop(),h&&h.stop()}}}},mu={};var vu=Ct.forwardRef(((e,t)=>Ct.createElement("div",p(d({},e),{ref:t,part:e.className})))),yu=["brightness","contrast","grayscale","hueRotate","invert","saturate","sepia","blur"],bu=e=>{var t=e,{htmlChildren:i,renderPreset:r,onCreated:n,mode:a="explore",resetWorldOnChange:o=!0,unstable_webglRenderer:s=!1,unstable_noReconciler:l=!1,hideInlineStyle:u=!1,controllerConfig:c,children:h,overlayStyle:f,containerStyle:m,enableNavigator:v,className:y,containerProps:b={},homePosition:w,homeOnResize:x,homeCover:_,background:S,runtimeOptions:E,debug:k,filters:C}=t,A=g(t,["htmlChildren","renderPreset","onCreated","mode","resetWorldOnChange","unstable_webglRenderer","unstable_noReconciler","hideInlineStyle","controllerConfig","children","overlayStyle","containerStyle","enableNavigator","className","containerProps","homePosition","homeOnResize","homeCover","background","runtimeOptions","debug","filters"]);let[P,O]=le(S),[T,R]=le(a),[I,M]=le(!1),z=de(!1),[L,F]=le(0),N=fe((()=>("string"==typeof r&&(r=[r,{}]),P||k?r?[r[0],d({debug:k,background:P},r[1]||{})]:["default-preset",{background:P,debug:k}]:r||"default-preset")),[r,P,k]),[j,$,B]=Bl({scroll:!0}),D=de(),[U,W,H,q]=function(e,t){let i=de(),r=de(),n=de(),a=de(),o=de({width:t.width,height:t.height,didUpdate:!0}),[s="default-preset",l=mu]=Array.isArray(e)?e||[]:[e],[u,c]=le(null);he((()=>{let e=r.current,u=a.current,h=i.current,p=n.current,f=(gu[s]||pu)(d({containerElement:u,canvasElement:e,overlayElement:h,navigatorElement:p,viewport:o.current,dpi:window.devicePixelRatio||1,forceRefresh:t.forceRefresh,unstable_webglRenderer:t.unstable_webglRenderer},l||{}));return c(f),()=>{f&&(f.unmount(),e&&(e.height=0,e.width=0),h&&(h.innerHTML=""),p&&(p.height=0,p.width=0))}}),[s,l]);let h=fe((()=>({canvas:r,overlay:i,container:a,navigator:n})),[]);return[s,u,o,h]}(N,{width:A.width,height:A.height,forceRefresh:B,unstable_webglRenderer:s}),[V,Q]=le("");ce((()=>{R(a)}),[a]),ce((()=>{W&&W.em&&W.em.updateBounds()}),[W,$]),ce((()=>{null==W||W.runtime.setOptions(E||{})}),[E]),ce((()=>{W&&W.runtime&&(W.runtime.mode=T),I&&W&&(W.ready=!0)}),[W,I,T]),ce((()=>{W&&(_||(W.runtime.manualHomePosition=!!w,W.runtime.setHomePosition(w)))}),[W,_,w]),ce((()=>{if(W){let e=W.runtime;e.resize(H.current.width,A.width,H.current.height,A.height),H.current.width=A.width,H.current.height=A.height,e.updateNextFrame(),H.current.didUpdate=!0}}),[W,A.width,A.height]),ce((()=>{if(C&&W){let e=W.runtime,t=!1;e.hookOptions.enableFilters=!0;for(let i of yu)C[i]?C[i]!==W.runtime.hookOptions.filters[i]&&(e.hookOptions.filters[i]=C[i],t=!0):e.hookOptions.filters[i]&&(e.hookOptions.filters[i]=0,t=!0);t&&e.updateNextFrame()}else if(W){let e=W.runtime;for(let t of yu)e.hookOptions.filters[t]=0;e.hookOptions.enableFilters=!1,e.updateNextFrame()}}),[W,C]),au((()=>{if(W&&(W.overlay&&(W.overlay.style.width=`${$.width}px`,W.overlay.style.height=`${$.height}px`),W.container&&(W.container.style.width=`${$.width}px`,W.container.style.height=`${$.height}px`),_)){let e=W.runtime.world.width,t=W.runtime.world.height,i=e/t,r=H.current.width,n=H.current.height,a=r/n;if(i>a){a=n/r,W.runtime.manualHomePosition=!0;let i=(e-t/a)/2;"start"===_&&(i=0),"end"===_&&(i=e-t/a),W.runtime.setHomePosition({x:i,y:0,width:t/a,height:t})}else{let i=(t-e/a)/2;"start"===_&&(i=0),"end"===_&&(i=t-e/a),W.runtime.manualHomePosition=!0,W.runtime.setHomePosition({x:0,y:i,width:e,height:e/a})}x&&W.runtime.goHome({})}}),[W,$.height,$.width,_,L]),au((()=>{let e=()=>{if(W){let e=W.runtime;H.current.width!==A.width&&H.current.height!==A.height&&(e.resize(H.current.width,A.width,H.current.height,A.height),H.current.width=A.width,H.current.height=A.height,e.updateNextFrame(),H.current.didUpdate=!0)}};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[W,A.height,A.width]);let Y=120,G=()=>{if(W&&W.navigator){let e=W.runtime.world.height,t=W.runtime.world.width,i=window.devicePixelRatio||1,r=Y,n=Y/t*e;W.navigator.width=r*i,W.navigator.height=n*i,W.navigator.style.width=r+"px",W.navigator.style.height=n+"px"}};au((()=>{if(W){G();let e=W.runtime;return e.world.addLayoutSubscriber((t=>{"recalculate-world-size"===t&&(G(),e.resize(H.current.width,A.width,H.current.height,A.height),F((e=>e+1)))}))}return()=>{}}),[W,A.width,A.height]);let K=ge((function(e){let t=()=>{M(!0)};return ce((()=>{if(!W)throw new Error("Invalid configuration - no runtime found");{W.runtime.goHome();let e=n&&n(W);e&&e.then?e.then(t):t()}}),[]),e.children}),[W]);ce((()=>{if(W){let e=W.runtime;if(o)return e.world.addLayoutSubscriber((t=>{"recalculate-world-size"===t&&e.goHome()}))}return()=>{}}),[W,o]),ce((()=>W?W.runtime.registerHook("useBeforeFrame",(()=>{var e;if(H.current.didUpdate&&W.canvas){let t=window.devicePixelRatio||1,i=H.current.width,r=H.current.height;W.canvas.width=i*t,W.canvas.height=r*t,W.canvas.style.width=i+"px",W.canvas.style.height=r+"px",null==(e=W.canvas.getContext("2d"))||e.scale(t,t),W&&W.em&&W.em.updateBounds(),H.current.didUpdate=!1}})):()=>{}),[W,o]),ce((()=>{let e=()=>{W&&(R("sketch"),Q("mode-sketch")),window.removeEventListener("keyup",e)},t=t=>{if("Space"===t.code&&W&&"sketch"===W.runtime.mode){if(t.target&&t.target.tagName&&"input"===t.target.tagName.toLowerCase())return;t.preventDefault(),R("explore"),Q("mode-explore"),window.addEventListener("keyup",e)}};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t),window.removeEventListener("keyup",e)}}),[W]),au((()=>{if(D.current&&!P){let e=getComputedStyle(D.current).getPropertyValue("--atlas-background");e&&O(e)}}),[P]),z.current=!0;let X=A,{height:Z,width:J}=X,ee=g(X,["height","width"]),te=function(e){return fe((()=>lu(e)),e)}([A.width,A.height]);return Ct.createElement(vu,{ref:e=>{D.current=e,j(e)},className:["atlas",u?"":`atlas-width-${te}`,V,y,`atlas-${U}`].filter(Boolean).join(" ").trim(),style:d(d({},m),u?{}:{width:A.width,height:A.height})},"static-preset"===U?Ct.createElement(vu,d({className:"atlas-static-container",style:W&&W.controller?void 0:{pointerEvents:"none"},ref:q.container,tabIndex:0},b)):Ct.createElement("canvas",p(d(d({className:"atlas-canvas",part:"atlas-canvas",tabIndex:0},ee),b),{ref:q.canvas})),Ct.createElement(vu,{className:"atlas-overlay",style:d({},f||{}),ref:q.overlay},l?Ct.createElement(K,null,Ct.createElement(Vl.Provider,{value:$},Ct.createElement(Fl.Provider,{value:T},Ct.createElement(Hl.Provider,{value:W},h)))):Ct.createElement(ou,{bounds:$,preset:W,mode:T,setIsReady:M,onCreated:n},h)),v?Ct.createElement(vu,{className:"atlas-navigator"},Ct.createElement("canvas",{className:"atlas-navigator-canvas",part:"atlas-navigator-canvas",ref:q.navigator})):null,u?Ct.createElement("style",null,`.atlas-width-${te} { width: ${A.width}px; height: ${A.height}px; }`):Ct.createElement("style",null,`\n        .atlas { position: relative; display: flex; background: var(--atlas-background, #000); z-index: var(--atlas-z-index, 10); -webkit-touch-callout: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; }\n        .atlas-width-${te} { width: ${A.width}px; height: ${A.height}px; }\n        .atlas-canvas { flex: 1 1 0px; }\n        .atlas-canvas:focus, .atlas-static-container:focus { outline: none }\n        .atlas-canvas:focus-visible, .atlas-canvas-container:focus-visible { outline: var(--atlas-focus, 2px solid darkorange) }\n        .atlas-static-preset { touch-action: inherit; }\n        .atlas-static-container { position: relative; overflow: hidden; flex: 1 1 0px; }\n        .atlas-overlay { position: absolute; top: 0; left: 0; pointer-events: none; overflow: hidden; }\n        .atlas-static-image { position: absolute; pointer-events: none; user-select: none; transform-origin: 0px 0px; }\n        .atlas-navigator { position: absolute; top: var(--atlas-navigator-top, 10px); right: var(--atlas-navigator-bottom, 10px); left: var(--atlas-navigator-left); bottom: var(--atlas-navigator-bottom); opacity: .8 }\n        .atlas-navigator-canvas { width: 100%; }\n      `),i)};var wu=e=>{var t=e,{resizeHash:i,aspectRatio:r,containerProps:n={}}=t,a=g(t,["resizeHash","aspectRatio","containerProps"]);let[o,s,l]=Bl(),u=a,{height:c,width:h}=u,p=g(u,["height","width"]);ce((()=>{l()}),[h,c,i,l]);let f=fe((()=>r?{width:s.width,height:s.width*(1/r)}:s),[s,r]);return Ct.createElement(vu,d({ref:o,className:"atlas-container"},n),f.width?Ct.createElement(bu,d({width:f.width||100,height:f.height||100},p),a.children):null,a.hideInlineStyle?null:Ct.createElement("style",null,`\n          .atlas-container { \n            display: var(--atlas-container-display, block);\n            flex: var(--atlas-container-flex, none);\n            width: var(--atlas-container-width, ${h?`${h}px`:"100%"});\n            height: var(--atlas-container-height, ${function(e){return Number(e)==e?`${e}px`:e}(c||(r?f.height:512))})  \n          }\n      `),a.htmlChildren)},xu=()=>me(Hl),_u=()=>{let e=xu();return e?e.runtime:void 0},Su=(e,t=[])=>{let i=_u();ce((()=>i?i.registerHook("useAfterFrame",e):()=>{}),t)},Eu=(e,t=[])=>{let i=_u();ce((()=>i?i.registerHook("useFrame",e):()=>{}),t)};function ku(){return me(Vl)}var Cu=({onCreate:e})=>{let t=de({x:0,y:0}),i=(()=>{let e=xu();return e&&e.canvas?e.canvas:void 0})(),r=ku(),n=_u(),[a,o]=le(),[s,l]=le(),u=Nl();return Eu((()=>{n&&a&&!s&&(n.pendingUpdate=!0)}),[a,s]),Su((()=>{if(a&&i&&n){let e=i.getContext("2d");if(e){let{x:i,y:r,width:o,height:l}=n.worldToViewer(a.x,a.y,(s?s.x:t.current.x)-a.x,(s?s.y:t.current.y)-a.y);e.lineWidth=s?3:1,e.strokeStyle="#fff",e.strokeRect(i,r,o,l),e.lineWidth=s?3:1,e.strokeStyle="#000",e.strokeRect(i+1,r+1,o-2,l-2)}}}),[a,s]),ce((()=>{let e=e=>{if(r&&n){let{x:i,y:a}=n.viewerToWorld(e.clientX-r.left,e.clientY-r.top);t.current.x=~~i,t.current.y=~~a}};return i?(i.addEventListener("mousemove",e),()=>i.removeEventListener("mousemove",e)):()=>{}}),[r,i,n]),ce((()=>{let e=e=>{"sketch"===u&&(o({x:Math.round(t.current.x),y:Math.round(t.current.y)}),l(void 0))};return i?(i.addEventListener("mousedown",e),()=>i.removeEventListener("mousedown",e)):()=>{}}),[i,u]),ce((()=>{let e=e=>{a&&!s&&l({x:Math.round(t.current.x),y:Math.round(t.current.y)})};return i?(i.addEventListener("mouseup",e),()=>i.removeEventListener("mouseup",e)):()=>{}}),[i,a,s]),ce((()=>{a&&s&&e({x:Math.min(a.x,s.x),y:Math.min(a.y,s.y),width:Math.abs(s.x-a.x),height:Math.abs(s.y-a.y)})}),[a,e,s]),null};var Au=Ct.forwardRef(((e,t)=>{var i=e,{children:r}=i,n=g(i,["children"]);let a=de(),o=_u(),s=de(0),l=de(),u=de();return Eu((()=>{var e,t,i,r;if(n.relative){let n=a.current;if(n&&o){let u=o.getScaleFactor();s.current!==u&&(s.current=u,n.style.transformOrigin="0 0",n.style.transform=`scale(${1/s.current})`,n.style.width=100*s.current+"%",n.style.height=100*s.current+"%",a.current&&(null==(t=null==(e=l.current)?void 0:e.__owner.value)?void 0:t.rotation)&&(n.style.transform=`scale(${1/s.current}) translate(50%, 50%) rotate(${(null==(r=null==(i=l.current)?void 0:i.__owner.value)?void 0:r.rotation)||0}deg)  translate(-50%, -50%)`))}}}),[n.relative]),he((()=>{let e=l.current;async function i(){if(e&&e.__host){let t=n.relative?Ct.createElement("div",{ref:a},r):r;await async function(e,t,i){if(_t.startsWith("18.")){let r=await Promise.resolve().then((()=>b(It(),1))),n=r.default?r.default.createRoot:r.createRoot;i.current||(i.current=n(e)),i.current.render(t)}else if(typeof ReactDOM<"u"){let{render:r,unmountComponentAtNode:n}=ReactDOM;r(t,e),i.current={unmount(){n(e)}}}else{let r=await Promise.resolve().then((()=>(At(),Fe))),n=r.default?r.default.render:r.render,a=r.default?r.default.unmountComponentAtNode:r.unmountComponentAtNode;n(t,e),i.current={unmount(){a(e)}}}}(e.__host.element,t,u)}}t&&e&&("function"==typeof t?t(e):t.current=e),e&&e.__host?i():e&&(e.__onCreate=i)}),[t,r,l,n.relative]),he((()=>()=>{u.current&&setTimeout((()=>{u.current.unmount()}),0)}),[]),Ct.createElement("box",p(d({html:!0},n),{ref:l}))}));Au.displayName="HTMLPortal";var Pu=(e,t,i=[])=>{let r=_u();ce((()=>{if(r){let i=t,n=Qt[e];r.world.activatedEvents.push(n);let a=n.slice(2).toLowerCase();return r.world.addEventListener(a,i),()=>{r.world.removeEventListener(a,i)}}return()=>{}}),[r?r.world:void 0,e,...i])};function Ou(e,t){if(0===e)return[0,1];if(0===t)return[1,0];let i=Math.abs(e)/Math.abs(t);return[i,1-i]}var Tu=(e,t)=>{let i=Nl(),r=_u(),n=ku(),a=de(),o=de(null),s=de(),[l,u]=le(!1),c=de(!1),h=de({north:0,south:0,east:0,west:0}),d=function(){let e=de({ctrl:!1,shift:!1,alt:!1});return he((()=>{function t(t){"Shift"===t.key&&(e.current.shift=!0),"Control"===t.key&&(e.current.ctrl=!0),"Alt"===t.key&&(e.current.alt=!0)}function i(t){"Shift"===t.key&&(e.current.shift=!1),"Control"===t.key&&(e.current.ctrl=!1),"Alt"===t.key&&(e.current.alt=!1)}return window.addEventListener("keydown",t),window.addEventListener("keyup",i),()=>{window.removeEventListener("keydown",t),window.removeEventListener("keyup",i)}}),[]),e}(),p=ge((e=>t=>{if(c.current=!0,u(!0),n&&r){let{top:i,left:o}=n,l=r.viewerToWorld(t.pageX-o,t.pageY-i);s.current={x:l.x,y:l.y},a.current=e}}),[n,r]),f=fe((()=>e.width/e.height),[e.width,e.height]),g=ge((t=>{if(!Math.abs(t.north-t.south+(t.east-t.west)))return;let i=-t.west+t.east,r=-t.north+t.south,n=e.width+i,a=e.height+r;if(n/a>=f){let e=n-a*f,[i,r]=Ou(t.east,t.west);t.west=t.west+e*r,t.east=t.east-e*i}else{let e=a-n/f,[i,r]=Ou(t.north,t.south);t.north=t.north+e*i,t.south=t.south-e*r}}),[e.width,e.height,f]);Eu((()=>{s&&r&&r.updateNextFrame()})),ce((()=>{r&&r.updateNextFrame()}),[r,l]);let m=ge((t=>{var i;if(!r||!n||"sketch"!==r.mode)return;let{top:l,left:u}=n,c=r.viewerToWorld(t.pageX-u,t.pageY-l),p=o.current,f=!e.maintainAspectRatio&&d.current.alt,m=!f&&d.current.shift&&-1!==(null==(i=a.current)?void 0:i.indexOf("-"));if(("translate"===a.current||"east"===a.current||"north-east"===a.current||"south-east"===a.current)&&(h.current.east=c.x-(s.current?s.current.x:0),f&&(h.current.west=-h.current.east)),("translate"===a.current||"west"===a.current||"north-west"===a.current||"south-west"===a.current)&&(h.current.west=c.x-(s.current?s.current.x:0),f&&(h.current.east=-h.current.west)),("translate"===a.current||"north"===a.current||"north-east"===a.current||"north-west"===a.current)&&(h.current.north=c.y-(s.current?s.current.y:0),f&&(h.current.south=-h.current.north)),("translate"===a.current||"south"===a.current||"south-west"===a.current||"south-east"===a.current)&&(h.current.south=c.y-(s.current?s.current.y:0),f&&(h.current.north=-h.current.south)),(e.maintainAspectRatio||m)&&g(h.current),p){let t=h.current.west,i=h.current.north,n=e.width+h.current.east,a=e.height+h.current.south;p.points[1]=Math.min(t,n),p.points[2]=Math.min(i,a),p.points[3]=Math.max(t,n),p.points[4]=Math.max(i,a),r.updateNextFrame()}}),[r,e.width,e.height,e.maintainAspectRatio,n]);Pu("mousemove",m,[e.width,e.height,n]),Pu("pointermove",m,[e.width,e.height,n]);let v=de();return ce((()=>{v.current=()=>{if(c.current){let i=h.current.west,r=h.current.north,n=e.width+h.current.east,o=e.height+h.current.south,l=Math.min(i,n),d=Math.min(r,o),p=Math.max(i,n),f=Math.max(r,o),g={x:(e.x||0)+l,y:(e.y||0)+d,width:p-l||1,height:f-d||1};e.maintainAspectRatio,t(g),a.current=void 0,s.current=void 0,h.current.east=0,h.current.west=0,h.current.north=0,h.current.south=0,c.current=!1,u(!1)}}}),[t,e.height,e.width,e.x,e.y]),ce((()=>{let e=()=>{v.current&&v.current()};return window.addEventListener("pointerup",e),window.addEventListener("touchend",e),()=>{window.removeEventListener("pointerup",e),window.removeEventListener("touchend",e)}}),[]),{portalRef:o,mode:i,mouseEvent:p,onPointerMoveCallback:m,isEditing:l}};function Ru(e){return e.endsWith("info.json")?e:e.endsWith("/")?`${e}info.json`:`${e}/info.json`}var Iu="http://library.stanford.edu/iiif/image-api/compliance.html#level1",Mu="http://library.stanford.edu/iiif/image-api/compliance.html#level2",zu="http://library.stanford.edu/iiif/image-api/conformance.html#level1",Lu="http://library.stanford.edu/iiif/image-api/conformance.html#level2",Fu="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",Nu="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",ju="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",$u="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",Bu="http://iiif.io/api/image/1/level1.json",Du="http://iiif.io/api/image/1/profiles/level1.json",Uu="http://iiif.io/api/image/1/level2.json",Wu="http://iiif.io/api/image/1/profiles/level2.json",Hu="http://iiif.io/api/image/2/level1.json",qu="http://iiif.io/api/image/2/profiles/level1.json",Vu="http://iiif.io/api/image/2/level2.json",Qu="http://iiif.io/api/image/2/profiles/level2.json",Yu="level1",Gu="level2",Ku="http://iiif.io/api/image/2/level1",Xu="http://iiif.io/api/image/2/level2",Zu=[Xu,Mu,Lu,Nu,$u,Uu,Wu,Vu,Qu,Gu],Ju=[...Zu,Ku,Iu,zu,Fu,ju,Bu,Du,Hu,qu,Yu],ec=["http://iiif.io/api/image/2/level0",Ku,Xu,"http://library.stanford.edu/iiif/image-api/compliance.html#level0",Iu,Mu,"http://library.stanford.edu/iiif/image-api/conformance.html#level0",zu,Lu,"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",Fu,Nu,"http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",ju,$u,"http://iiif.io/api/image/1/level0.json","http://iiif.io/api/image/1/profiles/level0.json",Bu,Du,Uu,Wu,"http://iiif.io/api/image/2/level0.json","http://iiif.io/api/image/2/profiles/level0.json",Hu,qu,Vu,Qu,"level0",Yu,Gu],tc={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["sizeByWhListed"]},ic={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPx","regionSquare","sizeByWhListed","sizeByH","sizeByW","sizeByWh"]},rc={extraFormats:["jpg","png"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPct","regionByPx","regionSquare","rotationBy90s","sizeByWhListed","sizeByConfinedWh","sizeByH","sizeByPct","sizeByW","sizeByWh"]};function nc(e){return-1!==Zu.indexOf(e)?rc:-1!==Ju.indexOf(e)?ic:tc}function ac(e){try{if("full"===e)return{full:!0};if("square"===e)return{square:!0};let t=e.startsWith("pct:"),i=e.substr(t?4:0).split(",").map((e=>parseFloat(e)));return{x:i[0],y:i[1],w:i[2],h:i[3],percent:t}}catch(t){throw new Error("Expected 'full', 'square' or 'x,y,w,h'. Found "+e)}}function oc(e){let t={upscaled:!1,max:!1,confined:!1};if("^"===e[0]&&(t.upscaled=!0,e=e.slice(1)),"max"===e||"full"===e)return t.max=!0,t.serialiseAsFull="full"===e,t;if("!"===e[0]&&(t.confined=!0,e=e.slice(1)),"p"===e[0])return t.percentScale=parseFloat(e.slice(4)),t;let i=e.split(",").map((e=>e.trim()));return i.length&&(""!==i[0]&&(t.width=parseInt(i[0],10)),""!==i[1]&&(t.height=parseInt(i[1],10))),t}function sc(e){let t={angle:0};if("!"===e[0]&&(t.mirror=!0,e=e.substr(1)),t.angle=parseFloat(e)%360,Number.isNaN(t.angle))throw new Error(`Invalid rotation ${e}`);return t}function lc(e,t=""){let{path:i,scheme:r,server:n,prefix:a}=function(e,t=""){let i=e.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!i)throw new Error(`Invalid or unknown input ${e}`);let r=i[2],n=i[3],a=i[4];if("/"===a[0]&&(a=a.substr(1)),t.length>0){if("/"===t[0]&&(t=t.substr(1)),t!==a.substr(0,t.length))throw new Error(`Path does not start with prefix (path: ${a}, prefix: ${t})`);a=a.substr(t.length)}return{scheme:r,server:n,path:a,prefix:t}}(e,t),o=i.split("/").reverse(),[s,l,u,c,...h]=o,d=h.reverse().filter(Boolean).join("/");if(1===o.length||""===s)return{type:"base",scheme:r,server:n,prefix:a,identifier:d};if("info.json"===s){let[,...e]=o;return{type:"info",scheme:r,server:n,prefix:a,identifier:e.reverse().filter(Boolean).join("/")}}let p=s.split(".");return{type:"image",scheme:r,server:n,prefix:a,identifier:d,originalPath:i,region:ac(c),size:oc(u),rotation:sc(l),quality:p[0],format:p[1]}}function uc(e){let t=lc(Ru(e.id));if("info"!==t.type)throw new Error("Invalid service URL");let i=function(e){let t=e?Array.isArray(e.profile)?e.profile:[e.profile]:[],i={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let e of t)if("string"==typeof e&&(e=nc(e)),e){if(e.formats)for(let t of e.formats)-1===i.extraFormats.indexOf(t)&&i.extraFormats.push(t);if(e.qualities)for(let t of e.qualities)-1===i.extraQualities.indexOf(t)&&i.extraQualities.push(t);if(e.supports)for(let t of e.supports)-1===i.extraFeatures.indexOf(t)&&i.extraFeatures.push(t);if(e.maxHeight&&(i.maxHeight=e.maxHeight),e.maxWidth&&(i.maxWidth=e.maxWidth),e.maxArea&&(i.maxArea=e.maxArea),e.extraFormats)for(let t of e.extraFormats)-1===i.extraFormats.indexOf(t)&&i.extraFormats.push(t);if(e.extraQualities)for(let t of e.extraQualities)-1===i.extraQualities.indexOf(t)&&i.extraQualities.push(t);if(e.extraFeatures)for(let t of e.extraFeatures)-1===i.extraFeatures.indexOf(t)&&i.extraFeatures.push(t);e.maxHeight&&(i.maxHeight=e.maxHeight),e.maxWidth&&(i.maxWidth=e.maxWidth),e.maxArea&&(i.maxArea=e.maxArea)}if(e.extraFormats)for(let t of e.extraFormats)-1===i.extraFormats.indexOf(t)&&i.extraFormats.push(t);if(e.extraFeatures)for(let t of e.extraFeatures)-1===i.extraFeatures.indexOf(t)&&i.extraFeatures.push(t);if(e.extraQualities)for(let t of e.extraQualities)-1===i.extraQualities.indexOf(t)&&i.extraQualities.push(t);return i}(e);return{identifier:t.identifier,originalPath:"",server:t.server,prefix:t.prefix,scheme:t.scheme,type:"image",quality:-1===i.extraQualities.indexOf("default")?i.extraQualities[0]:"default",region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:"jpg",rotation:{angle:0}}}function cc(e,t,i){let r=i.length,n=[];for(let t=0;t<r;t++){let r=i[t].width;n.push(e/r)}return n}function hc(e,t,i){let r=i.length,n=[];for(let a=0;a<r;a++){let r=i[a];n.push({width:Math.floor(e/r),height:Math.floor(t/r)})}return n}function dc(e){return e["@id"]?e["@id"]:e.id?e.id:void 0}function pc(e){if(!e||!e.profile||!dc(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let e of t)if("string"==typeof e&&-1!==ec.indexOf(e))return!0;return!1}function fc(e){if(!function(e){if(!pc(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let e of t)if("string"==typeof e){if(-1!==Ju.indexOf(e))return!0}else{let t=[...e.supports||[],...e.extraFeatures||[]];if(-1!==t.indexOf("regionByPx")&&(-1!==t.indexOf("sizeByW")||-1!==t.indexOf("sizeByWh")))return!0}return!1}(e))return[];let t=[],i=Array.isArray(e.profile)?e.profile:[e.profile],r=i.length;for(let t=0;t<r;t++){let r=i[t];if("string"!=typeof r&&(r.maxHeight||r.maxWidth))return[{id:dc(e),type:"variable",minWidth:0,minHeight:0,maxHeight:r.maxHeight||r.maxWidth,maxWidth:r.maxWidth||r.maxHeight}]}if(e.tiles){let i=e.tiles.length;for(let r=0;r<i;r++){let i=e.tiles[r];(i.height||i.width)&&t.push({id:dc(e),type:"variable",minHeight:0,minWidth:0,maxHeight:i.height||i.width,maxWidth:i.width})}}return t}function gc(e){let t=e.match(/^.*\/(full)\/(((\d+),(\d+)?)|max)\/(\d+)\/default\.(jpg|png|jpeg)$/);if(t){let i=t[1],r=parseInt(t[4],10),n=parseInt(t[5],10),a=t[7];if(("max"===i||"full"===i)&&r&&n&&a)return{type:"fixed",id:e,height:n,width:r}}return{type:"unknown",id:e}}function mc(e){return pc(e)?(e&&e.sizes?e.sizes:[]).map((t=>({id:dc(e),type:"fixed-service",height:t.height,width:t.width}))):[]}function vc(e){let t=[],i=e.length;for(let r=0;r<i;r++){let i=mc(e[r]);i.length&&t.push(...i);let n=fc(e[r]);n.length&&t.push(...n)}return t}function yc(e){let t=e.service?Array.isArray(e.service)?e.service:[e.service]:[],i=t.length,r=[];for(let e=0;e<i;e++)pc(t[e])&&r.push(t[e]);return r}function bc(e,t=!0,i){let r=[],n=function(e){if("string"==typeof e)return gc(e);let t=function(e){return e["@type"]?e["@type"]:e.type?e.type:void 0}(e);if("Image"!==t&&"sc:Image"!==t)return null;let i=e,r=dc(i);return r?r&&i.width&&i.height?{id:r,type:"fixed",width:i.width,height:i.height,unsafe:!0}:gc(r):null}(e);if(null===n)return r;let a=e;if(r.push(n),t&&a.width&&a.height){let e=[],t=yc(a);for(let r of t){let t={id:dc(r),width:a.width,height:a.height};if(i.canLoadSync(t)){let r=i.loadServiceSync(t);r&&(r.height||(r.height=a.height),r.width||(r.width=a.width),e.push(...vc([r])))}}if(e.length)return r.push(...e),r}return a.service&&r.push(...vc(a.service)),r}function wc({x:e=0,y:t=0,w:i,h:r,full:n,square:a,percent:o}){if(n)return"full";if(a)return"square";if(typeof i>"u"||typeof r>"u")throw new Error("RegionParameter: invalid region");let s=`${e},${t},${i},${r}`;return o?`pct:${s}`:s}function xc({max:e,percentScale:t,upscaled:i,confined:r,width:n,height:a,serialiseAsFull:o}){let s=[];return i&&s.push("^"),e?(s.push(o?"full":"max"),s.join("")):(r&&s.push("!"),t&&s.push(`pct:${t}`),n&&s.push(`${n}`),s.push(","),a&&s.push(`${a}`),s.join(""))}function _c(e){return`${e.mirror?"!":""}${(e.angle||0)%360}`}var Sc=Object.defineProperty,Ec=Object.defineProperties,kc=Object.getOwnPropertyDescriptors,Cc=Object.getOwnPropertySymbols,Ac=Object.prototype.hasOwnProperty,Pc=Object.prototype.propertyIsEnumerable,Oc=(e,t,i)=>t in e?Sc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Tc=(e,t)=>{for(var i in t||(t={}))Ac.call(t,i)&&Oc(e,i,t[i]);if(Cc)for(var i of Cc(t))Pc.call(t,i)&&Oc(e,i,t[i]);return e},Rc=(e,t)=>Ec(e,kc(t));function Ic(e,t){let i=e.prefix.startsWith("/")?e.prefix.substr(1):e.prefix,r=`${e.scheme}://${e.server}/${i?`${i}/`:""}${e.identifier}`;if("base"===e.type)return r;if("info"===e.type)return`${r}/info.json`;let{region:n,size:a,rotation:o,format:s,quality:l}=e;if(t){let e=t["@context"]?Array.isArray(t["@context"])?t["@context"]:[t["@context"]]:[],i=-1!==e.indexOf("http://iiif.io/api/image/2/context.json"),r=-1!==e.indexOf("http://iiif.io/api/image/3/context.json");if((a.width===t.width&&!a.height||a.height===t.height&&!a.width||a.width===t.width&&a.height===t.height)&&(a=Rc(Tc({},a),{max:!0})),i&&(a.max&&!a.serialiseAsFull&&(a=Rc(Tc({},a),{serialiseAsFull:!0})),!a.max&&a.width&&a.height&&(a=Rc(Tc({},a),{height:void 0}))),r&&(a.max&&a.serialiseAsFull&&(a=Rc(Tc({},a),{serialiseAsFull:!1})),a.width&&!a.height&&t.width&&t.height)){let e=t.height/t.width;a=Rc(Tc({},a),{height:Math.ceil(a.width*e)})}}return[r,wc(n),xc(a),_c(o),`${l}.${s}`].filter(Boolean).join("/")}function Mc(e,t,i){let r=uc({id:Ru(dc(e)),profile:"level2",type:"ImageService2"});if("image"!==r.type)throw new Error("Invalid service");return r.size.max=!1,r.size.width=t,r.size.height=i,{id:Ic(r),type:"fixed",width:t,height:i||e.height/(e.width||1)*t,unsafe:e.width>t}}function zc(e){let t=e.replace(/(https?:\/\/)?(www.)?/i,"");return-1!==t.indexOf("/")?t.split("/")[0]:t}function Lc(e,t){let i=[],r=Object.assign({unsafeImageService:!1,atAnyCost:!0,fallback:!0,minHeight:64,minWidth:64,maxHeight:1/0,maxWidth:1/0,returnAllOptions:!1,preferFixedSize:!1,allowUnsafe:!1,explain:!1,height:0,width:0},e),n=[],a=[],o=null,s=(e,t)=>{if(function(e,t,i){let r=e.width?e.width:e.maxWidth;return i.height<=e.maxHeight&&i.width<=e.maxWidth&&i.height>=e.minHeight&&i.width>=e.minWidth&&(!t||Math.abs(i.width-r)<Math.abs(t.width-r))}(r,t,e)){if(r.preferFixedSize&&e.unsafe)return void a.push(e);r.returnAllOptions&&t&&a.push(t),o=e}else r.returnAllOptions&&a.push(e)},l=t.length;for(let e=0;e<l;e++){let i=t[e](),a=i.length;for(let e=0;e<a;e++){let t=i[e];if("unknown"===t.type&&r.atAnyCost&&n.push(t),"fixed"===t.type&&(t.unsafe?n.push(t):s(t,o)),"fixed-service"===t.type)if(r.unsafeImageService){s(Mc(t,r.width,r.height),o)}else{s(Mc(t,t.width,t.height),o)}if("variable"===t.type&&t.maxWidth){s(Mc({id:t.id,type:"fixed-service",width:t.maxWidth,height:t.maxWidth},t.maxWidth),o)}}if(o&&!r.returnAllOptions){if(o.unsafe||r.allowUnsafe)continue;break}}return r.atAnyCost&&0===a.length?{best:o||n[0],fallback:n.slice(1),log:i}:r.returnAllOptions?{best:r.atAnyCost?o||a[0]||n[0]:o||a[0],fallback:[...a,...n],log:i}:{best:o||a[0]||null,fallback:o?a:a.slice(1),log:i}}var Fc=Object.defineProperty,Nc=Object.defineProperties,jc=Object.getOwnPropertyDescriptors,$c=Object.getOwnPropertySymbols,Bc=Object.prototype.hasOwnProperty,Dc=Object.prototype.propertyIsEnumerable,Uc=(e,t,i)=>t in e?Fc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Wc=(e,t)=>{for(var i in t||(t={}))Bc.call(t,i)&&Uc(e,i,t[i]);if($c)for(var i of $c(t))Dc.call(t,i)&&Uc(e,i,t[i]);return e},Hc=(e,t)=>Nc(e,jc(t));function qc(e,t,i){let r=e>t?e:t,n=i.length,a=[];for(let e=0;e<n;e++){let t=i[e],n=t.scaleFactors[0],o=r/n,s=[n];for(;o>=t.width;)n*=2,s.push(n),o/=2;a.push(Hc(Wc({},t),{scaleFactors:s}))}return a}var Vc=(e,t,i)=>new Promise(((r,n)=>{var a=e=>{try{s(i.next(e))}catch(e){n(e)}},o=e=>{try{s(i.throw(e))}catch(e){n(e)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(a,o);s((i=i.apply(e,t)).next())})),Qc=class{constructor(){this.config={verificationsRequired:1,approximateServices:!0,enableFetching:!0,disableThrottling:!1},this.fetchingCount=0,this.imageServices={},this.knownImageServers={}}setConfig(e){Object.assign(this.config,e)}sample(e,t,i=!0){let r=zc(dc(e)),n=Ru(dc(e)),a=this.knownImageServers[r];return this.imageServices[n]=Object.assign(e,{real:!0}),!a&&e.tiles?(this.knownImageServers[r]={verifications:0,malformed:!1,root:r,preLoaded:i,sampledId:dc(e),verified:!1,server:null,result:{context:e["@context"]||[],sampledProfile:e.profile,resourceServiceRatio:t&&e.height?t.height/e.height:1,sampledSizes:e.sizes||[],sizeRatios:cc(e.width,e.height,e.sizes||[]),sampledTiles:e.tiles||[]}},!0):this.verify(e)}preLoad(e,t=!0){this.knownImageServers[e.root]=e,t&&(this.knownImageServers[e.root].malformed=!1,this.knownImageServers[e.root].verifications=this.config.verificationsRequired)}predict(e,t=!1,i=!1){let r=null==e?void 0:e.source,n=zc(dc(e)),a=this.knownImageServers[n];if(!a||!a.result||!i&&(a.malformed||a.verifications<this.config.verificationsRequired))return null;let o=Ru(dc(e));return this.imageServices[o]||(this.imageServices[o]={"@context":a.result.context,"@id":dc(e),id:dc(e),protocol:"http://iiif.io/api/image",tiles:(null==r?void 0:r.tiles)||qc(e.width,e.height,a.result.sampledTiles),sizes:(null==r?void 0:r.sizes)||hc(Math.round(e.width/a.result.resourceServiceRatio),Math.round(e.height/a.result.resourceServiceRatio),a.result.sizeRatios),profile:(null==r?void 0:r.profile)||a.result.sampledProfile,height:(null==r?void 0:r.height)||e.height,width:(null==r?void 0:r.width)||e.width,real:!1}),this.imageServices[o]}getThumbnailFromResource(e,t){return Vc(this,arguments,(function*(e,t,i=!0,r=[]){let n=yield this.getImageCandidates(e,i);return Lc(t,[()=>r,()=>n])}))}getImageCandidates(e,t=!0){return Vc(this,null,(function*(){let i=e;if(t&&i.height&&i.width){let e=yc(i);for(let t of e){let e={id:dc(t),width:t.width?t.width:i.width,height:t.height?t.height:i.height,source:t};yield this.loadService(e)}}return bc(e,t,this)}))}verify(e){return Vc(this,null,(function*(){let t=this.predict(e,!1,!0),i=yield this.fetchService(dc(e));if(!t)return!1;let r=t.height===i.height&&t.width===i.width&&t["@context"]===i["@context"]&&function(e,t){if(e.length!==t.length)return!1;if(0===e.length&&0===t.length)return!0;let i=e.length,r=!0;for(let n=0;n<i;n++){let i=e[n],a=t[n];if(i.width!==a.width||i.height!==a.height){r=!1;break}}if(r)return!0;let n=0;for(let r=0;r<i;r++)for(let a=0;a<i;a++)if(e[r].width===t[a].width&&e[r].height===t[a].height){n++;break}return n===i}(t.sizes||[],i.sizes||[]);if(r){let t=zc(dc(e));this.knownImageServers[t].verifications+=1,this.knownImageServers[t].verifications>=this.config.verificationsRequired&&(this.knownImageServers[t].verified=!0)}return r}))}canLoadSync(e){let t="string"==typeof e?e:dc(e),i=Ru(t);if(this.imageServices[i])return!0;let r=this.knownImageServers[zc(t)];return r&&!r.malformed&&r.verifications>=this.config.verificationsRequired}markAsMalformed(e){return Vc(this,null,(function*(){return this.knownImageServers[zc(dc(e))].malformed=!0,this.loadService(e,!0)}))}fetchService(e,t=!1){return Vc(this,null,(function*(){let i=Ru(e);if(this.imageServices[i]&&(!t||this.imageServices[i].real))return this.imageServices[i];if(!this.config.enableFetching)throw new Error("Fetching is not enabled");let r=yield this.fetch(i).then((e=>e.json()));return!r.id&&r["@id"]&&(r.id=r["@id"]),r.id!==e&&(r.id=e,r["@id"]&&(r["@id"]=e)),this.imageServices[i]=Object.assign(r,{real:!0}),this.imageServices[i]}))}fetch(e,t){return Vc(this,null,(function*(){return fetch(e,t)}))}loadService(e,t=!1){return Vc(this,null,(function*(){if(!this.config.disableThrottling){let e=!0;for(;e;){if(!(this.fetchingCount>=this.config.verificationsRequired)){e=!1;break}yield new Promise((e=>setTimeout(e,500)))}}let i=this.knownImageServers[zc(dc(e))];if(i&&!i.malformed&&!t){yield i.result;let t=this.loadServiceSync(e);if(t)return t}this.fetchingCount++;let r=yield this.fetchService(dc(e),t);return this.fetchingCount--,r.real&&this.sample(r,e),r}))}loadServiceSync(e){let t=Ru(dc(e));return this.imageServices[t]?this.imageServices[t]:this.predict(e)}};new Qc;new Qc;function Yc(e,t){return e?t?p(d(d({},e),t||{}),{":hover":e[":hover"]?Object.assign(e[":hover"]||{},t[":hover"]||{}):t[":hover"],":active":e[":active"]?Object.assign(e[":active"]||{},t[":active"]||{}):t[":hover"]}):e:t}oe(),oe();var Gc=0;function Kc(e,t,i,r,n){var a,o,s={};for(o in t)"ref"==o?a=t[o]:s[o]=t[o];var l={type:e,props:s,key:i,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--Gc,__source:n,__self:r};if("function"==typeof e&&(a=e.defaultProps))for(o in a)void 0===s[o]&&(s[o]=a[o]);return X.vnode&&X.vnode(l),l}var Xc={id:"https://iiif-parser/annotation-page",type:"AnnotationPage",behavior:[],motivation:null,label:null,thumbnail:[],summary:null,requiredStatement:null,metadata:[],rights:null,provider:[],items:[],seeAlso:[],homepage:[],logo:[],rendering:[],service:[]},Zc={id:"https://iiif-parser/empty-canvas",type:"Canvas",label:null,behavior:[],motivation:null,thumbnail:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:[],rights:null,navDate:null,provider:[],items:[],annotations:[],seeAlso:[],homepage:[],logo:[],partOf:[],rendering:[],service:[],duration:0,height:0,width:0},Jc={id:"https://iiif-parser/empty-collection",type:"Collection",label:null,viewingDirection:"left-to-right",behavior:[],motivation:null,thumbnail:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:[],rights:null,navDate:null,provider:[],items:[],annotations:[],seeAlso:[],homepage:[],logo:[],partOf:[],rendering:[],service:[],services:[]},eh={id:"https://iiif-parser/empty-manifest",type:"Manifest",annotations:[],behavior:[],homepage:[],items:[],label:null,logo:[],metadata:[],motivation:null,navDate:null,provider:[],partOf:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,rendering:[],requiredStatement:null,rights:null,seeAlso:[],service:[],services:[],start:null,structures:[],summary:null,thumbnail:[],viewingDirection:"left-to-right"},th={id:"https://iiif-parser/empty-canvas",type:"Range",label:null,behavior:[],motivation:null,thumbnail:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:[],rights:null,navDate:null,provider:[],items:[],annotations:[],seeAlso:[],homepage:[],logo:[],partOf:[],rendering:[],service:[],start:null,supplementary:null,viewingDirection:"left-to-right"},ih={id:"https://iiif-parser/empty-agent",type:"Agent",label:{},logo:[],seeAlso:[],homepage:[]},rh=["Collection","Manifest","Canvas","AnnotationPage","AnnotationCollection","Annotation","ContentResource","Range","Service","Selector","Agent"];var nh=class{constructor(e,t={}){x(this,"traversals"),x(this,"options"),this.traversals=d({collection:[],manifest:[],canvas:[],annotationCollection:[],annotationPage:[],annotation:[],contentResource:[],choice:[],range:[],service:[],agent:[]},e),this.options=d({allowUndefinedReturn:!1},t)}static all(e){return new nh({collection:[e],manifest:[e],canvas:[e],annotationCollection:[e],annotationPage:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e]})}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=e.thumbnail.map((e=>this.traverseType(e,this.traversals.contentResource)))),e.provider&&(e.provider=e.provider.map((e=>this.traverseAgent(e)))),e}traverseLinking(e){return e.seeAlso&&(e.seeAlso=e.seeAlso.map((e=>this.traverseType(e,this.traversals.contentResource)))),e.service&&(e.service=e.service.map((e=>this.traverseType(e,this.traversals.service)))),e.services&&(e.services=e.services.map((e=>this.traverseType(e,this.traversals.service)))),e.logo&&(e.logo=e.logo.map((e=>this.traverseType(e,this.traversals.contentResource)))),e.homepage&&(e.homepage=e.homepage.map((e=>this.traverseType(e,this.traversals.contentResource)))),e.partOf&&(e.partOf=e.partOf.map((e=>"string"!=typeof e&&e.type?"Canvas"===e.type?this.traverseType(e,this.traversals.canvas):"AnnotationCollection"===e.type?this.traverseType(e,this.traversals.annotationCollection):this.traverseType(e,this.traversals.contentResource):this.traverseType(e,this.traversals.contentResource)))),e.start&&(e.start=e.start?this.traverseType(e.start,this.traversals.canvas):null),e.rendering&&(e.rendering=e.rendering.map((e=>this.traverseType(e,this.traversals.contentResource)))),e.supplementary&&(e.supplementary=e.supplementary.map((e=>this.traverseType(e,this.traversals.contentResource)))),e}traverseCollectionItems(e){return e.items&&e.items.map((e=>"Collection"===e.type?this.traverseCollection(e):this.traverseManifest(e))),e}traverseCollection(e){return this.traverseType(this.traverseDescriptive(this.traverseInlineAnnotationPages(this.traverseLinking(this.traversePosterCanvas(this.traverseCollectionItems(e))))),this.traversals.collection)}traverseManifestItems(e){return e.items&&(e.items=e.items.map((e=>this.traverseCanvas(e)))),e}traverseManifestStructures(e){return e.structures&&(e.structures=e.structures.map((e=>this.traverseRange(e)))),e}traverseManifest(e){return this.traverseType(this.traverseInlineAnnotationPages(this.traverseManifestStructures(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e)))))),this.traversals.manifest)}traverseCanvasItems(e){return e.items=(e.items||[]).map((e=>this.traverseAnnotationPage(e))),e}traverseInlineAnnotationPages(e){return"string"==typeof e||!e||e.annotations&&(e.annotations=e.annotations.map((e=>this.traverseAnnotationPage(e)))),e}traverseCanvas(e){return this.traverseType(this.traverseInlineAnnotationPages(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e))))),this.traversals.canvas)}traverseAnnotationPageItems(e){return e.items&&(e.items=e.items.map((e=>this.traverseAnnotation(e)))),e}traverseAnnotationPage(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationPageItems(e))),this.traversals.annotationPage)}traverseAnnotationBody(e){return Array.isArray(e.body)?e.body=e.body.map((e=>this.traverseContentResource(e))):e.body&&(e.body=this.traverseContentResource(e.body)),e}traversePosterCanvas(e){return e.posterCanvas&&(e.posterCanvas=this.traverseType(e.posterCanvas,this.traversals.canvas)),e.placeholderCanvas&&(e.placeholderCanvas=this.traverseType(e.placeholderCanvas,this.traversals.canvas)),e.accompanyingCanvas&&(e.accompanyingCanvas=this.traverseType(e.accompanyingCanvas,this.traversals.canvas)),e}traverseAnnotation(e){return this.traverseType(this.traverseLinking(this.traverseAnnotationBody(e)),this.traversals.annotation)}traverseContentResourceLinking(e){return"string"==typeof e||!e||e&&e.service&&(e.service=(e.service||[]).map((e=>this.traverseType(e,this.traversals.service)))),e}traverseContentResource(e){return"Choice"===e.type&&(e.items=e.items.map((e=>this.traverseContentResource(e)))),this.traverseType(this.traverseInlineAnnotationPages(this.traverseContentResourceLinking(e)),this.traversals.contentResource)}traverseRangeRanges(e){return e.items&&(e.items=e.items.map((e=>"string"==typeof e?this.traverseCanvas({id:e,type:"Canvas"}):"Manifest"===e.type?this.traverseManifest(e):this.traverseRange(e)))),e}traverseRange(e){return this.traverseType(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseRangeRanges(e)))),this.traversals.range)}traverseAgent(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),this.traversals.agent)}traverseType(e,t){return t.reduce(((e,t)=>{let i=t(e);return typeof i>"u"&&!this.options.allowUndefinedReturn?e:i}),e)}traverseService(e){return this.traverseType(e,this.traversals.service)}traverseUnknown(e){let t=function(e){if(typeof e>"u"||null===e)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(e))throw new Error("Array is not a valid entity");if("object"!=typeof e)throw new Error(typeof e+" is not a valid entity");if("string"==typeof e.type){let t=rh.indexOf(e.type);if(-1!==t)return rh[t]}if(e.profile)return"Service";throw new Error("Resource type is not known")}(e);switch(t){case"Collection":return this.traverseCollection(e);case"Manifest":return this.traverseManifest(e);case"Canvas":return this.traverseCanvas(e);case"AnnotationPage":return this.traverseAnnotationPage(e);case"Annotation":return this.traverseAnnotation(e);case"ContentResource":return this.traverseContentResource(e);case"Range":return this.traverseRange(e);case"Service":return this.traverseService(e);case"Agent":return this.traverseAgent(e);default:throw new Error(`Unknown or unsupported resource type of ${t}`)}}},ah=["sc:Collection","sc:Manifest","sc:Canvas","oa:AnnotationList","oa:Annotation","sc:Range","sc:Layer","sc:Sequence","oa:Choice","Service","ContentResource"];var oh=class{constructor(e,t={}){x(this,"traversals"),x(this,"options"),this.traversals=d({collection:[],manifest:[],canvas:[],annotationList:[],sequence:[],annotation:[],contentResource:[],choice:[],range:[],service:[],layer:[]},e),this.options=d({convertPropsToArray:!0,mergeMemberProperties:!0,allowUndefinedReturn:!1},t)}static all(e){return new oh({collection:[e],manifest:[e],canvas:[e],annotationList:[e],sequence:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e],layer:[e]})}traverseCollection(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCollectionItems(e))),this.traversals.collection)}traverseCollectionItems(e){if(this.options.mergeMemberProperties){let t=[...(e.manifests||[]).map((e=>"string"==typeof e?{"@id":e,"@type":"sc:Manifest"}:e)),...(e.collections||[]).map((e=>"string"==typeof e?{"@id":e,"@type":"sc:Collection"}:e)),...e.members||[]];delete e.collections,delete e.manifests,e.members=t}return e.manifests&&(e.manifests=e.manifests.map((e=>this.traverseManifest("string"==typeof e?{"@id":e,"@type":"sc:Manifest"}:e)))),e.collections&&(e.collections=e.collections.map((e=>this.traverseCollection("string"==typeof e?{"@id":e,"@type":"sc:Collection"}:e)))),e.members&&(e.members=e.members.map((e=>"string"==typeof e?e:this.traverseUnknown(e)))),e}traverseManifest(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e))),this.traversals.manifest)}traverseManifestItems(e){return e.sequences&&(e.sequences=e.sequences.map((e=>this.traverseSequence(e)))),e.structures&&(e.structures=e.structures.map((e=>this.traverseRange(e)))),e}traverseSequence(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseSequenceItems(e))),this.traversals.sequence)}traverseSequenceItems(e){return e.canvases&&(e.canvases=e.canvases.map((e=>this.traverseCanvas(e)))),e}traverseCanvas(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e))),this.traversals.canvas)}traverseCanvasItems(e){return e.images&&(e.images=e.images.map((e=>this.traverseAnnotation(e)))),e.otherContent&&(e.otherContent=e.otherContent.map((e=>this.traverseAnnotationList(e)))),e}traverseRange(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseRangeItems(e))),this.traversals.range)}traverseRangeItems(e){if(this.options.mergeMemberProperties){let t=[...(e.ranges||[]).map((e=>"string"==typeof e?{"@id":e,"@type":"sc:Range"}:e)),...(e.canvases||[]).map((e=>"string"==typeof e?{"@id":e,"@type":"sc:Canvas"}:e)),...e.members||[]];delete e.ranges,delete e.canvases,e.members=t.length?t.map((e=>this.traverseUnknown(e))):void 0}return e}traverseAnnotationList(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationListItems(e))),this.traversals.annotationList)}traverseAnnotationListItems(e){return e.resources&&(e.resources=e.resources.map((e=>this.traverseAnnotation(e)))),e}traverseAnnotation(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationItems(e))),this.traversals.annotation)}traverseAnnotationItems(e){return e.resource&&(e.resource=this.traverseContentResource(e.resource)),e.on,e}traverseLayer(e){return this.traverseType(this.traverseLinking(this.traverseLayerItems(e)),this.traversals.layer)}traverseLayerItems(e){return e.otherContent&&(e.otherContent=e.otherContent.map((e=>this.traverseAnnotationList(e)))),e}traverseChoice(e){return this.traverseType(this.traverseChoiceItems(e),this.traversals.choice)}traverseChoiceItems(e){return e.default&&"rdf:nil"!==e.default&&(e.default=this.traverseContentResource(e.default)),e.item&&"rdf:nil"!==e.item&&(e.item=e.item.map((e=>this.traverseContentResource(e)))),e}traverseService(e){return this.traverseType(this.traverseLinking(e),this.traversals.service)}traverseContentResource(e){return"oa:Choice"===e["@type"]?this.traverseChoice(e):this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),this.traversals.contentResource)}traverseUnknown(e){if(!e["@type"]||"string"==typeof e)return e;switch(function(e){if(typeof e>"u"||null===e)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(e))throw new Error("Array is not a valid entity");if("object"!=typeof e)throw new Error(typeof e+" is not a valid entity");if("string"==typeof e["@type"]){let t=ah.indexOf(e["@type"]);if(-1!==t)return ah[t]}if(e.profile)return"Service";if(e.format||e["@type"])return"ContentResource";throw new Error("Resource type is not known")}(e)){case"sc:Collection":return this.traverseCollection(e);case"sc:Manifest":return this.traverseManifest(e);case"sc:Canvas":return this.traverseCanvas(e);case"sc:Sequence":return this.traverseSequence(e);case"sc:Range":return this.traverseRange(e);case"oa:Annotation":return this.traverseAnnotation(e);case"oa:AnnotationList":return this.traverseAnnotationList(e);case"sc:Layer":return this.traverseLayer(e);case"Service":return this.traverseService(e);case"oa:Choice":return this.traverseChoice(e);case"ContentResource":return this.traverseContentResource(e)}return e.profile?this.traverseService(e):e}traverseImageResource(e){let t=Array.isArray(e),i=Array.isArray(e)?e:[e],r=[];for(let e of i)"string"==typeof e?r.push(this.traverseContentResource({"@id":e,"@type":"dctypes:Image"})):r.push(this.traverseContentResource(e));return t||this.options.convertPropsToArray?r:r[0]}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=this.traverseImageResource(e.thumbnail)),e.logo&&(e.logo=this.traverseImageResource(e.logo)),e}traverseOneOrMoreServices(e){let t=Array.isArray(e),i=Array.isArray(e)?e:[e],r=[];for(let e of i)r.push(this.traverseService(e));return t||this.options.convertPropsToArray?r:r[0]}traverseLinking(e){return e.related&&(e.related=this.traverseOneOrManyType(e.related,this.traversals.contentResource)),e.rendering&&(e.rendering=this.traverseOneOrManyType(e.rendering,this.traversals.contentResource)),e.service&&(e.service=this.traverseOneOrMoreServices(e.service)),e.seeAlso&&(e.seeAlso=this.traverseOneOrManyType(e.seeAlso,this.traversals.contentResource)),e.within&&("string"==typeof e.within||(e.within=this.traverseOneOrManyType(e.within,this.traversals.contentResource))),e.startCanvas&&("string"==typeof e.startCanvas?e.startCanvas=this.traverseType({"@id":e.startCanvas,"@type":"sc:Canvas"},this.traversals.canvas):e.startCanvas&&this.traverseType(e.startCanvas,this.traversals.canvas)),e.contentLayer&&("string"==typeof e.contentLayer?e.contentLayer=this.traverseLayer({"@id":e.contentLayer,"@type":"sc:Layer"}):e.contentLayer=this.traverseLayer(e.contentLayer)),e}traverseOneOrManyType(e,t){if(!Array.isArray(e)){if(!this.options.convertPropsToArray)return this.traverseType(e,t);e=[e]}return e.map((e=>this.traverseType(e,t)))}traverseType(e,t){return t.reduce(((e,t)=>{let i=t(e);return typeof i>"u"&&!this.options.allowUndefinedReturn?e:i}),e)}},sh="http://library.stanford.edu/iiif/image-api/compliance.html#level1",lh="http://library.stanford.edu/iiif/image-api/compliance.html#level2",uh="http://library.stanford.edu/iiif/image-api/conformance.html#level1",ch="http://library.stanford.edu/iiif/image-api/conformance.html#level2",hh="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",dh="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",ph="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",fh="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",gh="http://iiif.io/api/image/1/level1.json",mh="http://iiif.io/api/image/1/profiles/level1.json",vh="http://iiif.io/api/image/1/level2.json",yh="http://iiif.io/api/image/1/profiles/level2.json",bh="http://iiif.io/api/image/2/level1.json",wh="http://iiif.io/api/image/2/profiles/level1.json",xh="http://iiif.io/api/image/2/level2.json",_h="http://iiif.io/api/image/2/profiles/level2.json",Sh="level1",Eh="level2",kh="http://iiif.io/api/image/2/level1",Ch="http://iiif.io/api/image/2/level2",Ah=[kh,Ch,sh,lh,uh,ch,hh,dh,ph,fh,gh,mh,vh,yh,bh,wh,xh,_h,Sh,Eh],Ph=["http://iiif.io/api/image/2/level0",kh,Ch,"http://library.stanford.edu/iiif/image-api/compliance.html#level0",sh,lh,"http://library.stanford.edu/iiif/image-api/conformance.html#level0",uh,ch,"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",hh,dh,"http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",ph,fh,"http://iiif.io/api/image/1/level0.json","http://iiif.io/api/image/1/profiles/level0.json",gh,mh,vh,yh,"http://iiif.io/api/image/2/level0.json","http://iiif.io/api/image/2/profiles/level0.json",bh,wh,xh,_h,"level0",Sh,Eh],Oh={attributionLabel:"Attribution",lang:"none",providerId:"http://example.org/provider",providerName:"Unknown"};function Th(e,t="none"){if(!e)return{};let i=Array.isArray(e)?e:[e],r={};for(let e of i){if("string"==typeof e){r[t]=r[t]?r[t]:[],r[t].push(e||"");continue}if(!e["@language"]){r[t]=r[t]?r[t]:[],r[t].push(e["@value"]||"");continue}let i=e["@language"];r[i]=r[i]?r[i]:[],r[i].push(e["@value"]||"")}return r}function Rh(e){return Array.isArray(e)?Rh(e.find((e=>"string"==typeof e))):-1!==Ph.indexOf(e)?"level2":-1!==Ah.indexOf(e)?"level1":"string"==typeof e?e:void 0}function Ih(e){return Array.isArray(e)?e:[e]}function Mh(e){for(let t of["sc","oa","dcterms","dctypes","iiif"])if(e.startsWith(`${t}:`))return e.slice(t.length+1);return e}var zh=["Collection","Manifest","Annotation","AnnotationPage","Range","Service"];function Lh(e){let t=e["@id"]||e.id,i=e["@type"]||e.type,r=e.profile||void 0,n=e["@context"]||void 0;if(r){let e=function(e){switch(e){case"http://iiif.io/api/image/2/level0.json":case"http://iiif.io/api/image/2/level1.json":case"http://iiif.io/api/image/2/level2.json":return"ImageService2";case"http://iiif.io/api/auth/1/kiosk":case"http://iiif.io/api/auth/1/login":case"http://iiif.io/api/auth/1/clickthrough":case"http://iiif.io/api/auth/1/external":case"http://iiif.io/api/auth/0/kiosk":case"http://iiif.io/api/auth/0/login":case"http://iiif.io/api/auth/0/clickthrough":case"http://iiif.io/api/auth/0/external":return"AuthCookieService1";case"http://iiif.io/api/auth/1/token":case"http://iiif.io/api/auth/0/token":return"AuthTokenService1";case"http://iiif.io/api/auth/1/logout":case"http://iiif.io/api/auth/0/logout":return"AuthLogoutService1";case"http://iiif.io/api/search/1/search":case"http://iiif.io/api/search/0/search":return"SearchService1";case"http://iiif.io/api/search/1/autocomplete":case"http://iiif.io/api/search/0/autocomplete":return"AutoCompleteService1"}}(r);if(e)return e}if(n){let e=function(e){let t=Array.isArray(e)?e:[e];for(let e of t)switch(e){case"http://iiif.io/api/image/2/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2":return"ImageService2";case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":return"ImageService1";case"http://iiif.io/api/annex/openannotation/context.json":return"ImageApiSelector"}}(n);if(e)return e}if(i){if(Array.isArray(i)){if(-1!==i.indexOf("oa:CssStylesheet"))return"CssStylesheet";if(-1!==i.indexOf("cnt:ContentAsText"))return"TextualBody";i=i[0]}for(let e of["sc","oa","dcterms","dctypes","iiif"])if(i.startsWith(`${e}:`)){i=i.slice(e.length+1);break}switch(i){case"Layer":return"AnnotationCollection";case"AnnotationList":return"AnnotationPage";case"cnt:ContentAsText":return"TextualBody"}}if(i&&-1!==zh.indexOf(i))return i;if(e.format){if(e.format.startsWith("image/"))return"Image";if(e.format.startsWith("text/")||"application/pdf"===e.format)return"Text";if(e.format.startsWith("application/"))return"Dataset"}return t&&(t.endsWith(".jpg")||t.endsWith(".png")||t.endsWith(".jpeg"))?"Image":i||"unknown"}var Fh=/http(s)?:\/\/(creativecommons.org|rightsstatements.org)[^"'\\<\n]+/gm;function Nh(e){let t=e.match(Fh);return t?t[0]:e}var jh=["http://iiif.io/api/presentation/2/context.json","http://iiif.io/api/image/2/context.json","http://iiif.io/api/image/1/context.json","http://library.stanford.edu/iiif/image-api/1.1/context.json","http://iiif.io/api/search/1/context.json","http://iiif.io/api/search/0/context.json","http://iiif.io/api/auth/1/context.json","http://iiif.io/api/auth/0/context.json","http://iiif.io/api/annex/openannotation/context.json"];function $h(e){if(e){let t=Array.isArray(e)?e:[e],i=[];for(let e of t)"http://iiif.io/api/presentation/2/context.json"===e&&i.push("http://iiif.io/api/presentation/3/context.json"),-1===jh.indexOf(e)&&i.push(e);if(t.length)return 1===i.length?i[0]:i}}function Bh(e){return e?e.map((e=>({label:Th(e.label),value:Th(e.value)}))):[]}function Dh(e){for(let t in e)(typeof e[t]>"u"||null===e[t])&&delete e[t];return e}var Uh=0;function Wh(e,t){let i=encodeURI(e.id||e["@id"]||"").trim();return i&&t?`${i}/${t}`:i||(Uh++,`http://example.org/${e["@type"]}${t?`/${t}`:""}/${Uh}`)}function Hh(e){let t=[...e.behavior||[]];return e.viewingHint&&t.push(e.viewingHint),{"@context":e["@context"]?$h(e["@context"]):void 0,id:(e["@id"]||Wh(e)).trim(),type:Lh(e),behavior:t.length?t:void 0,height:e.height?e.height:void 0,width:e.width?e.width:void 0,motivation:e.motivation?Mh(e.motivation):void 0,viewingDirection:e.viewingDirection,profile:e.profile,format:e.format?e.format:void 0,duration:void 0,timeMode:void 0}}function qh(e){let[t,i]=function(e,t="Rights/License",i="none"){let r=null,n=[],a=Array.isArray(e)?e:[e];for(let e of a){let a=e?Nh(e):void 0;!a||-1===a.indexOf("creativecommons.org")&&-1===a.indexOf("rightsstatements.org")?a&&n.push({label:{[i]:[t]},value:{[i]:[a]}}):r=a.startsWith("https://")?`http://${a.slice(8)}`:a}return[r,n]}(e.license),r=[...e.metadata?Bh(e.metadata):[],...i];return{rights:t,metadata:r.length?r:void 0,label:e.label?Th(e.label):void 0,requiredStatement:e.attribution?{label:Th(Oh.attributionLabel),value:Th(e.attribution)}:void 0,navDate:e.navDate,summary:e.description?Th(e.description):void 0,thumbnail:e.thumbnail}}function Vh(e){if(!e.within)return;let t=Array.isArray(e.within)?e.within:[e.within],i=[];for(let r of t)if("string"==typeof r){if(r&&"sc:Manifest"===e["@type"])i.push({id:r,type:"Collection"})}else r["@id"]&&i.push({id:r["@id"],type:Lh(r)});return i.length?i:void 0}function Qh(e){let t=e.related?Array.isArray(e.related)?e.related:[e.related]:[],i=e.contentLayer;return{provider:e.logo||t.length?[{id:Oh.providerId,type:"Agent",homepage:t.length?[t[0]]:void 0,logo:e.logo?Array.isArray(e.logo)?e.logo:[e.logo]:void 0,label:Th(Oh.providerName)}]:void 0,partOf:Vh(e),rendering:e.rendering,seeAlso:e.seeAlso,start:e.startCanvas,service:e.service?Ih(e.service):void 0,supplementary:i?[i]:void 0}}var Yh=new oh({collection:[function(e){return Dh(p(d(d(d({},Hh(e)),qh(e)),Qh(e)),{items:e.members}))}],manifest:[function(e){let t=[],i=[];for(let r of e.sequences||[])r.canvases.length&&t.push(...r.canvases),r.behavior&&i.push(...r.behavior);let r=Hh(e);return i.length&&(r.behavior?r.behavior.push(...i):r.behavior=i),Dh(p(d(d(d({},r),qh(e)),Qh(e)),{items:t,structures:e.structures}))}],canvas:[function(e){return Dh(p(d(d(d({},Hh(e)),qh(e)),Qh(e)),{items:e.images&&e.images.length?[{id:Wh(e,"annotation-page"),type:"AnnotationPage",items:e.images}]:void 0}))}],annotationList:[function(e){return Dh(p(d(d(d({},Hh(e)),qh(e)),Qh(e)),{items:e.resources}))}],sequence:[function(e){return e.canvases&&0!==e.canvases.length?{canvases:e.canvases,behavior:e.viewingHint?[e.viewingHint]:[]}:{canvases:[],behavior:[]}}],annotation:[function(e){return Dh(p(d(d(d({},Hh(e)),qh(e)),Qh(e)),{target:"string"==typeof e.on?encodeURI(e.on).trim():e.on,body:e.resource}))}],contentResource:[function(e){let t=e;return Dh(d(d(d({},Hh(t)),qh(t)),Qh(t)))}],choice:[function(e){let t=[];return e.default&&"rdf:nil"!==e.default&&t.push(e.default),e.item&&"rdf:nil"!==e.item&&t.push(...e.item),p(d(d({},Hh(e)),qh(e)),{items:t})}],range:[function(e){return Dh(p(d(d(d({},Hh(e)),qh(e)),Qh(e)),{items:e.members}))}],service:[function(e){let t=e,{"@id":i,"@type":r,"@context":n,profile:a}=t,o=g(t,["@id","@type","@context","profile"]);return i&&(o.id=i),o.type=Lh(e),"unknown"===o.type&&(o.type="Service"),a&&(o.profile=Rh(a)),Dh(d(d({},o),qh(o)))}],layer:[function(e){return Dh(d(d(d({},Hh(e)),qh(e)),Qh(e)))}]});function Gh(e,t){if("string"==typeof e)return{id:e,type:t};if(!e.id)throw new Error(`Invalid resource does not have an ID (${t})`);return e}function Kh(e){let t=JSON.stringify(e),i=5381,r=t.length;for(;r;)i=33*i^t.charCodeAt(--r);let n=(i>>>0).toString(16);return n.length%2?"0"+n:n}function Xh(e){return t=>"string"==typeof t?{id:t,type:e}:t.id?t.type?t:d({type:e},t):d({id:Kh(t),type:e},t)}function Zh(e){return t=>d(d({},e),t)}function Jh(e){return Array.isArray(e)?e:[e]}function ed(e){return e.body&&(e.body=Jh(e.body)),e.seeAlso&&(e.seeAlso=Jh(e.seeAlso)),e.body&&(e.body=Jh(e.body)),e.audience&&(e.audience=Jh(e.audience)),e.accessibility&&(e.accessibility=Jh(e.accessibility)),e.motivation&&(e.motivation=Jh(e.motivation)),e}function td(e){let t=function(e){return e&&e["@context"]&&("http://iiif.io/api/presentation/2/context.json"===e["@context"]||-1!==e["@context"].indexOf("http://iiif.io/api/presentation/2/context.json")||"http://www.shared-canvas.org/ns/context.json"===e["@context"])||"http://iiif.io/api/image/2/context.json"===e["@context"]?Yh.traverseUnknown(e):e}(e),i={Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}},r={},n=function(e){return(t,i)=>{let r=e[t]?e[t]:{};return e=>{let n=Gh(e,i||t);return n&&n.id&&t?(r[n.id]=r[n.id]?Object.assign({},r[n.id],n):Object.assign({},n),{id:n.id,type:"ContentResource"===t?t:n.type}):n}}}(i),a=function(e){return(t,i)=>r=>{let{id:n,type:a}=Gh(r,i||t);if(typeof n>"u")throw new Error("Found invalid entity without an ID.");return e[n]="ContentResource"===t?t:a,r}}(r);return{entities:i,resource:new nh({collection:[Zh(Jc),a("Collection"),n("Collection")],manifest:[Zh(eh),a("Manifest"),n("Manifest")],canvas:[Zh(Zc),a("Canvas"),n("Canvas")],annotationPage:[Xh("AnnotationPage"),Zh(Xc),a("AnnotationPage"),n("AnnotationPage")],annotation:[Xh("Annotation"),ed,a("Annotation"),n("Annotation")],contentResource:[Xh("ContentResource"),a("ContentResource"),n("ContentResource")],range:[Zh(th),a("Range","Canvas"),n("Range","Canvas")],agent:[Zh(ih),a("Agent"),n("Agent")]}).traverseUnknown(t),mapping:r}}var id="__$UNSET$__",rd="__$UNWRAP$__";function nd(e,t,i){if(!t.type||!t.id)throw new Error("Unknown entity");if(!i[t.type])throw new Error(`Serializer not found for ${t.type}`);return function r(n){let a=i[n.type];if(!a)return id;let o=function(e,t){let i=e.requests[t],r=e.mapping[t];if(r&&(!i||!i.resourceUri||e.entities[r][i.resourceUri]))return e.entities[r][i?i.resourceUri:t]}(e,n.id)||(n.id&&n.type?n:null);if(!o)return id;let s=a(o,e,{isTopLevel:t.id===n.id}),l=s.next();for(;!l.done;){let e=l.value,t=id;if(e)if(Array.isArray(e)){let i=[];for(let t of e)i.push(r(t));t=i}else t=r(e);l=s.next(t)}return l.value===id?id:function(e){let t={};for(let[i,r]of e){if(i===rd&&r!==id)return r;r!==id&&typeof r<"u"&&null!==r&&(t[i]=r)}return t}(l.value)}(t)}function ad(e){if(!e)return;let t=Object.keys(e);if(0!==t.length){if(1===t.length){let i=t[0];if(!i)return"";let r=(e[i]||[]).join("");return"@none"===i||"none"===i||"en"===i?r:{"@language":i,"@value":r}}return t.map((t=>({"@language":t,"@value":(e[t]||[]).join("")})))}}function od(e){return Array.isArray(e)?e.map((e=>od(e))):"string"==typeof e?e:e.type&&"Canvas"===e.type?e.id:e}function sd(e,t=!1){if(e)return e.length>1&&!t?e:e[0]||void 0}function ld(e){if(e){if("string"==typeof e)return{"@id":e};if("@id"in e){let t=d({},e);return delete t["@type"],t}return{"@context":"http://iiif.io/api/image/2/context.json","@id":e.id,profile:`http://iiif.io/api/image/2/profiles/${e.profile}.json`}}}function ud(e,t){return[["@id",e.id],["@type",t],["format",e.format],["height",e.height],["width",e.width],["viewingDirection","left-to-right"!==e.viewingDirection?e.viewingDirection:void 0]]}function*cd(e){let t=e.provider?yield e.provider[0]:void 0;return[["label",ad(e.label)],["metadata",e.metadata&&e.metadata.length?e.metadata.map((e=>({label:ad(e.label)||"",value:ad(e.value)||""}))):void 0],["description",ad(e.summary)],["thumbnail",sd(yield e.thumbnail)],["navDate",e.navDate],["logo",t?sd(t.logo):void 0],["homepage",t?t.homepage:void 0],["attribution",e.requiredStatement?ad(e.requiredStatement.value):void 0]]}function*hd(e){return[["seeAlso",sd(yield e.seeAlso)],["service",sd((e.service||[]).map(ld))],["rendering",sd(yield e.rendering)],["startCanvas",e.start?e.start.id:void 0]]}var dd={Manifest:function*(e){return[...ud(e,"sc:Manifest"),...yield*cd(e),...yield*hd(e),["sequences",[{"@id":`${e.id}/sequence0`,"@type":"sc:Sequence",canvases:yield e.items}]],["structures",yield e.structures]]},Canvas:function*(e){let t=(yield e.items)[0];return[...ud(e,"sc:Canvas"),...yield*cd(e),...yield*hd(e),["images",t?[t.resources]:void 0],["annotations",e.annotations&&e.annotations.length?sd(yield e.annotations):void 0]]},AnnotationPage:function*(e){return[...ud(e,"sc:AnnotationList"),...yield*cd(e),["resources",e.items&&e.items.length?sd(yield e.items):void 0]]},Annotation:function*(e){return[["@id",e.id],["@type","oa:Annotation"],["motivation","sc:painting"],["on",od(e.target)],["resource",sd(yield e.body,!0)]]},ContentResource:function*(e){return"Image"===e.type?[...ud(e,"dctypes:Image"),...yield*cd(e),...yield*hd(e)]:[...ud(e,void 0),...yield*cd(e)]},AnnotationCollection:function*(e){return[["@id",e.id],["@type","sc:Layer"],["label",ad(e.label)]]},Collection:function*(e){return[...ud(e,"sc:Collection"),...yield*cd(e),...yield*hd(e),["members",yield*e.items]]},Range:function*(e){let t=[],i=[];if(e.items)for(let r of e.items){let n=yield r;t.push({"@id":r.id,"@type":r.type,label:n?n.label:void 0,within:e.id}),"Canvas"===r.type&&i.push(r.id)}return[...ud(e,"sc:Range"),...yield*cd(e),...yield*hd(e),["canvases",i.length===t.length?i:void 0],["members",i.length!==t.length?t:void 0]]}};function pd(e){return[["id",e.id],["type",e.type],["format",e.format],["profile",e.profile],["height",e.height],["width",e.width],["duration",e.duration||void 0],["viewingDirection","left-to-right"!==e.viewingDirection?e.viewingDirection:void 0],["behavior",e.behavior&&e.behavior.length?e.behavior:void 0],["timeMode",e.timeMode],["motivation",e.motivation]]}function fd(e){if(e&&0!==e.length)return e}function gd(e){if(e&&e.type&&"ImageService2"===e.type){let t=e,{id:i,type:r,profile:n}=t,a=g(t,["id","type","profile"]);return d({"@id":i,"@type":r,profile:n.startsWith("http")?n:`http://iiif.io/api/image/2/${n}.json`},a)}return e}function md(e){if(e&&0!==e.length)return e.map(gd)}function*vd(e){return[["label",e.label],["metadata",fd(e.metadata)],["summary",e.summary],["requiredStatement",e.requiredStatement],["rights",e.rights],["navDate",e.navDate],["language",e.language],["thumbnail",fd(yield e.thumbnail)],["placeholderCanvas",yield e.placeholderCanvas],["accompanyingCanvas",yield e.accompanyingCanvas],["provider",fd(yield e.provider)]]}function*yd(e){return[["seeAlso",fd(yield e.seeAlso)],["service",md(e.service)],["services",md(e.services)],["rendering",fd(yield e.rendering)],["supplementary",fd(yield e.supplementary)],["homepage",fd(yield e.homepage)],["logo",fd(yield e.logo)],["partOf",fd(yield e.partOf)],["start",e.start]]}var bd={Manifest:function*(e,t,{isTopLevel:i}){return i?[["@context","http://iiif.io/api/presentation/3/context.json"],...pd(e),...yield*vd(e),...yield*yd(e),["items",yield e.items],["structures",fd(yield e.structures)],["annotations",fd(yield e.annotations)]]:[...pd(e),...yield*vd(e)]},Canvas:function*(e){return[...pd(e),...yield*vd(e),...yield*yd(e),["items",yield e.items],["annotations",fd(yield e.annotations)]]},Agent:function*(e){return[["id",e.id],["type","Agent"],["label",e.label],...yield*yd(e)]},AnnotationPage:function*(e){return[...Object.entries(e).map((([e,t])=>[e,Array.isArray(t)?fd(t):t])).filter((([e,t])=>"items"!==e)),...yield*yd(e),["items",yield e.items]]},Service:function*(e){return[[rd,gd(e)]]},Annotation:function*(e){return[...Object.entries(e).map((([e,t])=>[e,Array.isArray(t)?fd(t):t])).filter((([e])=>"body"!==e)),["body",yield e.body]]},ContentResource:function*(e){return[...pd(e),...yield*vd(e),...yield*yd(e),["annotations",fd(yield e.annotations)]]},AnnotationCollection:function*(e){return[["id",e.id],["type","AnnotationCollection"],["label",e.label]]},Collection:function*(e,t,{isTopLevel:i}){return i?[["@context","http://iiif.io/api/presentation/3/context.json"],...pd(e),...yield*vd(e),...yield*yd(e),["items",fd(yield e.items)]]:[...pd(e),...yield*vd(e)]},Range:function*(e){let t=[];for(let i of e.items)"Range"===i.type?t.push(yield i):t.push(i);return[...pd(e),...yield*vd(e),...yield*yd(e),["items",t],["annotations",fd(yield e.annotations)]]}},wd=b(Mt(),1);function xd(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _d(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Sd(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?_d(Object(i),!0).forEach((function(t){xd(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):_d(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Ed(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var kd="function"==typeof Symbol&&Symbol.observable||"@@observable",Cd=function(){return Math.random().toString(36).substring(7).split("").join(".")},Ad={INIT:"@@redux/INIT"+Cd(),REPLACE:"@@redux/REPLACE"+Cd(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Cd()}};function Pd(e,t,i){var r;if("function"==typeof t&&"function"==typeof i||"function"==typeof i&&"function"==typeof arguments[3])throw new Error(Ed(0));if("function"==typeof t&&typeof i>"u"&&(i=t,t=void 0),typeof i<"u"){if("function"!=typeof i)throw new Error(Ed(1));return i(Pd)(e,t)}if("function"!=typeof e)throw new Error(Ed(2));var n=e,a=t,o=[],s=o,l=!1;function u(){s===o&&(s=o.slice())}function c(){if(l)throw new Error(Ed(3));return a}function h(e){if("function"!=typeof e)throw new Error(Ed(4));if(l)throw new Error(Ed(5));var t=!0;return u(),s.push(e),function(){if(t){if(l)throw new Error(Ed(6));t=!1,u();var i=s.indexOf(e);s.splice(i,1),o=null}}}function d(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw new Error(Ed(7));if(typeof e.type>"u")throw new Error(Ed(8));if(l)throw new Error(Ed(9));try{l=!0,a=n(a,e)}finally{l=!1}for(var t=o=s,i=0;i<t.length;i++){(0,t[i])()}return e}return d({type:Ad.INIT}),(r={dispatch:d,subscribe:h,getState:c,replaceReducer:function(e){if("function"!=typeof e)throw new Error(Ed(10));n=e,d({type:Ad.REPLACE})}})[kd]=function(){var e,t=h;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(Ed(11));function i(){e.next&&e.next(c())}return i(),{unsubscribe:t(i)}}})[kd]=function(){return this},e},r}function Od(e){for(var t=Object.keys(e),i={},r=0;r<t.length;r++){var n=t[r];"function"==typeof e[n]&&(i[n]=e[n])}var a,o=Object.keys(i);try{!function(e){Object.keys(e).forEach((function(t){var i=e[t];if(typeof i(void 0,{type:Ad.INIT})>"u")throw new Error(Ed(12));if(typeof i(void 0,{type:Ad.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Ed(13))}))}(i)}catch(e){a=e}return function(e,t){if(void 0===e&&(e={}),a)throw a;for(var r=!1,n={},s=0;s<o.length;s++){var l=o[s],u=i[l],c=e[l],h=u(c,t);if(typeof h>"u"){t&&t.type;throw new Error(Ed(14))}n[l]=h,r=r||h!==c}return(r=r||o.length!==Object.keys(e).length)?n:e}}function Td(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function Rd(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(e){return function(){var i=e.apply(void 0,arguments),r=function(){throw new Error(Ed(15))},n={getState:i.getState,dispatch:function(){return r.apply(void 0,arguments)}},a=t.map((function(e){return e(n)}));return r=Td.apply(void 0,a)(i.dispatch),Sd(Sd({},i),{},{dispatch:r})}}}var Id="@iiif/IMPORT_ENTITIES",Md="@iiif/MODIFY_ENTITY_FIELD",zd="@iiif/REORDER_ENTITY_FIELD",Ld="@iiif/ADD_REFERENCE",Fd="@iiif/REMOVE_REFERENCE",Nd=(0,wd.createAction)(Id)(),jd=(0,wd.createAction)(Md)(),$d=(0,wd.createAction)(zd)(),Bd=(0,wd.createAction)(Ld)(),Dd=(0,wd.createAction)(Fd)(),Ud={importEntities:Nd,modifyEntityField:jd,reorderEntityField:$d,addReference:Bd,removeReference:Dd},Wd="@iiif/ADD_MAPPING",Hd="@iiif/ADD_MAPPINGS",qd=(0,wd.createAction)(Wd)(),Vd=(0,wd.createAction)(Hd)(),Qd="@iiif/SET_META_VALUE",Yd="@iiif/SET_META_VALUE_DYNAMIC",Gd="@iiif/UNSET_META_VALUE",Kd={setMetaValue:(0,wd.createAction)(Qd)(),setMetaValueDynamic:(0,wd.createAction)(Yd)(),unsetMetaValue:(0,wd.createAction)(Gd)()},Xd="RESOURCE_ERROR",Zd="RESOURCE_LOADING",Jd="RESOURCE_READY",ep="@iiif/REQUEST_RESOURCE",tp="@iiif/REQUEST_ERROR",ip="@iiif/REQUEST_MISMATCH",rp="@iiif/REQUEST_COMPLETE",np="@iiif/REQUEST_OFFLINE_RESOURCE",ap=(0,wd.createAction)(ep)(),op=(0,wd.createAction)(tp)(),sp=(0,wd.createAction)(ip)(),lp=(0,wd.createAction)(rp)();(0,wd.createAction)(np)();var up="@iiif/BATCH",cp="@iiif/BATCH_IMPORT",hp=(0,wd.createAction)(up)();(0,wd.createAction)(cp)();var dp=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function pp(e,t){return!!(e===t||dp(e)&&dp(t))}function fp(e,t){if(!Array.isArray(e)||!Array.isArray(t))return e===t;if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!pp(e[i],t[i]))return!1;return!0}function gp(e,t){let i=e.iiif.requests[t],r=e.iiif.mapping[t];if(r&&e.iiif.entities[r][i.resourceUri])return e.iiif.entities[r][i.resourceUri]}function mp(e,t,{waitTimeout:i=30}={}){return async(r,n)=>{let a=e.getState(),o=a.iiif.requests[r];if(o)switch(o.loadingState){case Xd:break;case Zd:{let t,n=!1;try{let a=await Promise.race([new Promise(((i,a)=>{n||(t=e.subscribe((()=>{let t=e.getState();if(t.iiif.requests[r].loadingState!==Xd){if(t.iiif.requests[r].loadingState===Jd){let e=gp(t,r);e?i(e):a()}}else a()})))})),new Promise(((e,t)=>setTimeout((()=>{n=!0,t()}),60*i)))]);if(t&&t(),a)return a}catch(e){t&&t();break}break}case Jd:{let e=gp(a,r);if(e)return e;break}}e.dispatch(ap({id:r}));try{let i=await t(r,n);!i.id&&!i["@id"]&&(i["@type"]&&(i["@id"]=r),i.id=r);let a=((e,t)=>{let{entities:i,resource:r,mapping:n}=td(t);if(void 0===r.id)return[op({id:e,message:"ID is not defined in resource."})];let a=[Nd({entities:i}),Vd({mapping:n})];return r.id!==e&&(a.push(qd({id:e,type:r.type})),a.push(sp({requestId:e,actualId:r.id}))),a.push(lp({id:e})),a})(r,i);return e.dispatch(hp({actions:a})),gp(e.getState(),r)}catch(t){throw e.dispatch(op({id:r,message:t.toString()})),t}}}function vp(e,t,i,r){return!!(e[i]&&e[i][t]&&e[i][t][r]&&Array.isArray(e[i][t][r]))}var yp=Od({mapping:(e={},t)=>{switch(t.type){case Wd:return p(d({},e),{[t.payload.id]:t.payload.type});case Hd:return d(d({},e),t.payload.mapping);default:return e}},entities:(e={Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}},t)=>{var i;switch(t.type){case Md:{if(!e[t.payload.type]||!e[t.payload.type][t.payload.id])return e;let i=e[t.payload.type][t.payload.id];return"string"==typeof i?e:p(d({},e),{[t.payload.type]:p(d({},e[t.payload.type]),{[t.payload.id]:p(d({},i),{[t.payload.key]:t.payload.value})})})}case zd:{if(!vp(e,t.payload.id,t.payload.type,t.payload.key))return e;let i=e[t.payload.type][t.payload.id];if("string"==typeof i)return e;let r=Array.from(i[t.payload.key]),[n]=r.splice(t.payload.startIndex,1);return r.splice(t.payload.endIndex,0,n),p(d({},e),{[t.payload.type]:p(d({},e[t.payload.type]),{[t.payload.id]:p(d({},i),{[t.payload.key]:r})})})}case Id:{let i=Object.keys(t.payload.entities),r=d({},e);for(let n of i)r[n]=d(d({},e[n]||{}),t.payload.entities[n]||{});return r}case Ld:{if(!vp(e,t.payload.id,t.payload.type,t.payload.key))return e;let i=e[t.payload.type][t.payload.id],r=Array.from(i[t.payload.key]);return r.splice(t.payload.index||r.length+1,0,t.payload.reference),p(d({},e),{[t.payload.type]:p(d({},e[t.payload.type]),{[t.payload.id]:p(d({},i),{[t.payload.key]:r})})})}case Fd:{if(!vp(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id],n=Array.from(r[t.payload.key]),a=t.payload.index||n.findIndex((e=>e&&e.id===t.payload.reference.id));return-1===a||(null==(i=n[a])?void 0:i.id)!==t.payload.reference.id?e:(n.splice(a,1),p(d({},e),{[t.payload.type]:p(d({},e[t.payload.type]),{[t.payload.id]:p(d({},r),{[t.payload.key]:n})})}))}default:return e}},requests:(e={},t)=>{switch(t.type){case ep:case np:return p(d({},e),{[t.payload.id]:{requestUri:t.payload.id,loadingState:Zd,uriMismatch:!1,resourceUri:t.payload.id}});case ip:return p(d({},e),{[t.payload.requestId]:p(d({},e[t.payload.requestId]||{}),{uriMismatch:!0,resourceUri:t.payload.actualId}),[t.payload.actualId]:{requestUri:t.payload.requestId,loadingState:e[t.payload.requestId].loadingState,uriMismatch:!0,resourceUri:t.payload.actualId}});case tp:return p(d({},e),{[t.payload.id]:p(d({},e[t.payload.id]||{}),{loadingState:Xd,error:t.payload.message})});case rp:return p(d({},e),{[t.payload.id]:p(d({},e[t.payload.id]||{}),{loadingState:Jd,error:void 0})})}return e},meta:(e={},t)=>{let{id:i,updateValue:r,value:n,meta:a,key:o}=t&&t.payload||{};switch(t.type){case Qd:return p(d({},e),{[i]:p(d({},e[i]||{}),{[a]:p(d({},e[i]&&e[i][a]||{}),{[o]:n})})});case Yd:return p(d({},e),{[i]:p(d({},e[i]||{}),{[a]:p(d({},e[i]&&e[i][a]||{}),{[o]:e[i]&&e[i][a]?r(e[i][a][o]):r(void 0)})})});case Gd:return e[i]&&e[i][a]&&e[i][a][o]?p(d({},e),{[i]:p(d({},e[i]||{}),{[a]:p(d({},e[i]&&e[i][a]||{}),{[o]:void 0})})}):e;default:return e}}}),bp=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Td;function wp(e={}){let{enableDevtools:t=!0,iiifStoreName:i="iiif",defaultState:r={},extraMiddleware:n=[],customReducers:a={}}=e;return Pd(function(e){return(t,i)=>i&&i.type===up?i.payload.actions.reduce(e,t):i&&i.type===cp?i.payload.state:e(t,i)}(Od(d({[i]:yp},a))),r,t?bp(Rd(...n)):Td(Rd(...n)))}var xp=class{constructor(e,t){x(this,"options"),x(this,"store"),x(this,"emitter"),x(this,"isBatching",!1),x(this,"batchQueue",[]),x(this,"remoteFetcher"),x(this,"staticFetcher"),x(this,"defaultFetcher",(e=>fetch(e).then((e=>e.json())))),x(this,"middleware",(e=>t=>i=>{if(i.type===up){for(let t of i.payload.actions)this.emitter.emit(t.type,{realAction:t,state:e.getState()});let r=t(i);for(let e of i.payload.actions)this.emitter.emit(`after:${i.type}`,{action:i,state:r});return r}this.emitter.emit(i.type,{action:i,state:e.getState()});let r=t(i);return this.emitter.emit(`after:${i.type}`,{action:i,state:r}),r})),this.options=Object.assign({reducers:{},middleware:[],defaultState:{},customFetcher:this.defaultFetcher,enableDevtools:!0},e||{}),this.store=t||wp({customReducers:this.options.reducers,extraMiddleware:[...this.options.middleware,this.middleware],defaultState:this.options.defaultState,enableDevtools:this.options.enableDevtools}),this.emitter=function(e){return{all:e=e||new Map,on:function(t,i){var r=e.get(t);r?r.push(i):e.set(t,[i])},off:function(t,i){var r=e.get(t);r&&(i?r.splice(r.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var r=e.get(t);r&&r.slice().map((function(e){e(i)})),(r=e.get("*"))&&r.slice().map((function(e){e(t,i)}))}}}(),this.remoteFetcher=mp(this.store,this.options.customFetcher),this.staticFetcher=mp(this.store,((e,t)=>t))}batch(e){this.isBatching=!0;try{e(this),this.store.dispatch(hp({actions:this.batchQueue}))}catch(e){throw this.batchQueue=[],this.isBatching=!1,e}this.batchQueue=[],this.isBatching=!1}async asyncBatch(e){this.isBatching=!0;try{await e(this),this.store.dispatch(hp({actions:this.batchQueue}))}catch(e){throw this.batchQueue=[],this.isBatching=!1,e}this.batchQueue=[],this.isBatching=!1}modifyEntityField(e,t,i){this.dispatch(Ud.modifyEntityField({id:e.id,type:e.type,key:t,value:i}))}dispatch(e){this.isBatching?this.batchQueue.push(e):this.store.dispatch(e)}serialize(e,t){return nd(this.getState().iiif,e,t)}toPresentation2(e){return this.serialize(e,dd)}toPresentation3(e){return this.serialize(e,bd)}hydrate(e,t){return this.get(e,t,{skipSelfReturn:!1})}get(e,t,i={}){"string"!=typeof t&&(i=t||{},t=void 0);let{skipSelfReturn:r=!0}=i||{};if(Array.isArray(e))return e.map((e=>this.get(e,i)));let n=this.getState();if("string"==typeof e){let i=t||n.iiif.mapping[e];if(!i)return r?null:{id:e,type:"unknown"};e={id:e,type:i}}let a=t||e.type,o=e.id,s=n.iiif.entities[a];if(!s){let t=n.iiif.requests[o];return t&&t.resourceUri!==o?this.get(t.resourceUri,i):r?null:e}return s[e.id]||(r?null:e)}select(e){return e(this.getState())}getStore(){return this.store}getState(){return this.store.getState()}loadManifest(e,t){let i="string"==typeof e?e:e.id;return this.load(i,t)}loadCollection(e,t){let i="string"==typeof e?e:e.id;return this.load(i,t)}load(e,t){let i="string"==typeof e?e:e.id;return t?this.staticFetcher(i,t):this.remoteFetcher(i)}areInputsEqual(e,t){return fp(e,t)}subscribe(e,t,i){typeof i>"u"&&(typeof t>"u"||!1===t||!0===t)&&(i=t,t=e,e=e=>e);let r=i?null:e(this.store.getState());return i||t(r,this),this.store.subscribe((()=>{let i=this.store.getState(),n=e(i);fp(r,n)||t(n,this),r=n}))}async ensureLoaded(e){let t="string"==typeof e?e:e.id;this.requestStatus(t)||await this.load(t)}requestStatus(e){return this.select((t=>t.iiif.requests[e]))}getResourceMeta(e,t){let i=this.getState().iiif.meta[e];if(i)return t?i[t]:i}setMetaValue([e,t,i],r){this.dispatch("function"==typeof r?Kd.setMetaValueDynamic({id:e,meta:t,key:i,updateValue:r}):Kd.setMetaValue({id:e,meta:t,key:i,value:r}))}};function _p(e){let t=typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{};try{let e=t.IIIF_VAULT;if(e)return e}catch(e){}let i=new xp(e);try{t.IIIF_VAULT=i}catch(e){}return i}var Sp=b(Mt(),1),Ep=(b(It(),1),Object.defineProperty),kp=Object.defineProperties,Cp=Object.getOwnPropertyDescriptors,Ap=Object.getOwnPropertySymbols,Pp=Object.prototype.hasOwnProperty,Op=Object.prototype.propertyIsEnumerable,Tp=(e,t,i)=>t in e?Ep(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Rp=(e,t)=>{for(var i in t||(t={}))Pp.call(t,i)&&Tp(e,i,t[i]);if(Ap)for(var i of Ap(t))Op.call(t,i)&&Tp(e,i,t[i]);return e},Ip=(e,t)=>kp(e,Cp(t));function Mp(e){return e.endsWith("info.json")?e:e.endsWith("/")?`${e}info.json`:`${e}/info.json`}var zp="http://library.stanford.edu/iiif/image-api/compliance.html#level1",Lp="http://library.stanford.edu/iiif/image-api/compliance.html#level2",Fp="http://library.stanford.edu/iiif/image-api/conformance.html#level1",Np="http://library.stanford.edu/iiif/image-api/conformance.html#level2",jp="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",$p="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",Bp="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",Dp="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",Up="http://iiif.io/api/image/1/level1.json",Wp="http://iiif.io/api/image/1/profiles/level1.json",Hp="http://iiif.io/api/image/1/level2.json",qp="http://iiif.io/api/image/1/profiles/level2.json",Vp="http://iiif.io/api/image/2/level1.json",Qp="http://iiif.io/api/image/2/profiles/level1.json",Yp="http://iiif.io/api/image/2/level2.json",Gp="http://iiif.io/api/image/2/profiles/level2.json",Kp="level1",Xp="level2",Zp="http://iiif.io/api/image/2/level1",Jp="http://iiif.io/api/image/2/level2",ef=[Jp,Lp,Np,$p,Dp,Hp,qp,Yp,Gp,Xp],tf=[...ef,Zp,zp,Fp,jp,Bp,Up,Wp,Vp,Qp,Kp],rf=["http://iiif.io/api/image/2/level0",Zp,Jp,"http://library.stanford.edu/iiif/image-api/compliance.html#level0",zp,Lp,"http://library.stanford.edu/iiif/image-api/conformance.html#level0",Fp,Np,"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",jp,$p,"http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",Bp,Dp,"http://iiif.io/api/image/1/level0.json","http://iiif.io/api/image/1/profiles/level0.json",Up,Wp,Hp,qp,"http://iiif.io/api/image/2/level0.json","http://iiif.io/api/image/2/profiles/level0.json",Vp,Qp,Yp,Gp,"level0",Kp,Xp],nf={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["sizeByWhListed"]},af={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPx","regionSquare","sizeByWhListed","sizeByH","sizeByW","sizeByWh"]},of={extraFormats:["jpg","png"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPct","regionByPx","regionSquare","rotationBy90s","sizeByWhListed","sizeByConfinedWh","sizeByH","sizeByPct","sizeByW","sizeByWh"]};function sf(e){return-1!==ef.indexOf(e)?of:-1!==tf.indexOf(e)?af:nf}function lf(e){try{if("full"===e)return{full:!0};if("square"===e)return{square:!0};let t=e.startsWith("pct:"),i=e.substr(t?4:0).split(",").map((e=>parseFloat(e)));return{x:i[0],y:i[1],w:i[2],h:i[3],percent:t}}catch(t){throw new Error("Expected 'full', 'square' or 'x,y,w,h'. Found "+e)}}function uf(e){let t={upscaled:!1,max:!1,confined:!1};if("^"===e[0]&&(t.upscaled=!0,e=e.slice(1)),"max"===e||"full"===e)return t.max=!0,t.serialiseAsFull="full"===e,t;if("!"===e[0]&&(t.confined=!0,e=e.slice(1)),"p"===e[0])return t.percentScale=parseFloat(e.slice(4)),t;let i=e.split(",").map((e=>e.trim()));return i.length&&(""!==i[0]&&(t.width=parseInt(i[0],10)),""!==i[1]&&(t.height=parseInt(i[1],10))),t}function cf(e){let t={angle:0};if("!"===e[0]&&(t.mirror=!0,e=e.substr(1)),t.angle=parseFloat(e)%360,Number.isNaN(t.angle))throw new Error(`Invalid rotation ${e}`);return t}function hf(e,t=""){let{path:i,scheme:r,server:n,prefix:a}=function(e,t=""){let i=e.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!i)throw new Error(`Invalid or unknown input ${e}`);let r=i[2],n=i[3],a=i[4];if("/"===a[0]&&(a=a.substr(1)),t.length>0){if("/"===t[0]&&(t=t.substr(1)),t!==a.substr(0,t.length))throw new Error(`Path does not start with prefix (path: ${a}, prefix: ${t})`);a=a.substr(t.length)}return{scheme:r,server:n,path:a,prefix:t}}(e,t),o=i.split("/").reverse(),[s,l,u,c,...h]=o,d=h.reverse().filter(Boolean).join("/");if(1===o.length||""===s)return{type:"base",scheme:r,server:n,prefix:a,identifier:d};if("info.json"===s){let[,...e]=o;return{type:"info",scheme:r,server:n,prefix:a,identifier:e.reverse().filter(Boolean).join("/")}}let p=s.split(".");return{type:"image",scheme:r,server:n,prefix:a,identifier:d,originalPath:i,region:lf(c),size:uf(u),rotation:cf(l),quality:p[0],format:p[1]}}function df(e){let t=hf(Mp(e.id));if("info"!==t.type)throw new Error("Invalid service URL");let i=function(e){let t=e?Array.isArray(e.profile)?e.profile:[e.profile]:[],i={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let e of t)if("string"==typeof e&&(e=sf(e)),e){if(e.formats)for(let t of e.formats)-1===i.extraFormats.indexOf(t)&&i.extraFormats.push(t);if(e.qualities)for(let t of e.qualities)-1===i.extraQualities.indexOf(t)&&i.extraQualities.push(t);if(e.supports)for(let t of e.supports)-1===i.extraFeatures.indexOf(t)&&i.extraFeatures.push(t);if(e.maxHeight&&(i.maxHeight=e.maxHeight),e.maxWidth&&(i.maxWidth=e.maxWidth),e.maxArea&&(i.maxArea=e.maxArea),e.extraFormats)for(let t of e.extraFormats)-1===i.extraFormats.indexOf(t)&&i.extraFormats.push(t);if(e.extraQualities)for(let t of e.extraQualities)-1===i.extraQualities.indexOf(t)&&i.extraQualities.push(t);if(e.extraFeatures)for(let t of e.extraFeatures)-1===i.extraFeatures.indexOf(t)&&i.extraFeatures.push(t);e.maxHeight&&(i.maxHeight=e.maxHeight),e.maxWidth&&(i.maxWidth=e.maxWidth),e.maxArea&&(i.maxArea=e.maxArea)}if(e.extraFormats)for(let t of e.extraFormats)-1===i.extraFormats.indexOf(t)&&i.extraFormats.push(t);if(e.extraFeatures)for(let t of e.extraFeatures)-1===i.extraFeatures.indexOf(t)&&i.extraFeatures.push(t);if(e.extraQualities)for(let t of e.extraQualities)-1===i.extraQualities.indexOf(t)&&i.extraQualities.push(t);return i}(e);return{identifier:t.identifier,originalPath:"",server:t.server,prefix:t.prefix,scheme:t.scheme,type:"image",quality:-1===i.extraQualities.indexOf("default")?i.extraQualities[0]:"default",region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:"jpg",rotation:{angle:0}}}function pf(e,t,i){let r=i.length,n=[];for(let t=0;t<r;t++){let r=i[t].width;n.push(e/r)}return n}function ff(e,t,i){let r=i.length,n=[];for(let a=0;a<r;a++){let r=i[a];n.push({width:Math.floor(e/r),height:Math.floor(t/r)})}return n}function gf(e){return e["@id"]?e["@id"]:e.id?e.id:void 0}function mf(e){if(!e||!e.profile||!gf(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let e of t)if("string"==typeof e&&-1!==rf.indexOf(e))return!0;return!1}function vf(e){if(!function(e){if(!mf(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let e of t)if("string"==typeof e){if(-1!==tf.indexOf(e))return!0}else{let t=[...e.supports||[],...e.extraFeatures||[]];if(-1!==t.indexOf("regionByPx")&&(-1!==t.indexOf("sizeByW")||-1!==t.indexOf("sizeByWh")))return!0}return!1}(e))return[];let t=[],i=Array.isArray(e.profile)?e.profile:[e.profile],r=i.length;for(let t=0;t<r;t++){let r=i[t];if("string"!=typeof r&&(r.maxHeight||r.maxWidth))return[{id:gf(e),type:"variable",minWidth:0,minHeight:0,maxHeight:r.maxHeight||r.maxWidth,maxWidth:r.maxWidth||r.maxHeight}]}if(e.tiles){let i=e.tiles.length;for(let r=0;r<i;r++){let i=e.tiles[r];(i.height||i.width)&&t.push({id:gf(e),type:"variable",minHeight:0,minWidth:0,maxHeight:i.height||i.width,maxWidth:i.width})}}return t}function yf(e){let t=e.match(/^.*\/(full)\/(((\d+),(\d+)?)|max)\/(\d+)\/default\.(jpg|png|jpeg)$/);if(t){let i=t[1],r=parseInt(t[4],10),n=parseInt(t[5],10),a=t[7];if(("max"===i||"full"===i)&&r&&n&&a)return{type:"fixed",id:e,height:n,width:r}}return{type:"unknown",id:e}}function bf(e){return mf(e)?(e&&e.sizes?e.sizes:[]).map((t=>({id:gf(e),type:"fixed-service",height:t.height,width:t.width}))):[]}function wf(e){let t=[],i=e.length;for(let r=0;r<i;r++){let i=bf(e[r]);i.length&&t.push(...i);let n=vf(e[r]);n.length&&t.push(...n)}return t}function xf(e){let t=e.service?Array.isArray(e.service)?e.service:[e.service]:[],i=t.length,r=[];for(let e=0;e<i;e++)mf(t[e])&&r.push(t[e]);return r}function _f(e,t=!0,i){let r=[],n=function(e){if("string"==typeof e)return yf(e);let t=function(e){return e["@type"]?e["@type"]:e.type?e.type:void 0}(e);if("Image"!==t&&"sc:Image"!==t)return null;let i=e,r=gf(i);return r?r&&i.width&&i.height?{id:r,type:"fixed",width:i.width,height:i.height,unsafe:!0}:yf(r):null}(e);if(null===n)return r;let a=e;if(r.push(n),t&&a.width&&a.height){let e=[],t=xf(a);for(let r of t){let t={id:gf(r),width:a.width,height:a.height};if(i.canLoadSync(t)){let r=i.loadServiceSync(t);r&&(r.height||(r.height=a.height),r.width||(r.width=a.width),e.push(...wf([r])))}}if(e.length)return r.push(...e),r}return a.service&&r.push(...wf(a.service)),r}function Sf({x:e=0,y:t=0,w:i,h:r,full:n,square:a,percent:o}){if(n)return"full";if(a)return"square";if(typeof i>"u"||typeof r>"u")throw new Error("RegionParameter: invalid region");let s=`${e},${t},${i},${r}`;return o?`pct:${s}`:s}function Ef({max:e,percentScale:t,upscaled:i,confined:r,width:n,height:a,serialiseAsFull:o}){let s=[];return i&&s.push("^"),e?(s.push(o?"full":"max"),s.join("")):(r&&s.push("!"),t&&s.push(`pct:${t}`),n&&s.push(`${n}`),s.push(","),a&&s.push(`${a}`),s.join(""))}function kf(e){return`${e.mirror?"!":""}${(e.angle||0)%360}`}var Cf=Object.defineProperty,Af=Object.defineProperties,Pf=Object.getOwnPropertyDescriptors,Of=Object.getOwnPropertySymbols,Tf=Object.prototype.hasOwnProperty,Rf=Object.prototype.propertyIsEnumerable,If=(e,t,i)=>t in e?Cf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Mf=(e,t)=>{for(var i in t||(t={}))Tf.call(t,i)&&If(e,i,t[i]);if(Of)for(var i of Of(t))Rf.call(t,i)&&If(e,i,t[i]);return e},zf=(e,t)=>Af(e,Pf(t));function Lf(e,t){let i=e.prefix.startsWith("/")?e.prefix.substr(1):e.prefix,r=`${e.scheme}://${e.server}/${i?`${i}/`:""}${e.identifier}`;if("base"===e.type)return r;if("info"===e.type)return`${r}/info.json`;let{region:n,size:a,rotation:o,format:s,quality:l}=e;if(t){let e=t["@context"]?Array.isArray(t["@context"])?t["@context"]:[t["@context"]]:[],i=-1!==e.indexOf("http://iiif.io/api/image/2/context.json"),r=-1!==e.indexOf("http://iiif.io/api/image/3/context.json");if((a.width===t.width&&!a.height||a.height===t.height&&!a.width||a.width===t.width&&a.height===t.height)&&(a=zf(Mf({},a),{max:!0})),i&&(a.max&&!a.serialiseAsFull&&(a=zf(Mf({},a),{serialiseAsFull:!0})),!a.max&&a.width&&a.height&&(a=zf(Mf({},a),{height:void 0}))),r&&(a.max&&a.serialiseAsFull&&(a=zf(Mf({},a),{serialiseAsFull:!1})),a.width&&!a.height&&t.width&&t.height)){let e=t.height/t.width;a=zf(Mf({},a),{height:Math.ceil(a.width*e)})}}return[r,Sf(n),Ef(a),kf(o),`${l}.${s}`].filter(Boolean).join("/")}function Ff(e,t,i){let r=df({id:Mp(gf(e)),profile:"level2",type:"ImageService2"});if("image"!==r.type)throw new Error("Invalid service");return r.size.max=!1,r.size.width=t,r.size.height=i,{id:Lf(r),type:"fixed",width:t,height:i||e.height/(e.width||1)*t,unsafe:e.width>t}}function Nf(e){let t=e.replace(/(https?:\/\/)?(www.)?/i,"");return-1!==t.indexOf("/")?t.split("/")[0]:t}function jf(e,t){let i=[],r=Object.assign({unsafeImageService:!1,atAnyCost:!0,fallback:!0,minHeight:64,minWidth:64,maxHeight:1/0,maxWidth:1/0,returnAllOptions:!1,preferFixedSize:!1,allowUnsafe:!1,explain:!1,height:0,width:0},e),n=[],a=[],o=null,s=(e,t)=>{if(function(e,t,i){let r=e.width?e.width:e.maxWidth;return i.height<=e.maxHeight&&i.width<=e.maxWidth&&i.height>=e.minHeight&&i.width>=e.minWidth&&(!t||Math.abs(i.width-r)<Math.abs(t.width-r))}(r,t,e)){if(r.preferFixedSize&&e.unsafe)return void a.push(e);r.returnAllOptions&&t&&a.push(t),o=e}else r.returnAllOptions&&a.push(e)},l=t.length;for(let e=0;e<l;e++){let i=t[e](),a=i.length;for(let e=0;e<a;e++){let t=i[e];if("unknown"===t.type&&r.atAnyCost&&n.push(t),"fixed"===t.type&&(t.unsafe?n.push(t):s(t,o)),"fixed-service"===t.type)if(r.unsafeImageService){s(Ff(t,r.width,r.height),o)}else{s(Ff(t,t.width,t.height),o)}if("variable"===t.type&&t.maxWidth){s(Ff({id:t.id,type:"fixed-service",width:t.maxWidth,height:t.maxWidth},t.maxWidth),o)}}if(o&&!r.returnAllOptions){if(o.unsafe||r.allowUnsafe)continue;break}}return r.atAnyCost&&0===a.length?{best:o||n[0],fallback:n.slice(1),log:i}:r.returnAllOptions?{best:r.atAnyCost?o||a[0]||n[0]:o||a[0],fallback:[...a,...n],log:i}:{best:o||a[0]||null,fallback:o?a:a.slice(1),log:i}}var $f=Object.defineProperty,Bf=Object.defineProperties,Df=Object.getOwnPropertyDescriptors,Uf=Object.getOwnPropertySymbols,Wf=Object.prototype.hasOwnProperty,Hf=Object.prototype.propertyIsEnumerable,qf=(e,t,i)=>t in e?$f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Vf=(e,t)=>{for(var i in t||(t={}))Wf.call(t,i)&&qf(e,i,t[i]);if(Uf)for(var i of Uf(t))Hf.call(t,i)&&qf(e,i,t[i]);return e},Qf=(e,t)=>Bf(e,Df(t));function Yf(e,t,i){let r=e>t?e:t,n=i.length,a=[];for(let e=0;e<n;e++){let t=i[e],n=t.scaleFactors[0],o=r/n,s=[n];for(;o>=t.width;)n*=2,s.push(n),o/=2;a.push(Qf(Vf({},t),{scaleFactors:s}))}return a}var Gf=(e,t,i)=>new Promise(((r,n)=>{var a=e=>{try{s(i.next(e))}catch(e){n(e)}},o=e=>{try{s(i.throw(e))}catch(e){n(e)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(a,o);s((i=i.apply(e,t)).next())}));new class{constructor(){this.config={verificationsRequired:1,approximateServices:!0,enableFetching:!0,disableThrottling:!1},this.fetchingCount=0,this.imageServices={},this.knownImageServers={}}setConfig(e){Object.assign(this.config,e)}sample(e,t,i=!0){let r=Nf(gf(e)),n=Mp(gf(e)),a=this.knownImageServers[r];return this.imageServices[n]=Object.assign(e,{real:!0}),a?this.verify(e):(this.knownImageServers[r]={verifications:0,malformed:!1,root:r,preLoaded:i,sampledId:gf(e),verified:!1,server:null,result:{context:e["@context"]||[],sampledProfile:e.profile,resourceServiceRatio:t&&e.height?t.height/e.height:1,sampledSizes:e.sizes||[],sizeRatios:pf(e.width,e.height,e.sizes||[]),sampledTiles:e.tiles||[]}},!0)}preLoad(e,t=!0){this.knownImageServers[e.root]=e,t&&(this.knownImageServers[e.root].malformed=!1,this.knownImageServers[e.root].verifications=this.config.verificationsRequired)}predict(e,t=!1,i=!1){let r=null==e?void 0:e.source,n=Nf(gf(e)),a=this.knownImageServers[n];if(!a||!a.result||!i&&(a.malformed||a.verifications<this.config.verificationsRequired))return null;let o=Mp(gf(e));return this.imageServices[o]||(this.imageServices[o]={"@context":a.result.context,"@id":gf(e),id:gf(e),protocol:"http://iiif.io/api/image",tiles:(null==r?void 0:r.tiles)||Yf(e.width,e.height,a.result.sampledTiles),sizes:(null==r?void 0:r.sizes)||ff(Math.round(e.width/a.result.resourceServiceRatio),Math.round(e.height/a.result.resourceServiceRatio),a.result.sizeRatios),profile:(null==r?void 0:r.profile)||a.result.sampledProfile,height:(null==r?void 0:r.height)||e.height,width:(null==r?void 0:r.width)||e.width,real:!1}),this.imageServices[o]}getThumbnailFromResource(e,t){return Gf(this,arguments,(function*(e,t,i=!0,r=[]){let n=yield this.getImageCandidates(e,i);return jf(t,[()=>r,()=>n])}))}getImageCandidates(e,t=!0){return Gf(this,null,(function*(){let i=e;if(t&&i.height&&i.width){let e=xf(i);for(let t of e){let e={id:gf(t),width:t.width?t.width:i.width,height:t.height?t.height:i.height,source:t};yield this.loadService(e)}}return _f(e,t,this)}))}verify(e){return Gf(this,null,(function*(){let t=this.predict(e,!1,!0),i=yield this.fetchService(gf(e));if(!t)return!1;let r=t.height===i.height&&t.width===i.width&&t["@context"]===i["@context"]&&function(e,t){if(e.length!==t.length)return!1;if(0===e.length&&0===t.length)return!0;let i=e.length,r=!0;for(let n=0;n<i;n++){let i=e[n],a=t[n];if(i.width!==a.width||i.height!==a.height){r=!1;break}}if(r)return!0;let n=0;for(let r=0;r<i;r++)for(let a=0;a<i;a++)if(e[r].width===t[a].width&&e[r].height===t[a].height){n++;break}return n===i}(t.sizes||[],i.sizes||[]);if(r){let t=Nf(gf(e));this.knownImageServers[t].verifications+=1,this.knownImageServers[t].verifications>=this.config.verificationsRequired&&(this.knownImageServers[t].verified=!0)}return r}))}canLoadSync(e){let t="string"==typeof e?e:gf(e),i=Mp(t);if(this.imageServices[i])return!0;let r=this.knownImageServers[Nf(t)];return r&&!r.malformed&&r.verifications>=this.config.verificationsRequired}markAsMalformed(e){return Gf(this,null,(function*(){return this.knownImageServers[Nf(gf(e))].malformed=!0,this.loadService(e,!0)}))}fetchService(e,t=!1){return Gf(this,null,(function*(){let i=Mp(e);if(this.imageServices[i]&&(!t||this.imageServices[i].real))return this.imageServices[i];if(!this.config.enableFetching)throw new Error("Fetching is not enabled");let r=yield this.fetch(i).then((e=>e.json()));return!r.id&&r["@id"]&&(r.id=r["@id"]),r.id!==e&&(r.id=e,r["@id"]&&(r["@id"]=e)),this.imageServices[i]=Object.assign(r,{real:!0}),this.imageServices[i]}))}fetch(e,t){return Gf(this,null,(function*(){return fetch(e,t)}))}loadService(e,t=!1){return Gf(this,null,(function*(){if(!this.config.disableThrottling){let e=!0;for(;e;){if(!(this.fetchingCount>=this.config.verificationsRequired)){e=!1;break}yield new Promise((e=>setTimeout(e,500)))}}let i=this.knownImageServers[Nf(gf(e))];if(i&&!i.malformed&&!t){yield i.result;let t=this.loadServiceSync(e);if(t)return t}this.fetchingCount++;let r=yield this.fetchService(gf(e),t);return this.fetchingCount--,r.real&&this.sample(r,e),r}))}loadServiceSync(e){let t=Mp(gf(e));return this.imageServices[t]?this.imageServices[t]:this.predict(e)}};var Kf=/&?(xywh=)?(pixel:|percent:|pct:)?([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?)/,Xf=/&?(t=)(npt:)?([0-9]+(.[0-9]+)?)?(,([0-9]+(.[0-9]+)?))?/;function Zf(e){if(Array.isArray(e))return e.reduce(((e,t)=>{let{selector:i,selectors:r}=Zf(t);return i&&(e.selector||(e.selector=i),e.selectors.push(...r)),e}),{selector:null,selectors:[]});if(!e)return{selector:null,selectors:[]};if("string"==typeof e){let[t,i]=e.split("#");return i?Zf({type:"FragmentSelector",value:i}):{selector:null,selectors:[]}}if("PointSelector"===e.type&&(e.t||0===e.t)){let t={type:"TemporalSelector",temporal:{startTime:e.t}};return{selector:t,selectors:[t]}}if("FragmentSelector"===e.type){let t=Kf.exec(e.value);if(t){let e={type:"BoxSelector",spatial:{unit:"percent:"===t[2]||"pct:"===t[2]?"percent":"pixel",x:parseFloat(t[3]),y:parseFloat(t[4]),width:parseFloat(t[5]),height:parseFloat(t[6])}};return{selector:e,selectors:[e]}}let i=e.value.match(Xf);if(i){let e={type:"TemporalSelector",temporal:{startTime:i[4]?parseFloat(i[4]):0,endTime:i[7]?parseFloat(i[7]):void 0}};return{selector:e,selectors:[e]}}return{selector:null,selectors:[]}}return{selector:null,selectors:[]}}function Jf(e,t={}){if(Array.isArray(e))return Jf(e[0]);if("string"==typeof e){let[i,r]=e.split("#");return r?Jf({type:"SpecificResource",source:{id:i,type:"Unknown"},selector:{type:"FragmentSelector",value:r}}):{type:"SpecificResource",source:{id:i,type:t.typeMap&&t.typeMap[i]||"Unknown"},selector:null,selectors:[]}}if("Choice"===e.type||"List"===e.type||"Composite"===e.type||"Independents"===e.type)return Jf(e.items[0]);if("SpecificResource"===e.type){"Canvas"===e.source.type&&e.source.partOf&&"string"==typeof e.source.partOf&&(e.source.partOf=[{id:e.source.partOf,type:"Manifest"}]);let{selector:t,selectors:i}=e.selector?Zf(e.selector):{selector:null,selectors:[]};return{type:"SpecificResource",source:e.source,selector:t,selectors:i}}if(e.id){"Canvas"===e.type&&e.partOf&&"string"==typeof e.partOf&&(e.partOf=[{id:e.partOf,type:"Manifest"}]);let[t,i]=e.id.split("#");return i?Jf({type:"SpecificResource",source:Ip(Rp({},e),{id:t}),selector:{type:"FragmentSelector",value:i}}):{type:"SpecificResource",source:Ip(Rp({},e),{id:t}),selector:null,selectors:[]}}return{type:"SpecificResource",source:e,selector:null,selectors:[]}}function eg(e){return e.endsWith("info.json")?e:e.endsWith("/")?`${e}info.json`:`${e}/info.json`}var tg="http://library.stanford.edu/iiif/image-api/compliance.html#level1",ig="http://library.stanford.edu/iiif/image-api/compliance.html#level2",rg="http://library.stanford.edu/iiif/image-api/conformance.html#level1",ng="http://library.stanford.edu/iiif/image-api/conformance.html#level2",ag="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",og="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",sg="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",lg="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",ug="http://iiif.io/api/image/1/level1.json",cg="http://iiif.io/api/image/1/profiles/level1.json",hg="http://iiif.io/api/image/1/level2.json",dg="http://iiif.io/api/image/1/profiles/level2.json",pg="http://iiif.io/api/image/2/level1.json",fg="http://iiif.io/api/image/2/profiles/level1.json",gg="http://iiif.io/api/image/2/level2.json",mg="http://iiif.io/api/image/2/profiles/level2.json",vg="level1",yg="level2",bg="http://iiif.io/api/image/2/level1",wg="http://iiif.io/api/image/2/level2",xg=[wg,ig,ng,og,lg,hg,dg,gg,mg,yg],_g=[...xg,bg,tg,rg,ag,sg,ug,cg,pg,fg,vg],Sg=["http://iiif.io/api/image/2/level0",bg,wg,"http://library.stanford.edu/iiif/image-api/compliance.html#level0",tg,ig,"http://library.stanford.edu/iiif/image-api/conformance.html#level0",rg,ng,"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",ag,og,"http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",sg,lg,"http://iiif.io/api/image/1/level0.json","http://iiif.io/api/image/1/profiles/level0.json",ug,cg,hg,dg,"http://iiif.io/api/image/2/level0.json","http://iiif.io/api/image/2/profiles/level0.json",pg,fg,gg,mg,"level0",vg,yg],Eg={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["sizeByWhListed"]},kg={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPx","regionSquare","sizeByWhListed","sizeByH","sizeByW","sizeByWh"]},Cg={extraFormats:["jpg","png"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPct","regionByPx","regionSquare","rotationBy90s","sizeByWhListed","sizeByConfinedWh","sizeByH","sizeByPct","sizeByW","sizeByWh"]};function Ag(e){return-1!==xg.indexOf(e)?Cg:-1!==_g.indexOf(e)?kg:Eg}function Pg(e){try{if("full"===e)return{full:!0};if("square"===e)return{square:!0};let t=e.startsWith("pct:"),i=e.substr(t?4:0).split(",").map((e=>parseFloat(e)));return{x:i[0],y:i[1],w:i[2],h:i[3],percent:t}}catch(t){throw new Error("Expected 'full', 'square' or 'x,y,w,h'. Found "+e)}}function Og(e){let t={upscaled:!1,max:!1,confined:!1};if("^"===e[0]&&(t.upscaled=!0,e=e.slice(1)),"max"===e||"full"===e)return t.max=!0,t.serialiseAsFull="full"===e,t;if("!"===e[0]&&(t.confined=!0,e=e.slice(1)),"p"===e[0])return t.percentScale=parseFloat(e.slice(4)),t;let i=e.split(",").map((e=>e.trim()));return i.length&&(""!==i[0]&&(t.width=parseInt(i[0],10)),""!==i[1]?(t.height=parseInt(i[1],10),t.version=2):t.version=3),t}function Tg(e){let t={angle:0};if("!"===e[0]&&(t.mirror=!0,e=e.substr(1)),t.angle=parseFloat(e)%360,Number.isNaN(t.angle))throw new Error(`Invalid rotation ${e}`);return t}function Rg(e,t=""){let i=e.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!i)throw new Error(`Invalid or unknown input ${e}`);let r=i[2],n=i[3],a=i[4];if("/"===a[0]&&(a=a.substr(1)),t.length>0){if("/"===t[0]&&(t=t.substr(1)),t!==a.substr(0,t.length))throw new Error(`Path does not start with prefix (path: ${a}, prefix: ${t})`);a=a.substr(t.length)}return{scheme:r,server:n,path:a,prefix:t}}function Ig(e){let t=function(e,t=""){let{path:i,scheme:r,server:n,prefix:a}=Rg(e,t),o=i.split("/").reverse(),[s,l,u,c,...h]=o,d=h.reverse().filter(Boolean).join("/");if(1===o.length||""===s)return{type:"base",scheme:r,server:n,prefix:a,identifier:d};if("info.json"===s){let[,...e]=o;return{type:"info",scheme:r,server:n,prefix:a,identifier:e.reverse().filter(Boolean).join("/")}}let p=s.split(".");return{type:"image",scheme:r,server:n,prefix:a,identifier:d,originalPath:i,region:Pg(c),size:Og(u),rotation:Tg(l),quality:p[0],format:p[1]}}(eg(e.id));if("info"!==t.type)throw new Error("Invalid service URL");let i=function(e){let t=e?Array.isArray(e.profile)?e.profile:[e.profile]:[],i={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let e of t)if("string"==typeof e&&(e=Ag(e)),e){if(e.formats)for(let t of e.formats)-1===i.extraFormats.indexOf(t)&&i.extraFormats.push(t);if(e.qualities)for(let t of e.qualities)-1===i.extraQualities.indexOf(t)&&i.extraQualities.push(t);if(e.supports)for(let t of e.supports)-1===i.extraFeatures.indexOf(t)&&i.extraFeatures.push(t);if(e.maxHeight&&(i.maxHeight=e.maxHeight),e.maxWidth&&(i.maxWidth=e.maxWidth),e.maxArea&&(i.maxArea=e.maxArea),e.extraFormats)for(let t of e.extraFormats)-1===i.extraFormats.indexOf(t)&&i.extraFormats.push(t);if(e.extraQualities)for(let t of e.extraQualities)-1===i.extraQualities.indexOf(t)&&i.extraQualities.push(t);if(e.extraFeatures)for(let t of e.extraFeatures)-1===i.extraFeatures.indexOf(t)&&i.extraFeatures.push(t);e.maxHeight&&(i.maxHeight=e.maxHeight),e.maxWidth&&(i.maxWidth=e.maxWidth),e.maxArea&&(i.maxArea=e.maxArea)}if(e.extraFormats)for(let t of e.extraFormats)-1===i.extraFormats.indexOf(t)&&i.extraFormats.push(t);if(e.extraFeatures)for(let t of e.extraFeatures)-1===i.extraFeatures.indexOf(t)&&i.extraFeatures.push(t);if(e.extraQualities)for(let t of e.extraQualities)-1===i.extraQualities.indexOf(t)&&i.extraQualities.push(t);return i}(e);return{identifier:t.identifier,originalPath:"",server:t.server,prefix:t.prefix,scheme:t.scheme,type:"image",quality:-1===i.extraQualities.indexOf("default")?i.extraQualities[0]:"default",region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:"jpg",rotation:{angle:0}}}function Mg(e,t,i){let r=i.length,n=[];for(let t=0;t<r;t++){let r=i[t].width;n.push(e/r)}return n}function zg(e,t,i){let r=i.length,n=[];for(let a=0;a<r;a++){let r=i[a];n.push({width:Math.floor(e/r),height:Math.floor(t/r)})}return n}function Lg(e){return e["@id"]?e["@id"]:e.id?e.id:void 0}function Fg(e){if(!e||!e.profile||!Lg(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let e of t)if("string"==typeof e&&-1!==Sg.indexOf(e))return!0;return!1}function Ng(e,t){if(t&&t.profile){let i=t.profile;if(i){let t=Array.isArray(i)?i:[i];return t.includes(`level${e}`)||t.includes(`http://iiif.io/api/image/2/level${e}.json`)||t.includes(`http://iiif.io/api/image/1/level${e}.json`)||t.includes(`http://iiif.io/api/image/1/profiles/level${e}.json`)}}return!1}function jg(e){return Fg(e)?Ng(0,e)?0:Ng(1,e)?1:Ng(2,e)?2:null:null}function $g(e){return-1!==(e["@context"]?Array.isArray(e["@context"])?e["@context"]:[e["@context"]]:[]).indexOf("http://iiif.io/api/image/3/context.json")}function Bg(e){if(!function(e){if(!Fg(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let e of t)if("string"==typeof e){if(-1!==_g.indexOf(e))return!0}else{let t=[...e.supports||[],...e.extraFeatures||[]];if(-1!==t.indexOf("regionByPx")&&(-1!==t.indexOf("sizeByW")||-1!==t.indexOf("sizeByWh")))return!0}return!1}(e))return[];let t=[],i=Array.isArray(e.profile)?e.profile:[e.profile],r=i.length;for(let t=0;t<r;t++){let r=i[t];if("string"!=typeof r&&(r.maxHeight||r.maxWidth))return[{id:Lg(e),type:"variable",minWidth:0,minHeight:0,maxHeight:r.maxHeight||r.maxWidth,maxWidth:r.maxWidth||r.maxHeight,level:jg(e),version:"http://iiif.io/api/image/3/context.json"===e["@context"]?3:2}]}if(e.tiles){let i=e.tiles.length;for(let r=0;r<i;r++){let i=e.tiles[r];(i.height||i.width)&&t.push({id:Lg(e),type:"variable",minHeight:0,minWidth:0,maxHeight:i.height||i.width,maxWidth:i.width,level:jg(e),version:$g(e)?3:2})}}return t}function Dg(e){let t=e.match(/^.*\/(full)\/(((\d+),(\d+)?)|max)\/(\d+)\/default\.(jpg|png|jpeg)$/);if(t){let i=t[1],r=parseInt(t[4],10),n=parseInt(t[5],10),a=t[7];if(("max"===i||"full"===i)&&r&&n&&a)return{type:"fixed",id:e,height:n,width:r}}return{type:"unknown",id:e}}function Ug(e){if("string"==typeof e)return Dg(e);let t=function(e){return e["@type"]?e["@type"]:e.type?e.type:void 0}(e);if("Image"!==t&&"sc:Image"!==t)return null;let i=e,r=Lg(i);return r?r&&i.width&&i.height?{id:r,type:"fixed",width:i.width,height:i.height,unsafe:!0}:Dg(r):null}function Wg(e){return Fg(e)?(e&&e.sizes?e.sizes:[]).map((t=>({id:Lg(e),type:"fixed-service",height:t.height,width:t.width,level:jg(e),version:$g(e)?3:2}))):[]}function Hg(e){let t=[],i=e.length;for(let r=0;r<i;r++){let i=Wg(e[r]);i.length&&t.push(...i);let n=Bg(e[r]);n.length&&t.push(...n)}return t}function qg(e){let t=e.service?Array.isArray(e.service)?e.service:[e.service]:[],i=t.length,r=[];for(let e=0;e<i;e++)Fg(t[e])&&r.push(t[e]);return r}function Vg({x:e=0,y:t=0,w:i,h:r,full:n,square:a,percent:o}){if(n)return"full";if(a)return"square";if(typeof i>"u"||typeof r>"u")throw new Error("RegionParameter: invalid region");let s=`${e},${t},${i},${r}`;return o?`pct:${s}`:s}function Qg({max:e,percentScale:t,upscaled:i,confined:r,width:n,height:a,serialiseAsFull:o,version:s}){let l=[];return i&&l.push("^"),e?(l.push(o?"full":"max"),l.join("")):(r&&l.push("!"),t&&l.push(`pct:${t}`),n&&l.push(`${n}`),l.push(","),a&&3===s&&l.push(`${a}`),l.join(""))}function Yg(e){return`${e.mirror?"!":""}${(e.angle||0)%360}`}var Gg=Object.defineProperty,Kg=Object.defineProperties,Xg=Object.getOwnPropertyDescriptors,Zg=Object.getOwnPropertySymbols,Jg=Object.prototype.hasOwnProperty,em=Object.prototype.propertyIsEnumerable,tm=(e,t,i)=>t in e?Gg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,im=(e,t)=>{for(var i in t||(t={}))Jg.call(t,i)&&tm(e,i,t[i]);if(Zg)for(var i of Zg(t))em.call(t,i)&&tm(e,i,t[i]);return e},rm=(e,t)=>Kg(e,Xg(t));function nm(e,t){let i=e.prefix.startsWith("/")?e.prefix.substr(1):e.prefix,r=`${e.scheme}://${e.server}/${i?`${i}/`:""}${e.identifier}`;if("base"===e.type)return r;if("info"===e.type)return`${r}/info.json`;let{size:n}=e,{region:a,rotation:o,format:s,quality:l}=e;if(t){let e=t["@context"]?Array.isArray(t["@context"])?t["@context"]:[t["@context"]]:[],i=-1!==e.indexOf("http://iiif.io/api/image/2/context.json"),r=-1!==e.indexOf("http://iiif.io/api/image/3/context.json");if((n.width===t.width&&!n.height||n.height===t.height&&!n.width||n.width===t.width&&n.height===t.height)&&(n=rm(im({},n),{max:!0})),i&&(n.max&&!n.serialiseAsFull&&(n=rm(im({},n),{serialiseAsFull:!0})),!n.max&&n.width&&n.height&&(n=rm(im({},n),{height:void 0})),n=rm(im({},n),{version:2})),r){if(n.max&&n.serialiseAsFull&&(n=rm(im({},n),{serialiseAsFull:!1})),n.width&&!n.height&&t.width&&t.height){let e=t.height/t.width;n=rm(im({},n),{height:Math.ceil(n.width*e)})}n=rm(im({},n),{version:3})}}return[r,Vg(a),Qg(n),Yg(o),`${l}.${s}`].filter(Boolean).join("/")}function am(e,t,i){let r=Ig({"@context":3===e.version?"http://iiif.io/api/image/3/context.json":"http://iiif.io/api/image/2/context.json",id:eg(Lg(e)),profile:null===e.level||typeof e.level>"u"?"level0":`level${e.level}}`,type:3===e.version?"ImageService3":"ImageService2"});if("image"!==r.type)throw new Error("Invalid service");return r.size.max=!1,r.size.width=t,r.size.height=i,{id:nm(r),type:"fixed",width:t,height:i||e.height/(e.width||1)*t,unsafe:e.width>t}}function om(e){let t=e.replace(/(https?:\/\/)?(www.)?/i,"");return-1!==t.indexOf("/")?t.split("/")[0]:t}function sm(e,t){let i=[],r=Object.assign({unsafeImageService:!1,atAnyCost:!0,fallback:!0,minHeight:64,minWidth:64,maxHeight:1/0,maxWidth:1/0,returnAllOptions:!1,preferFixedSize:!1,allowUnsafe:!1,explain:!1,height:0,width:0},e),n=(e,t=0)=>r.explain?i.push(new Array(t).fill(0).map((e=>"    ")).join("")+e().trim()):void 0,a=[],o=[],s=null;n((()=>`Using configuration: ${JSON.stringify(r,null,2)}`));let l=(e,t)=>{if(n((()=>"Swapping choice"),3),function(e,t,i){let r=e.width?e.width:e.maxWidth;return i.height<=e.maxHeight&&i.width<=e.maxWidth&&i.height>=e.minHeight&&i.width>=e.minWidth&&(!t||Math.abs(i.width-r)<Math.abs(t.width-r))}(r,t,e)){if(r.preferFixedSize&&e.unsafe)return n((()=>`We found an image that was marked as unsafe, but it was the best size. (${e.id})`),4),void o.push(e);r.returnAllOptions&&t&&o.push(t),n((()=>`We found a new image that was the best size. (${e.id})`),4),s=e}else r.returnAllOptions&&o.push(e)};n((()=>`The input shows we have ${t.length} list(s) of candidates to choose from.`));let u=t.length;for(let e=0;e<u;e++){let i=t[e]();n((()=>`Candidate group ${e}: ${JSON.stringify(i,null,2)}`),1);let o=i.length;n((()=>`Checking candidate list number ${e} and found ${o} potential ways of creating image(s)`),1);for(let e=0;e<o;e++){let t=i[e];if(n((()=>`-> Checking candidate ${e}`),1),"unknown"===t.type&&r.atAnyCost&&(n((()=>'We\'ve found an unknown image type, adding this to the "last resort" list'),2),a.push(t)),"fixed"===t.type&&(t.unsafe?(n((()=>'We\'ve found an unsafe fixed image type, adding this to the "last resort" list'),2),a.push(t)):(n((()=>"We've found a fixed size image, checking if it matches the request"),2),l(t,s))),"fixed-service"===t.type)if(r.unsafeImageService){n((()=>"Checking for an image from the tile source, without calculating the right height and width (unsafeImageService)"),2),l(am(t,r.width,r.height),s)}else{n((()=>"Checking for an image from the tile source 3"),2),l(am(t,t.width,t.height),s)}if("variable"===t.type&&t.maxWidth){l(am({id:t.id,type:"fixed-service",width:t.maxWidth,height:t.maxWidth,level:t.level,version:t.version},t.maxWidth),s)}}if(s&&!r.returnAllOptions){if(s.unsafe||r.allowUnsafe)continue;n((()=>`We found a match in choice list number ${e}, no searching any more`));break}}return r.atAnyCost&&0===o.length?(n((()=>s?`We found an image! ${s.id} of type ${s.type}`:'We found no images, but "atAnyCost" is set, so returning that')),{best:s||a[0],fallback:a.slice(1),log:i}):r.returnAllOptions?(n((()=>"Returning all options that we have found")),{best:r.atAnyCost?s||o[0]||a[0]:s||o[0],fallback:[...o,...a],log:i}):(n((()=>"Returning the best image that we found, and a fallback")),{best:s||o[0]||null,fallback:s?o:o.slice(1),log:i})}var lm=Object.defineProperty,um=Object.defineProperties,cm=Object.getOwnPropertyDescriptors,hm=Object.getOwnPropertySymbols,dm=Object.prototype.hasOwnProperty,pm=Object.prototype.propertyIsEnumerable,fm=(e,t,i)=>t in e?lm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,gm=(e,t)=>{for(var i in t||(t={}))dm.call(t,i)&&fm(e,i,t[i]);if(hm)for(var i of hm(t))pm.call(t,i)&&fm(e,i,t[i]);return e},mm=(e,t)=>um(e,cm(t));function vm(e,t,i){let r=e>t?e:t,n=i.length,a=[];for(let e=0;e<n;e++){let t=i[e],n=t.scaleFactors[0],o=r/n,s=[n];for(;o>=t.width;)n*=2,s.push(n),o/=2;a.push(mm(gm({},t),{scaleFactors:s}))}return a}function ym(e){return Ng(0,e)}var bm=(e,t,i)=>new Promise(((r,n)=>{var a=e=>{try{s(i.next(e))}catch(e){n(e)}},o=e=>{try{s(i.throw(e))}catch(e){n(e)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(a,o);s((i=i.apply(e,t)).next())})),wm=class{constructor(e={}){this.config={verificationsRequired:1,approximateServices:!1,enableFetching:!0,disableThrottling:!1},this.fetchingCount=0,this.imageServices={},this.knownImageServers={},this.config=Object.assign(this.config,e)}setConfig(e){Object.assign(this.config,e)}sample(e,t,i=!0){let r=om(Lg(e)),n=eg(Lg(e)),a=this.knownImageServers[r];return this.imageServices[n]=Object.assign(e,{real:!0}),a||!e.tiles||ym(e)?this.verify(e):(this.knownImageServers[r]={verifications:0,malformed:!1,root:r,preLoaded:i,sampledId:Lg(e),verified:!1,server:null,result:{context:e["@context"]||[],sampledProfile:e.profile,resourceServiceRatio:t&&e.height?t.height/e.height:1,sampledSizes:e.sizes||[],sizeRatios:Mg(e.width,e.height,e.sizes||[]),sampledTiles:e.tiles||[]}},!0)}preLoad(e,t=!0){this.knownImageServers[e.root]=e,t&&(this.knownImageServers[e.root].malformed=!1,this.knownImageServers[e.root].verifications=this.config.verificationsRequired)}predict(e,t=!1,i=!1){let r=null==e?void 0:e.source,n=om(Lg(e)),a=this.knownImageServers[n],o=eg(Lg(e));return this.imageServices[o]?this.imageServices[o]:!this.config.approximateServices||!a||!a.result||!(null==r?void 0:r.height)&&!e.height||!(null==r?void 0:r.width)&&!e.width||!i&&(a.malformed||a.verifications<this.config.verificationsRequired)||ym(e.source)?null:(this.imageServices[o]||(this.imageServices[o]={"@context":a.result.context,"@id":Lg(e),id:Lg(e),protocol:"http://iiif.io/api/image",tiles:(null==r?void 0:r.tiles)||vm(e.width,e.height,a.result.sampledTiles),sizes:(null==r?void 0:r.sizes)||zg(Math.round(e.width/a.result.resourceServiceRatio),Math.round(e.height/a.result.resourceServiceRatio),a.result.sizeRatios),profile:(null==r?void 0:r.profile)||a.result.sampledProfile,height:(null==r?void 0:r.height)||e.height,width:(null==r?void 0:r.width)||e.width,real:!1}),this.imageServices[o])}getThumbnailFromResource(e,t){return bm(this,arguments,(function*(e,t,i=!0,r=[]){let n=e?yield this.getImageCandidates(e,i):[];return sm(t,[()=>r,()=>n])}))}getImageCandidates(e,t=!0){return bm(this,null,(function*(){let i=e;if(t&&i&&i.height&&i.width){let e=qg(i);for(let t of e){let e={id:Lg(t),width:t.width?t.width:i.width,height:t.height?t.height:i.height,source:t};yield this.loadService(e)}}return function(e,t=!0,i){let r=[],n=Ug(e);if(null===n)return r;let a=e;if(r.push(n),t&&a&&a.width&&a.height){let e=[],t=qg(a);for(let r of t){let t={id:Lg(r),width:a.width,height:a.height};if(i.canLoadSync(t)){let r=i.loadServiceSync(t);r&&(r.height||(r.height=a.height),r.width||(r.width=a.width),e.push(...Hg([r])))}}if(e.length)return r.push(...e),r}return a.service&&r.push(...Hg(a.service)),r}(e,t,this)}))}verify(e){return bm(this,null,(function*(){let t=this.predict(e,!1,!0),i=yield this.fetchService(Lg(e));if(!t)return!1;let r=t.height===i.height&&t.width===i.width&&t["@context"]===i["@context"]&&function(e,t){if(e.length!==t.length)return!1;if(0===e.length&&0===t.length)return!0;let i=e.length,r=!0;for(let n=0;n<i;n++){let i=e[n],a=t[n];if(i.width!==a.width||i.height!==a.height){r=!1;break}}if(r)return!0;let n=0;for(let r=0;r<i;r++)for(let a=0;a<i;a++)if(e[r].width===t[a].width&&e[r].height===t[a].height){n++;break}return n===i}(t.sizes||[],i.sizes||[]);if(r){let t=om(Lg(e));this.knownImageServers[t]&&(this.knownImageServers[t].verifications+=1,this.knownImageServers[t].verifications>=this.config.verificationsRequired&&(this.knownImageServers[t].verified=!0))}return r}))}canLoadSync(e){let t="string"==typeof e?e:Lg(e),i=eg(t);if(this.imageServices[i])return!0;let r=this.knownImageServers[om(t)];return r&&!r.malformed&&r.verifications>=this.config.verificationsRequired}markAsMalformed(e){return bm(this,null,(function*(){return this.knownImageServers[om(Lg(e))].malformed=!0,this.loadService(e,!0)}))}fetchService(e,t=!1){return bm(this,null,(function*(){let i=eg(e);if(this.imageServices[i]&&(!t||this.imageServices[i].real))return this.imageServices[i];if(!this.config.enableFetching)throw new Error("Fetching is not enabled");let r=yield this.fetch(i).then((e=>e.json()));return!r.id&&r["@id"]&&(r.id=r["@id"]),r.id!==e&&(r.id=e,r["@id"]&&(r["@id"]=e)),this.imageServices[i]=Object.assign(r,{real:!0}),this.imageServices[i]}))}fetch(e,t){return bm(this,null,(function*(){return fetch(e,t)}))}loadService(e,t=!1){return bm(this,null,(function*(){if(!this.config.disableThrottling){let e=!0;for(;e;){if(!(this.fetchingCount>=this.config.verificationsRequired)){e=!1;break}yield new Promise((e=>setTimeout(e,500)))}}let i=this.knownImageServers[om(Lg(e))];if(i&&!i.malformed&&!t){yield i.result;let t=this.loadServiceSync(e);if(t)return t}this.fetchingCount++;let r=yield this.fetchService(Lg(e),t);return this.fetchingCount--,r.real&&this.sample(r,e),r}))}loadServiceSync(e){let t=eg(Lg(e));return this.imageServices[t]?this.imageServices[t]:this.config.approximateServices?this.predict(e):null}},xm=(new wm,Object.defineProperty),_m=Object.defineProperties,Sm=Object.getOwnPropertyDescriptors,Em=Object.getOwnPropertySymbols,km=Object.prototype.hasOwnProperty,Cm=Object.prototype.propertyIsEnumerable,Am=(e,t,i)=>t in e?xm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Pm=(e,t)=>{for(var i in t||(t={}))km.call(t,i)&&Am(e,i,t[i]);if(Em)for(var i of Em(t))Cm.call(t,i)&&Am(e,i,t[i]);return e},Om=(e,t)=>_m(e,Sm(t)),Tm=Ct.createContext({collection:void 0,manifest:void 0,range:void 0,canvas:void 0,annotation:void 0,annotationPage:void 0}),Rm=()=>me(Tm);function Im({value:e,children:t}){let i=Rm(),r=fe((()=>Pm(Pm({},i),e)),[e,i]);return Kc(Tm.Provider,{value:r,children:t})}var Mm=Ct.createContext({vault:null,setVaultInstance:e=>{}});function zm({vault:e,vaultOptions:t,useGlobal:i,resources:r,children:n}){let[a,o]=le((()=>e||(i?_p(t):t?new xp(t):new xp)));return Kc(Mm.Provider,{value:{vault:a,setVaultInstance:o},children:Kc(Im,{value:r||{},children:n})})}var Lm=()=>{let{vault:e}=me(Mm);if(null===e)throw new Error("Vault not found. Ensure you have your provider set up correctly.");return e};function Fm(e,t){let{id:i,isLoaded:r,error:n,resource:a,requestId:o,cached:s}=function(e,{noCache:t=!1}={}){let i="string"==typeof e?e:e.id,r=Lm(),[n,a]=le(i),[o,s]=le(void 0),l=fe((()=>r.get(i,{skipSelfReturn:!0})||void 0),[i,r]),[u,c]=le(l);return ce((()=>{(async()=>{try{let e=l&&!t?l:await r.load(i),o=e?e.id||e["@id"]:null;e&&n!==o&&a(o),c(e)}catch(e){s(e)}})()}),[i,t]),{isLoaded:!!u,id:n,requestId:i,error:o,resource:u,cached:!(!u||u!==l)}}(e,t);return{id:i,isLoaded:r,error:n,manifest:a,requestId:o,cached:s}}function Nm({manifest:e,children:t}){return Kc(Im,{value:{manifest:e},children:t})}function jm({canvas:e,children:t}){return Kc(Im,{value:{canvas:e},children:t})}function $m(e,t=[]){let i=Lm(),[r,n]=le((()=>e(i.getState(),i)));return ce((()=>i.subscribe((t=>e(t,i)),(e=>{n(e)}),!1)),t),r}var Bm=Ct.createContext([]);function Dm(){let e=me(Bm);return $m((t=>e.map((e=>t.iiif.entities.Canvas[e])).filter(Boolean)),[e])}function Um(e={},t=[]){let{id:i,selector:r}=e,n=Rm();Lm();let a=i||n.manifest,o=$m((e=>a?e.iiif.entities.Manifest[a]:void 0),[a]);return fe((()=>{if(o)return r?r(o):o}),[o,r,...t])}function Wm({range:e,children:t}){return Kc(Im,{value:{range:e},children:t})}function Hm(e,t){let i=[];for(let r of t.items)if("Canvas"===r.type&&(-1!==r.id.indexOf("#")?i.push({id:r.id.split("#")[0],type:"Canvas"}):i.push(r)),"Range"===r.type&&i.push(...Hm(e,e.get(r))),"SpecificResource"===r.type){let e="string"==typeof r.source?r.source:r.source.id;i.push({id:e,type:"Canvas"})}return i}function qm(e,t,{disablePaging:i,skipNonPaged:r}={}){let n=t.behavior,a=n.includes("paged"),o=!a&&n.includes("continuous"),s=!a&&!o&&n.includes("individuals"),l="Manifest"===t.type?t.items:Hm(e,t);if(o)return[l,[l.map(((e,t)=>t))]];if(s||!a||i)return[l,l.map(((e,t)=>[t]))];let u=[],c=[],h=()=>{c.length&&(u.push([...c]),c=[])},d=0,p=!1;for(let t=0;t<l.length;t++){let i=e.get(l[t]);i.behavior.includes("non-paged")?(t===d&&d++,r||(h(),u.push([t]),h())):t===d||i.behavior.includes("facing-pages")?(c.length&&(p=!0),h(),u.push([t]),h()):(c.push(t),p?(h(),p=!1):c.length>1&&h())}return c.length&&h(),[l,u]}function Vm(e={},t=[]){let{id:i,selector:r}=e,n=Rm(),a=i||n.range,o=$m((e=>a?e.iiif.entities.Range[a]:void 0),[a]);return fe((()=>{if(o)return r?r(o):o}),[o,r,...t])}var Qm=()=>{},Ym=G({setCurrentCanvasId:Qm,setCurrentCanvasIndex:Qm,nextCanvas:Qm,previousCanvas:Qm,items:[],sequence:[],setSequenceIndex:Qm,currentSequenceIndex:0});function Gm(e){let t=Um(),{cursor:i,visibleItems:r,next:n,sequence:a,items:o,setCanvasIndex:s,setCanvasId:l,previous:u,setSequenceIndex:c}=function({startCanvas:e,disablePaging:t}){var i;let r=Lm(),n=Um(),a=Vm(),[o,s]=le(void 0),l=a||n;if(!l)throw new Error("Nothing selected");let[u,c]=fe((()=>qm(r,l,{disablePaging:t})),[r,l]),h=ge((e=>{let t=c.findIndex((t=>t.includes(e)));s(-1===t?0:t)}),[u,c]),d=ge((e=>{let t=u.findIndex((t=>t.id===e));-1!==t?h(t):s(0)}),[u,c]),p=ge((()=>{s((e=>e>=c.length?e:e+1))}),[c]),f=ge((()=>{s((e=>e<=0?0:e-1))}),[c]);return typeof o>"u"&&(e?d(e):s(0)),{visibleItems:(null==(i=c[o])?void 0:i.map((e=>u[e].id)))||[],cursor:o,items:u,sequence:c,setSequenceIndex:s,setCanvasIndex:h,setCanvasId:d,next:p,previous:f}}({startCanvas:e.startCanvas,disablePaging:!1===e.pagingEnabled}),h=fe((()=>({sequence:a,items:o,setCurrentCanvasId:l,nextCanvas:n,previousCanvas:u,totalCanvases:o.length,setCurrentCanvasIndex:s,setSequenceIndex:c,currentSequenceIndex:i})),[a,o,l,n,u,o,s,c,i]);return t?Kc(Ym.Provider,{value:h,children:Kc(Bm.Provider,{value:r,children:Kc(jm,{canvas:r[0],children:e.children})})}):(console.warn("The manifest passed to the provider is not a valid IIIF manifest."),Kc("div",{children:"Sorry, something went wrong."}))}function Km(e){let t=Fm(e.manifest);if(!t)return console.warn("The manifest passed to the provider is not a valid IIIF manifest."),Kc("div",{children:"Sorry, something went wrong."});if(!t.isLoaded)return Kc("div",{children:"Loading..."});let i=Kc(Gm,Om(Pm({},e),{children:e.children}));return Kc(Nm,{manifest:t.id,children:e.rangeId?Kc(Wm,{range:e.rangeId,children:i}):i})}var Xm={importEntities:(0,Sp.createAction)("@iiif/IMPORT_ENTITIES")(),modifyEntityField:(0,Sp.createAction)("@iiif/MODIFY_ENTITY_FIELD")(),reorderEntityField:(0,Sp.createAction)("@iiif/REORDER_ENTITY_FIELD")(),addReference:(0,Sp.createAction)("@iiif/ADD_REFERENCE")(),removeReference:(0,Sp.createAction)("@iiif/REMOVE_REFERENCE")()};(0,Sp.createAction)("@iiif/ADD_MAPPING")(),(0,Sp.createAction)("@iiif/ADD_MAPPINGS")();(0,Sp.createAction)("@iiif/SET_META_VALUE")(),(0,Sp.createAction)("@iiif/SET_META_VALUE_DYNAMIC")(),(0,Sp.createAction)("@iiif/UNSET_META_VALUE")();(0,Sp.createAction)("@iiif/REQUEST_RESOURCE")(),(0,Sp.createAction)("@iiif/REQUEST_ERROR")(),(0,Sp.createAction)("@iiif/REQUEST_MISMATCH")(),(0,Sp.createAction)("@iiif/REQUEST_COMPLETE")(),(0,Sp.createAction)("@iiif/REQUEST_OFFLINE_RESOURCE")();function Zm(e){return"string"!=typeof e&&e&&e.bindToVault}function Jm(){let e=Lm(),t=de([]),i=function(){let e=Lm().getStore();return fe((()=>t=>e.dispatch(t)),[e])}(),r=fe((()=>`vault://annotation-page/${(new Date).getTime()}/${Math.round(1e9*Math.random()).toString(16)}`),[]);return he((()=>{let e={id:r,type:"AnnotationPage",behavior:[],motivation:null,label:null,thumbnail:[],summary:null,requiredStatement:null,metadata:[],rights:null,provider:[],items:[],seeAlso:[],homepage:[],logo:[],rendering:[],service:[]};i(Xm.importEntities({entities:{AnnotationPage:{[e.id]:e}}}))}),[r]),[$m((e=>r?e.iiif.entities.AnnotationPage[r]:null),[r]),{addAnnotation:ge(((n,a)=>{if(r){if(Zm(n)){let i=n;i.__vault||i.bindToVault(e),n="string"==typeof i.source?i.source:i.source.id,t.current[n]=i}else"string"!=typeof n&&(n=n.id);let o=e.get({id:r,type:"AnnotationPage"}),s=e.get({id:n,type:"Annotation"});o&&s&&(o.items.find((e=>e.id===s.id))||i(Xm.addReference({id:r,type:"AnnotationPage",key:"items",reference:{id:n,type:"Annotation"},index:a})))}}),[r]),removeAnnotation:ge((n=>{r&&(Zm(n)?n="string"==typeof n.source?n.source:n.source.id:"string"!=typeof n&&(n=n.id),t.current[n]&&t.current[n].beforeRemove(),e.get({id:r,type:"AnnotationPage"})&&i(Xm.removeReference({id:r,type:"AnnotationPage",key:"items",reference:{id:n,type:"Annotation"}})))}),[r])}]}(0,Sp.createAction)("@iiif/BATCH")(),(0,Sp.createAction)("@iiif/BATCH_IMPORT")();G(null),G(null),Ct.createContext(null),Ct.createContext(null);function ev(e,t){let i=Lm(),r=fe((()=>function(e){return{addEventListener(t,i,r,n){if(t)return e.setMetaValue([t.id,"eventManager",i],(e=>{let t=e||[];for(let e of t)if(e.callback===r)return t;return[...t,{callback:r,scope:n}]})),r},removeEventListener(t,i,r){!t||e.setMetaValue([t.id,"eventManager",i],(e=>(e||[]).filter((e=>e.callback!==r))))},getListenersAsProps(t,i){let r="string"==typeof t?{id:t}:t;if(!r||!r.id)return{};let n=e.getResourceMeta(r.id,"eventManager"),a={};if(n&&r)for(let t of Object.keys(n))a[t]=a=>{let o=e.get(r);for(let{callback:e,scope:r}of n[t]||[])(!r||i&&-1!==r.indexOf(i))&&e(a,o)};return a}}}(i)),[i]);return fe((()=>e?r.getListenersAsProps(e,t):{}),[$m((()=>e&&e.id?i.getResourceMeta(e.id,"eventManager"):null),[e]),e,i,t])}function tv(e){return{applyStyles(t,i,r){let n="string"==typeof t?t:t.id;return e.setMetaValue([n,"styles",i],r)},getAppliedStyles(t){let i="string"==typeof t?t:t.id;return e.getResourceMeta(i,"styles")}}}function iv(e,t){let i=Lm(),r=fe((()=>tv(i)),[i]);return $m((()=>{if(!e)return null;let i=r.getAppliedStyles(e.id);return i?t?i[t]:i:void 0}),[e,t])}var rv=Object.defineProperty,nv=Object.defineProperties,av=Object.getOwnPropertyDescriptors,ov=Object.getOwnPropertySymbols,sv=Object.prototype.hasOwnProperty,lv=Object.prototype.propertyIsEnumerable,uv=(e,t,i)=>t in e?rv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,cv=(e,t)=>{for(var i in t||(t={}))sv.call(t,i)&&uv(e,i,t[i]);if(ov)for(var i of ov(t))lv.call(t,i)&&uv(e,i,t[i]);return e},hv=(e,t)=>nv(e,av(t)),dv=/&?(xywh=)?(pixel:|percent:|pct:)?([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?)/,pv=/&?(t=)(npt:)?([0-9]+(.[0-9]+)?)?(,([0-9]+(.[0-9]+)?))?/;function fv(e){if(Array.isArray(e))return e.reduce(((e,t)=>{let{selector:i,selectors:r}=fv(t);return i&&(e.selector||(e.selector=i),e.selectors.push(...r)),e}),{selector:null,selectors:[]});if(!e)return{selector:null,selectors:[]};if("string"==typeof e){let[t,i]=e.split("#");return i?fv({type:"FragmentSelector",value:i}):{selector:null,selectors:[]}}if("PointSelector"===e.type&&(e.t||0===e.t)){let t={type:"TemporalSelector",temporal:{startTime:e.t}};return{selector:t,selectors:[t]}}if("FragmentSelector"===e.type){let t=dv.exec(e.value);if(t){let e={type:"BoxSelector",spatial:{unit:"percent:"===t[2]||"pct:"===t[2]?"percent":"pixel",x:parseFloat(t[3]),y:parseFloat(t[4]),width:parseFloat(t[5]),height:parseFloat(t[6])}};return{selector:e,selectors:[e]}}let i=e.value.match(pv);if(i){let e={type:"TemporalSelector",temporal:{startTime:i[4]?parseFloat(i[4]):0,endTime:i[7]?parseFloat(i[7]):void 0}};return{selector:e,selectors:[e]}}return{selector:null,selectors:[]}}return{selector:null,selectors:[]}}function gv(e,t={}){if(Array.isArray(e))return gv(e[0]);if("string"==typeof e){let[i,r]=e.split("#");return r?gv({type:"SpecificResource",source:{id:i,type:"Unknown"},selector:{type:"FragmentSelector",value:r}}):{type:"SpecificResource",source:{id:i,type:t.typeMap&&t.typeMap[i]||"Unknown"},selector:null,selectors:[]}}if("Choice"===e.type||"List"===e.type||"Composite"===e.type||"Independents"===e.type)return gv(e.items[0]);if("SpecificResource"===e.type){"Canvas"===e.source.type&&e.source.partOf&&"string"==typeof e.source.partOf&&(e.source.partOf=[{id:e.source.partOf,type:"Manifest"}]);let{selector:t,selectors:i}=e.selector?fv(e.selector):{selector:null,selectors:[]};return{type:"SpecificResource",source:e.source,selector:t,selectors:i}}if(e.id){"Canvas"===e.type&&e.partOf&&"string"==typeof e.partOf&&(e.partOf=[{id:e.partOf,type:"Manifest"}]);let[t,i]=e.id.split("#");return i?gv({type:"SpecificResource",source:hv(cv({},e),{id:t}),selector:{type:"FragmentSelector",value:i}}):{type:"SpecificResource",source:hv(cv({},e),{id:t}),selector:null,selectors:[]}}return{type:"SpecificResource",source:e,selector:null,selectors:[]}}function mv(e={},t=[]){let{id:i,selector:r}=e,n=Rm(),a=Lm(),o=i||n.annotation,s=$m((e=>o?e.iiif.entities.Annotation[o]:void 0),[o]),l=$m((e=>s&&s.body?s.body.map((t=>t?e.iiif.entities[t.type][t.id]:null)).filter(Boolean):[]),[s]);return fe((()=>{if(!s)return;let e=Om(Pm({},s),{body:l,target:gv(s.target,{typeMap:a.getState().iiif.mapping})});return r?r(e):e}),[s,r,l,...t])}function vv(e={},t=[]){let{id:i,selector:r}=e,n=Rm(),a=i||n.canvas,o=$m((e=>a?e.iiif.entities.Canvas[a]:void 0),[a]);return fe((()=>{if(o)return r?r(o):o}),[o,r,...t])}function yv(e){return"SpecificResource"===e.type?[e.source,{selector:e.selector}]:[e,{selector:null}]}function bv(e,t){let{selector:i,source:r}=Jf(t);if(r.id!==e.id)return[null,r];let n={type:"BoxSelector",spatial:{x:0,y:0,width:e.width,height:e.height}};return[i?"TemporalSelector"===i.type?{type:"TemporalBoxSelector",temporal:i.temporal,spatial:n.spatial}:i:null,r]}var wv={makeChoice:()=>{}},xv={type:"unknown"},_v=e=>({type:"unknown",reason:e,annotations:{pages:[]}}),Sv=(e,t)=>({type:"empty",width:e,height:t,annotations:{pages:[]},image:null,images:[]});function Ev(e,t){var i;let r=null==(i=null==e?void 0:e.iiif)?void 0:i.meta[t];return r?r.annotationPageManager:null}function kv(e,t){var i;let r=null==(i=null==e?void 0:e.iiif)?void 0:i.meta[t];return r?r.annotationPageManager:null}function Cv(e,t={}){let i=Lm(),r=Um(),n=vv(),a=Dm(),o=fe((()=>function({canvas:e,manifest:t,all:i,canvases:r}){let n=[];if(t)for(let e of t.annotations)-1===n.indexOf(e.id)&&n.push(e.id);if(i){if(r&&r.length)for(let e of r)for(let t of e.annotations)-1===n.indexOf(t.id)&&n.push(t.id)}else if(e)for(let t of e.annotations)-1===n.indexOf(t.id)&&n.push(t.id);return n}({all:t.all,manifest:r,canvas:n,canvases:a})),[t.all,n,a,r]),s=function(e,t){return $m((i=>{let r=[];if(!e)return r;let n=Object.keys(i.iiif.entities.AnnotationPage);for(let a of n)if(!t||-1!==t.indexOf(a)){let t=Ev(i,a);t&&t.views&&t.views[e]&&r.push(a)}return r}),[e,t])}(e,t.all?void 0:o),l=ge((t=>{!e||i.setMetaValue([t,"annotationPageManager","views"],(t=>t&&!t[e]?t:Om(Pm({},t||{}),{[e]:!1})))}),[e,i]);return{availablePageIds:o,enabledPageIds:s,setPageEnabled:ge(((t,r={})=>{if(!e)return;let n=i.getState(),a=[];if(null!=r&&r.deselectOthers){let t=Object.keys(n.iiif.entities.AnnotationPage);for(let i of t){let t=kv(n,i);t&&t.views&&t.views[e]&&a.push(i)}}for(let e of a)l(e);i.setMetaValue([t,"annotationPageManager","views"],(t=>t&&t[e]?t:Om(Pm({},t||{}),{[e]:!0})))}),[e,l,i]),setPageDisabled:l}}var Av=Ct.createContext(new wm);function Pv(){return me(Av)}function Ov(){let e=Pv(),[t,i]=le({}),r=de(!1);return ce((()=>()=>{r.current=!0}),[]),[ge(((n,{height:a,width:o})=>{if(n){let s=n.id||n["@id"],l=e.loadServiceSync({id:s,width:n.width||o,height:n.height||a,source:n});l?n=l:t[s]||(r.current||i((e=>Om(Pm({},e),{[s]:"loading"}))),e.loadService({id:s,width:n.width||o,height:n.height||a}).then((()=>{r.current||i((e=>Om(Pm({},e),{[s]:"done"})))})))}return n}),[e,t]),t]}function Tv(e,t=[]){let i=Lm(),r=function(e={}){let t=mv(),i=vv(e.canvasId?{id:e.canvasId}:void 0);return $m(((r,n)=>{if(!i)return[];if(t&&e.enableSingleAnnotation)return[t];let a=n.get(i.items),o=[];for(let e of a)o.push(...n.get(e.items));return o}),[i])}({enableSingleAnnotation:null==e?void 0:e.enableSingleAnnotation}),[n,a]=le((null==e?void 0:e.defaultChoices)||[]),o=fe((()=>function(e,t,i){let r=[],n=null,a=[];for(let o of t){let t=e.get(o.body,{skipSelfReturn:!1});for(let s of t){if(!s)continue;let[l,{selector:u}]=yv(s),c=(l.type||"unknown").toLowerCase();if("choice"!==c)-1===r.indexOf(c)&&r.push(c),a.push({annotationId:o.id,type:c,resource:l,target:o.target,selector:u});else{let r=e.get(l.items),a=i.length?i.map((e=>r.find((t=>t.id===e)))).filter(Boolean):[r[0]];0===a.length&&a.push(r[0]),n={type:"single-choice",items:r.map((e=>({id:e.id,label:e.label,selected:-1!==a.indexOf(e)}))),label:s.label},t.push(...a)}}}return{types:r,items:a,choice:n}}(i,r,n)),[i,r,n,...t]),s={makeChoice:ge(((e,{deselectOthers:t=!0,deselect:i=!1}={})=>{if(o.choice){if("single-choice"!==o.choice.type)throw new Error("Complex choice not supported yet");a((r=>{if(i){let t=r.filter((t=>t!==e));if(0===t.length){let e=o.items[0].resource.id;return e?[e]:[]}return t}if(t)return[e];let n=[...r];if(0===n.length&&o.items.length){let e=o.items[0].resource.id;e&&n.push(e)}return-1!==r.indexOf(e)?r:[...r,e]}))}}),[o.choice])};return[o,s]}var Rv=["model/gltf-binary"];function Iv(e,t={},i){let r=e.language||i||"none";switch(e.type){case"TextualBody":typeof e.value<"u"&&(t[r]=e.value);break;case"List":case"Composite":case"Choice":e.items&&e.items.forEach((e=>Iv(e,t,r)))}return t}function Mv(e){let t=Um(),i=vv(),r=Lm(),[n,a]=Ov(),{enabledPageIds:o}=Cv((null==e?void 0:e.annotationPageManagerId)||(null==t?void 0:t.id)||(null==i?void 0:i.id),{all:!1}),s=function(e,t){return $m(((i,r)=>r.get(e.map((e=>({id:e,type:t}))))),[e,t])}(o,"AnnotationPage"),l=(null==e?void 0:e.strategies)||["empty","images","media","textual-content","complex-timeline"],[u,c]=Tv(e,[a]),h=fe((()=>{if(!i)return xv;if(0===u.types.length)return-1!==l.indexOf("empty")?Sv(i.width,i.height):xv;if(1!==u.types.length){if(2!==u.types.length||-1===u.types.indexOf("text"))return-1===l.indexOf("complex-timeline")?_v("Complex timeline not supported"):_v("ComplexTimelineStrategy not yet supported");u.types=u.types.filter((e=>"text"!==e))}let e=u.types[0];return"image"===e?-1===l.indexOf("images")?_v("Image not supported"):function(e,t,i){let r=[];for(let n of t.items){let t,a=n.resource&&"SpecificResource"===n.resource.type?n.resource.source:n.resource;if(!a.id)return _v("No resource Identifier");if(a.service){let r=qg(a);r[0]&&(t=i(r[0],e))}let o={type:"BoxSelector",spatial:{x:0,y:0,width:e.width,height:e.height}},[s,l]=bv(e,n.target);if(l.id!==e.id)continue;let u={type:"BoxSelector",spatial:{x:0,y:0,width:e.width,height:e.height}},c="SpecificResource"===n.resource.type?gv(n.resource):null,h=c&&c.selector&&("BoxSelector"===c.selector.type||"TemporalBoxSelector"===c.selector.type)?{type:"BoxSelector",spatial:{x:c.selector.spatial.x,y:c.selector.spatial.y,width:c.selector.spatial.width,height:c.selector.spatial.height}}:u;t&&!t.id&&(t.id=t["@id"]);let d={id:a.id,type:"Image",annotationId:n.annotationId,width:s?a.width:e.width,height:s?a.height:e.height,service:t,sizes:t&&t.sizes?t.sizes:a.width&&a.height?[{width:a.width,height:a.height}]:[],target:s&&"PointSelector"!==s.type?s:o,selector:h};r.push(d)}return{type:"images",image:r[0],images:r,choice:t.choice}}(i,u,n):"Model"===e||"model"===e?-1===l.indexOf("3d-model")?_v("3D not supported"):function(e,t){let i=t.items[0].resource;return i.format?-1===Rv.indexOf(i.format)?_v(`3D format: ${i.format} is unsupported`):{type:"3d-model",model:i}:_v("Unknown format")}(0,u):"textualbody"===e?-1===l.indexOf("textual-content")?_v("Textual content not supported"):function(e,t){let i=[];return t.items.forEach((t=>{if(t.resource){let[r]=bv(e,t.target);i.push({annotationId:t.annotationId,text:Iv(t.resource),target:r})}})),{type:"textual-content",items:i}}(i,u):"sound"===e||"audio"===e?-1===l.indexOf("media")?_v("Media not supported"):function(e,t){var i;if(!e.duration)return _v("No duration on canvas");if(t.items.length>1)return _v("Only one audio source supported");let r=null==(i=t.items[0])?void 0:i.resource;return r?r.format?{type:"media",media:{annotationId:t.items[0].annotationId,duration:e.duration,url:r.id,type:"Sound",target:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}},format:r.format,selector:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}}},annotations:{pages:[]}}:_v("Audio does not have format"):_v("Unknown audio")}(i,u):"video"===e?-1===l.indexOf("media")?_v("Media not supported"):function(e,t){var i;let r=t.items.filter((e=>"video"===e.type));if(!e.duration)return _v("No duration on canvas");if(r.length>1)return _v("Only one video source supported");let n=null==(i=r[0])?void 0:i.resource;return n?n.format?{type:"media",media:{annotationId:t.items[0].annotationId,duration:e.duration,url:n.id,type:"Video",items:[],target:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}},format:n.format,selector:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}}},annotations:{pages:[]}}:_v("Video does not have format"):_v("Unknown video")}(i,u):xv}),[i,u,r,c.makeChoice]);return fe((()=>"unknown"===h.type?[h,wv]:[Om(Pm({},h),{annotations:{pages:s}}),c]),[h,s])}var zv=(e,t=[])=>{let i=Lm();ce((()=>{e(i)}),[i,...t])};function Lv(e,t,{canvasId:i,manifestId:r}={}){let n=Lm(),a=Pv(),o=fe((()=>function(e,t={}){let i=t.imageServiceLoader||new wm;return{getBestThumbnailAtSize:async function t(r,n,a,o=[],s){if("string"==typeof r)return{best:Ug(r),fallback:[],log:[]};let l=e.get(r);if("string"==typeof l)return{best:Ug(l),fallback:[],log:[]};switch(l.type){case"Annotation":{let t=l.body,r=e.get(t[0]);return s&&!r.width&&(r.width=s.width,r.height=s.height),await i.getThumbnailFromResource(r,n,a,o)}case"Canvas":{let r=l;if(r.thumbnail&&r.thumbnail.length){let t=e.get(r.thumbnail[0]),n=await i.getImageCandidates(t,a);n&&n.length&&o.push(...n)}return t(r.items[0],n,a,o,{width:r.width,height:r.height})}case"AnnotationPage":case"Choice":case"Collection":case"Manifest":return t(l.items[0],n,a,o,s);case"SpecificResource":case"Image":case"Dataset":case"Sound":case"Text":case"TextualBody":case"Video":return s&&!l.width&&(l.width=s.width,l.height=s.height),i.getThumbnailFromResource(l,n,a,o);case"Service":case"Range":case"AnnotationCollection":case"CanvasReference":case"ContentResource":return{best:void 0,fallback:[],log:[]}}return{best:void 0,fallback:[],log:[]}}}}(n,{imageServiceLoader:a})),[n,a]),[s,l]=le(),u=Um(r?{id:r}:void 0),c=vv(i?{id:i}:void 0)||u,h=de(!1);if(ce((()=>(h.current=!1,()=>{h.current=!0})),[]),!c)throw new Error("Must be called under a manifest or canvas context.");return zv((i=>{o.getBestThumbnailAtSize(c,e,t).then((e=>{e.best&&!h.current&&l(e.best)}))}),[c]),s}function Fv(e,t){switch(t.type){case"FINISHED":return Om(Pm({},e),{isFinished:!0,isPlaying:!1,playRequested:!1});case"PLAY_PAUSE":return Om(Pm({},e),{isFinished:!1,isPlaying:!e.isPlaying});case"PLAY_REQUESTED":return Om(Pm({},e),{isFinished:!1,playRequested:!0});case"PAUSE":return Om(Pm({},e),{isPlaying:!1});case"PLAY":return Om(Pm({},e),{isFinished:!1,playRequested:!1,isPlaying:!0});case"MUTE":return Om(Pm({},e),{isMuted:!0});case"SET_VOLUME":return Om(Pm({},e),{volume:t.volume,isMuted:0===t.volume});case"TOGGLE_MUTE":return Om(Pm({},e),{isMuted:!e.isMuted});case"UNMUTE":return Om(Pm({},e),{isMuted:!1})}return e}function Nv(e){let[t,i]=ue(Fv,function(e){return{isMuted:!1,playRequested:!1,isPlaying:!1,isFinished:!1,volume:100,duration:e}}(e.duration)),r=de(null),n=de(null),a=de(null),o=de(!1),s=ge((()=>{n.current&&r.current&&(n.current.innerHTML=function(e){let t=Math.round(e);return`${Math.floor(t/60)}:${(""+t%60).padStart(2,"0")}`}(r.current.currentTime),a.current&&(a.current.style.width=r.current.currentTime/e.duration*100+"%"),o.current!==r.current.muted&&(o.current=r.current.muted,i(r.current.muted?{type:"MUTE"}:{type:"UNMUTE"})))}),[e.duration]),l=ge((()=>{r.current&&(i({type:"PLAY_REQUESTED"}),r.current.play().then((()=>{i({type:"PLAY"})})),s())}),[s]),u=ge((()=>{r.current&&(r.current.duration>0&&r.current.paused?l():c())}),[s]),c=ge((()=>{r.current&&(r.current.pause(),i({type:"PAUSE"}),s())}),[s]),h=ge((()=>{r.current&&(r.current.muted=!r.current.muted,i(r.current.muted?{type:"MUTE"}:{type:"UNMUTE"}))}),[]),d=ge((()=>{r.current&&(r.current.muted=!0,i({type:"MUTE"}))}),[]),p=ge((()=>{r.current&&(r.current.muted=!1,i({type:"UNMUTE"}))}),[]),f=ge((e=>{r.current&&(r.current.muted=!1,r.current.volume=e/100,i({type:"SET_VOLUME",volume:e}))}),[]),g=ge((t=>{r.current&&(r.current.currentTime=Math.max(0,Math.min(t*e.duration,e.duration)),s())}),[]),m=ge((t=>{r.current&&(r.current.currentTime=Math.max(0,Math.min(t,e.duration)),s())}),[]);return ce((()=>{let e=setInterval((()=>{s()}),350);return()=>clearInterval(e)}),[s,e.duration]),ce((()=>{let e=()=>{i({type:"FINISHED"})},t=r.current;return null==t||t.addEventListener("ended",e),()=>null==t?void 0:t.removeEventListener("ended",e)}),[]),[{element:r,currentTime:n,progress:a},t,{play:l,pause:c,playPause:u,mute:d,unmute:p,toggleMute:h,setVolume:f,setDurationPercent:g,setTime:m}]}var jv=G(null),$v=G(null),Bv=G(null);function Dv({actions:e,state:t,children:i,currentTime:r,progress:n,element:a}){return Kc(Bv.Provider,{value:{currentTime:r,progress:n,element:a},children:Kc($v.Provider,{value:e,children:Kc(jv.Provider,{value:t,children:i})})})}function Uv(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Ct.createContext(),function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.usedNamespaces={}}(function(e,t,i){t&&Uv(e.prototype,t),i&&Uv(e,i),Object.defineProperty(e,"prototype",{writable:!1})})(e,[{key:"addUsedNamespaces",value:function(e){var t=this;e.forEach((function(e){t.usedNamespaces[e]||(t.usedNamespaces[e]=!0)}))}},{key:"getUsedNamespaces",value:function(){return Object.keys(this.usedNamespaces)}}])}();function Wv(){let e=me(Mm);return e&&e.vault?e.vault:_p()}function Hv(e,t){let[i,r]=le(!1),[n,a]=le({}),o=e&&!n.__loaded,s=!(e&&!n.__loaded||!i);return he((()=>{let i=[];return e&&async function(e){if(!e)return null;switch(e){case"static":return{render:"static",interactive:!1,viewport:!0};case"responsive":return{render:"static",interactive:!1,viewport:!1};case"zoom":return{render:"canvas",interactive:!0,viewport:!0}}if(e.startsWith("http"))return fetch(e).then((e=>e.json()));if(e.startsWith("#")){let t=document.getElementById(e.slice(1));if(t)try{return JSON.parse(t.innerText)}catch(e){console.error("Invalid JSON on element",t)}}return null}(e).then((e=>{if(e){let r=e,{media:n}=r,o=g(r,["media"]),s=Object.keys(n||{}),l=s.map((e=>({query:e,mql:window.matchMedia(e)}))),u=()=>{if(!l.length||!n)return d({__loaded:!0},o);let e=l.filter((({mql:e})=>e.matches)),i=d(d({__loaded:!0},o),e.reduce(((e,t)=>Object.assign(e,n[t.query])),{}));if(t)for(let r of e)t(r.query,i);return i};for(let e of s){let t=window.matchMedia(e),r=()=>{let e=u();a(e)};t.addEventListener("change",r),i.push((()=>{t.removeEventListener("change",r)}))}a(u())}else a({__loaded:!0})})).catch((()=>{a({__loaded:!0})})),()=>{i.forEach((e=>e()))}}),[s,e]),{internalConfig:n,isReady:s,isConfigBlocking:o,setIsReady:r}}function qv(e,{parse:t,defaultValue:i}={}){let r=de(),[n,a]=le((()=>t?t(e):e)),o=ge((e=>{let o=t?t(e):e;typeof i<"u"&&typeof o>"u"&&(o=i),(r.current||n)!==o&&(a(o),r.current=o)}),[]);return he((()=>{o(e)}),[e]),[n,o,a,r]}function Vv({max:e,percentScale:t,upscaled:i,confined:r,width:n,height:a}){let o=[];return i&&o.push("^"),e?(o.push("max"),o.join("")):(r&&o.push("!"),t&&o.push(`pct:${t}`),n&&o.push(`${n}`),o.push(","),a&&o.push(`${a}`),o.join(""))}function Qv(e){let t={upscaled:!1,max:!1,confined:!1};if("^"===e[0]&&(t.upscaled=!0,e=e.slice(1)),("max"===e||"full"===e)&&(t.max=!0),"!"===e[0]&&(t.confined=!0,e=e.slice(1)),"p"===e[0])return t.percentScale=parseFloat(e.slice(4)),t;let i=e.split(",").map((e=>e.trim()));return""!==i[0]&&(t.width=parseInt(i[0],10)),""!==i[1]&&(t.height=parseInt(i[1],10)),t}function Yv(e){return null==e||e<0?0:e}function Gv(e){return function(e){let t=encodeURIComponent(e);return(typeof btoa>"u"?Buffer.from(t,"utf-8").toString("base64"):btoa(t)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}("string"==typeof e?e:JSON.stringify(e))}function Kv(e,t){if("{"===(e=e.trim())[0])return t?Promise.resolve(JSON.parse(e)):JSON.parse(e);if(e.startsWith("http")){if(!t)throw new Error("Cannot fetch remote fetch with async=false in parseContentState");return fetch(e).then((e=>e.json()))}return Kv(function(e){let t=function(e){let t=e.length%4;if(1===t)throw new Error("InvalidLengthError: Input base64url string is the wrong length to determine padding");return e+(t?"====".slice(0,4-t):"")}(e).replace(/-/g,"+").replace(/_/g,"/"),i=typeof atob>"u"?Buffer.from(t,"base64").toString("utf-8"):atob(t);return decodeURIComponent(i).trim()}(e),t)}function Xv(e){if(!e)throw new Error("Content state is empty");Array.isArray(e)||(e=[e]);let t="vault://virtual-annotation/"+(new Date).getTime(),i=["contentState"],r=[];for(let n of e){if("string"==typeof n)throw new Error("Content state is a [String] type and cannot be inferred");if("Annotation"===n.type){if(t=n.id,Array.isArray(n.motivation))for(let e of n.motivation)-1===i.indexOf(e)&&i.push(e);if(Array.isArray(n.target))for(let e of n.target){let t=gv(e);r.push(t)}else{let e=gv(n.target);r.push(e)}continue}let e=gv(n);r.push(e)}return{id:t,type:"Annotation",motivation:["contentState",...e.motivation||[]],target:r,extensions:{}}}function Zv(e){if(!e)return[];"string"==typeof e&&(e=e.split("|")),Array.isArray(e)||(e=[e]);let t=[];for(let i of e)"string"==typeof i&&(i=Qv(i)),t.push(i);return t}function Jv(e){if("string"==typeof e){let t=e.match(/^(pct|pixel|percent)?:?([0-9,\s]+)/);if(t)return Jv({type:"FragmentSelector",value:`xywh=${t[1]?"pixel"===t[1]?"pixel:":"percent:":""}${t[2]}`})}return e?fv(e):void 0}function ey(e){return e?Array.isArray(e)?e:-1!==e.indexOf(",")?e.split(",").map((e=>e.trim())):[e]:[]}function ty(e){let t=ey(e),i=[];for(let e of t){let[t,r]=e.split("#");if(r){let e=r.match(/opacity=([01]?\.[0-9]+)/);if(e){let r=parseFloat(e[1]);if(r<1&&r>=0){i.push({id:t,opacity:r});continue}}}i.push({id:t})}return i}function iy(e,t){return typeof e>"u"?t:"string"==typeof e?"true"===e.toLowerCase():t?typeof e>"u"&&t:e}function ry(e,t){return typeof e>"u"||null===e||""===e?t:("string"==typeof e&&(e=parseInt(""+e,10)),typeof e<"u"&&!Number.isNaN(e)?e:t)}function ny(e){if(!e)return null;if("string"==typeof e&&e.startsWith("http"))return{type:"remote-content-state",id:e};try{return Xv("string"==typeof e?Kv(e):e)}catch(e){return null}}At(),At(),At();function ay(e){return{addEventListener(t,i,r,n){if(t)return e.setMetaValue([t.id,"eventManager",i],(e=>{let t=e||[];for(let e of t)if(e.callback===r)return t;return[...t,{callback:r,scope:n}]})),r},removeEventListener(t,i,r){!t||e.setMetaValue([t.id,"eventManager",i],(e=>(e||[]).filter((e=>e.callback!==r))))},getListenersAsProps(t,i){let r="string"==typeof t?{id:t}:t;if(!r||!r.id)return{};let n=e.getResourceMeta(r.id,"eventManager"),a={};if(n&&r)for(let t of Object.keys(n))a[t]=a=>{let o=e.get(r);for(let{callback:e,scope:r}of n[t]||[])(!r||i&&-1!==r.indexOf(i))&&e(a,o)};return a}}}function oy(e){return{applyStyles(t,i,r){let n="string"==typeof t?t:t.id;return e.setMetaValue([n,"styles",i],r)},getAppliedStyles(t){let i="string"==typeof t?t:t.id;return e.getResourceMeta(i,"styles")}}}function sy(e){return e.endsWith("info.json")?e:e.endsWith("/")?`${e}info.json`:`${e}/info.json`}var ly="http://library.stanford.edu/iiif/image-api/compliance.html#level1",uy="http://library.stanford.edu/iiif/image-api/compliance.html#level2",cy="http://library.stanford.edu/iiif/image-api/conformance.html#level1",hy="http://library.stanford.edu/iiif/image-api/conformance.html#level2",dy="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",py="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",fy="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",gy="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",my="http://iiif.io/api/image/1/level1.json",vy="http://iiif.io/api/image/1/profiles/level1.json",yy="http://iiif.io/api/image/1/level2.json",by="http://iiif.io/api/image/1/profiles/level2.json",wy="http://iiif.io/api/image/2/level1.json",xy="http://iiif.io/api/image/2/profiles/level1.json",_y="http://iiif.io/api/image/2/level2.json",Sy="http://iiif.io/api/image/2/profiles/level2.json",Ey="level1",ky="level2",Cy="http://iiif.io/api/image/2/level1",Ay="http://iiif.io/api/image/2/level2",Py=[Ay,uy,hy,py,gy,yy,by,_y,Sy,ky],Oy=[...Py,Cy,ly,cy,dy,fy,my,vy,wy,xy,Ey],Ty=["http://iiif.io/api/image/2/level0",Cy,Ay,"http://library.stanford.edu/iiif/image-api/compliance.html#level0",ly,uy,"http://library.stanford.edu/iiif/image-api/conformance.html#level0",cy,hy,"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",dy,py,"http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",fy,gy,"http://iiif.io/api/image/1/level0.json","http://iiif.io/api/image/1/profiles/level0.json",my,vy,yy,by,"http://iiif.io/api/image/2/level0.json","http://iiif.io/api/image/2/profiles/level0.json",wy,xy,_y,Sy,"level0",Ey,ky],Ry={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["sizeByWhListed"]},Iy={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPx","regionSquare","sizeByWhListed","sizeByH","sizeByW","sizeByWh"]},My={extraFormats:["jpg","png"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPct","regionByPx","regionSquare","rotationBy90s","sizeByWhListed","sizeByConfinedWh","sizeByH","sizeByPct","sizeByW","sizeByWh"]};function zy(e){return-1!==Py.indexOf(e)?My:-1!==Oy.indexOf(e)?Iy:Ry}function Ly(e){try{if("full"===e)return{full:!0};if("square"===e)return{square:!0};let t=e.startsWith("pct:"),i=e.substr(t?4:0).split(",").map((e=>parseFloat(e)));return{x:i[0],y:i[1],w:i[2],h:i[3],percent:t}}catch(t){throw new Error("Expected 'full', 'square' or 'x,y,w,h'. Found "+e)}}function Fy(e){let t={upscaled:!1,max:!1,confined:!1};if("^"===e[0]&&(t.upscaled=!0,e=e.slice(1)),"max"===e||"full"===e)return t.max=!0,t.serialiseAsFull="full"===e,t;if("!"===e[0]&&(t.confined=!0,e=e.slice(1)),"p"===e[0])return t.percentScale=parseFloat(e.slice(4)),t;let i=e.split(",").map((e=>e.trim()));return i.length&&(""!==i[0]&&(t.width=parseInt(i[0],10)),""!==i[1]&&(t.height=parseInt(i[1],10))),t}function Ny(e){let t={angle:0};if("!"===e[0]&&(t.mirror=!0,e=e.substr(1)),t.angle=parseFloat(e)%360,Number.isNaN(t.angle))throw new Error(`Invalid rotation ${e}`);return t}function jy(e,t=""){let{path:i,scheme:r,server:n,prefix:a}=function(e,t=""){let i=e.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!i)throw new Error(`Invalid or unknown input ${e}`);let r=i[2],n=i[3],a=i[4];if("/"===a[0]&&(a=a.substr(1)),t.length>0){if("/"===t[0]&&(t=t.substr(1)),t!==a.substr(0,t.length))throw new Error(`Path does not start with prefix (path: ${a}, prefix: ${t})`);a=a.substr(t.length)}return{scheme:r,server:n,path:a,prefix:t}}(e,t),o=i.split("/").reverse(),[s,l,u,c,...h]=o,d=h.reverse().filter(Boolean).join("/");if(1===o.length||""===s)return{type:"base",scheme:r,server:n,prefix:a,identifier:d};if("info.json"===s){let[,...e]=o;return{type:"info",scheme:r,server:n,prefix:a,identifier:e.reverse().filter(Boolean).join("/")}}let p=s.split(".");return{type:"image",scheme:r,server:n,prefix:a,identifier:d,originalPath:i,region:Ly(c),size:Fy(u),rotation:Ny(l),quality:p[0],format:p[1]}}function $y(e){let t=jy(sy(e.id));if("info"!==t.type)throw new Error("Invalid service URL");let i=function(e){let t=e?Array.isArray(e.profile)?e.profile:[e.profile]:[],i={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let e of t)if("string"==typeof e&&(e=zy(e)),e){if(e.formats)for(let t of e.formats)-1===i.extraFormats.indexOf(t)&&i.extraFormats.push(t);if(e.qualities)for(let t of e.qualities)-1===i.extraQualities.indexOf(t)&&i.extraQualities.push(t);if(e.supports)for(let t of e.supports)-1===i.extraFeatures.indexOf(t)&&i.extraFeatures.push(t);if(e.maxHeight&&(i.maxHeight=e.maxHeight),e.maxWidth&&(i.maxWidth=e.maxWidth),e.maxArea&&(i.maxArea=e.maxArea),e.extraFormats)for(let t of e.extraFormats)-1===i.extraFormats.indexOf(t)&&i.extraFormats.push(t);if(e.extraQualities)for(let t of e.extraQualities)-1===i.extraQualities.indexOf(t)&&i.extraQualities.push(t);if(e.extraFeatures)for(let t of e.extraFeatures)-1===i.extraFeatures.indexOf(t)&&i.extraFeatures.push(t);e.maxHeight&&(i.maxHeight=e.maxHeight),e.maxWidth&&(i.maxWidth=e.maxWidth),e.maxArea&&(i.maxArea=e.maxArea)}if(e.extraFormats)for(let t of e.extraFormats)-1===i.extraFormats.indexOf(t)&&i.extraFormats.push(t);if(e.extraFeatures)for(let t of e.extraFeatures)-1===i.extraFeatures.indexOf(t)&&i.extraFeatures.push(t);if(e.extraQualities)for(let t of e.extraQualities)-1===i.extraQualities.indexOf(t)&&i.extraQualities.push(t);return i}(e);return{identifier:t.identifier,originalPath:"",server:t.server,prefix:t.prefix,scheme:t.scheme,type:"image",quality:-1===i.extraQualities.indexOf("default")?i.extraQualities[0]:"default",region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:"jpg",rotation:{angle:0}}}function By(e,t,i){let r=i.length,n=[];for(let t=0;t<r;t++){let r=i[t].width;n.push(e/r)}return n}function Dy(e,t,i){let r=i.length,n=[];for(let a=0;a<r;a++){let r=i[a];n.push({width:Math.floor(e/r),height:Math.floor(t/r)})}return n}function Uy(e){return e["@id"]?e["@id"]:e.id?e.id:void 0}function Wy(e){if(!e||!e.profile||!Uy(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let e of t)if("string"==typeof e&&-1!==Ty.indexOf(e))return!0;return!1}function Hy(e){if(!function(e){if(!Wy(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let e of t)if("string"==typeof e){if(-1!==Oy.indexOf(e))return!0}else{let t=[...e.supports||[],...e.extraFeatures||[]];if(-1!==t.indexOf("regionByPx")&&(-1!==t.indexOf("sizeByW")||-1!==t.indexOf("sizeByWh")))return!0}return!1}(e))return[];let t=[],i=Array.isArray(e.profile)?e.profile:[e.profile],r=i.length;for(let t=0;t<r;t++){let r=i[t];if("string"!=typeof r&&(r.maxHeight||r.maxWidth))return[{id:Uy(e),type:"variable",minWidth:0,minHeight:0,maxHeight:r.maxHeight||r.maxWidth,maxWidth:r.maxWidth||r.maxHeight}]}if(e.tiles){let i=e.tiles.length;for(let r=0;r<i;r++){let i=e.tiles[r];(i.height||i.width)&&t.push({id:Uy(e),type:"variable",minHeight:0,minWidth:0,maxHeight:i.height||i.width,maxWidth:i.width})}}return t}function qy(e){let t=e.match(/^.*\/(full)\/(((\d+),(\d+)?)|max)\/(\d+)\/default\.(jpg|png|jpeg)$/);if(t){let i=t[1],r=parseInt(t[4],10),n=parseInt(t[5],10),a=t[7];if(("max"===i||"full"===i)&&r&&n&&a)return{type:"fixed",id:e,height:n,width:r}}return{type:"unknown",id:e}}function Vy(e){if("string"==typeof e)return qy(e);let t=function(e){return e["@type"]?e["@type"]:e.type?e.type:void 0}(e);if("Image"!==t&&"sc:Image"!==t)return null;let i=e,r=Uy(i);return r?r&&i.width&&i.height?{id:r,type:"fixed",width:i.width,height:i.height,unsafe:!0}:qy(r):null}function Qy(e){return Wy(e)?(e&&e.sizes?e.sizes:[]).map((t=>({id:Uy(e),type:"fixed-service",height:t.height,width:t.width}))):[]}function Yy(e){let t=[],i=e.length;for(let r=0;r<i;r++){let i=Qy(e[r]);i.length&&t.push(...i);let n=Hy(e[r]);n.length&&t.push(...n)}return t}function Gy(e){let t=e.service?Array.isArray(e.service)?e.service:[e.service]:[],i=t.length,r=[];for(let e=0;e<i;e++)Wy(t[e])&&r.push(t[e]);return r}function Ky({x:e=0,y:t=0,w:i,h:r,full:n,square:a,percent:o}){if(n)return"full";if(a)return"square";if(typeof i>"u"||typeof r>"u")throw new Error("RegionParameter: invalid region");let s=`${e},${t},${i},${r}`;return o?`pct:${s}`:s}function Xy({max:e,percentScale:t,upscaled:i,confined:r,width:n,height:a,serialiseAsFull:o}){let s=[];return i&&s.push("^"),e?(s.push(o?"full":"max"),s.join("")):(r&&s.push("!"),t&&s.push(`pct:${t}`),n&&s.push(`${n}`),s.push(","),a&&s.push(`${a}`),s.join(""))}function Zy(e){return`${e.mirror?"!":""}${(e.angle||0)%360}`}var Jy=Object.defineProperty,eb=Object.defineProperties,tb=Object.getOwnPropertyDescriptors,ib=Object.getOwnPropertySymbols,rb=Object.prototype.hasOwnProperty,nb=Object.prototype.propertyIsEnumerable,ab=(e,t,i)=>t in e?Jy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,ob=(e,t)=>{for(var i in t||(t={}))rb.call(t,i)&&ab(e,i,t[i]);if(ib)for(var i of ib(t))nb.call(t,i)&&ab(e,i,t[i]);return e},sb=(e,t)=>eb(e,tb(t));function lb(e,t){let i=e.prefix.startsWith("/")?e.prefix.substr(1):e.prefix,r=`${e.scheme}://${e.server}/${i?`${i}/`:""}${e.identifier}`;if("base"===e.type)return r;if("info"===e.type)return`${r}/info.json`;let{region:n,size:a,rotation:o,format:s,quality:l}=e;if(t){let e=t["@context"]?Array.isArray(t["@context"])?t["@context"]:[t["@context"]]:[],i=-1!==e.indexOf("http://iiif.io/api/image/2/context.json"),r=-1!==e.indexOf("http://iiif.io/api/image/3/context.json");if((a.width===t.width&&!a.height||a.height===t.height&&!a.width||a.width===t.width&&a.height===t.height)&&(a=sb(ob({},a),{max:!0})),i&&(a.max&&!a.serialiseAsFull&&(a=sb(ob({},a),{serialiseAsFull:!0})),!a.max&&a.width&&a.height&&(a=sb(ob({},a),{height:void 0}))),r&&(a.max&&a.serialiseAsFull&&(a=sb(ob({},a),{serialiseAsFull:!1})),a.width&&!a.height&&t.width&&t.height)){let e=t.height/t.width;a=sb(ob({},a),{height:Math.ceil(a.width*e)})}}return[r,Ky(n),Xy(a),Zy(o),`${l}.${s}`].filter(Boolean).join("/")}function ub(e,t,i){let r=$y({id:sy(Uy(e)),profile:"level2",type:"ImageService2"});if("image"!==r.type)throw new Error("Invalid service");return r.size.max=!1,r.size.width=t,r.size.height=i,{id:lb(r),type:"fixed",width:t,height:i||e.height/(e.width||1)*t,unsafe:e.width>t}}function cb(e){let t=e.replace(/(https?:\/\/)?(www.)?/i,"");return-1!==t.indexOf("/")?t.split("/")[0]:t}function hb(e,t){let i=[],r=Object.assign({unsafeImageService:!1,atAnyCost:!0,fallback:!0,minHeight:64,minWidth:64,maxHeight:1/0,maxWidth:1/0,returnAllOptions:!1,preferFixedSize:!1,allowUnsafe:!1,explain:!1,height:0,width:0},e),n=[],a=[],o=null,s=(e,t)=>{if(function(e,t,i){let r=e.width?e.width:e.maxWidth;return i.height<=e.maxHeight&&i.width<=e.maxWidth&&i.height>=e.minHeight&&i.width>=e.minWidth&&(!t||Math.abs(i.width-r)<Math.abs(t.width-r))}(r,t,e)){if(r.preferFixedSize&&e.unsafe)return void a.push(e);r.returnAllOptions&&t&&a.push(t),o=e}else r.returnAllOptions&&a.push(e)},l=t.length;for(let e=0;e<l;e++){let i=t[e](),a=i.length;for(let e=0;e<a;e++){let t=i[e];if("unknown"===t.type&&r.atAnyCost&&n.push(t),"fixed"===t.type&&(t.unsafe?n.push(t):s(t,o)),"fixed-service"===t.type)if(r.unsafeImageService){s(ub(t,r.width,r.height),o)}else{s(ub(t,t.width,t.height),o)}if("variable"===t.type&&t.maxWidth){s(ub({id:t.id,type:"fixed-service",width:t.maxWidth,height:t.maxWidth},t.maxWidth),o)}}if(o&&!r.returnAllOptions){if(o.unsafe||r.allowUnsafe)continue;break}}return r.atAnyCost&&0===a.length?{best:o||n[0],fallback:n.slice(1),log:i}:r.returnAllOptions?{best:r.atAnyCost?o||a[0]||n[0]:o||a[0],fallback:[...a,...n],log:i}:{best:o||a[0]||null,fallback:o?a:a.slice(1),log:i}}var db=Object.defineProperty,pb=Object.defineProperties,fb=Object.getOwnPropertyDescriptors,gb=Object.getOwnPropertySymbols,mb=Object.prototype.hasOwnProperty,vb=Object.prototype.propertyIsEnumerable,yb=(e,t,i)=>t in e?db(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,bb=(e,t)=>{for(var i in t||(t={}))mb.call(t,i)&&yb(e,i,t[i]);if(gb)for(var i of gb(t))vb.call(t,i)&&yb(e,i,t[i]);return e},wb=(e,t)=>pb(e,fb(t));function xb(e,t,i){let r=e>t?e:t,n=i.length,a=[];for(let e=0;e<n;e++){let t=i[e],n=t.scaleFactors[0],o=r/n,s=[n];for(;o>=t.width;)n*=2,s.push(n),o/=2;a.push(wb(bb({},t),{scaleFactors:s}))}return a}function _b(e){if(e&&e.profile){let t=e.profile;if(t){let e=Array.isArray(t)?t:[t];return e.includes("level0")||e.includes("http://iiif.io/api/image/2/level0.json")||e.includes("http://iiif.io/api/image/1/level0.json")||e.includes("http://iiif.io/api/image/1/profiles/level0.json")}}return!1}var Sb=(e,t,i)=>new Promise(((r,n)=>{var a=e=>{try{s(i.next(e))}catch(e){n(e)}},o=e=>{try{s(i.throw(e))}catch(e){n(e)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(a,o);s((i=i.apply(e,t)).next())})),Eb=class{constructor(){this.config={verificationsRequired:1,approximateServices:!0,enableFetching:!0,disableThrottling:!1},this.fetchingCount=0,this.imageServices={},this.knownImageServers={}}setConfig(e){Object.assign(this.config,e)}sample(e,t,i=!0){let r=cb(Uy(e)),n=sy(Uy(e)),a=this.knownImageServers[r];return this.imageServices[n]=Object.assign(e,{real:!0}),a||!e.tiles||_b(e)?this.verify(e):(this.knownImageServers[r]={verifications:0,malformed:!1,root:r,preLoaded:i,sampledId:Uy(e),verified:!1,server:null,result:{context:e["@context"]||[],sampledProfile:e.profile,resourceServiceRatio:t&&e.height?t.height/e.height:1,sampledSizes:e.sizes||[],sizeRatios:By(e.width,e.height,e.sizes||[]),sampledTiles:e.tiles||[]}},!0)}preLoad(e,t=!0){this.knownImageServers[e.root]=e,t&&(this.knownImageServers[e.root].malformed=!1,this.knownImageServers[e.root].verifications=this.config.verificationsRequired)}predict(e,t=!1,i=!1){let r=null==e?void 0:e.source,n=cb(Uy(e)),a=this.knownImageServers[n];if(!a||!a.result||!i&&(a.malformed||a.verifications<this.config.verificationsRequired)||_b(e.source))return null;let o=sy(Uy(e));return this.imageServices[o]||(this.imageServices[o]={"@context":a.result.context,"@id":Uy(e),id:Uy(e),protocol:"http://iiif.io/api/image",tiles:(null==r?void 0:r.tiles)||xb(e.width,e.height,a.result.sampledTiles),sizes:(null==r?void 0:r.sizes)||Dy(Math.round(e.width/a.result.resourceServiceRatio),Math.round(e.height/a.result.resourceServiceRatio),a.result.sizeRatios),profile:(null==r?void 0:r.profile)||a.result.sampledProfile,height:(null==r?void 0:r.height)||e.height,width:(null==r?void 0:r.width)||e.width,real:!1}),this.imageServices[o]}getThumbnailFromResource(e,t){return Sb(this,arguments,(function*(e,t,i=!0,r=[]){let n=yield this.getImageCandidates(e,i);return hb(t,[()=>r,()=>n])}))}getImageCandidates(e,t=!0){return Sb(this,null,(function*(){let i=e;if(t&&i.height&&i.width){let e=Gy(i);for(let t of e){let e={id:Uy(t),width:t.width?t.width:i.width,height:t.height?t.height:i.height,source:t};yield this.loadService(e)}}return function(e,t=!0,i){let r=[],n=Vy(e);if(null===n)return r;let a=e;if(r.push(n),t&&a.width&&a.height){let e=[],t=Gy(a);for(let r of t){let t={id:Uy(r),width:a.width,height:a.height};if(i.canLoadSync(t)){let r=i.loadServiceSync(t);r&&(r.height||(r.height=a.height),r.width||(r.width=a.width),e.push(...Yy([r])))}}if(e.length)return r.push(...e),r}return a.service&&r.push(...Yy(a.service)),r}(e,t,this)}))}verify(e){return Sb(this,null,(function*(){let t=this.predict(e,!1,!0),i=yield this.fetchService(Uy(e));if(!t)return!1;let r=t.height===i.height&&t.width===i.width&&t["@context"]===i["@context"]&&function(e,t){if(e.length!==t.length)return!1;if(0===e.length&&0===t.length)return!0;let i=e.length,r=!0;for(let n=0;n<i;n++){let i=e[n],a=t[n];if(i.width!==a.width||i.height!==a.height){r=!1;break}}if(r)return!0;let n=0;for(let r=0;r<i;r++)for(let a=0;a<i;a++)if(e[r].width===t[a].width&&e[r].height===t[a].height){n++;break}return n===i}(t.sizes||[],i.sizes||[]);if(r){let t=cb(Uy(e));this.knownImageServers[t].verifications+=1,this.knownImageServers[t].verifications>=this.config.verificationsRequired&&(this.knownImageServers[t].verified=!0)}return r}))}canLoadSync(e){let t="string"==typeof e?e:Uy(e),i=sy(t);if(this.imageServices[i])return!0;let r=this.knownImageServers[cb(t)];return r&&!r.malformed&&r.verifications>=this.config.verificationsRequired}markAsMalformed(e){return Sb(this,null,(function*(){return this.knownImageServers[cb(Uy(e))].malformed=!0,this.loadService(e,!0)}))}fetchService(e,t=!1){return Sb(this,null,(function*(){let i=sy(e);if(this.imageServices[i]&&(!t||this.imageServices[i].real))return this.imageServices[i];if(!this.config.enableFetching)throw new Error("Fetching is not enabled");let r=yield this.fetch(i).then((e=>e.json()));return!r.id&&r["@id"]&&(r.id=r["@id"]),r.id!==e&&(r.id=e,r["@id"]&&(r["@id"]=e)),this.imageServices[i]=Object.assign(r,{real:!0}),this.imageServices[i]}))}fetch(e,t){return Sb(this,null,(function*(){return fetch(e,t)}))}loadService(e,t=!1){return Sb(this,null,(function*(){if(!this.config.disableThrottling){let e=!0;for(;e;){if(!(this.fetchingCount>=this.config.verificationsRequired)){e=!1;break}yield new Promise((e=>setTimeout(e,500)))}}let i=this.knownImageServers[cb(Uy(e))];if(i&&!i.malformed&&!t){yield i.result;let t=this.loadServiceSync(e);if(t)return t}this.fetchingCount++;let r=yield this.fetchService(Uy(e),t);return this.fetchingCount--,r.real&&this.sample(r,e),r}))}loadServiceSync(e){let t=sy(Uy(e));return this.imageServices[t]?this.imageServices[t]:this.predict(e)}};function kb(e,t={}){return function(e,t,i={}){let{strictFallback:r=!1,defaultText:n="",separator:a="\n",fallbackLanguages:o=[],closest:s}=i,l=Object.keys(e||{}),u=s?t:function(e,t,i=[],r=!1){if(!e||!t||0===t.length)return;if(1===t.length)return t[0];if(-1!==t.indexOf(e))return e;let n=-1!==e.indexOf("-")?e.slice(0,e.indexOf("-")):null;if(n&&-1!==t.indexOf(n))return n;for(let e of i)if(-1!==t.indexOf(e))return e;if(!r){let r=t.map((e=>-1!==e.indexOf("-")?e.slice(0,e.indexOf("-")):null)).indexOf(e);if(-1!==r)return t[r];for(let e of i){let i=-1!==e.indexOf("-")?e.slice(0,e.indexOf("-")):null,r=i?t.indexOf(i):-1;if(-1!==r)return t[r]}}return-1!==t.indexOf("none")?"none":-1!==t.indexOf("@none")?"@none":t[0]}(t,l,o,r);if(!e)return n;if("string"==typeof e)return e;let c=u?e[u]:void 0;return c?"string"==typeof c?c:c.join(a):""}(e,typeof navigator<"u"?navigator.language:void 0,t)}new Eb;var Cb=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],r=!0,n=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(i.push(o.value),!t||i.length!==t);r=!0);}catch(e){n=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw a}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},Ab=2*Math.PI,Pb=function(e,t,i,r,n,a,o){var s=e.x,l=e.y;return{x:r*(s*=t)-n*(l*=i)+a,y:n*s+r*l+o}},Ob=function(e,t){var i=1.5707963267948966===t?.551915024494:-1.5707963267948966===t?-.551915024494:1.3333333333333333*Math.tan(t/4),r=Math.cos(e),n=Math.sin(e),a=Math.cos(e+t),o=Math.sin(e+t);return[{x:r-n*i,y:n+r*i},{x:a+o*i,y:o-a*i},{x:a,y:o}]},Tb=function(e,t,i,r){var n=e*i+t*r;return n>1&&(n=1),n<-1&&(n=-1),(e*r-t*i<0?-1:1)*Math.acos(n)},Rb=function(e){var t=e.px,i=e.py,r=e.cx,n=e.cy,a=e.rx,o=e.ry,s=e.xAxisRotation,l=void 0===s?0:s,u=e.largeArcFlag,c=void 0===u?0:u,h=e.sweepFlag,d=void 0===h?0:h,p=[];if(0===a||0===o)return[];var f=Math.sin(l*Ab/360),g=Math.cos(l*Ab/360),m=g*(t-r)/2+f*(i-n)/2,v=-f*(t-r)/2+g*(i-n)/2;if(0===m&&0===v)return[];a=Math.abs(a),o=Math.abs(o);var y=Math.pow(m,2)/Math.pow(a,2)+Math.pow(v,2)/Math.pow(o,2);y>1&&(a*=Math.sqrt(y),o*=Math.sqrt(y));var b=function(e,t,i,r,n,a,o,s,l,u,c,h){var d=Math.pow(n,2),p=Math.pow(a,2),f=Math.pow(c,2),g=Math.pow(h,2),m=d*p-d*g-p*f;m<0&&(m=0),m/=d*g+p*f;var v=(m=Math.sqrt(m)*(o===s?-1:1))*n/a*h,y=m*-a/n*c,b=u*v-l*y+(e+i)/2,w=l*v+u*y+(t+r)/2,x=(c-v)/n,_=(h-y)/a,S=(-c-v)/n,E=(-h-y)/a,k=Tb(1,0,x,_),C=Tb(x,_,S,E);return 0===s&&C>0&&(C-=Ab),1===s&&C<0&&(C+=Ab),[b,w,k,C]}(t,i,r,n,a,o,c,d,f,g,m,v),w=Cb(b,4),x=w[0],_=w[1],S=w[2],E=w[3],k=Math.abs(E)/(Ab/4);Math.abs(1-k)<1e-7&&(k=1);var C=Math.max(Math.ceil(k),1);E/=C;for(var A=0;A<C;A++)p.push(Ob(S,E)),S+=E;return p.map((function(e){var t=Pb(e[0],a,o,g,f,x,_),i=t.x,r=t.y,n=Pb(e[1],a,o,g,f,x,_),s=n.x,l=n.y,u=Pb(e[2],a,o,g,f,x,_);return{x1:i,y1:r,x2:s,y2:l,x:u.x,y:u.y}}))},Ib=function(e){var t=[];return e.replace(zb,(function(e,i,r){var n=i.toLowerCase();for(r=function(e){var t=e.match(Lb);return t?t.map(Number):[]}(r),"m"==n&&r.length>2&&(t.push([i].concat(r.splice(0,2))),n="l",i="m"==i?"l":"L");;){if(r.length==Mb[n])return r.unshift(i),t.push(r);if(r.length<Mb[n])throw new Error("malformed path data");t.push([i].concat(r.splice(0,Mb[n])))}})),t},Mb={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},zb=/([astvzqmhlc])([^astvzqmhlc]*)/gi;var Lb=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;var Fb=function(e){var t=0,i=0,r=0,n=0;return e.map((function(e){var a=(e=e.slice())[0],o=a.toUpperCase();if(a!=o)switch(e[0]=o,a){case"a":e[6]+=r,e[7]+=n;break;case"v":e[1]+=n;break;case"h":e[1]+=r;break;default:for(var s=1;s<e.length;)e[s++]+=r,e[s++]+=n}switch(o){case"Z":r=t,n=i;break;case"H":r=e[1];break;case"V":n=e[1];break;case"M":r=t=e[1],n=i=e[2];break;default:r=e[e.length-2],n=e[e.length-1]}return e}))};function Nb(e){let t,i,r,n=Ib(e),a=Fb(n),o=0,s=0,l=0,u=0,c=0,h=0,d=[];for(let e=0;e<a.length;e++){let n=a[e],p=n[0];switch(p){case"M":o=n[1],s=n[2];break;case"H":n=["L",n[1],s];break;case"V":n=["L",o,n[1]];break;case"S":{let e=c,i=h;("C"===t||"S"==t)&&(e+=e-l,i+=i-u),n=["C",e,i,n[1],n[2],n[3],n[4]]}break;case"T":"Q"===t||"T"==t?(i=2*c-i,r=2*h-r):(i=c,r=h),n=["Q",i,r,n[1],n[2]];break;case"Q":i=n[1],r=n[2];break;case"A":{let e=Rb({px:c,py:h,cx:n[6],cy:n[7],rx:n[1],ry:n[2],xAxisRotation:n[3],largeArcFlag:n[4],sweepFlag:n[5]});if(!e.length)continue;for(let[t,i]of e.entries())n=["C",i.x1,i.y1,i.x2,i.y2,i.x,i.y],t<e.length-1&&d.push(n)}break;case"Z":n=["L",o,s]}t=p,c=n[n.length-2],h=n[n.length-1],["C","Q","A"].indexOf(p)>-1?(l=n[n.length-4],u=n[n.length-3]):(l=c,u=h),d.push(n)}return d}function jb(e,t,i,r=1){return new Ub(e,t,i).subdivide(r)}function $b(e,t,i,r,n=1){return new Wb(new Float64Array([e.x,e.y,t.x,t.y,i.x,i.y,r.x,r.y])).subdivide(n)}function Bb(e){return e/(1-.67+Math.pow(Math.pow(.67,4)+.25*e*e,.25))}function Db(e){return e*(.61+Math.sqrt(.1521+.25*e*e))}var Ub=class{constructor(e,t,i){this.start=e,this.control=t,this.end=i}eval(e){let t=1-e;return{x:this.start.x*t*t+2*this.control.x*t*e+this.end.x*e*e,y:this.start.y*t*t+2*this.control.y*t*e+this.end.y*e*e}}mapToBasic(){let{x:e,y:t}=this.start,{x:i,y:r}=this.control,{x:n,y:a}=this.end,o=2*i-e-n,s=2*r-t-a,l=(n-e)*s-(a-t)*o,u=((i-e)*o+(r-t)*s)/l,c=((n-i)*o+(a-r)*s)/l;return{x0:e,x2:n,scale:Math.abs(l)/(Math.hypot(o,s)*Math.abs(c-u)),cross:l}}subdivide(e){let t=this.mapToBasic(),i=Bb(t.x0),r=Bb(t.x2),n=.5*Math.abs(r-i)*Math.sqrt(t.scale/e),a=Math.ceil(n),o=Db(i),s=Db(r),l=[0];for(let e=1;e<a;e++){let t=(Db(i+(r-i)*e/a)-o)/(s-o);l.push(t)}return l.push(1),l.map((e=>this.eval(e)))}},Wb=class{constructor(e){this.c=e}weightsum(e,t,i,r){return{x:e*this.c[0]+t*this.c[2]+i*this.c[4]+r*this.c[6],y:e*this.c[1]+t*this.c[3]+i*this.c[5]+r*this.c[7]}}eval(e){let t=1-e,i=t*t*t,r=3*t*t*e,n=3*t*e*e,a=e*e*e;return this.weightsum(i,r,n,a)}deriv(e){let t=1-e,i=-3*t*t,r=3*e*e,n=-6*e*t-i,a=6*e*t-r;return this.weightsum(i,n,a,r)}midpoint_quadbez(){let e=this.weightsum(-.25,.75,.75,-.25);return new Ub({x:this.c[0],y:this.c[1]},e,{x:this.c[6],y:this.c[7]})}subsegment(e,t){let i=new Float64Array(8),r=this.eval(e),n=this.eval(t);i[0]=r.x,i[1]=r.y;let a=(t-e)/3,o=this.deriv(e);i[2]=r.x+a*o.x,i[3]=r.y+a*o.y;let s=this.deriv(t);return i[4]=n.x-a*s.x,i[5]=n.y-a*s.y,i[6]=n.x,i[7]=n.y,new Wb(i)}subdivide(e){let t=.1*e,i=e-t,r=Math.sqrt(i),n=function(e){return e.x*e.x+e.y*e.y}(this.weightsum(1,-3,3,-1)),a=Math.ceil(Math.pow(n/(432*t*t),1/6)),o=[],s=0;for(let e=0;e<a;e++){let t=e/a,i=(e+1)/a,n=this.subsegment(t,i).midpoint_quadbez(),l=n.mapToBasic(),u=Bb(l.x0),c=Bb(l.x2),h=Math.sqrt(l.scale),d=Math.abs(c-u)*h;if(Math.sign(l.x0)!=Math.sign(l.x2)){let e=r/h,t=r*Math.abs(c-u)/Bb(e);d=Math.max(d,t)}o.push({quad:n,a0:u,a2:c,val:d}),s+=d}let l=.5*s/r,u=Math.ceil(l),c=[{x:this.c[0],y:this.c[1]}],h=0,d=0;for(let e=1;e<u;e++){let t=s*e/u;for(;h+o[d].val<t;)h+=o[d].val,d++;let i=o[d].a0,r=o[d].a2,n=Db(i),a=Db(r),l=(Db(i+(r-i)*(t-h)/o[d].val)-n)/(a-n);c.push(o[d].quad.eval(l))}return c.push({x:this.c[6],y:this.c[7]}),c}},Hb=/&?(xywh=)?(pixel:|percent:|pct:)?([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?)/,qb=/&?(t=)(npt:)?([0-9]+(.[0-9]+)?)?(,([0-9]+(.[0-9]+)?))?/,Vb=/^rgba\((\d+),(\d+),(\d+),([0-9.]+)\)$/;function Qb(e,{domParser:t,svgPreprocessor:i}={}){var r,n;if(Array.isArray(e))return e.reduce(((e,t)=>{let{selector:i,selectors:r}=Qb(t);return i&&(e.selector||(e.selector=i),e.selectors.push(...r)),e}),{selector:null,selectors:[]});if(!e)return{selector:null,selectors:[]};if("string"==typeof e){let[t,i]=e.split("#");return i?Qb({type:"FragmentSelector",value:i}):{selector:null,selectors:[]}}if("PointSelector"===e.type&&(e.t||0===e.t)){let t={type:"TemporalSelector",temporal:{startTime:e.t}};return{selector:t,selectors:[t]}}if("FragmentSelector"===e.type){let t=Hb.exec(e.value);if(t){let e={type:"BoxSelector",spatial:{unit:"percent:"===t[2]||"pct:"===t[2]?"percent":"pixel",x:parseFloat(t[3]),y:parseFloat(t[4]),width:parseFloat(t[5]),height:parseFloat(t[6])}};return{selector:e,selectors:[e]}}let i=e.value.match(qb);if(i){let e={type:"TemporalSelector",temporal:{startTime:i[4]?parseFloat(i[4]):0,endTime:i[7]?parseFloat(i[7]):void 0}};return{selector:e,selectors:[e]}}return{selector:null,selectors:[]}}if("SvgSelector"===e.type&&"value"in e){t||(typeof window<"u"?t=new window.DOMParser:console.warn("No DOMParser available, cannot parse SVG selector, `points`, `spatial` and `style` will be unavailable and the SVG will not be normalized."));let a,o,s,l=[],u=null!=(r=null==i?void 0:i(e.value))?r:e.value;if(t){let i=t.parseFromString(e.value,"image/svg+xml").querySelector("svg");if(!i)return console.warn(`Illegal SVG selector: ${e.value}`),{selector:null,selectors:[]};let r=Gb(i);r&&(l=r.points,s=r.shapeType,a=[Math.min(...l.map((e=>e[0]))),Math.min(...l.map((e=>e[1]))),Math.max(...l.map((e=>e[0]))),Math.max(...l.map((e=>e[1])))],({style:o,svg:u}=null!=(n=function(e){let t={};if(e.hasAttribute("fill")?(t.fill=e.getAttribute("fill"),e.removeAttribute("fill")):e.style.fill&&(t.fill=e.style.fill),t.fill){let e=Vb.exec(t.fill);e&&(t.fillOpacity=parseFloat(e[4]),t.fill=`rgb(${e[1]}, ${e[2]}, ${e[3]})`)}if(e.hasAttribute("fill-opacity")?(t.fillOpacity=parseFloat(e.getAttribute("fill-opacity")),e.removeAttribute("fill-opacity")):e.style.fillOpacity&&(t.fillOpacity=parseFloat(e.style.fillOpacity)),e.hasAttribute("stroke")?(t.stroke=e.getAttribute("stroke"),e.removeAttribute("stroke")):e.style.stroke&&(t.stroke=e.style.stroke),t.stroke){let e=Vb.exec(t.stroke);e&&(t.strokeOpacity=parseFloat(e[4]),t.stroke=`rgb(${e[1]}, ${e[2]}, ${e[3]})`)}e.hasAttribute("stroke-opacity")?(t.strokeOpacity=parseFloat(e.getAttribute("stroke-opacity")),e.removeAttribute("stroke-opacity")):e.style.strokeOpacity&&(t.strokeOpacity=parseFloat(e.style.strokeOpacity)),e.hasAttribute("stroke-width")?(t.strokeWidth=e.getAttribute("stroke-width"),e.removeAttribute("stroke-width")):e.style.strokeWidth&&(t.strokeWidth=e.style.strokeWidth),e.hasAttribute("stroke-dasharray")?(t.strokeDasharray=e.getAttribute("stroke-dasharray"),e.removeAttribute("stroke-dasharray")):e.style.strokeDasharray&&(t.strokeDasharray=e.style.strokeDasharray);let i=e;for(;"svg"!==i.tagName.toLowerCase();)if(i=i.parentElement,null===i)throw new Error("Could not find root SVG element");return{svg:i.outerHTML,style:Object.keys(t).length>0?t:void 0}}(r.element))?n:{svg:u}))}let c={type:"SvgSelector",svg:u,svgShape:s,style:o,points:l.length?l:void 0,spatial:a?{unit:"pixel",x:a[0],y:a[1],width:a[2]-a[0],height:a[3]-a[1]}:void 0};return{selector:c,selectors:[c]}}return{selector:null,selectors:[]}}function Yb(e){let t=e.map((e=>e[0])).reduce(((e,t)=>(e[t]+=1,e)),{C:0,Q:0,L:0,M:0}),i=new Set(e.map((e=>e[0])));if(t.C>0||t.Q>0)return"path";if(t.L>0&&(1===i.size||2===i.size&&i.has("M"))){if(4===t.L)return"rect";let i=e.slice(-1)[0];return"M"===e[0][0]&&"L"===i[0]&&i[1]==e[0][1]&&i[2]===e[0][2]||0===i[1]&&0===i[2]?"polygon":"polyline"}return"path"}function Gb(e){var t,i,r,n,a,o,s,l,u,c,h,d,p,f,g,m,v;for(let y of Array.from(e.children))switch(null==y?void 0:y.tagName.toLowerCase()){case"g":{let e=Gb(y);if(e)return e}continue;case"path":{let e=y.getAttribute("d");if(!e)continue;let t=Nb(e);return{element:y,points:Kb(t),shapeType:Yb(t)}}case"circle":{let e=parseFloat(null!=(t=y.getAttribute("cx"))?t:"0"),n=parseFloat(null!=(i=y.getAttribute("cy"))?i:"0"),a=parseFloat(null!=(r=y.getAttribute("r"))?r:"0");if(!a)continue;let o=[];for(let t=0;t<=360;t+=12){let i=t*Math.PI/180;o.push([e+a*Math.cos(i),n+a*Math.sin(i)])}return{element:y,points:o,shapeType:"circle"}}case"ellipse":{let e=parseFloat(null!=(n=y.getAttribute("cx"))?n:"0"),t=parseFloat(null!=(a=y.getAttribute("cy"))?a:"0"),i=parseFloat(null!=(o=y.getAttribute("rx"))?o:"0"),r=parseFloat(null!=(s=y.getAttribute("ry"))?s:"0");if(!i&&!r)continue;let l=[];for(let n=0;n<=360;n+=12){let a=Math.tan(n/360*Math.PI),o=i*(1-a**2)/(1+a**2),s=2*r*a/(1+a**2);l.push([e+o,t+s])}return{element:y,points:l,shapeType:"ellipse"}}case"line":{let e=parseFloat(null!=(l=y.getAttribute("x0"))?l:"0"),t=parseFloat(null!=(u=y.getAttribute("y0"))?u:"0"),i=parseFloat(null!=(c=y.getAttribute("x1"))?c:"0"),r=parseFloat(null!=(h=y.getAttribute("y1"))?h:"0");if(e===i&&t===r)continue;return{element:y,points:[[e,t],[i,r]],shapeType:"polyline"}}case"polygon":case"polyline":{let e=null!=(p=null==(d=y.getAttribute("points"))?void 0:d.split(" ").map((e=>e.split(",").map(parseFloat))))?p:[];if(!e.length)continue;let t="polyline";return"polygon"===y.tagName.toLowerCase()&&(e.push(e[0]),t="polygon"),{element:y,points:e,shapeType:t}}case"rect":{let e=parseFloat(null!=(f=y.getAttribute("x"))?f:"0"),t=parseFloat(null!=(g=y.getAttribute("y"))?g:"0"),i=parseFloat(null!=(m=y.getAttribute("width"))?m:"0"),r=parseFloat(null!=(v=y.getAttribute("height"))?v:"0");if(!i||!r)continue;return{element:y,points:[[e,t],[e+i,t],[e+i,t+r],[e,t+r],[e,t]],shapeType:"rect"}}default:continue}return null}function Kb(e){var t;let i=[];for(let r=0;r<e.length;r++){let n=null!=(t=i[i.length-1])?t:[0,0],a=e[r];switch(a[0]){case"M":case"L":i.push([a[1],a[2]]);continue;case"C":i.push(...$b({x:n[0],y:n[1]},{x:a[1],y:a[2]},{x:a[3],y:a[4]},{x:a[5],y:a[6]}).map((e=>[e.x,e.y])).slice(1));continue;case"Q":i.push(...jb({x:n[0],y:n[1]},{x:a[1],y:a[2]},{x:a[3],y:a[4]}).map((e=>[e.x,e.y])).slice(1));continue}}return i}function Xb(e){return"SpecificResource"===e.type?[e.source,{selector:e.selector}]:[e,{selector:null}]}Symbol.for("_refs_"),Symbol.for("_reactive_"),Symbol.for("_defined_");function Zb(e,t){for(let i of t.items){if("Canvas"===i.type)return i;if("Range"===i.type){let t=Zb(e,e.get(i));if(t)return t}}return null}function Jb(e,t,i){var r;for(let n of t.items){let a=null==(r=n.id)?void 0:r.split("#")[0];if("SpecificResource"===n.type&&n.source===i||"Canvas"===n.type&&i===a)return t;if("Range"===n.type){let t=Jb(e,e.get(n),i);if(t)return t}}return null}var ew=class{constructor(e){this.__vault=null,this.__eventsHelper=null,this.__stylesHelper=null,this.__e={},this.htmlProps={},this.handlers=[],this.__annotation="string"==typeof e?{id:e,type:"Annotation"}:{id:e.id,type:"Annotation"},this.classList=new class{constructor(e,t){this._className="",this.onChange=e||(()=>{}),this.className=Array.isArray(t)?t.join(" "):t||""}set className(e){this._className=e}get className(){return this._className}add(e){this.className.split(" ").includes(e.trim())||(this.className+=" "+e.trim())}remove(e){this.className=this.className.split(" ").filter((t=>t&&t!==e)).join(" ")}toggle(e,t){let i=this.className.split(" ");t&&!i.includes(e)&&(this.className+=" "+e.trim())}contains(e){return this.className.split(" ").includes(e.trim())}getClassName(){return this.className}}((e=>{this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"html",p(d({},this.htmlProps),{className:e}))})),this.source=e}get className(){return this.classList.getClassName()}set className(e){this.classList.className=e}set href(e){this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"html",{href:e}),this.htmlProps.href=e}set title(e){this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"html",{title:e}),this.htmlProps.title=e}set target(e){this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"html",{target:e}),this.htmlProps.target=e}applyStyle(e){this.style=Yc(this.style,e),this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"atlas",this.style)}addEventListener(e,t){this.__eventsHelper&&this.__eventsHelper.addEventListener(this.__annotation,e,t),this.handlers.push([e,t])}removeEventListener(e,t){this.__eventsHelper&&this.__eventsHelper.removeEventListener(this.__annotation,e,t),this.handlers=this.handlers.filter((i=>i[0]===e&&i[1]===t))}bindToVault(e){this.__vault=e,this.__eventsHelper=ay(e),this.__stylesHelper=oy(e);for(let[e,t]of this.handlers)this.__eventsHelper.addEventListener(this.__annotation,e,t);this.__stylesHelper.applyStyles(this.__annotation,"atlas",this.style),this.__stylesHelper.applyStyles(this.__annotation,"html",p(d({},this.htmlProps),{className:this.classList.getClassName()}))}getSource(){return this.source}getAnnotation(){return this.__annotation}beforeRemove(){if(this.onBeforeRemove&&this.onBeforeRemove(),this.__vault){if(this.__eventsHelper)for(let[e,t]of this.handlers)this.__eventsHelper.removeEventListener(this.__annotation,e,t);this.__vault=null}}};At();var tw=b(Mt(),1),iw="@iiif/IMPORT_ENTITIES",rw="@iiif/MODIFY_ENTITY_FIELD",nw="@iiif/REORDER_ENTITY_FIELD",aw="@iiif/ADD_REFERENCE",ow="@iiif/REMOVE_REFERENCE",sw=(0,tw.createAction)(iw)(),lw=(0,tw.createAction)(rw)(),uw=(0,tw.createAction)(nw)(),cw=(0,tw.createAction)(aw)(),hw=(0,tw.createAction)(ow)(),dw={importEntities:sw,modifyEntityField:lw,reorderEntityField:uw,addReference:cw,removeReference:hw},pw="@iiif/ADD_MAPPING",fw="@iiif/ADD_MAPPINGS",gw=(0,tw.createAction)(pw)(),mw=(0,tw.createAction)(fw)(),vw="@iiif/SET_META_VALUE",yw="@iiif/SET_META_VALUE_DYNAMIC",bw="@iiif/UNSET_META_VALUE",ww={setMetaValue:(0,tw.createAction)(vw)(),setMetaValueDynamic:(0,tw.createAction)(yw)(),unsetMetaValue:(0,tw.createAction)(bw)()},xw="RESOURCE_ERROR",_w="RESOURCE_LOADING",Sw="RESOURCE_READY",Ew="@iiif/REQUEST_RESOURCE",kw="@iiif/REQUEST_ERROR",Cw="@iiif/REQUEST_MISMATCH",Aw="@iiif/REQUEST_COMPLETE",Pw="@iiif/REQUEST_OFFLINE_RESOURCE",Ow=(0,tw.createAction)(Ew)(),Tw=(0,tw.createAction)(kw)(),Rw=(0,tw.createAction)(Cw)(),Iw=(0,tw.createAction)(Aw)();(0,tw.createAction)(Pw)();var Mw="@iiif/BATCH",zw="@iiif/BATCH_IMPORT",Lw=(0,tw.createAction)(Mw)();(0,tw.createAction)(zw)();var Fw=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function Nw(e,t){return!!(e===t||Fw(e)&&Fw(t))}function jw(e,t){if(!Array.isArray(e)||!Array.isArray(t))return e===t;if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!Nw(e[i],t[i]))return!1;return!0}function $w(e,t){let i=e.iiif.requests[t],r=e.iiif.mapping[t];if(r&&e.iiif.entities[r][i.resourceUri])return e.iiif.entities[r][i.resourceUri]}function Bw(e,t,{waitTimeout:i=30}={}){return async(r,n)=>{let a=e.getState(),o=a.iiif.requests[r];if(o)switch(o.loadingState){case xw:break;case _w:{let t,n=!1;try{let a=await Promise.race([new Promise(((i,a)=>{n||(t=e.subscribe((()=>{let t=e.getState();if(t.iiif.requests[r].loadingState!==xw){if(t.iiif.requests[r].loadingState===Sw){let e=$w(t,r);e?i(e):a()}}else a()})))})),new Promise(((e,t)=>setTimeout((()=>{n=!0,t()}),60*i)))]);if(t&&t(),a)return a}catch(e){t&&t();break}break}case Sw:{let e=$w(a,r);if(e)return e;break}}e.dispatch(Ow({id:r}));try{let i=await t(r,n);!i.id&&!i["@id"]&&(i["@type"]&&(i["@id"]=r),i.id=r);let a=((e,t)=>{let{entities:i,resource:r,mapping:n}=td(t);if(void 0===r.id)return[Tw({id:e,message:"ID is not defined in resource."})];let a=[sw({entities:i}),mw({mapping:n})];return r.id!==e&&(a.push(gw({id:e,type:r.type})),a.push(Rw({requestId:e,actualId:r.id}))),a.push(Iw({id:e})),a})(r,i);return e.dispatch(Lw({actions:a})),$w(e.getState(),r)}catch(t){throw e.dispatch(Tw({id:r,message:t.toString()})),t}}}function Dw(e,t,i,r){return!!(e[i]&&e[i][t]&&e[i][t][r]&&Array.isArray(e[i][t][r]))}function Uw(e,t){let i={},r=[];for(let[n,a]of Object.entries(e||{})){r.push(n);let e=(t||{})[n];e&&0!==e.length?i[n]=e:i[n]=a}for(let[e,n]of Object.entries(t||{}))-1===r.indexOf(e)&&(i[e]=n);return i}var Ww=Od({mapping:(e={},t)=>{switch(t.type){case pw:return p(d({},e),{[t.payload.id]:t.payload.type});case fw:return d(d({},e),t.payload.mapping);default:return e}},entities:(e={Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}},t)=>{var i;switch(t.type){case rw:{if(!e[t.payload.type]||!e[t.payload.type][t.payload.id])return e;let i=e[t.payload.type][t.payload.id];return"string"==typeof i?e:p(d({},e),{[t.payload.type]:p(d({},e[t.payload.type]),{[t.payload.id]:p(d({},i),{[t.payload.key]:t.payload.value})})})}case nw:{if(!Dw(e,t.payload.id,t.payload.type,t.payload.key))return e;let i=e[t.payload.type][t.payload.id];if("string"==typeof i)return e;let r=Array.from(i[t.payload.key]),[n]=r.splice(t.payload.startIndex,1);return r.splice(t.payload.endIndex,0,n),p(d({},e),{[t.payload.type]:p(d({},e[t.payload.type]),{[t.payload.id]:p(d({},i),{[t.payload.key]:r})})})}case iw:{let i=Object.keys(t.payload.entities),r=d({},e);for(let n of i){let i=t.payload.entities[n],a=d({},e[n]||{}),o=!1,s=Object.keys(i||{})||[];if(i&&s){for(let t of s)o=!0,a[t]=e[n][t]?Uw(e[n][t],i[t]):i[t];o&&(r[n]=a)}}return r}case aw:{if(!Dw(e,t.payload.id,t.payload.type,t.payload.key))return e;let i=e[t.payload.type][t.payload.id],r=Array.from(i[t.payload.key]);return r.splice(t.payload.index||r.length+1,0,t.payload.reference),p(d({},e),{[t.payload.type]:p(d({},e[t.payload.type]),{[t.payload.id]:p(d({},i),{[t.payload.key]:r})})})}case ow:{if(!Dw(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id],n=Array.from(r[t.payload.key]),a=t.payload.index||n.findIndex((e=>e&&e.id===t.payload.reference.id));return-1===a||(null==(i=n[a])?void 0:i.id)!==t.payload.reference.id?e:(n.splice(a,1),p(d({},e),{[t.payload.type]:p(d({},e[t.payload.type]),{[t.payload.id]:p(d({},r),{[t.payload.key]:n})})}))}default:return e}},requests:(e={},t)=>{switch(t.type){case Ew:case Pw:return p(d({},e),{[t.payload.id]:{requestUri:t.payload.id,loadingState:_w,uriMismatch:!1,resourceUri:t.payload.id}});case Cw:return p(d({},e),{[t.payload.requestId]:p(d({},e[t.payload.requestId]||{}),{uriMismatch:!0,resourceUri:t.payload.actualId}),[t.payload.actualId]:{requestUri:t.payload.requestId,loadingState:e[t.payload.requestId].loadingState,uriMismatch:!0,resourceUri:t.payload.actualId}});case kw:return p(d({},e),{[t.payload.id]:p(d({},e[t.payload.id]||{}),{loadingState:xw,error:t.payload.message})});case Aw:return p(d({},e),{[t.payload.id]:p(d({},e[t.payload.id]||{}),{loadingState:Sw,error:void 0})})}return e},meta:(e={},t)=>{let{id:i,updateValue:r,value:n,meta:a,key:o}=t&&t.payload||{};switch(t.type){case vw:return p(d({},e),{[i]:p(d({},e[i]||{}),{[a]:p(d({},e[i]&&e[i][a]||{}),{[o]:n})})});case yw:return p(d({},e),{[i]:p(d({},e[i]||{}),{[a]:p(d({},e[i]&&e[i][a]||{}),{[o]:e[i]&&e[i][a]?r(e[i][a][o]):r(void 0)})})});case bw:return e[i]&&e[i][a]&&e[i][a][o]?p(d({},e),{[i]:p(d({},e[i]||{}),{[a]:p(d({},e[i]&&e[i][a]||{}),{[o]:void 0})})}):e;default:return e}}}),Hw=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Td;function qw(e={}){let{enableDevtools:t=!0,iiifStoreName:i="iiif",defaultState:r={},extraMiddleware:n=[],customReducers:a={}}=e;return Pd(function(e){return(t,i)=>i&&i.type===Mw?i.payload.actions.reduce(e,t):i&&i.type===zw?i.payload.state:e(t,i)}(Od(d({[i]:Ww},a))),r,t?Hw(Rd(...n)):Td(Rd(...n)))}var Vw=class{constructor(e,t){x(this,"options"),x(this,"store"),x(this,"emitter"),x(this,"isBatching",!1),x(this,"batchQueue",[]),x(this,"remoteFetcher"),x(this,"staticFetcher"),x(this,"defaultFetcher",(e=>fetch(e).then((e=>e.json())))),x(this,"middleware",(e=>t=>i=>{if(i.type===Mw){for(let t of i.payload.actions)this.emitter.emit(t.type,{realAction:t,state:e.getState()});let r=t(i);for(let e of i.payload.actions)this.emitter.emit(`after:${i.type}`,{action:i,state:r});return r}this.emitter.emit(i.type,{action:i,state:e.getState()});let r=t(i);return this.emitter.emit(`after:${i.type}`,{action:i,state:r}),r})),this.options=Object.assign({reducers:{},middleware:[],defaultState:{},customFetcher:this.defaultFetcher,enableDevtools:!0},e||{}),this.store=t||qw({customReducers:this.options.reducers,extraMiddleware:[...this.options.middleware,this.middleware],defaultState:this.options.defaultState,enableDevtools:this.options.enableDevtools}),this.emitter=function(e){return{all:e=e||new Map,on:function(t,i){var r=e.get(t);r?r.push(i):e.set(t,[i])},off:function(t,i){var r=e.get(t);r&&(i?r.splice(r.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var r=e.get(t);r&&r.slice().map((function(e){e(i)})),(r=e.get("*"))&&r.slice().map((function(e){e(t,i)}))}}}(),this.remoteFetcher=Bw(this.store,this.options.customFetcher),this.staticFetcher=Bw(this.store,((e,t)=>t))}batch(e){this.isBatching=!0;try{e(this),this.store.dispatch(Lw({actions:this.batchQueue}))}catch(e){throw this.batchQueue=[],this.isBatching=!1,e}this.batchQueue=[],this.isBatching=!1}async asyncBatch(e){this.isBatching=!0;try{await e(this),this.store.dispatch(Lw({actions:this.batchQueue}))}catch(e){throw this.batchQueue=[],this.isBatching=!1,e}this.batchQueue=[],this.isBatching=!1}modifyEntityField(e,t,i){this.dispatch(dw.modifyEntityField({id:e.id,type:e.type,key:t,value:i}))}dispatch(e){this.isBatching?this.batchQueue.push(e):this.store.dispatch(e)}serialize(e,t){return nd(this.getState().iiif,e,t)}toPresentation2(e){return this.serialize(e,dd)}toPresentation3(e){return this.serialize(e,bd)}hydrate(e,t){return this.get(e,t,{skipSelfReturn:!1})}get(e,t,i={}){"string"!=typeof t&&(i=t||{},t=void 0);let{skipSelfReturn:r=!0}=i||{};if(Array.isArray(e))return e.map((e=>this.get(e,i)));let n=this.getState();if("string"==typeof e){let i=t||n.iiif.mapping[e];if(!i)return r?null:{id:e,type:"unknown"};e={id:e,type:i}}let a=t||e.type,o=e.id,s=n.iiif.entities[a];if(!s){let t=n.iiif.requests[o];return t&&t.resourceUri!==o?this.get(t.resourceUri,i):r?null:e}return s[e.id]||(r?null:e)}select(e){return e(this.getState())}getStore(){return this.store}getState(){return this.store.getState()}loadManifest(e,t){let i="string"==typeof e?e:e.id;return this.load(i,t)}loadCollection(e,t){let i="string"==typeof e?e:e.id;return this.load(i,t)}load(e,t){let i="string"==typeof e?e:e.id;return t?this.staticFetcher(i,t):this.remoteFetcher(i)}areInputsEqual(e,t){return jw(e,t)}subscribe(e,t,i){typeof i>"u"&&(typeof t>"u"||!1===t||!0===t)&&(i=t,t=e,e=e=>e);let r=i?null:e(this.store.getState());return i||t(r,this),this.store.subscribe((()=>{let i=this.store.getState(),n=e(i);r!==n&&!jw(r,n)&&t(n,this),r=n}))}async ensureLoaded(e){let t="string"==typeof e?e:e.id;this.requestStatus(t)||await this.load(t)}requestStatus(e){return this.select((t=>t.iiif.requests[e]))}getResourceMeta(e,t){let i=this.getState().iiif.meta[e];if(i)return t?i[t]:i}setMetaValue([e,t,i],r){this.dispatch("function"==typeof r?ww.setMetaValueDynamic({id:e,meta:t,key:i,updateValue:r}):ww.setMetaValue({id:e,meta:t,key:i,value:r}))}};function Qw(e){let t=typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{};try{let e=t.IIIF_VAULT;if(e)return e}catch(e){}let i=new Vw(e);try{t.IIIF_VAULT=i}catch(e){}return i}var Yw=function(e){let t={},i=(e,i)=>{var n;return void 0===t[e]&&(t[e]=[]),null==(n=t[e])||n.push(i),()=>{r(e,i)}},r=(e,i)=>{var r,n,a;let o=null!=(n=null==(r=t[e])?void 0:r.indexOf(i))?n:-1;null==(a=t[e])||a.splice(o>>>0,1)};return{on:i,off:r,once:(e,t)=>{let n=i=>{t(i),r(e,n)};i(e,n)},emit:(i,r)=>{var n;null==(n=t[i])||n.forEach((t=>{try{t(r)}catch(t){null==e||e.onError(t)}}))}}}();function Gw(e){let t=de(),i=1/.75,r=Wv(),n=e.vault||r||Qw(),a=Pv(),o=de({}),{isReady:s,isConfigBlocking:l,setIsReady:u,internalConfig:c}=Hv(e.preset,((e,i)=>{t.current?t.current.dispatchEvent(new CustomEvent("media",{detail:{query:e,config:i}})):o.current[e]=i})),h=fe((()=>ay(n)),[n]),f=fe((()=>oy(n)),[n]),g=fe((()=>function(e,t={}){let i=t.imageServiceLoader||new Eb;return{getBestThumbnailAtSize:async function t(r,n,a,o=[],s){if("string"==typeof r)return{best:Vy(r),fallback:[],log:[]};let l=e.get(r);if("string"==typeof l)return{best:Vy(l),fallback:[],log:[]};switch(l.type){case"Annotation":{let t=l.body,r=e.get(t[0]);return s&&!r.width&&(r.width=s.width,r.height=s.height),await i.getThumbnailFromResource(r,n,a,o)}case"Canvas":{let r=l;if(r.thumbnail&&r.thumbnail.length){let t=e.get(r.thumbnail[0]),n=await i.getImageCandidates(t,a);n&&n.length&&o.push(...n)}return t(r.items[0],n,a,o,{width:r.width,height:r.height})}case"AnnotationPage":case"Choice":case"Collection":case"Manifest":return t(l.items[0],n,a,o,s);case"SpecificResource":case"Image":case"Dataset":case"Sound":case"Text":case"TextualBody":case"Video":return s&&!l.width&&(l.width=s.width,l.height=s.height),i.getThumbnailFromResource(l,n,a,o);case"Service":case"Range":case"AnnotationCollection":case"CanvasReference":case"ContentResource":return{best:void 0,fallback:[],log:[]}}return{best:void 0,fallback:[],log:[]}}}}(n,{imageServiceLoader:a})),[n,a]),[m]=qv(e.nested||c.nested,{parse:iy,defaultValue:!1}),[v]=qv(e.x||c.x,{parse:ry,defaultValue:0}),[y]=qv(e.y||c.y,{parse:ry,defaultValue:0}),b=de(),[w]=qv(e.render||c.render,{defaultValue:"canvas"}),[x]=qv(e.class),[_]=qv(e.virtualSizes||c.virtualSizes,{parse:Zv}),[S]=qv(e.height||c.height,{parse:ry}),[E]=qv(e.width||c.width,{parse:ry}),[k]=qv(e.a11yRole||void 0),[C]=qv(e.a11yTitle||void 0),[A]=qv(e.interactive||c.interactive,{parse:iy,defaultValue:!0}),[P]=qv(e.viewport||c.viewport,{parse:iy,defaultValue:!0}),[O]=qv(e.responsive||c.responsive,{parse:iy,defaultValue:!0}),[T]=qv(e.moveEvents||c.moveEvents,{parse:iy,defaultValue:!1}),[R]=qv(e.granularMoveEvents||c.granularMoveEvents,{parse:iy,defaultValue:!1}),[I]=qv(e.clickToEnableZoom||e.clickToEnableZoom,{parse:iy,defaultValue:!0}),[M]=qv(e.disableKeyboardNavigation||c.disableKeyboardNavigation,{parse:iy,defaultValue:!1}),[z]=qv(e.debug||c.debug,{parse:iy}),[L]=qv(e.enablePanOnWait||c.enablePanOnWait,{parse:iy,defaultValue:void 0}),[F]=qv(e.ignoreSingleFingerTouch||c.ignoreSingleFingerTouch,{parse:iy,defaultValue:void 0}),[N]=qv(e.requireMetaKeyForWheelZoom||c.requireMetaKeyForWheelZoom,{parse:iy,defaultValue:!1}),[j]=qv(e.panOnWaitDelay||c.panOnWaitDelay,{parse:ry,defaultValue:40}),[$]=qv(e.enableNavigator||c.enableNavigator,{parse:iy}),[B,D,U,W]=qv(e.target||e.region||c.target||c.region,{parse:Jv}),[H,q,,V]=qv(e.rotation,{parse:ry}),[Q,Y,,G]=qv(e.highlight||c.highlight,{parse:Jv}),[K]=qv(e.styleId||c.styleId),[X]=qv(e.highlightCssClass||c.highlightCssClass,{defaultValue:"canvas-panel-highlight"}),[Z,,,J]=qv(e.preferredFormats||c.preferredFormats,{parse:ey}),[ee]=qv(e.homeCover,{parse:e=>"false"!==e&&("true"===e||("start"===e?"start":"end"===e&&"end"))}),[te,ie]=qv(e.atlasMode||c.atlasMode),[re,ne]=le(""),[ae,oe]=le(""),[se]=qv(e.stylesheet||c.stylesheet),ue=de({}),[pe,ge]=le("");function me(){if(t.current&&b.current){let e=t.current.getBoundingClientRect(),i=b.current.world.height||1,r=b.current.world.width||1;return r/i<1?e.height/i:e.width/r}return-1}let ve=de({});function ye(e){let t=e._lastGoodScale,r=me(),n=e.getZoomedPosition(i,{}),a=e.getZoomedPosition(.75,{}),o=Math.round(a[3]),s=Math.round(a[4]),l=Math.round(n[3]),u=Math.round(n[4]),c=Math.round(e.target[3]),h=Math.round(e.target[4]);return{canZoomIn:h>s&&c>o,canZoomOut:h+2<u&&c+2<l,scaleFactor:e.getScaleFactor(),current:t,max:e.maxScaleFactor,min:r,worldHeight:e.world.height,worldWidth:e.world.width}}function be(t){he((()=>{e.__registerPublicApi&&e.__registerPublicApi(t)}),[])}return ce((()=>{let e=Yw.on("onResetSeen",(()=>{ve.current={}})),i=Yw.on("onChoiceChange",(e=>{let i=e.choice;if((null==t?void 0:t.current)&&i&&i.items){let r=i.items;r.sort(((e,t)=>e.id<t.id?-1:e.id>t.id?1:0));let n=r.map((e=>e.id)).join(""),a=r.map((e=>e.selected)).join("");if(ve.current[n]&&ve.current[n]==a)return;ve.current[n]=a,i.partOf=e.partOf,t.current.dispatchEvent(new CustomEvent("choice",{detail:{choice:i}}))}}));return()=>{e(),i()}}),[]),ce((()=>{if(b.current&&t.current){let e=d({},ye(b.current));"queued"==re&&e&&(null==e?void 0:e.scaleFactor)<1&&e.scaleFactor>0&&null!=t.current&&(ne("fired"),setTimeout((()=>{var i;null==(i=t.current)||i.dispatchEvent(new CustomEvent("world-ready",{detail:e}))}),100))}}),[s,t.current,pe,re]),ce((()=>{var e;let i=b.current,r=null==(e=b.current)?void 0:e.transitionManager;if(i&&r&&s){let e=!1,n=0;return i.world.addLayoutSubscriber((async(a,o)=>{if("repaint"!==a&&t.current){if(["recalculate-world-size","zoom-to","go-home","goto-region"].includes(a)){if("recalculate-world-size"==a&&ne("queued"),r.hasPending()){if(e)return;e=!0,await new Promise((e=>setTimeout(e,r.pendingTransition.total_time-r.pendingTransition.elapsed_time))),e=!1}let s=me(),l=Math.abs(s-i._lastGoodScale)<2e-4;l?n++:n=0;let u={detail:d(p(d({source:a,minZoomCount:n},ye(i)),{isMin:l,isMax:Math.abs(i.maxScaleFactor-i._lastGoodScale)<2e-4}),o||{})};return void t.current.dispatchEvent(new CustomEvent("zoom",u))}t.current.dispatchEvent(new CustomEvent(a,{detail:o}))}}))}return()=>{}}),[s,pe]),ce((()=>{var e;let i=b.current,r=null==(e=b.current)?void 0:e.transitionManager;if(s&&i&&T){let e=-1,n=-1,a=!1;return i.registerHook("useAfterFrame",(async()=>{if(t.current&&(i.target[1]!==e||i.target[2]!==n)){if(!R&&r){if(a)return;r.hasPending()&&(a=!0,await new Promise((e=>setTimeout(e,r.pendingTransition.total_time-r.pendingTransition.elapsed_time))),a=!1)}t.current.dispatchEvent(new CustomEvent("move",{detail:{x:i.x,y:i.y,width:i.width,height:i.height,points:i.target,lastX:e,lastY:n}})),e=i.x,n=i.y}}))}return()=>{}}),[s,T]),be((e=>{t.current=e;let r,s,l=!1;if(I){r=e=>{e.stopPropagation()};let t=()=>{r&&!l&&(l=!0,e.addEventListener("wheel",r,{capture:!0}),e.addEventListener("touchstart",r,{capture:!0}))};s=()=>{r&&l&&(l=!1,e.removeEventListener("wheel",r,{capture:!0}),e.removeEventListener("touchstart",r,{capture:!0}))},t(),document.addEventListener("click",(i=>{document.activeElement!==e&&t()}))}e.addEventListener("click",(t=>{s&&s();let i=t.composedPath()[0];i&&e!==document.activeElement&&i.focus()}));let u=Object.keys(o.current);if(u.length){for(let t of u)e.dispatchEvent(new CustomEvent("media",{detail:{query:t,config:o.current[t]}}));o.current={}}return{vault:n,events:h,styles:f,thumbnailHelper:g,imageServiceLoader:a,getRotation:()=>V.current,setRotation:t=>{e.setAttribute("rotation",t.toString())},getHighlight:()=>G.current,setHighlight:t=>{"string"==typeof t?e.setAttribute("highlight",t):Y(t)},getTarget:()=>W.current,setTarget:t=>{"string"==typeof t?e.setAttribute("target",t):D(t)},setDefaultChoiceIds:t=>{e.setAttribute("choice-id",t.join(","))},getPosition(){var e,t,i,r;return{x:null==(e=b.current)?void 0:e.x,y:null==(t=b.current)?void 0:t.y,width:null==(i=b.current)?void 0:i.width,height:null==(r=b.current)?void 0:r.height}},getMaxZoom(){var e;return(null==(e=b.current)?void 0:e.maxScaleFactor)||1},getMinZoom:()=>me()||0,makeChoice(e,t){Yw.emit("onMakeChoice",{id:e,options:t})},zoomIn(e){b.current&&b.current.world.trigger("zoom-to",{point:e,factor:.75})},zoomOut(e){b.current&&b.current.world.trigger("zoom-to",{point:e,factor:i})},zoomBy(e,t){b.current&&b.current.world.trigger("zoom-to",{point:t,factor:e})},zoomTo(e,t,i){b.current&&b.current.world.zoomTo(e,t,i)},withAtlas(e){b.current?e(b.current):ue.current=p(d({},ue.current),{[(new Date).getTime()]:t=>e(t)})},goHome(e=!1){b.current?b.current.world.goHome(e):ue.current=p(d({},ue.current),{viewport:t=>t.world.goHome(e)})},getZoom(){var e;return null==(e=b.current)?void 0:e._lastGoodScale},getScaleInformation(){let e=b.current;if(null!=e)return d({},ye(e))},goToTarget(e,t={}){b.current?b.current.world.gotoRegion(d(d({},e),t)):ue.current=p(d({},ue.current),{viewport:i=>{i.world.gotoRegion(d(d({},e),t))}})},setFps(e){b.current?b.current.fpsLimit=e:ue.current=p(d({},ue.current),{setFps:t=>{t.fpsLimit=e}})},clearTarget(){D(void 0),b.current?b.current.world.goHome(!0):ue.current=p(d({},ue.current),{viewport:e=>{e.world.goHome(!0)}})},setPreferredFormats(t){e.setAttribute("preferred-formats",t.join(","))},getPreferredFormats:()=>J.current||[],setMode(t){e.setAttribute("atlas-mode",t)},applyStyles(e,t){f.applyStyles("string"==typeof e?{id:e}:e,"atlas",t)},applyHTMLProperties(e,t){f.applyStyles("string"==typeof e?{id:e}:e,"html",t)},setClassName(e,t){f.applyStyles("string"==typeof e?{id:e}:e,"html",{className:t})},createAnnotationDisplay:e=>new ew(e),getThumbnail:(e,t,i)=>g.getBestThumbnailAtSize(e,t,i),addVaultEventListener:(e,t,i,r)=>h.addEventListener(e,t,i,r),removeVaultEventListener(e,t,i){h.removeEventListener(e,t,i)},getListenersAsProps:(e,t)=>h.getListenersAsProps(e,t)}})),ce((()=>{if(b.current){let e=Object.values(ue.current);for(let t of e)t(b.current);ue.current={}}}),[s]),he((()=>{if(K){let e=document.getElementById(K);e&&oe(e.innerText)}}),[s,K]),he((()=>{if(t.current&&!M){let e=e=>{var t,i,r;if(b.current&&b.current.transitionManager){let n,a=b.current.transitionManager,o=a.pendingTransition.done?b.current.target:a.pendingTransition.to,s=.1*Math.min(o[3]-o[1],o[4]-o[2]);switch(e.key){case"=":return void(null==(t=b.current.world)||t.zoomIn());case"-":return void(null==(i=b.current.world)||i.zoomOut());case"0":return void(null==(r=b.current.world)||r.goHome());case"ArrowRight":e.preventDefault(),n=o.slice(0),n[1]=n[1]+s,n[3]=n[3]+s;break;case"ArrowLeft":e.preventDefault(),n=o.slice(0),n[1]=n[1]-s,n[3]=n[3]-s;break;case"ArrowUp":e.preventDefault(),n=o.slice(0),n[2]=n[2]-s,n[4]=n[4]-s;break;case"ArrowDown":e.preventDefault(),n=o.slice(0),n[2]=n[2]+s,n[4]=n[4]+s}n&&a.applyTransition(n,{duration:500,easing:Ks.easeOutExpo,constrain:!0})}},i=t.current;return i.addEventListener("keydown",e),()=>{i.removeEventListener("keydown",e)}}return()=>{}}),[M]),{atlasProps:fe((()=>({children:null,nested:m,responsive:O,viewport:P,enableNavigator:$,onCreated:e=>{ne(""),u(!0),ge(e.runtime.id),b.current=e.runtime},homePosition:B&&B.selector&&"BoxSelector"===B.selector.type?B.selector.spatial:void 0,renderPreset:"static"===w?["static-preset",{interactive:A}]:["default-preset",{interactive:A,unstable_webglRenderer:"webgl"===w,controllerConfig:{ignoreSingleFingerTouch:F,enablePanOnWait:L,requireMetaKeyForWheelZoom:N,panOnWaitDelay:j}}],width:E||void 0,height:S||(O?void 0:512),role:k,title:C})),[O,P,B,w,$,c,k,C]),isReady:s,isConfigBlocking:l,setIsReady:u,internalConfig:c,target:B,setParsedTarget:U,highlight:Q,highlightCssClass:X,preferredFormats:Z,render:w,interactive:A,mode:te,setMode:ie,virtualSizes:_,styleId:K,responsive:O,viewport:P,debug:z,enableNavigator:$,height:S,width:E,className:x,inlineStyles:ae,inlineStyleSheet:se,vault:n,nested:m,x:v,y:y,rotation:H,homeCover:ee,useProp:function(t,i={}){return qv(e[t]||c[t],i)},useRegisterWebComponentApi:be,runtime:b,webComponent:t}}oe(),At();var Kw=G(!1);function Xw(e){let t=xu();return ce((()=>{t&&e.onCreated(t)}),[t]),null}function Zw(e){var t=e,{children:i,onCreated:r,responsive:n,viewport:a,nested:o}=t,s=g(t,["children","onCreated","responsive","viewport","nested"]);let[l,u]=le(!1),c=me(Kw);return o||c?E(A,null,r?E(Xw,{onCreated:r}):null,i):E(Kw.Provider,{value:!0},E(wu,p(d({},s),{onCreated:e=>{if(u(!0),r)return e.runtime.updateNextFrame(),r(e)},unstable_noReconciler:!0}),E(Kw.Provider,{value:!0},l?i:null)))}function Jw(e){var t=e,{children:i}=t,r=g(t,["children"]);let n=Wv(),{setIsReady:a,atlasProps:o,isReady:s,className:l}=Gw(r);return E(zm,{vault:n},E(Zw,d({onCreated:()=>{a(!0)},viewport:!0,className:l||""},o),s?E("slot",null,i):null))}if(oe(),typeof window<"u"){let e={shadow:!0,onConstruct(e){e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}};Lt(Jw,"atlas-viewer",[],e),Lt(Jw,"layout-container",[],e)}oe(),At(),oe(),At();var ex=()=>()=>({}),tx=G(ex);function ix(e,t){let i=de(),r=me(tx)||ex;i.current!==t&&r(e),i.current=t}oe();var rx=b(zt());At(),oe(),oe(),At();var nx=G(null);function ax({displayName:e,component:t,customConstructor:i}){let r=De((function(e,r){var n=e,{children:a}=n,o=g(n,["children"]);let[s,l]=le(),u=xu(),c=me(nx),h=de(o);return ce((()=>(u&&u.runtime&&l(i?i(o):new t),()=>{})),[]),ce((()=>{if(u&&u.runtime&&s){let e=u.runtime,t=u.runtime.world,i=c||t;i.appendChild(s),r&&("function"==typeof r?r(s):r.current=s),s instanceof Os&&(e.world=s),s instanceof Ps||(e.pendingUpdate=!0,e.world&&e.world.needsRecalculate&&(e.world.recalculateWorldSize(),e.world.triggerRepaint()));let n=i,a=s;return()=>{a&&(n.removeChild(a),e.pendingUpdate=!0,e.world&&e.world.needsRecalculate&&(e.world.recalculateWorldSize(),e.world.triggerRepaint()))}}return()=>{}}),[s,null==u?void 0:u.runtime]),ce((()=>{s&&u&&u.runtime&&(Jl(u.runtime.world,o),Zl(s,h.current,o),h.current=o,u.runtime.pendingUpdate=!0,u.runtime.world&&(u.runtime.world.needsRecalculate=!0,u.runtime.world.needsRecalculate&&(u.runtime.world.recalculateWorldSize(),u.runtime.world.triggerRepaint())))}),[s,o]),s?E(nx.Provider,{value:s},a):null}));return r.displayName=e,Be(r)}oe(),At();var ox=e=>{var t=e,{height:i,tiles:r,width:n,x:a,y:o,style:s,skipSizes:l=!1,skipThumbnail:u=!1,rotation:c=0,viewport:h,tileFormat:p,children:f}=t,m=g(t,["height","tiles","width","x","y","style","skipSizes","skipThumbnail","rotation","viewport","tileFormat","children"]);let v=n/r.width,y=r.imageService.tiles||[],b=r.imageService.sizes||[],w=r.imageService.id||r.imageService["@id"],x=fe((()=>{let e=w;return e&&e.endsWith("/info.json")?e.slice(0,-10):e}),[w]),_=s&&typeof s.opacity<"u"&&1!==s.opacity;return E(sx,d({key:x,scale:v,height:r.height,width:r.width,x:a,rotation:c,y:o},m),E(cx,{key:"composite-"+x,id:x,width:r.width,height:r.height,renderOptions:_?{renderLayers:1,renderSmallestFallback:!1}:h?{renderLayers:1,renderSmallestFallback:!0}:{renderLayers:2,renderSmallestFallback:!0}},f,!r.thumbnail||_||u?null:E(ux,{uri:r.thumbnail.id,target:{width:r.width,height:r.height},display:{width:r.thumbnail.width,height:r.thumbnail.height},style:s}),l?null:b.map(((e,t)=>{let{prefix:i,server:n,scheme:a,path:o}=Rg(x);return E(ux,{key:t,uri:nm({scheme:a,server:n,prefix:i,identifier:o,originalPath:"",type:"image",region:{full:!0},size:{max:!1,upscaled:!1,confined:!1,width:e.width,height:e.height},rotation:{angle:0,mirror:!1},format:"jpg",quality:"default"},r.imageService),target:{width:r.width,height:r.height},display:{width:e.width,height:e.height},style:s})})),y.map((e=>(e.scaleFactors||[]).map((t=>E(hx,{key:`${e}-${t}`,uri:x,display:{width:r.width,height:r.height},tile:e,scaleFactor:t,style:s,format:p})))))))},sx=(ax({displayName:"Atlas.World",component:Os,customConstructor:e=>new Os(e.width,e.height)}),ax({displayName:"Atlas.WorldObject",component:Ps})),lx=ax({displayName:"Atlas.Box",component:Ms}),ux=ax({displayName:"Atlas.SingleImage",component:ai}),cx=(ax({displayName:"Atlas.ImageTexture",component:oi}),ax({displayName:"Atlas.CompositeResource",component:hs,customConstructor:e=>new hs({id:e.id,width:e.width,height:e.height,images:[],renderOptions:e.renderOptions})})),hx=ax({displayName:"Atlas.TiledImage",component:us,customConstructor:e=>us.fromTile(e.uri,e.display,e.tile,e.scaleFactor,void 0,e.format)});ax({displayName:"Atlas.Text",component:js});oe(),At(),oe(),At(),At(),At(),oe(),At();var dx=De(((e,t)=>{var i=e,{children:r}=i,n=g(i,["children"]);let a=de(),o=_u(),s=de(0),l=de(),[u,c]=ue((e=>e+1),0);return Su((()=>{if(n.relative){let e=a.current;if(e&&o){let t=o.getScaleFactor();s.current!==t&&(s.current=t,e.style.transformOrigin="0 0",e.style.transform=`scale(${1/s.current})`,e.style.width=100*s.current+"%",e.style.height=100*s.current+"%")}}}),[n.relative]),he((()=>{let e=l.current;if(!e){let e=setTimeout(c,100);return()=>{clearTimeout(e)}}return t&&e&&("function"==typeof t?t(e):t.current=e),e&&e.__host?n.relative?Ge(E("div",{ref:a},r),e.__host.element):Ge(r,e.__host.element):e&&(e.__onCreate=()=>{n.relative?Ge(E("div",{ref:a},r),e.__host.element):Ge(r,e.__host.element)}),()=>{}}),[u,t,r,l,n.relative]),E(lx,d({html:!0,ref:l},n))}));oe();var px=e=>{var t=e,{handleSize:i=9,resizable:r,onSave:n,children:a}=t,o=g(t,["handleSize","resizable","onSave","children"]);let{portalRef:s,mode:l,mouseEvent:u,isEditing:c}=Tu({x:o.x||0,y:o.y||0,width:o.width,height:o.height},n),h=fe((()=>u("translate")),[u]),p=fe((()=>u("east")),[u]),f=fe((()=>u("west")),[u]),m=fe((()=>u("south")),[u]),v=fe((()=>u("north")),[u]),y=fe((()=>u("south-east")),[u]),b=fe((()=>u("south-west")),[u]),w=fe((()=>u("north-east")),[u]),x=fe((()=>u("north-west")),[u]);return E(A,null,E(sx,d({},o),a,E(dx,{ref:s,target:{x:0,y:0,height:o.height,width:o.width},relative:!0,interactive:!1},"sketch"===l&&r?E(A,null,E("div",{onMouseDown:h,onTouchStart:h,style:{display:"block",width:"100%",height:"100%",border:"1px dashed #999",boxSizing:"border-box",pointerEvents:c?"none":"sketch"===l?"initial":"none"}}),E("div",{title:"east",onTouchStart:p,onMouseDown:p,style:{cursor:"e-resize",position:"absolute",background:"#fff",height:2*i,width:i,right:0,top:"50%",transform:`translate(${i/2}px, -${i}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:c?"none":"sketch"===l?"initial":"none"}}),E("div",{title:"west",onMouseDown:f,style:{cursor:"w-resize",position:"absolute",background:"#fff",height:2*i,width:i,left:0,top:"50%",transform:`translate(-${i/2}px, -${i}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:c?"none":"sketch"===l?"initial":"none"}}),E("div",{title:"north",onMouseDown:v,style:{cursor:"n-resize",position:"absolute",background:"#fff",height:i,width:2*i,left:"50%",top:0,transform:`translate(-${i}px, -${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid rgba(0,0,0,.5)",pointerEvents:c?"none":"sketch"===l?"initial":"none"}}),E("div",{title:"south",onMouseDown:m,style:{cursor:"s-resize",position:"absolute",background:"#fff",height:i,width:2*i,left:"50%",bottom:0,transform:`translate(-${i}px, ${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:c?"none":"sketch"===l?"initial":"none"}}),E("div",{title:"north-east",onMouseDown:w,style:{cursor:"ne-resize",position:"absolute",background:"#fff",height:i,width:i,right:0,top:0,transform:`translate(${i/2}px, -${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:c?"none":"sketch"===l?"initial":"none"}}),E("div",{title:"south-east",onMouseDown:y,style:{cursor:"se-resize",position:"absolute",background:"#fff",height:i,width:i,bottom:0,right:0,transform:`translate(${i/2}px, ${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:c?"none":"sketch"===l?"initial":"none"}}),E("div",{title:"south-west",onMouseDown:b,style:{cursor:"sw-resize",position:"absolute",background:"#fff",height:i,width:i,bottom:0,left:0,transform:`translate(-${i/2}px, ${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:c?"none":"sketch"===l?"initial":"none"}}),E("div",{title:"north-west",onMouseDown:x,style:{cursor:"nw-resize",position:"absolute",background:"#fff",height:i,width:i,top:0,left:0,transform:`translate(-${i/2}px, -${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:c?"none":"sketch"===l?"initial":"none"}})):null)))};oe();var fx=e=>{var t=e,{children:i,interactive:r,region:n,onClick:a,onSave:o,isEditing:s,className:l,style:u}=t,c=g(t,["children","interactive","region","onClick","onSave","isEditing","className","style"]);let h=Nl(),p=ge((e=>{o&&o(d({id:n.id,x:n.x,y:n.y,height:n.height,width:n.width},e))}),[o,n.id,n.x,n.y,n.height,n.width]);return E(px,{x:n.x,y:n.y,width:n.width,height:n.height,resizable:s,onSave:p,onClick:"explore"===h&&a?e=>{a(n)}:()=>{}},E(lx,d({html:!0,className:l,interactive:!0,relativeStyle:!0,target:{x:0,y:0,width:n.width,height:n.height},style:u},c)),i)};function gx({annotationId:e,interactive:t,relative:i}){var r;let n=mv({id:e});if(null==(r=null==n?void 0:n.motivation)||!r.includes("supplementing")||!n.body)return null;let a=(Array.isArray(n.body)?n.body:[n.body]).filter((e=>"TextualBody"===e.type)),o=n.target.selector;return o?E(A,null,E("rect",{x:i?0:o.spatial.x,y:i?0:o.spatial.y,width:o.spatial.width,height:o.spatial.height,style:{fill:"rgba(0,0,0,0)"}}),E("text",{x:i?0:o.spatial.x,y:(i?0:o.spatial.y)+.75*o.spatial.height,textLength:o.spatial.width,fontSize:`${o.spatial.height}px`,lengthAdjust:"spacingAndGlyphs",className:"text-line-segment",part:"text-line-segment",style:p(d({},{fill:"rgba(0,0,0,0)"}),{pointerEvents:t?"initial":void 0})},a[0].value||"")):null}function mx({annotation:e,textSelectionEnabled:t}){var i;let r=Lm();return null!=(i=null==e?void 0:e.motivation)&&i.includes("supplementing")&&e.body?E(dx,{target:p(d({},e.target.selector.spatial),{x:0,y:0}),interactive:t},E(zm,{vault:r},E("svg",{height:e.target.selector.spatial.height,width:e.target.selector.spatial.width,style:{userSelect:t?"text":void 0}},E(gx,{annotationId:e.id,interactive:t,relative:!0})))):null}oe(),At(),oe();var vx=({id:e,style:t,className:i,interactive:r,textSelectionEnabled:n})=>{let a=mv({id:e}),o=iv(a,"atlas"),s=iv(a,"html"),l=ev(a,["atlas"]),u=vv(),c=fe((()=>Yc(t,o)),[t,o]);return u&&a&&a.target&&a.target.selector&&"BoxSelector"===a.target.selector.type&&a.target.source&&a.target.source.id===u.id?E(fx,d({id:a.id,isEditing:!0,region:a.target.selector.spatial,style:c,className:(null==s?void 0:s.className)||i,interactive:!(!(null==s?void 0:s.href)&&!r),href:(null==s?void 0:s.href)||null,title:(null==s?void 0:s.title)||null,hrefTarget:(null==s?void 0:s.target)||null},l),E(mx,{annotation:a,textSelectionEnabled:n})):null},yx=({className:e,page:t,textSelectionEnabled:i})=>{var r;let n=iv(t,"atlas"),a=iv(t,"html");return $m((e=>t.id?e.iiif.entities.AnnotationPage[t.id]:null),[]),E(A,null,null==(r=t.items)?void 0:r.map((t=>E(vx,{key:t.id,id:t.id,style:n,className:(null==a?void 0:a.className)||e,textSelectionEnabled:i}))))};function bx(){let e=_u(),[t,i]=le(),[r,n]=le();return Su((()=>{e&&(!t||e.focalPosition[1]!==t[1]||e.focalPosition[2]!==t[2]||e.focalPosition[3]!==t[3]||e.focalPosition[4]!==t[4])&&i(new Float32Array(e.focalPosition)),e&&(!r||e.homePosition[1]!==r[1]||e.homePosition[2]!==r[2]||e.homePosition[3]!==r[3]||e.homePosition[4]!==r[4])&&n(new Float32Array(e.homePosition))}),[t,r]),E(A,null,t?E(fx,{id:"focal",onClick:()=>{},onSave:()=>{},isEditing:!1,className:"test",region:{id:"focal",x:t[1],y:t[2],width:t[3]-t[1],height:t[4]-t[2]},style:{backgroundColor:"rgba(0, 0, 244, 0.5)"}}):null,r?E(fx,{id:"home",onClick:()=>{},onSave:()=>{},isEditing:!1,className:"test",region:{id:"home",x:r[1],y:r[2],width:r[3]-r[1],height:r[4]-r[2]},style:{backgroundColor:"rgba(0, 200, 0, 0.5)"}}):null)}function wx({id:e,image:t,thumbnail:i,isStatic:r,virtualSizes:n=[],x:a=0,y:o=0,rotation:s=0,annotations:l,tileFormat:u,skipSizes:c,annotationId:h,skipThumbnail:p}){var f,g,m,v;let y=iv(h?{id:h,type:"Annotation"}:void 0,"atlas"),b=iv({id:e,type:"ContentResource"},"atlas"),w=fe((()=>d(d({},y),b)),[y,b]),x=ev(h?{id:h,type:"Annotation"}:void 0,["atlas"]),_=ev({id:e,type:"ContentResource"},["atlas"]);return E(Ct.Fragment,null,t.service?E(A,{key:"service"},E(ox,d(d({viewport:r,tiles:{id:t.service.id,height:t.height!==t.service.height?t.service.height:t.height,width:t.width!==t.service.width?t.service.width:t.width,imageService:t.service,thumbnail:!p&&i&&"fixed"===i.type?i:void 0},skipSizes:c,skipThumbnail:p,x:(null==(f=t.target)?void 0:f.spatial.x)+a,y:(null==(g=t.target)?void 0:g.spatial.y)+o,rotation:s,width:null==(m=t.target)?void 0:m.spatial.width,height:null==(v=t.target)?void 0:v.spatial.height,style:w,tileFormat:u},x),_),t.service&&n.map((e=>{if(t.service){let[i,{height:r,width:n}]=function(e,t){let i=eg(e.id||e["@id"]||"").slice(0,-10);return i&&!t.percentScale&&t.width&&!t.confined&&e.height&&e.width?[[i,"full",Vv(t),"0","default.jpg"].join("/"),{width:t.width||1,height:t.confined?e.height/e.width*t.width:t.height||e.height/e.width*t.width}]:[null,{height:0,width:0}]}(t.service,e);return i?E(ux,{priority:!0,style:w,key:i,uri:i,target:t.target.spatial,display:{height:r,width:n}}):null}return null}))),l):E(A,{key:"no-service"},E(ux,d(d({style:w,uri:t.id,target:t.target.spatial,display:t.width&&t.height?{width:t.width,height:t.height}:void 0},x),_)),l))}function xx(){let[e,{addAnnotation:t,removeAnnotation:i}]=Jm(),r=Lm(),n=function(){let e=Lm();return fe((()=>tv(e)),[e])}(),a=de([]),o=null==e?void 0:e.id,s=fe((()=>ay(r)),[r]);return ix((()=>({annotations:{add(e){t(e)},get(e){if(o){let t=(r.get({id:o,type:"AnnotationPage"}).items||[]).find((t=>t.id===e));return t?r.get(t):null}return null},getSource:e=>a.current[e]||null,getAll(){if(o){let e=r.get({id:o,type:"AnnotationPage"});return e&&r.get(e.items)||[]}return[]},remove(e){i(e)},applyStyles(e){o&&n.applyStyles(o,"atlas",e)},addEventListener(e,t){if(o)return s.addEventListener({id:o,type:"AnnotationPage"},e,t)},applyHTMLProperties(e){o&&n.applyStyles(o,"html",e)}}})),o),[e,{addAnnotation:t,removeAnnotation:i}]}oe(),At(),At(),oe(),At(),At(),oe(),At(),At();var _x=G(null);function Sx({children:e}){let[t,{addAnnotation:i,removeAnnotation:r}]=xx();return E(_x.Provider,{value:fe((()=>({fullPage:t,addAnnotation:i,removeAnnotation:r})),[t])},e)}function Ex({media:e,children:t}){let[{element:i,currentTime:r,progress:n},a,o]=Nv({duration:e.duration});return ix((e=>(e.mediaActions=o,e.mediaElement=i,e.setMediaProgressElement=e=>{n.current=e},e.dispatchEvent(new Event("media-displayed")),e.dispatchEvent(new Event("audio-displayed")),{})),e.url),E(Dv,{state:a,actions:o,currentTime:r,progress:n,element:i},E("video",{ref:i,src:e.url}),t)}function kx({media:e}){let[{element:t,currentTime:i,progress:r},n,a]=Nv({duration:e.duration}),o=a.playPause;return ix((e=>(e.mediaActions=a,e.mediaElement=t,e.setMediaProgressElement=e=>{r.current=e},e.dispatchEvent(new Event("media-displayed")),e.dispatchEvent(new Event("audio-displayed")),{})),e.url),E("div",{className:"video-container",part:"video-container",onClick:o},E("style",null,"\n            .video-container {\n              position: absolute;\n              top: 0;\n              bottom: 0;\n              left: 0;\n              right: 0;\n              background: #000;\n              z-index: 13;\n              display: flex;\n              justify-content: center;\n              pointer-events: visible;\n            }\n          "),E("video",{ref:t,src:e.url,style:{width:"100%",objectFit:"contain"}}))}function Cx({annotationPageId:e,selectionEnabled:t}){let i=function(e={},t=[]){let{id:i,selector:r}=e,n=Rm(),a=i||n.annotationPage,o=$m((e=>a?e.iiif.entities.AnnotationPage[a]:void 0),[a]);return fe((()=>{if(o)return r?r(o):o}),[o,...t])}({id:e}),r=vv(),n=Lm(),a=iv(i,"text-lines");return i&&i.items&&r?E(sx,d({},{x:0,y:0,width:r.width,height:r.height}),E(dx,{target:{x:0,y:0,width:r.width,height:r.height}},E(zm,{vault:n},E("svg",{tabindex:0,"aria-name":"","aria-live":"off","aria-atomic":"true","aria-relevant":"all","aria-expanded":"true",role:"article",style:p(d({},a),{userSelect:"text"}),width:r.width,height:r.height},i.items.map((e=>E(gx,{key:`line-${e.id}`,annotationId:e.id,interactive:t}))))))):null}function Ax({x:e,y:t,highlight:i,annoMode:r,onCreated:n,debug:a,virtualSizes:o,highlightCssClass:s,defaultChoices:l,isStatic:u,textSelectionEnabled:c,textEnabled:h,disableThumbnail:p,skipSizes:f,rotation:g}){var m;let v=Um(),y=vv(),b=ev(y,["deep-zoom"]),[w]=function(){let e=me(_x);return[e.fullPage,{addAnnotation:e.addAnnotation,removeAnnotation:e.removeAnnotation}]}(),x=Lm(),_=fe((()=>oy(x)),[x]),[S,k]=Mv({strategies:["images","media"],defaultChoices:null==l?void 0:l.map((({id:e})=>e))}),C=Cv((null==v?void 0:v.id)||(null==y?void 0:y.id)),P=$m(((e,t)=>C.availablePageIds.map((e=>t.get(e)))),[...C.availablePageIds]);ce((()=>{let e=function(e){function t(t){let i=t?"string"==typeof t?e.get(t):t:null;if(!i)return[];let r=e.get(i.items),n=[];for(let t of r)n.push(...e.get(t.items));return n}function i(i,r=[]){let n=Array.isArray(i)?i:t(i),a=[],o=null,s=[];for(let t of n){if("Annotation"!==t.type)throw new Error("getPaintables() accept either a canvas or list of annotations");let i=e.get(t.body);for(let n of i){let[l,{selector:u}]=Xb(n),c=(l.type||"unknown").toLowerCase();if("choice"!==c)-1===a.indexOf(c)&&a.push(c),s.push({type:c,resource:l,target:t.target,selector:u});else{let t=e.get(l.items),a=r.length?r.map((e=>t.find((t=>t.id===e)))).filter(Boolean):[t[0]];0===a.length&&a.push(t[0]),o={type:"single-choice",items:t.map((e=>({id:e.id,label:e.label,selected:-1!==a.indexOf(e)}))),label:n.label},i.push(...a)}}}return{types:a,items:s,choice:o}}return{getAllPaintingAnnotations:t,getPaintables:i,extractChoices:function(e){let{choice:t}=i(e);return t}}}(x);if(null!=y&&y.id){let t=(null==l?void 0:l.map((({id:e})=>e)))||[],i=e.getAllPaintingAnnotations(y.id);for(let e of i){if("Annotation"!==e.type)throw new Error("getPaintables() accept either a canvas or list of annotations");let i=Array.from(Array.isArray(e.body)?e.body:[e.body]);for(let e of i){let[i,{selector:r}]=yv(e),n=x.get(i);if("choice"!==(n.type||"unknown").toLowerCase())continue;let a=x.get(n.items),o=t.length?t.map((e=>a.find((t=>t.id===e)))).filter(Boolean):[a[0]];0===o.length&&o.push(a[0]);let s={type:"single-choice",items:a.map((e=>({id:e.id,label:e.label,selected:-1!==o.indexOf(e)}))),label:i.label};Yw.emit("onChoiceChange",{choice:s,partOf:{canvasId:y.id,choiceId:n.id,manifestId:null==v?void 0:v.id}})}}e.extractChoices(y.id)}}),[null==y?void 0:y.id,k,l]);let O=fe((()=>function(e,t){let i=[],r={};for(let n of e){let e={},a=[],o=t.get(n),s=(null==o?void 0:o.items)||[];for(let i of s){let r=t.get(i);if(r.motivation)for(let t of r.motivation)a.includes(t)||a.push(t),e[t]=e[t]?e[t]:[],e[t].push(r.id)}i.push({typeMap:e,allTypes:a,id:n});for(let e of a)r[e]=r[e]||[],r[e].push(n)}return{pagesWithTypes:i,pageMapping:r}}(C.availablePageIds,x)),P),T=null!=(m=O.pageMapping.supplementing)&&m.length?O.pageMapping.supplementing[0]:null;ce((()=>{let e=Yw.on("onMakeChoice",(e=>{k.makeChoice(e.id,e.options)}));return()=>{e()}}),[k]),ce((()=>{if(h){let e=[];for(let t of C.availablePageIds)x.requestStatus(t)||e.push(x.load(t))}}),[null==y?void 0:y.id,h]),ce((()=>{if(l)for(let e of l)typeof e.opacity<"u"&&_.applyStyles({id:e.id},"atlas",{opacity:e.opacity})}),[l]);let R=Lv({maxWidth:256,maxHeight:256});if(!y)return null;if("media"===S.type){if("Sound"!==S.media.type&&"Video"!==S.media.type)throw new Error("Unknown media type");return E(sx,d({key:S.type,height:y.height||1e3,width:y.width||1e3,x:e,y:t},b),"Sound"===S.media.type?E(Ex,{media:S.media}):null,"Video"===S.media.type?E(kx,{media:S.media}):null)}if("unknown"===S.type){if(R&&"fixed"===R.type)return E(sx,{height:y.height,width:y.width,x:e,y:t},E(ux,{uri:R.id,target:{x:0,y:0,width:y.width,height:y.height},display:R.width&&R.height?{width:R.width,height:R.height}:void 0}));throw new Error("Unknown image strategy")}let I=E(A,null,r?E(Cu,{onCreate:e=>{n&&n(e)}}):null,i&&i.selector&&"BoxSelector"===i.selector.type?E(fx,{id:"highlight",isEditing:!0,onClick:()=>{},onSave:()=>{},region:i.selector.spatial,style:s?void 0:{border:"3px solid red"},className:s}):null,w?E(yx,{page:w,textSelectionEnabled:c}):null,S.annotations&&S.annotations.pages?S.annotations.pages.map((e=>E(yx,{key:e.id,page:e,textSelectionEnabled:c}))):null,a?E(bx,null):null,h&&T?E(Cx,{annotationPageId:T,selectionEnabled:c}):null);return E(sx,d({key:S.type,height:y.height,width:y.width,x:e,y:t},b),"images"===S.type?S.images.map(((e,t)=>E(wx,{isStatic:u,key:e.id,image:e,id:e.id,rotation:g,annotationId:e.annotationId,thumbnail:0!==t||p?void 0:R,virtualSizes:o,annotations:I,skipSizes:f,skipThumbnail:p}))):null)}function Px({error:e,resetErrorBoundary:t,aspectRatio:i,height:r=512,width:n}){let a=i?{paddingTop:100*i+"%"}:{height:r,width:n};return ce((()=>{console.error(e)}),[e]),E("slot",{name:"fallback"},E("div",{role:"alert",style:d({background:"#000",color:"#fff",display:"flex",flexDirection:"column",alignContent:"center",justifyContent:"center",fontFamily:"monospace"},a)},E("div",{style:{padding:"1em",textAlign:"center"}},E("img",{className:"img-oops",part:"image-oops",width:33,height:24,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAICAYAAAAvOAWIAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAC6ADAAQAAAABAAAACAAAAADGHiDWAAAAO0lEQVQYGWP4DwQMQACjQWxkABOH0TgVwjRhKIQLwFRAaZg4jEaTphKXEWYOPmsYgQCmjnQPwnXiYQAAP/M3zvinPKAAAAAASUVORK5CYII="}),E("h2",null,"Unable to load image"),E("pre",null,null==e?void 0:e.message),t?E("button",{style:{color:"#fff",border:"2px solid #fff",background:"#000",fontFamily:"monospace",padding:"0.25em 1em"},onClick:t},"Try again"):null,E("style",null,".img-oops { border: 3px solid white; padding: 15px; image-rendering: auto; image-rendering: crisp-edges; image-rendering: pixelated; margin-bottom: 10px; }"))))}oe(),oe(),oe(),At(),oe(),At(),oe(),At();var Ox=jm;function Tx(e){let t=Dm(),i=me(Ym),r=Vm(),n=de(!1),a=de();ix((e=>(a.current=e,e.sequence=i,n.current||(n.current=!0,e.dispatchEvent(new CustomEvent("sequence",{detail:i}))),{})),[i]),ce((()=>{a.current&&(Yw.emit("onResetSeen"),a.current.dispatchEvent(new CustomEvent("sequence-change",{detail:{index:i.currentSequenceIndex,total:i.sequence.length}})))}),[i.currentSequenceIndex,r]);let o=0,s=t.map(((t,i)=>{let r=o;return o+=t.width+(e.margin||0),E(Ox,{key:t.id,canvas:t.id},E(Ax,p(d({key:t.id},e),{x:r})))}));return E(A,null,s)}var Rx=rx.ErrorBoundary;function Ix(e){let t=Lm(),i=Rm(),r=vv(),n=Um(),a=Cv((null==n?void 0:n.id)||(null==r?void 0:r.id)),[o,s]=le(!1),l=e.rotation||0,u=!e.displayOptions.viewport&&r?e.displayOptions.homePosition?e.displayOptions.homePosition.width/e.displayOptions.homePosition.height:r.width/r.height:void 0;ix((e=>a?(e.annotationPageManager||(e.annotationPageManager={}),e.annotationPageManager.availablePageIds=a.availablePageIds,e.annotationPageManager.enabledPageIds=a.enabledPageIds,e.annotationPageManager.setPageEnabled=a.setPageEnabled,e.annotationPageManager.setPageDisabled=a.setPageDisabled,{}):{}),[a.availablePageIds,a.enabledPageIds,a.setPageEnabled,a.setPageDisabled].join("/")),he((()=>{!1!==e.followAnnotations&&a.availablePageIds.map((e=>{t.requestStatus(e)||t.load(e)}))}),[a.availablePageIds,e.followAnnotations]),$m((e=>i.canvas?e.iiif.entities.Canvas[i.canvas]:null),[]);let[c,h]=fe((()=>{let t=e.displayOptions,{width:i,height:n,homePosition:a,containerProps:o}=t,s=g(t,["width","height","homePosition","containerProps"]),l=e.displayOptions.homePosition&&r?function(e,t){var i=e,{unit:r}=i,n=g(i,["unit"]);return"percent"===r?{x:t.width*(n.x/100),y:t.height*(n.y/100),width:t.width*(n.width/100),height:t.height*(n.height/100)}:n}(e.displayOptions.homePosition,r):null;return l&&(s.homePosition=l),i&&(s.width=i),n&&(s.height=n),[s,o]}),[e.displayOptions,r]),f=e.renderMultiple?Tx:Ax;return E(Rx,{fallbackRender:e=>E(Px,d({height:c.height,width:c.width,aspectRatio:u},e))},E(Zw,p(d({key:e.renderMultiple?"":null==r?void 0:r.id,aspectRatio:u,containerProps:d({onKeyDown:e=>{e.altKey&&"KeyB"===e.code&&s(!0)}},h||{}),className:e.className},c),{mode:o?"sketch":e.mode,homeCover:e.homeCover,homeOnResize:!!e.homeCover}),E(f,{isStatic:!e.interactive,debug:e.debug,virtualSizes:e.virtualSizes,highlight:e.highlight,highlightCssClass:e.highlightCssClass,annoMode:o,defaultChoices:e.defaultChoices,disableThumbnail:e.disableThumbnail,skipSizes:e.skipSizes,rotation:l,onCreated:e=>{n&&r&&e&&navigator.clipboard.writeText(Gv({id:`${r.id}#xywh=${e.x},${e.y},${e.width},${e.height}`,type:"Canvas",partOf:[{id:n.id,type:"Manifest"}]})),s(!1)},x:e.x,y:e.y,textSelectionEnabled:e.textSelectionEnabled,textEnabled:e.textEnabled,margin:e.margin}),e.children))}function Mx(e){return E("svg",d({width:"1em",height:"1em",viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",stroke:"#000"},e),E("g",{transform:"translate(1 1)",strokeWidth:2,fill:"none",fillRule:"evenodd"},E("circle",{strokeOpacity:.5,cx:18,cy:18,r:18}),E("path",{d:"M36 18c0-9.94-8.06-18-18-18"},E("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"1s",repeatCount:"indefinite"}))))}oe(),oe(),At();var zx=({manifestId:e,children:t})=>{let{manifest:i,isLoaded:r,error:n}=Fm(e,{});return ce((()=>{n&&console.error(n)}),[n]),n?E(Px,{error:new Error(`Unable to load Manifest: ${e} \n \n ${n.toString()}`)}):r&&i?E(Nm,{manifest:i.id},t):E(Mx,null)};At();var Lx=["width","height","target","region","highlight","highlight-css-class","disable-keyboard-navigation","click-to-enable-zoom","preferred-formats","atlas-mode","style-id","debug","preset","responsive","interactive","class","move-events","granular-move-events","a11y-title","a11y-role"],Fx=[...Lx,"manifest-id","canvas-id","choice-id","text-selection-enabled","disable-thumbnail","text-enabled","follow-annotations","iiif-content","home-cover","rotation"];typeof window<"u"&&Lt((e=>{let{vault:t,webComponent:i,runtime:r,atlasProps:n,isConfigBlocking:a,setParsedTarget:o,highlight:s,highlightCssClass:l,preferredFormats:u,virtualSizes:c,viewport:h,debug:f,mode:g,interactive:m,x:v,y:y,homeCover:b,className:w,inlineStyles:x,inlineStyleSheet:_,useProp:S,useRegisterWebComponentApi:k,setMode:C}=Gw(e),[A,P]=le(void 0),O=de([]),[T,R]=le(),[I,,M]=S("iiifContent",{parse:ny}),[z,L,,F]=S("canvasId"),[N,j,,$]=S("rotation",{parse:ry,defaultValue:0}),[B,D,,U]=S("manifestId"),[W]=S("followAnnotations",{parse:iy,defaultValue:!0}),[H,,,q]=S("choiceId",{parse:ty}),[V]=S("textSelectionEnabled",{parse:iy,defaultValue:!0}),[Q]=S("disableThumbnail",{parse:iy,defaultValue:!1}),[Y]=S("skipSizes",{parse:iy,defaultValue:!1}),[G]=S("textEnabled",{parse:iy,defaultValue:!1}),K=I&&"remote-content-state"!==I.type?I:null,X=I&&"remote-content-state"===I.type?I.id:null,Z=ge((e=>{i.current&&(Yw.emit("onResetSeen"),i.current.dispatchEvent(new CustomEvent("canvas-change",{detail:{canvas:e}})))}),[]),J=ge((e=>{if(A){let t={id:`${z}#xywh=${Yv(e.x)},${Yv(e.y)},${e.width},${e.height}`,type:"Canvas",partOf:[{id:B,type:"Manifest"}]},i={contentState:t,normalisedContentState:Xv(t),encodedContentState:Gv(t),selection:{type:"BoxSelector",spatial:e}};O.current.push(i),A(i)}}),[A,B,z]);if(k((e=>({vault:t,setCanvas:t=>{e.setAttribute("canvas-id",t)},setManifest:t=>{e.setAttribute("manifest-id",t)},setDefaultChoiceIds:t=>{e.setAttribute("choice-id",t.join(","))},getDefaultChoiceIds:()=>(q.current||[]).map((({id:e})=>e)),getCanvasId:()=>F.current,getContentState(){var e,t,i,n;let a=null!=U&&U.current?null==U?void 0:U.current:B,o={id:`${null!=F&&F.current?null==F?void 0:F.current:z}#xywh=${null==(e=r.current)?void 0:e.x},${null==(t=r.current)?void 0:t.y},${null==(i=r.current)?void 0:i.width},${null==(n=r.current)?void 0:n.height}`,type:"Canvas",partOf:[{id:a,type:"Manifest"}]};return{contentState:o,normalisedContentState:Xv(o),encodedContentState:Gv(o)}},getPosition(){var e,t,i,n;return{x:null==(e=r.current)?void 0:e.x,y:null==(t=r.current)?void 0:t.y,width:null==(i=r.current)?void 0:i.width,height:null==(n=r.current)?void 0:n.height}},getManifestId:()=>U.current,disableTextSelection(){e.setAttribute("text-selection-enabled","false")},enableTextSelection(){e.setAttribute("text-selection-enabled","true")},enableText(){e.setAttribute("text-enabled","true")},disableText(){e.setAttribute("text-enabled","true")},easingFunctions:()=>Ks,getContentStateStack:()=>O.current,transition(e){var t,i;null!=(t=r.current)&&t.transitionManager&&e(null==(i=r.current)?void 0:i.transitionManager)},enableContentStateSelection(e){C("sketch"),P((t=>t||e))},disableContentStateSelection(){P(void 0),C("explore"),O.current=[]},setContentStateFromText(e,t=!1){if(null==e||""===e.trim())return;let i=Xv(Kv(e));i.immediate=t;let n=i.target[0];F.current===n.source.id?r.current&&i.target&&i.target[0]&&i.target[0].selector&&"BoxSelector"===i.target[0].selector.type&&r.current.world.gotoRegion(p(d({},i.target[0].selector.spatial),{immediate:t})):M(i)}}))),he((()=>{X&&!T&&fetch(X).then((e=>e.json())).then((e=>{M(ny(e))})).catch((e=>{console.error(e),R(new Error(`Failed to load content state from ${X} \n\n ${e.toString()}`))}))}),[X,T]),he((()=>{if(K&&K.target.length){let e=K.target[0];if("SpecificResource"===e.type&&"Canvas"===e.source.type){let t=(e.source.partOf||[]).find((e=>"Manifest"===e.type));if(L(e.source.id),t&&D(t.id),e.selector&&r.current&&i.current)if("BoxSelector"===e.selector.type){let{x:t,y:i,width:n,height:a}=e.selector.spatial;r.current.world.gotoRegion({x:t,y:i,width:n,height:a,immediate:K.immediate})}else o(e)}}}),[K]),ce((()=>{Z(z)}),[z]),a)return null;if(T)return E(Px,{error:T,resetErrorBoundary:()=>R(null)});let ee=z?E(jm,{canvas:z},E(Ix,{key:`${z}-${h?"v1":"v0"}`,interactive:m,defaultChoices:H,followAnnotations:W,className:w,highlight:s,debug:f,virtualSizes:c,highlightCssClass:l,canvasId:z,displayOptions:n,mode:g,rotation:N||0,x:v,y:y,textEnabled:G,textSelectionEnabled:V,disableThumbnail:Q,skipSizes:Y,homeCover:b},E("slot",{name:"atlas"}),A?E(Cu,{onCreate:J}):null),E("slot",null)):null;return E(tx.Provider,{value:e.__registerPublicApi},E(zm,{vault:t},E(Sx,null,B?E(zx,{manifestId:B},ee):ee)),x?E("style",null,x):null,_?E("link",{rel:"stylesheet",href:_}):null)}),"canvas-panel",Fx,{shadow:!0,onConstruct(e){Object.defineProperty(e,"vault",{get:()=>e._props.vault,set(t){e._props.vault=t}}),e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}}),oe(),At();var Nx=b(zt()).ErrorBoundary;function jx(e){let{atlasProps:t,isConfigBlocking:i,setIsReady:r,preferredFormats:n,virtualSizes:a,height:o,width:s,className:l,inlineStyles:u,inlineStyleSheet:c,viewport:h,vault:p,useProp:f,interactive:g,x:m,y:v,homeCover:y}=Gw(e),[b]=f("src"),[w]=f("nested",{parse:iy}),[x]=f("rotation",{parse:ry}),[_,S]=f("tileFormat"),[k]=f("skipSizes",{parse:iy}),[C]=f("disableThumbnail",{parse:iy}),[A,P]=Ov(),O=P[b],T=fe((()=>{let e=A({id:b},{});return e&&e.preferredFormats&&1===e.preferredFormats.length&&S(e.preferredFormats[0]),e&&e.height&&e.width&&"loading"!==O?{id:b,width:e.width,height:e.height,service:e,type:"Image",selector:{type:"BoxSelector",spatial:{x:0,y:0,width:e.width,height:e.height}},target:{type:"BoxSelector",spatial:{x:0,y:0,width:e.width,height:e.height}}}:null}),[A,b,P]);if(!T||!T.height||!T.width||i)return null;let R=h?void 0:t.homePosition?t.homePosition.width/t.homePosition.height:T.width/T.height;return E(Nx,{fallbackRender:e=>E(Px,d({height:o,width:s,aspectRatio:R},e))},E(zm,{vault:p},E(Zw,d({onCreated:()=>{r(!0)},viewport:!0,aspectRatio:R,className:l,nested:w,homeCover:y,homeOnResize:!!y,rotation:x},t),E(wx,{key:T.id,image:T,id:T.id,isStatic:!g,virtualSizes:a,skipSizes:k,skipThumbnail:C,x:m,y:v,rotation:x,tileFormat:_}))),u?E("style",null,u):null,c?E("link",{rel:"stylesheet",href:c}):null,e.children?E("slot",null,e.children):null)}typeof window<"u"&&Lt((function(e){let t=fe((()=>new wm),[]);return E(Av.Provider,{value:t},E(jx,d({},e)))}),"image-service",["src","nested","x","y","width","height","target","region","highlight","highlight-css-class","text-selection-enabled","disable-keyboard-navigation","click-to-enable-zoom","preferred-formats","atlas-mode","style-id","debug","preset","responsive","interactive","iiif-content","class","choice-id","move-events","granular-move-events","home-cover","tile-format","rotation"],{shadow:!0,onConstruct(e){e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}}),oe(),At();var $x=[...Lx,"manifest-id","range-id","start-canvas","paging-enabled","text-selection-enabled","text-enabled","follow-annotations","margin"];typeof window<"u"&&Lt((function(e){let{vault:t,webComponent:i,runtime:r,atlasProps:n,isConfigBlocking:a,setParsedTarget:o,highlight:s,highlightCssClass:l,preferredFormats:u,virtualSizes:c,viewport:h,debug:d,mode:p,interactive:f,x:g,y:m,className:v,inlineStyles:y,inlineStyleSheet:b,useProp:w,useRegisterWebComponentApi:x,setMode:_}=Gw(e),[S,k,,C]=w("manifestId"),[A,,,P]=w("rangeId"),[O,T,,R]=w("startCanvas"),[I]=w("margin",{parse:ry,defaultValue:0}),[M]=w("pagingEnabled",{parse:iy,defaultValue:!0}),[z]=w("textSelectionEnabled",{parse:iy,defaultValue:!0}),[L]=w("textEnabled",{parse:iy,defaultValue:!1}),[F]=w("followAnnotations",{parse:iy,defaultValue:!0}),[N,,j]=w("iiifContent",{parse:ny}),$=N&&"remote-content-state"!==N.type?N:null,B=N&&"remote-content-state"===N.type?N.id:null,[D,U]=le(),[W]=w("skipSizes",{parse:iy,defaultValue:!1});return x((e=>({vault:t,setManifest:t=>{e.setAttribute("manifest-id",t)},setRange:t=>{e.setAttribute("range-id",t)},getRangeId:()=>P.current,getContentState(){let e=null!=C&&C.current?null==C?void 0:C.current:S,t=i.current.sequence,n=t.items[t.sequence[t.currentSequenceIndex][0]].id,{x:a,y:o,width:s,height:l}=(null==r?void 0:r.current)||{},u={id:`${n}#xywh=${Yv(a)},${Yv(o)},${s},${l}`,type:"Canvas",partOf:[{id:e,type:"Manifest"}]};return{contentState:u,normalisedContentState:Xv(u),encodedContentState:Gv(u)}},setContentStateFromText(e,t=!1){if(null==e||""===e.trim())return;let i=Xv(Kv(e));i.immediate=t,j(i)},getManifestId:()=>C.current,disableTextSelection(){e.setAttribute("text-selection-enabled","false")},enableTextSelection(){e.setAttribute("text-selection-enabled","true")},enableText(){e.setAttribute("text-enabled","true")},disableText(){e.setAttribute("text-enabled","true")}}))),he((()=>{B&&!D&&fetch(B).then((e=>e.json())).then((e=>{j(ny(e))})).catch((e=>{console.error(e),U(new Error(`Failed to load content state from ${B} \n\n ${e.toString()}`))}))}),[B,D]),he((()=>{var e;if($&&$.target.length){let t=$.target[0];if("SpecificResource"===t.type&&"Canvas"===t.source.type){let n=(t.source.partOf||[]).find((e=>"Manifest"===e.type));if(i.current.sequence.setCurrentCanvasId(t.source.id),n&&k(n.id),t.selector&&"BoxSelector"===t.selector.type){let{x:i,y:n,width:a,height:o}=t.selector.spatial;null==(e=null==r?void 0:r.current)||e.world.gotoRegion({x:i,y:n,width:a,height:o,immediate:$.immediate})}}}}),[$]),!S||a?null:E(tx.Provider,{value:e.__registerPublicApi},E(zm,{vault:t},E(Sx,null,E(Km,{manifest:S,startCanvas:O,rangeId:A,pagingEnabled:M},E(Ix,{renderMultiple:!0,key:`${O}-${h?"v1":"v0"}`,interactive:f,followAnnotations:F,className:v,highlight:s,debug:d,virtualSizes:c,highlightCssClass:l,displayOptions:n,mode:p,textEnabled:L,skipSizes:W,textSelectionEnabled:z,margin:I},E("slot",{name:"atlas"})),E("slot",null)))),y?E("style",null,y):null,b?E("link",{rel:"stylesheet",href:b}):null)}),"sequence-panel",$x,{shadow:!0,onConstruct(e){Object.defineProperty(e,"vault",{get:()=>e._props.vault,set(t){e._props.vault=t}}),e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}}),oe(),At(),oe();var Bx=({metadata:e=[],config:t,variation:i="table",labelWidth:r=16,bordered:n,labelStyle:a,showEmptyMessage:o,allowHtml:s,separator:l})=>{let u={separator:l},c=fe((()=>{let i=(t||[]).reduce(((e,t)=>[...e,...t.keys]),[]),r={};for(let t of e){let e=t&&t.label?Object.values(t.label):[];for(let n of e)if(n&&n.length&&(-1!==i.indexOf(`metadata.${n[0]}`)||0===i.length)&&t){let e=`metadata.${n[0]}`;r[e]=r[e]?r[e]:[],r[e].push(t);break}}return r}),[t,e]);return 0===Object.keys(c).length&&o?E("slot",{name:"empty"}):t&&t.length?E("table",{"data-variation":i,"data-label-style":a,"data-bordered":n},E("slot",{slot:"header"}),E("tbody",null,t.map(((e,t)=>{let i=[];for(let r of e.keys)for(let e of c[r]||[])i.push(E("div",{key:t+"__"+r},s?E("span",{dangerouslySetInnerHTML:{__html:kb(e.value,u)}}):kb(e.value,u)));return 0===i.length?null:E("tr",{className:"metadata-row",key:t},E("td",{className:"metadata-key",style:r?{minWidth:r}:{}},s?E("span",{dangerouslySetInnerHTML:{__html:kb(e.label,u)}}):kb(e.label,u)),E("td",{className:"metadata-value"},i))}))),E("slot",{name:"footer"})):E("table",{"data-variation":i,"data-label-style":a,"data-bordered":n},E("slot",{name:"header"}),E("tbody",null,e&&e.length?e.map(((e,t)=>e?E("tr",{className:"metadata-row",key:t},E("td",{className:"metadata-key",style:r?{minWidth:r}:{}},s?E("span",{dangerouslySetInnerHTML:{__html:kb(e.label,u)}}):kb(e.label,u)),E("td",{className:"metadata-value"},s?E("span",{dangerouslySetInnerHTML:{__html:kb(e.value,u)}}):kb(e.value,u))):null)):E("slot",{name:"empty-table"})),E("slot",{name:"footer"}))};function Dx(e){let{manifest:t}=Fm(e.manifestId);return E(Bx,p(d({},e),{metadata:null==t?void 0:t.metadata}))}function Ux(e){var t;let i=Vm(),r=Lm(),n=fe((()=>null==i?void 0:i.items.find((e=>"Canvas"===e.type))),[i]),a=fe((()=>!(null==i||!i.items.find((e=>"Range"===e.type)))),[i]),o=e.selected&&e.selected===(null==i?void 0:i.id);return i?E("ul",{className:"range-item-container","data-leaf":!a,"data-selected":o,"data-with-selector":-1!==(null==(t=null==n?void 0:n.id)?void 0:t.indexOf("#")),"data-range-id":i.id},i.label?E("li",{className:"range-split",onClick:function(){var t,o;if(i&&e.onRangeClick){let s={isLeaf:!a};if(n){let[e,i]=null==(t=n.id)?void 0:t.split("#");s.selector=n.id,s.canvasId=e,s.fragment=i}else if(i){let e=Zb(r,i);if(e){let[t,i]=null==(o=e.id)?void 0:o.split("#");s.selector=e.id,s.canvasId=t,s.fragment=i}}if(s.selector)try{s.parsedSelector=Qb(s.selector)}catch(e){}e.onRangeClick(i,s)}}},E("span",{className:"range-label"},kb(i.label))):null,a?E("div",{className:"range-nested-container"},i.items.map((t=>"Canvas"!==t.type&&"SpecificResource"!==t.type&&t.id?E(Wm,{key:t.id,range:t.id},E(Ux,{onRangeClick:e.onRangeClick,selected:e.selected})):null))):null):null}function Wx(e){let t=Um(),i=Lm();if(!t)throw new Error("No manifest");let r=e.canvasId?function(e,t,i){for(let r of t.structures){let t=Jb(e,e.get(r),i);if(t)return t}return null}(i,t,e.canvasId):e.selectedRange?i.get(e.selectedRange):void 0;return he((()=>{if(r&&e.autoScroll){let e=document.querySelector(`[data-range-id="${r.id}"]`);e&&e.scrollIntoView({block:"nearest",behavior:"auto"})}}),[r]),t&&t.structures.length?E(A,null,r?E("div",{className:"range-current"},kb(r.label)):null,t.structures.map((t=>E(Wm,{key:t.id,range:t.id},E(Ux,{selected:null==r?void 0:r.id,onRangeClick:e.onRangeClick}))))):E("slot",{name:"no-range"})}function Hx(e){let{manifest:t,isLoaded:i}=Fm(e.manifestId);return t&&i?E(Nm,{manifest:t.id},E(Wx,d({},e))):null}typeof window<"u"&&Lt((function(e){let t=Wv(),i=e.vault||t||Qw(),[r]=qv(e.manifestId),[n]=qv(e.variation),[a]=qv(e.labelStyle),[o]=qv(e.separator),[s]=qv(e.labelWidth,{parse:ry}),[l]=qv(e.bordered,{parse:iy,defaultValue:!1}),[u]=qv(e.allowHtml,{parse:iy,defaultValue:!1}),[c]=qv(e.showEmptyMessage,{parse:iy,defaultValue:!1});return r?E(A,null,E(zm,{vault:i},E(Nm,{manifest:r},E(Dx,{manifestId:r,variation:n,labelStyle:a,labelWidth:s,bordered:l,showEmptyMessage:c,allowHtml:u,separator:o})))):E("slot",{name:"no-manifest"})}),"metadata-panel",["manifest-id","config-id","variation","label-style","label-width","bordered","show-empty-message"],{shadow:!1,onConstruct(e){Object.defineProperty(e,"vault",{get:()=>e._props.vault,set(t){e._props.vault=t}}),e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}}),oe(),At(),oe(),oe(),At(),At();typeof window<"u"&&Lt((function(e){let t=Wv(),i=e.vault||t||Qw(),[r]=qv(e.manifestId),[n]=qv(e.canvasId),[a]=qv(e.selectedRange),[o]=qv(e.autoScroll,{parse:iy,defaultValue:!0}),[s,l]=le();return he((()=>{e.__registerPublicApi&&e.__registerPublicApi((e=>(l(e),{})))}),[]),r?E(A,null,E(zm,{vault:i},E(Hx,{manifestId:r,canvasId:n,selectedRange:a,autoScroll:o,onRangeClick:function(e,t){s&&s.dispatchEvent(new CustomEvent("range-change",{detail:{range:e,isLeaf:t.isLeaf,canvasId:t.canvasId,fragment:t.fragment,selector:t.selector,parsedSelector:t.parsedSelector}}))}}))):E("slot",{name:"no-manifest"})}),"range-panel",["manifest-id","config-id","canvas-id","auto-scroll","selected-range"],{shadow:!1,onConstruct(e){Object.defineProperty(e,"vault",{get:()=>e._props.vault,set(t){e._props.vault=t}}),e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}})})();
/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
/**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @param {?boolean} capture Check if the capture phase is supported.
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */
/** Code to "flatten" quadratic and cubic Bézier curves to polylines.
 *
 * All code in this module is based on JavaScript code by Raph Levien, published on his blog at
 * https://raphlinus.github.io/.
 * I merely changed the structure a bit, removed some unneeded parts and added some comments and type hints.
 *
 * Flattening of quadratic Bézier curves:
 * - Article: https://raphlinus.github.io/graphics/curves/2019/12/23/flatten-quadbez.html
 * - Code: https://github.com/raphlinus/raphlinus.github.io/blob/master/_posts/2019-12-23-flatten-quadbez.md?plain=1#L73-L212
 *
 * Flattening of cubic Bézier curves: https://levien.com/tmp/flatten.html
 *
 * Note that the code in this module has a different license than the rest of the package,
 * due to the inclusion of Apache-licensed third party code.
 *
 * @license
 * Copyright 2022 Johannes Baiter <johannes.baiter@gmail.com>
 * Copyright 2019, 2022 Raph Levien <raph.levien@gmail.com>
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
//# sourceMappingURL=/sm/f97cbfa491c995da8a946e513ae99cc84b2776d2aea81be24882ce388358b4dc.map